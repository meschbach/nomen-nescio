{"version":3,"sources":["webpack:///webpack/bootstrap 96f9d77ad30213b2245b","webpack:///./node_modules/THREE/three.js","webpack:///./src/browser/stats.js","webpack:///./src/browser/collidable.js","webpack:///./src/browser/rendering.js","webpack:///./src/browser/system.js","webpack:///./src/browser/renderer.js","webpack:///./node_modules/stats.js/build/stats.min.js","webpack:///(webpack)/buildin/module.js","webpack:///./src/browser/simulation.js","webpack:///./src/browser/player.js","webpack:///./src/browser/thrusters.js","webpack:///./src/browser/player-controls.js","webpack:///./src/browser/dock.js","webpack:///./node_modules/three-loaders-collada/index.js"],"names":["self","THREE","REVISION","module","exports","Math","sign","undefined","x","log","console","apply","arguments","warn","error","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","NoShading","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","Projector","projectVector","vector","camera","project","unprojectVector","unproject","pickingRay","CanvasRenderer","domElement","document","createElement","clear","render","setClearColor","setSize","Color","color","length","setRGB","set","prototype","constructor","r","g","b","value","copy","setHex","setStyle","hex","floor","setHSL","h","s","l","hue2rgb","p","q","t","style","test","exec","min","parseInt","ColorKeywords","copyGammaToLinear","gammaFactor","pow","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","sqrt","getHex","getHexString","toString","slice","getHSL","optionalTarget","hsl","max","hue","saturation","lightness","delta","getStyle","offsetHSL","add","addColors","color1","color2","addScalar","multiply","multiplyScalar","lerp","alpha","equals","c","fromArray","array","toArray","offset","clone","Quaternion","y","z","w","_x","_y","_z","_w","onChangeCallback","quaternion","setFromEuler","euler","update","Euler","Error","c1","cos","c2","c3","s1","sin","s2","s3","order","setFromAxisAngle","axis","angle","halfAngle","setFromRotationMatrix","m","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","Vector3","dot","abs","crossVectors","normalize","inverse","conjugate","v","lengthSq","multiplyQuaternions","a","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","slerp","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","callback","qa","qm","Vector2","setX","setY","setComponent","index","getComponent","addVectors","sub","subVectors","subScalar","divide","divideScalar","scalar","invScalar","clamp","clampScalar","minVal","maxVal","ceil","round","roundToZero","negate","distanceTo","distanceToSquared","dx","dy","setLength","oldLength","lerpVectors","v2","fromAttribute","attribute","itemSize","setZ","multiplyVectors","applyEuler","applyAxisAngle","applyMatrix3","e","applyMatrix4","applyProjection","d","qx","qy","qz","qw","ix","iy","iz","iw","matrix","Matrix4","multiplyMatrices","projectionMatrix","getInverse","matrixWorld","transformDirection","lengthManhattan","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","normal","angleTo","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","setFromMatrixPosition","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","PI","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","asin","atan2","setFromQuaternion","makeRotationFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","start","end","line","center","result","distanceSq","distance","at","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","Infinity","setFromPoints","points","makeEmpty","i","il","expandByPoint","setFromCenterAndSize","size","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromObject","object","scope","updateMatrixWorld","traverse","node","geometry","Geometry","vertices","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","radius","Matrix3","Float32Array","n11","n12","n13","n21","n22","n23","n31","n32","n33","identity","multiplyVector3Array","applyToVector3Array","j","determinant","f","throwOnInvertible","det","msg","transpose","tmp","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","lookAt","eye","target","up","n","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","setPosition","rotateX","rotateY","rotateZ","rotateByAxis","scale","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","position","decompose","invSX","invSY","invSZ","makeFrustum","left","right","bottom","top","near","far","makePerspective","fov","aspect","ymax","tan","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","origin","direction","ray","recast","directionDistance","distanceSqToSegment","segCenter","segDir","diff","v0","optionalPointOnRay","optionalPointOnSegment","segExtent","a01","b0","b1","s0","sqrDist","extDet","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","boundingSphere","computeBoundingSphere","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","split","uuid","Array","rnd","random","join","clampBottom","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","low","high","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nextPowerOfTwo","Spline","v3","intPoint","weight","w2","w3","pa","pb","pc","pd","initFromArray","getPoint","k","interpolate","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","total","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","push","t2","t3","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","Clock","autoStart","startTime","oldTime","elapsedTime","running","performance","now","Date","stop","getElapsedTime","getDelta","newTime","EventDispatcher","addEventListener","hasEventListener","removeEventListener","dispatchEvent","type","listener","_listeners","listeners","indexOf","listenerArray","splice","event","call","Raycaster","params","Sprite","Mesh","PointCloud","threshold","LOD","Line","descSort","intersectObject","raycaster","intersects","recursive","raycast","children","precision","linePrecision","setFromCamera","PerspectiveCamera","OrthographicCamera","sort","intersectObjects","objects","Object3D","Object","defineProperty","Object3DIdCount","name","parent","DefaultUp","rotation","onRotationChange","onQuaternionChange","defineProperties","enumerable","rotationAutoUpdate","matrixAutoUpdate","matrixWorldNeedsUpdate","visible","castShadow","receiveShadow","frustumCulled","renderOrder","userData","eulerOrder","useQuaternion","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","remove","getChildByName","getObjectByName","getObjectById","id","getObjectByProperty","child","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","updateMatrix","force","toJSON","output","metadata","version","generator","geometries","parseGeometry","json","materials","parseMaterial","material","parseObject","data","JSON","stringify","AmbientLight","DirectionalLight","intensity","PointLight","decay","SpotLight","exponent","HemisphereLight","groundColor","mode","parse","Face3","materialIndex","vertexNormals","vertexColors","vertexTangents","face","Face4","BufferAttribute","needsUpdate","copyAt","index1","index2","setXY","setXYZ","setXYZW","Int8Attribute","Uint8Attribute","Uint8ClampedAttribute","Int16Attribute","Uint16Attribute","Int32Attribute","Uint32Attribute","Float32Attribute","Float64Attribute","DynamicBufferAttribute","updateRange","count","create","GeometryIdCount","attributesKeys","drawcalls","offsets","boundingBox","addAttribute","keys","getAttribute","addDrawCall","indexOffset","computeBoundingBox","fromGeometry","settings","faces","faceVertexUvs","hasFaceVertexUv","hasFaceVertexNormals","normals","colors","uvs","i3","na","nb","nc","fc","vca","vcb","vcc","uva","uvb","uvc","bb","isNaN","computeFaceNormals","computeVertexNormals","vA","vB","vC","pA","pB","pC","cb","ab","indices","jl","normalizeNormals","computeTangents","uv","nVertices","tangent","tangents","tan1","tan2","uvA","uvB","uvC","x1","y1","z1","sdir","tdir","handleTriangle","iA","iB","iC","tmp2","n2","handleVertex","computeOffsets","facesCount","sortedIndices","Uint16Array","indexPtr","vertexPtr","duplicatedVertices","newVerticeMaps","faceVertices","Int32Array","vertexMap","revVertexMap","findex","vo","vid","faceMax","new_offset","new_vid","reorderBuffers","merge","key","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","indexBuffer","indexMap","vertexCount","sortedAttributes","attr","sourceArray","attrArray","attrSize","sortedAttr","numItems","sourceAttr","dispose","morphTargets","morphColors","morphNormals","skinWeights","skinIndices","lineDistances","hasTangents","dynamic","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","tangentsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","fromBufferGeometry","tempNormals","tempUVs","addFace","drawcall","fl","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","dstNormalsFace","dstNormalsVertex","faceNormal","vertexIndex","context","ua","ub","uc","faceIndex","computeLineDistances","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","uvs2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mesh","mergeVertices","verticesMap","unique","changes","precisionPoints","faceIndicesToRemove","dupIndex","idx","parameters","normalsHash","colorsHash","uvsHash","hasMaterial","hasFaceUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","setBit","getUvIndex","getNormalIndex","getColorIndex","enabled","hash","uvsCopy","kl","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","format","magFilter","minFilter","updateCubeMap","renderer","scene","generateMipmaps","activeCubeFace","zoom","updateProjectionMatrix","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","width","height","Light","light","AreaLight","constantAttenuation","linearAttenuation","quadraticAttenuation","onlyShadow","shadowCameraNear","shadowCameraFar","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","shadowCascade","shadowCascadeOffset","shadowCascadeCount","shadowCascadeBias","shadowCascadeWidth","shadowCascadeHeight","shadowCascadeNearZ","shadowCascadeFarZ","shadowCascadeArray","shadowMap","shadowMapSize","shadowCamera","shadowMatrix","skyColor","shadowCameraFov","Cache","files","file","get","Loader","showStatus","statusDomElement","addStatusElement","imageLoader","ImageLoader","onLoadStart","onLoadProgress","onLoadComplete","crossOrigin","fontSize","textAlign","background","padding","zIndex","innerHTML","updateProgress","progress","message","loaded","toFixed","extractUrlBase","url","parts","pop","initMaterials","texturePath","createMaterial","needsTangents","ShaderMaterial","nearest_pow2","LN2","create_texture","where","sourceFile","repeat","wrap","anisotropy","fullPath","texture","loader","Handlers","load","Texture","image","canvas","getContext","drawImage","wrapS","wrapT","wrapMap","rgb2hex","rgb","mtype","mpars","opacity","map","lightMap","normalMap","bumpMap","wireframe","shading","toLowerCase","blending","transparent","depthTest","depthWrite","flipSided","side","doubleSided","colorDiffuse","DbgColor","colorSpecular","specular","colorEmissive","emissive","transparency","specularCoef","shininess","mapDiffuse","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLight","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapBump","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormal","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecular","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlpha","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","mapBumpScale","bumpScale","mapNormalFactor","normalScale","DbgName","handlers","regex","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","request","XMLHttpRequest","open","response","itemEnd","responseType","send","itemStart","setResponseType","setCrossOrigin","src","JSONLoader","withCredentials","loadAjaxJSON","callbackProgress","xhr","onreadystatechange","readyState","DONE","status","responseText","LOADING","getResponseHeader","HEADERS_RECEIVED","parseModel","parseSkin","parseMorphing","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","influencesPerVertex","bones","animation","animations","dstVertices","srcVertices","cl","dstColors","srcColors","LoadingManager","BufferGeometryLoader","text","typedArray","MaterialLoader","uniforms","vertexShader","fragmentShader","sizeAttenuation","ObjectLoader","substring","lastIndexOf","setTexturePath","parseGeometries","images","parseImages","textures","parseTextures","parseMaterials","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","BoxGeometry","depth","depthSegments","CircleGeometry","segments","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","IcosahedronGeometry","detail","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","getTexture","alphaMap","envMap","specularMap","loadImage","path","getGeometry","getMaterial","Scene","Group","TextureLoader","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","buffer","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","loadTexture","texDatas","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","alphaTest","overdraw","_needsUpdate","setValues","values","newValue","currentValue","Number","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshNormalMaterial","MeshDepthMaterial","PointCloudMaterial","SpriteMaterial","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","combine","reflectivity","refractionRatio","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","wrapAround","wrapRGB","metal","MeshFaceMaterial","ParticleBasicMaterial","ParticleSystemMaterial","defines","lights","defaultAttributeValues","index0AttributeName","UniformsUtils","RawShaderMaterial","mapping","TextureIdCount","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","CubeTexture","VideoTexture","video","requestAnimationFrame","HAVE_ENOUGH_DATA","inverseMatrix","localThreshold","testPoint","rayPointDistance","intersectPoint","distanceToRay","oi","ol","pointCount","ParticleSystem","LineStrip","LinePieces","precisionSq","vStart","vEnd","interSegment","interRay","step","distSq","offsetIndex","nbVertices","updateMorphTargets","morphTargetBase","morphTargetForcedOrder","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","intersectionPoint","isFaceMaterial","objectMaterials","morphInfluences","tl","influence","targets","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","bone","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","pos","rotq","scl","normalizeSkinWeights","bind","skeleton","sw","MorphAnimMesh","duration","mirroredLoop","time","lastKeyframe","currentKeyframe","directionBackwards","setFrameRange","startKeyframe","endKeyframe","setDirectionForward","setDirectionBackward","parseAnimations","firstAnimation","pattern","morph","match","label","setAnimationLabel","playAnimation","fps","updateAnimation","frameTime","keyframe","mix","interpolateTargets","influences","addLevel","getObjectForDistance","matrixPosition","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","bump","normalmap","particle","shadowmap","ShaderLib","WebGLRenderer","_canvas","_context","pixelRatio","_precision","_alpha","_depth","_stencil","stencil","_antialias","antialias","_premultipliedAlpha","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_logarithmicDepthBuffer","logarithmicDepthBuffer","_clearColor","_clearAlpha","_webglObjects","_webglObjectsImmediate","opaqueObjects","transparentObjects","sprites","autoClear","autoClearColor","autoClearDepth","autoClearStencil","sortObjects","gammaInput","gammaOutput","shadowMapEnabled","shadowMapType","shadowMapCullFace","shadowMapDebug","shadowMapCascade","maxMorphTargets","maxMorphNormals","autoScaleCubemaps","info","memory","programs","calls","_this","_programs","_currentProgram","_currentFramebuffer","_currentMaterialId","_currentGeometryProgram","_currentCamera","_usedTextureUnits","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_currentWidth","_currentHeight","_frustum","_projScreenMatrix","_vector3","_direction","_lightsNeedUpdate","_lights","ambient","directional","distances","decays","spot","directions","anglesCos","exponents","hemi","skyColors","groundColors","_gl","preventDefault","resetGLState","setDefaultGLState","state","WebGLState","paramThreeToGL","getShaderPrecisionFormat","extensions","WebGLExtensions","glClearColor","clearColor","clearDepth","clearStencil","enable","DEPTH_TEST","depthFunc","LEQUAL","frontFace","CCW","cullFace","BACK","CULL_FACE","BLEND","FUNC_ADD","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","viewport","reset","_maxTextures","MAX_TEXTURE_IMAGE_UNITS","_maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","_maxTextureSize","MAX_TEXTURE_SIZE","_maxCubemapSize","MAX_CUBE_MAP_TEXTURE_SIZE","_supportsVertexTextures","_supportsBoneTextures","_vertexShaderPrecisionHighpFloat","VERTEX_SHADER","HIGH_FLOAT","_vertexShaderPrecisionMediumpFloat","MEDIUM_FLOAT","_fragmentShaderPrecisionHighpFloat","FRAGMENT_SHADER","_fragmentShaderPrecisionMediumpFloat","getCompressedTextureFormats","formats","COMPRESSED_TEXTURE_FORMATS","highpAvailable","mediumpAvailable","shadowMapPlugin","ShadowMapPlugin","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","forceContextLoss","loseContext","supportsVertexTextures","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","getMaxAnisotropy","extension","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","updateStyle","setViewport","setScissor","scissor","enableScissorTest","SCISSOR_TEST","disable","getClearColor","getClearAlpha","setClearAlpha","bits","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearTarget","setRenderTarget","createParticleBuffers","__webglVertexBuffer","createBuffer","__webglColorBuffer","createLineBuffers","__webglLineDistanceBuffer","createMeshBuffers","geometryGroup","__webglNormalBuffer","__webglTangentBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","numMorphTargets","__webglMorphTargetsBuffers","numMorphNormals","__webglMorphNormalsBuffers","onObjectRemoved","removeObject","onGeometryDispose","deallocateGeometry","onTextureDispose","deallocateTexture","onRenderTargetDispose","deallocateRenderTarget","onMaterialDispose","deallocateMaterial","deleteBuffers","buffers","deleteBuffer","__webglCustomAttributesList","__webglInit","geometryGroupsList","geometryGroups","__webglTextureCube","deleteTexture","__webglTexture","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","program","programInfo","deleteProgram","usedTimes","newPrograms","initCustomAttributes","nvertices","__webglInitialized","createUniqueBuffers","belongsToAttribute","initParticleBuffers","__vertexArray","__colorArray","__webglParticleCount","initLineBuffers","__lineDistanceArray","__webglLineCount","initMeshBuffers","faces3","ntris","nlines","getBufferMaterial","__normalArray","__uvArray","__uv2Array","__tangentArray","__skinIndexArray","__skinWeightArray","UintArray","Uint32Array","__typeArray","__faceArray","__lineArray","__morphTargetsArrays","__morphNormalsArrays","__webglFaceCount","originalAttribute","property","__original","__inittedArrays","materialNeedsFaceNormals","setParticleBuffers","hint","vertexArray","colorArray","dirtyVertices","dirtyColors","customAttributes","ca","cal","customAttribute","bindBuffer","ARRAY_BUFFER","bufferData","boundTo","setLineBuffers","dl","lineDistanceArray","dirtyLineDistances","setMeshBuffers","needsFaceNormals","faceColor","uv2","n1","n3","sw1","sw2","sw3","si1","si2","si3","vn","uvi","uv2i","vk","vkl","vka","nka","chf","offset_uv","offset_uv2","offset_face","offset_normal","offset_tangent","offset_line","offset_color","offset_skin","offset_morphTarget","offset_custom","uvArray","uv2Array","normalArray","tangentArray","skinIndexArray","skinWeightArray","morphTargetsArrays","morphNormalsArrays","faceArray","lineArray","dirtyElements","dirtyUvs","dirtyNormals","dirtyTangents","dirtyMorphTargets","morphTargetsNeedUpdate","chunk_faces3","obj_faces","obj_uvs","obj_uvs2","obj_skinIndices","obj_skinWeights","ELEMENT_ARRAY_BUFFER","pp","renderBufferImmediate","initAttributes","hasPositions","hasNormals","hasUvs","__webglUvBuffer","hasColors","positionArray","DYNAMIC_DRAW","enableAttribute","vertexAttribPointer","FLOAT","nx","ny","nz","nax","nbx","ncx","nay","nby","ncy","naz","nbz","ncz","disableUnusedAttributes","drawArrays","TRIANGLES","setupVertexAttributes","startIndex","geometryAttributes","programAttributes","programAttributesKeys","programAttribute","geometryAttribute","vertexAttrib2fv","vertexAttrib3fv","renderBufferDirect","updateObject","setProgram","updateBuffers","wireframeBit","geometryProgram","LINES","UNSIGNED_INT","UNSIGNED_SHORT","drawElements","POINTS","LINE_STRIP","setLineWidth","renderBuffer","setupMorphTargets","skinIndex","skinWeight","lineDistance","numSupportedMorphTargets","__webglMorphTargetInfluences","activeInfluenceIndices","numericalSort","numSupportedMorphNormals","influenceIndex","uniform1fv","painterSortStable","reversePainterSortStable","forceClear","projectObject","webglObject","setupMatrices","unrollImmediateBufferMaterial","setMaterial","renderObjects","renderObjectsImmediate","setBlending","updateRenderTargetMipmap","setDepthTest","setDepthWrite","setColorWrite","initObject","webglObjects","unrollBufferMaterial","renderList","setMaterialFaces","materialType","renderImmediateObject","immediateRenderCallback","globject","opaque","_modelViewMatrix","_normalMatrix","initGeometryGroups","__webglActive","addBuffer","ImmediateRenderObject","addBufferImmediate","geometryGroupCounter","makeGroups","usesFaceMaterial","maxVerticesInGroup","groupHash","hash_map","group","groups","groupsList","counter","addBuffers","objlist","bufferType","STATIC_DRAW","bufferSubData","BYTES_PER_ELEMENT","subarray","customAttributesDirty","areCustomAttributesDirty","clearCustomAttributes","removeInstances","o","shaderIDs","initMaterial","shaderID","shader","__webglShader","maxLightCount","allocateLights","maxShadows","allocateShadows","maxBones","allocateBones","envMapMode","useFog","fogExp","flatShading","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","code","pl","WebGLProgram","base","uniformsList","location","setPolygonOffset","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","useProgram","uniformMatrix4fv","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","setupLights","refreshUniformsLights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","refreshUniformsLambert","mNear","mFar","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","diffuse","uvScaleMap","offsetRepeat","flipEnvMap","totalSize","psColor","fogColor","fogNear","fogFar","fogDensity","ambientLightColor","directionalLightColor","directionalLightDirection","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDistance","spotLightDirection","spotLightAngleCos","spotLightExponent","spotLightDecay","hemisphereLightSkyColor","hemisphereLightGroundColor","hemisphereLightDirection","modelViewMatrix","uniformMatrix3fv","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform2fv","uniform3fv","uniform4fv","_array","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","setFaceCulling","frontFaceDirection","CW","FRONT","FRONT_AND_BACK","setDoubleSided","setFlipSided","setTextureParameters","textureType","isImagePowerOfTwo","texParameteri","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","uploadTexture","createTexture","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","clampToMaxSize","glFormat","glType","mipmap","texImage2D","compressedTexImage2D","generateMipmap","slot","activeTexture","TEXTURE0","maxSize","TEXTURE_CUBE_MAP","isCompressed","isDataTexture","cubeImage","TEXTURE_CUBE_MAP_POSITIVE_X","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","isCube","isTargetPowerOfTwo","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","WebGLRenderTarget","restore","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","RGBA","UNSIGNED_BYTE","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","INT","HALF_FLOAT_OES","ALPHA","RGB","LUMINANCE","LUMINANCE_ALPHA","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","nVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","nVertexMatrices","dirLights","pointLights","spotLights","hemiLights","addPrePlugin","addPostPlugin","updateShadowMap","options","gl","getExtension","programIdCount","generateDefines","chunk","cacheUniformLocations","identifiers","getUniformLocation","cacheAttributeLocations","getAttribLocation","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","gammaFactorDefine","customDefines","createProgram","prefix_vertex","prefix_fragment","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLogInfo","getProgramInfoLog","getProgramParameter","LINK_STATUS","getError","VALIDATE_STATUS","deleteShader","addLineNumbers","string","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","newAttributes","Uint8Array","enabledAttributes","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthTest","currentDepthWrite","currentColorWrite","currentDoubleSided","currentFlipSided","currentLineWidth","currentPolygonOffset","currentPolygonOffsetFactor","currentPolygonOffsetUnits","enableVertexAttribArray","disableVertexAttribArray","blendEquationSeparate","blendFuncSeparate","depthMask","colorMask","lineWidth","polygonoffset","factor","units","POLYGON_OFFSET_FILL","flares","vertexBuffer","elementBuffer","hasVertexTexture","tempTexture","occlusionTexture","init","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","sprite","prefix","_renderer","_depthMaterial","_depthMaterialMorph","_depthMaterialSkin","_depthMaterialMorphSkin","_min","_max","_matrixPosition","_renderList","depthShader","depthUniforms","virtualLight","createVirtualLight","originalCamera","gyro","Gyroscope","updateVirtualLight","shadowFilter","pars","cameraHelper","CameraHelper","isVirtual","updateShadowCamera","objectMaterial","useMorphing","useSkinning","getObjectMaterial","customDepthMaterial","clearAlpha","cascade","pointsWorld","pointsFrustum","nearZ","farZ","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","fillStyle","fillRect","oldFogType","sceneFogType","GeometryUtils","geometry1","geometry2","ImageUtils","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","getNormalMap","subtract","getImageData","imageData","createImageData","ly","uy","lx","ux","num_points","putImageData","generateDataTexture","SceneUtils","createMultiMaterialObject","detach","attach","FontUtils","divisions","getFace","loadFace","family","familyName","ThreeFont","cssFontWeight","cssFontStyle","drawText","resolution","String","fontPaths","Path","ret","extractGlyphPoints","paths","pts","outline","action","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","glyph","glyphs","_cachedOutline","moveTo","lineTo","quadraticCurveTo","Shape","Utils","bezierCurveTo","b3","ha","generateShapes","curveSegments","font","shapes","toShapes","namespace","EPSILON","process","contour","verts","vertIndices","nv","snip","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cCROSSap","bCROSScp","aCROSSbp","Triangulate","_typeface_js","typeface_js","Audio","source","createBufferSource","onended","onEnded","gain","createGain","connect","destination","panner","createPanner","autoplay","isPlaying","onload","decodeAudioData","play","loop","pause","currentTime","setLoop","setRefDistance","refDistance","setRolloffFactor","rolloffFactor","setVolume","AudioListener","window","AudioContext","webkitAudioContext","orientation","velocity","positionPrev","setOrientation","setVelocity","Curve","getPointAt","getUtoTmapping","getPoints","getSpacedPoints","lengths","getLengths","__arcLengthDivisions","cacheArcLengths","cache","current","last","sum","updateArcLengths","arcLengths","targetArcLength","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","getPointFunc","CurvePath","curves","bends","autoClose","curve","checkConnection","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","maxX","maxY","maxZ","minX","minY","minZ","NEGATIVE_INFINITY","POSITIVE_INFINITY","createPointsGeometry","createGeometry","createSpacedPointsGeometry","addWrapPath","bendpath","getTransformedPoints","oldPts","getWrapPoints","getTransformedSpacedPoints","bounds","oldX","oldY","xNorm","pathPt","translationObject","quaternionObject","scaleObject","translationWorld","quaternionWorld","scaleWorld","actions","fromPoints","PathActions","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","BEZIER_CURVE_TO","CSPLINE_THRU","ARC","ELLIPSE","vectors","vlen","args","lastargs","x0","y0","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","EllipseCurve","lastPoint","closedPath","useSpacedPoints","item","spts","concat","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","isClockWise","betterShapeHoles","newShapes","newShapeHoles","mainIdx","tmpPoints","ambigious","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","hole","tmpHoles","holes","extrude","extruded","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","getSpacedPointsHoles","extractAllPoints","shape","extractPoints","extractAllSpacedPoints","triangulateShape","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","limit","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","nextIdx","intersection","indepHoles","intersectsHoleEdge","ihIdx","chkHole","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","failedCuts","tmpShape1","tmpShape2","tmpHole1","tmpHole2","hl","minShapeIndex","h2","allPointsMap","allpoints","shapeWithoutHoles","triangles","b2p0","b2p1","b2p2","b3p0","b3p1","b3p2","b3p3","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","ClosedSplineCurve3","AnimationHandler","CATMULLROM","CATMULLROM_FORWARD","initialized","hierarchy","rot","quat","usedMorphTargets","morphTargetName","morphTargetsInfluences","root","parseRecurseHierarchy","deltaTimeMS","resetBlendWeights","Animation","timeScale","interpolationType","keyTypes","animationCache","positionWeight","quaternionWeight","scaleWeight","prevKey","nextKey","originalMatrix","getNextKeyWith","newVector","newQuat","interpolateCatmullRom","prevXYZ","nextXYZ","proportionalWeight","getPrevKeyWith","currentPoint","forwardPoint","KeyFrameAnimation","isPaused","sids","obj","sid","next","endTime","original","hasTarget","MorphAnimation","frames","lastFrame","currentFrame","interpolation","frame","width_half","height_half","depth_half","buildPlane","udir","vdir","gridX","gridY","gridX1","gridY1","segment_width","segment_height","uvd","centerUV","segment","CubeGeometry","heightHalf","verticesRow","uvsRow","tanTheta","v4","n4","uv1","uv3","uv4","addShapeList","addShape","amount","bevelThickness","bevelSize","bevelSegments","bevelEnabled","steps","extrudePath","extrudePts","extrudeByPath","extrudeMaterial","uvgen","UVGenerator","WorldUVGenerator","splineTube","binormal","position2","TubeGeometry","FrenetFrames","ahole","shapesOffset","shapePoints","reverse","scalePt2","pt","bs","vert","flen","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","colinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","contourMovements","holesMovements","oneHoleMovements","verticesMovements","binormals","buildLidFaces","buildSideFaces","layer","f3","layeroffset","sidewalls","slen1","slen2","f4","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","generateSideWallUV","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","radiusStep","thetaSegment","TextGeometry","textShapes","grid","tang","bitan","getPos","ip","jp","in_q","in_p","cu","su","quOverP","cs","tz","closed","taper","NoTaper","numpoints","pos2","SinusoidalTaper","mat","smallest","initialNormal3","MAX_VALUE","PolyhedronGeometry","that","prepare","centroid","subdivide","azimuth","inclination","make","azi","correctUV","cols","aj","bj","rows","DodecahedronGeometry","OctahedronGeometry","TetrahedronGeometry","ParametricGeometry","func","slices","stacks","sliceCount","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","dir","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","addLine","addPoint","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","thresholdAngle","thresholdDot","edge","sortFunction","numEdges","vert1","vert2","face1","face2","FaceNormalsHelper","objectVertices","objectFaces","objectWorldMatrix","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","worldMatrix","vertexId","VertexTangentsHelper","WireframeHelper","edges","numTris","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","active","autoCreateAnimations","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","init_stats","targetID","stats","display","getElementById","appendChild","collidable_aspect","print","sys","visual","collidable","calc","animate_tick","sync_position","collision_tick","others","realArea","hit","filter","other","check","collided","visuals","animatable","sim","collidables","system","player","dock","done","collidedWith","test_model","ColladaLoader","convertUpAxis","collada","needsAdding","controller","goal_text","textGeom","wrapper","words","init_system","System","what","simulation_tick","tickables","init_gl","innerWidth","innerHeight","devicePixelRatio","body","renderingStats","animatables","begin","forEach","Stats","dom","cssText","Panel","addPanel","showPanel","usedJSHeapSize","jsHeapSizeLimit","setMode","textBaseline","fillText","globalAlpha","webpackPolyfill","deprecate","init_simulation","simStats","collisionStats","game_tick","clearInterval","sim_clock","setInterval","simulate","init_player","momentum","primary_thruster","top_nav_thruster","bottom_nav_thruster","starboard_nav_thruster","port_nav_thruster","hitbox","hitOthers","pitchThrust","pitch_forward","increase","pitch_back","decrease","yawThrust","yaw_port","yaw_starboard","rollThrust","roll_port","roll_starboard","translate_up","perform","description","translate_down","translate_port","translate_starboard","translate_fore","translate_aft","full_stop","rotational_thrust_aspect","thrust_aspect","thruster","maximum","minimum","thrust","more","less","init_player_controls","keyActionMap","R","Z","W","S","A","D","I","K","J","L","Q","E","P","fromCharCode","keyCode","init_dock","stationMesh","simulatedStation","waypointMesh","COLLADA","visualScene","kinematicsModel","readyCallbackFunc","sources","controllers","effects","cameras","animData","kinematics","visualScenes","kinematicsModels","baseUrl","morphs","skins","flip_uv","preferredShading","centerGeometry","subdivideFaces","upAxis","defaultEnvMap","colladaUnit","colladaUp","upConversion","readyCallback","progressCallback","failCallback","implementation","createDocument","responseXML","xmlParser","DOMParser","parseFromString","faillCallback","alert","doc","callBack","parseAsset","setUpConversion","parseLib","_Image","Effect","Controller","VisualScene","KinematicsModel","parseScene","nodes","createSceneGraph","createAnimations","parseKinematicsModel","createKinematics","dae","setPreferredShading","querySelectorAll","element","childNodes","nodeName","meter","parseFloat","textContent","charAt","classSpec","lib","elementsLength","daeElement","sceneElement","replace","kinematicsModelElement","recurseHierarchy","getChildById","colladaId","newData","calcAnimationBounds","ID","sampler","input","createMorph","ctrl","morphCtrl","InstanceController","target_id","daeGeometry","primitives","createSkin","applyBindShape","skinCtrl","bindShapeMatrix","setupSkeleton","world","localworld","channels","channel","setupSkinningMatrices","found","joints","inv","invBindMatrices","invBindMatrix","skinningMatrix","animatrix","weights","joint","flattenSkeleton","list","walk","parentid","skinToBindPose","skinController","skinned","vidx","applySkin","instanceCtrl","animationBounds","getChildBySid","bonelist","sortedbones","indicies","animationdata","jointMap","_addToMap","jointIndex","parentVisualElement","parentVisualElementId","colladaNode","transforms","zeroPosition","getJointValue","jointData","setJointValue","limits","static","threejsNode","transform","elementsFloat32Arr","elementsRowMajor","querySelector","nodeType","visualTarget","visualTargetElement","parentElement","morphController","inst_geom","InstanceGeometry","instance_material","second","double_sided_materials","instance_geometry","instance_materials","used_materials","used_materials_array","num_materials","first_material","effect_id","instance_effect","material3js","symbol","_copied_material","geom","geometry3js","daeMaterial","isLineStrip","instance_camera","cparams","cam","yfov","aspect_ratio","znear","zfar","instance_light","lparams","technique","falloff_angle","getJointId","getLibraryNode","attObj","getNamedItem","getChannelsForNode","calcFrameDuration","minT","calcMatrixAt","animated","bakeAnimations","fullSid","getTransformBySid","member","arrIndices","getConvertedIndex","getConvertedMember","getData","findKey","Key","timeNdx","findTimeNdx","addTarget","interpolateKeys","retVal","ndx","prevTarget","getTarget","nextData","prevData","init_from","Skin","Morph","method","inputs","Source","parseInputs","semantic","read","Input","_floats","getConvertedMat4","parseJoints","parseWeights","vcount","_ints","numBones","vertex_weights","Node","getChannelForTransform","transformSid","shift","dotSyntax","arrSyntax","InstanceCamera","InstanceLight","iNode","Transform","convert","fixCoords","members","propName","instances","instance","InstanceMaterial","extractDoubleSided","_source","Vertices","LineStrips","Triangles","Polygons","Polylist","vertexData","getConvertedVec3","primitive","setVertices","handlePrimitive","calcNormals","pList","idx32","numParams","vcIndex","maxOffset","texture_sets","pCount","vs","ns","ts","accessor","NORMAL","len","TEXCOORD","COLOR","uvArr","clr","vec1","vec2","vec3","norm","_attr_as_int","Accessor","stride","param","_bools","_strings","InstanceEffect","ColorOrTexture","texcoord","texOpts","isColor","isTexture","rgba","offsetU","offsetV","repeatU","repeatV","wrapU","wrapV","parseTexture","toUpperCase","Shader","effect","bumpType","props","transparentColor","transparencyLevel","prop","cot","samplerId","surfaceId","surface","loadTextureImage","Surface","Sampler2D","wrap_s","wrap_t","minfilter","magfilter","mipfilter","parseTechnique","parseProfileCOMMON","parseNewparam","_image","parseExtra","parseExtraTechnique","anim","Sampler","Channel","strideOut","getConvertedTranslation","opt_sid","nextTarget","parseOptics","perspective","xfov","orthographic","xmag","ymag","parseCommon","profile","links","Joint","Link","middlePosition","axisElement","_axis","jointTypes","jointElement","attachments","Attachment","_nsResolver","nsPrefix","str","raw","_trimString","_attr_as_float","defaultValue","hasAttribute","_attr_as_string","_format_float","num","substr","arr","X","Y"],"mappings":"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","file":"application.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 96f9d77ad30213b2245b","var self = self || {};// File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = { REVISION: '71' };\r\n\r\n// browserify support\r\n\r\nif ( typeof module === 'object' ) {\r\n\r\n\tmodule.exports = THREE;\r\n\r\n}\r\n\r\n// polyfills\r\n\r\nif ( Math.sign === undefined ) {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\tMath.sign = function ( x ) {\r\n\r\n\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : +x;\r\n\r\n\t};\r\n\r\n}\r\n\r\n\r\n// set the default log handlers\r\nTHREE.log = function() { console.log.apply( console, arguments ); }\r\nTHREE.warn = function() { console.warn.apply( console, arguments ); }\r\nTHREE.error = function() { console.error.apply( console, arguments ); }\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.NoShading = 0;\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n//  mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n\r\n// DEPRECATED\r\n\r\nTHREE.Projector = function () {\r\n\r\n\tTHREE.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\r\n\tthis.projectVector = function ( vector, camera ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\tvector.project( camera );\r\n\r\n\t};\r\n\r\n\tthis.unprojectVector = function ( vector, camera ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\tvector.unproject( camera );\r\n\r\n\t};\r\n\r\n\tthis.pickingRay = function ( vector, camera ) {\r\n\r\n\t\tTHREE.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CanvasRenderer = function () {\r\n\r\n\tTHREE.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\r\n\tthis.domElement = document.createElement( 'canvas' );\r\n\tthis.clear = function () {};\r\n\tthis.render = function () {};\r\n\tthis.setClearColor = function () {};\r\n\tthis.setSize = function () {};\r\n\r\n};\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function ( color ) {\r\n\r\n\tif ( arguments.length === 3 ) {\r\n\r\n\t\treturn this.setRGB( arguments[ 0 ], arguments[ 1 ], arguments[ 2 ] );\r\n\r\n\t}\r\n\r\n\treturn this.set( color )\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n\tconstructor: THREE.Color,\r\n\r\n\tr: 1, g: 1, b: 1,\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tif ( value instanceof THREE.Color ) {\r\n\r\n\t\t\tthis.copy( value );\r\n\r\n\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\tthis.setHex( value );\r\n\r\n\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\tthis.setStyle( value );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHex: function ( hex ) {\r\n\r\n\t\thex = Math.floor( hex );\r\n\r\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\tthis.r = r;\r\n\t\tthis.g = g;\r\n\t\tthis.b = b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHSL: function ( h, s, l ) {\r\n\r\n\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\tif ( s === 0 ) {\r\n\r\n\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar hue2rgb = function ( p, q, t ) {\r\n\r\n\t\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\t\treturn p;\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetStyle: function ( style ) {\r\n\r\n\t\t// rgb(255,0,0)\r\n\r\n\t\tif ( /^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.test( style ) ) {\r\n\r\n\t\t\tvar color = /^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.exec( style );\r\n\r\n\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\t// rgb(100%,0%,0%)\r\n\r\n\t\tif ( /^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.test( style ) ) {\r\n\r\n\t\t\tvar color = /^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.exec( style );\r\n\r\n\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\t// #ff0000\r\n\r\n\t\tif ( /^\\#([0-9a-f]{6})$/i.test( style ) ) {\r\n\r\n\t\t\tvar color = /^\\#([0-9a-f]{6})$/i.exec( style );\r\n\r\n\t\t\tthis.setHex( parseInt( color[ 1 ], 16 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\t// #f00\r\n\r\n\t\tif ( /^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test( style ) ) {\r\n\r\n\t\t\tvar color = /^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec( style );\r\n\r\n\t\t\tthis.setHex( parseInt( color[ 1 ] + color[ 1 ] + color[ 2 ] + color[ 2 ] + color[ 3 ] + color[ 3 ], 16 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\t// red\r\n\r\n\t\tif ( /^(\\w+)$/i.test( style ) ) {\r\n\r\n\t\t\tthis.setHex( THREE.ColorKeywords[ style ] );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\r\n\t},\r\n\r\n\tcopy: function ( color ) {\r\n\r\n\t\tthis.r = color.r;\r\n\t\tthis.g = color.g;\r\n\t\tthis.b = color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertGammaToLinear: function () {\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tthis.r = r * r;\r\n\t\tthis.g = g * g;\r\n\t\tthis.b = b * b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertLinearToGamma: function () {\r\n\r\n\t\tthis.r = Math.sqrt( this.r );\r\n\t\tthis.g = Math.sqrt( this.g );\r\n\t\tthis.b = Math.sqrt( this.b );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetHex: function () {\r\n\r\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t},\r\n\r\n\tgetHexString: function () {\r\n\r\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t},\r\n\r\n\tgetHSL: function ( optionalTarget ) {\r\n\r\n\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tvar max = Math.max( r, g, b );\r\n\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\tvar hue, saturation;\r\n\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\tif ( min === max ) {\r\n\r\n\t\t\thue = 0;\r\n\t\t\tsaturation = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar delta = max - min;\r\n\r\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\thue /= 6;\r\n\r\n\t\t}\r\n\r\n\t\thsl.h = hue;\r\n\t\thsl.s = saturation;\r\n\t\thsl.l = lightness;\r\n\r\n\t\treturn hsl;\r\n\r\n\t},\r\n\r\n\tgetStyle: function () {\r\n\r\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t},\r\n\r\n\toffsetHSL: function ( h, s, l ) {\r\n\r\n\t\tvar hsl = this.getHSL();\r\n\r\n\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\r\n\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( color ) {\r\n\r\n\t\tthis.r += color.r;\r\n\t\tthis.g += color.g;\r\n\t\tthis.b += color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddColors: function ( color1, color2 ) {\r\n\r\n\t\tthis.r = color1.r + color2.r;\r\n\t\tthis.g = color1.g + color2.g;\r\n\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.r += s;\r\n\t\tthis.g += s;\r\n\t\tthis.b += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( color ) {\r\n\r\n\t\tthis.r *= color.r;\r\n\t\tthis.g *= color.g;\r\n\t\tthis.b *= color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tthis.r *= s;\r\n\t\tthis.g *= s;\r\n\t\tthis.b *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( color, alpha ) {\r\n\r\n\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( c ) {\r\n\r\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.r = array[ 0 ];\r\n\t\tthis.g = array[ 1 ];\r\n\t\tthis.b = array[ 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.r;\r\n\t\tarray[ offset + 1 ] = this.g;\r\n\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\treturn array;\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Color().setRGB( this.r, this.g, this.b );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Quaternion = function ( x, y, z, w ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n\tconstructor: THREE.Quaternion,\r\n\r\n\t_x: 0,_y: 0, _z: 0, _w: 0,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget w () {\r\n\r\n\t\treturn this._w;\r\n\r\n\t},\r\n\r\n\tset w ( value ) {\r\n\r\n\t\tthis._w = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._w = w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( quaternion ) {\r\n\r\n\t\tthis._x = quaternion.x;\r\n\t\tthis._y = quaternion.y;\r\n\t\tthis._z = quaternion.z;\r\n\t\tthis._w = quaternion.w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\t\t}\r\n\r\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\tvar c1 = Math.cos( euler._x / 2 );\r\n\t\tvar c2 = Math.cos( euler._y / 2 );\r\n\t\tvar c3 = Math.cos( euler._z / 2 );\r\n\t\tvar s1 = Math.sin( euler._x / 2 );\r\n\t\tvar s2 = Math.sin( euler._y / 2 );\r\n\t\tvar s3 = Math.sin( euler._z / 2 );\r\n\r\n\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t}\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\tthis._x = axis.x * s;\r\n\t\tthis._y = axis.y * s;\r\n\t\tthis._z = axis.z * s;\r\n\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\ts;\r\n\r\n\t\tif ( trace > 0 ) {\r\n\r\n\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\tthis._w = 0.25 / s;\r\n\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\tthis._x = 0.25 * s;\r\n\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\tthis._y = 0.25 * s;\r\n\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromUnitVectors: function () {\r\n\r\n\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\tvar v1, r;\r\n\r\n\t\tvar EPS = 0.000001;\r\n\r\n\t\treturn function ( vFrom, vTo ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\tr = 0;\r\n\r\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._x = v1.x;\r\n\t\t\tthis._y = v1.y;\r\n\t\t\tthis._z = v1.z;\r\n\t\t\tthis._w = r;\r\n\r\n\t\t\tthis.normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tinverse: function () {\r\n\r\n\t\tthis.conjugate().normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconjugate: function () {\r\n\r\n\t\tthis._x *= - 1;\r\n\t\tthis._y *= - 1;\r\n\t\tthis._z *= - 1;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tvar l = this.length();\r\n\r\n\t\tif ( l === 0 ) {\r\n\r\n\t\t\tthis._x = 0;\r\n\t\t\tthis._y = 0;\r\n\t\t\tthis._z = 0;\r\n\t\t\tthis._w = 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tl = 1 / l;\r\n\r\n\t\t\tthis._x = this._x * l;\r\n\t\t\tthis._y = this._y * l;\r\n\t\t\tthis._z = this._z * l;\r\n\t\t\tthis._w = this._w * l;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( q, p ) {\r\n\r\n\t\tif ( p !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t},\r\n\r\n\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\treturn vector.applyQuaternion( this );\r\n\r\n\t},\r\n\r\n\tslerp: function ( qb, t ) {\r\n\r\n\t\tif ( t === 0 ) return this;\r\n\t\tif ( t === 1 ) return this.copy( qb );\r\n\r\n\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\tthis._w = - qb._w;\r\n\t\t\tthis._x = - qb._x;\r\n\t\t\tthis._y = - qb._y;\r\n\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.copy( qb );\r\n\r\n\t\t}\r\n\r\n\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\tthis._w = w;\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar halfTheta = Math.acos( cosHalfTheta );\r\n\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\r\n\r\n\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\r\n\r\n\t\t\tthis._w = 0.5 * ( w + this._w );\r\n\t\t\tthis._x = 0.5 * ( x + this._x );\r\n\t\t\tthis._y = 0.5 * ( y + this._y );\r\n\t\t\tthis._z = 0.5 * ( z + this._z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( quaternion ) {\r\n\r\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis._x = array[ offset ];\r\n\t\tthis._y = array[ offset + 1 ];\r\n\t\tthis._z = array[ offset + 2 ];\r\n\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Quaternion( this._x, this._y, this._z, this._w );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Quaternion.slerp = function ( qa, qb, qm, t ) {\r\n\r\n\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n}\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function ( x, y ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n\tconstructor: THREE.Vector2,\r\n\r\n\tset: function ( x, y ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v ) {\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tthis.x *= s;\r\n\t\tthis.y *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\tif ( scalar !== 0 ) {\r\n\r\n\t\t\tvar invScalar = 1 / scalar;\r\n\r\n\t\t\tthis.x *= invScalar;\r\n\t\t\tthis.y *= invScalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tif ( this.x > v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y > v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tif ( this.x < v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tif ( this.x < min.x ) {\r\n\r\n\t\t\tthis.x = min.x;\r\n\r\n\t\t} else if ( this.x > max.x ) {\r\n\r\n\t\t\tthis.x = max.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < min.y ) {\r\n\r\n\t\t\tthis.y = min.y;\r\n\r\n\t\t} else if ( this.y > max.y ) {\r\n\r\n\t\t\tthis.y = max.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tclampScalar: ( function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function ( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector2();\r\n\t\t\t\tmax = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\treturn dx * dx + dy * dy;\r\n\r\n\t},\r\n\r\n\tsetLength: function ( l ) {\r\n\r\n\t\tvar oldLength = this.length();\r\n\r\n\t\tif ( oldLength !== 0 && l !== oldLength ) {\r\n\r\n\t\t\tthis.multiplyScalar( l / oldLength );\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Vector2( this.x, this.y );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function ( x, y, z ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n\tconstructor: THREE.Vector3,\r\n\r\n\tset: function ( x, y, z ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\t\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t\tthis.z *= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tthis.x *= scalar;\r\n\t\tthis.y *= scalar;\r\n\t\tthis.z *= scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x * b.x;\r\n\t\tthis.y = a.y * b.y;\r\n\t\tthis.z = a.z * b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyEuler: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function ( euler ) {\r\n\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\t\tTHREE.error( 'THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyAxisAngle: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function ( axis, angle ) {\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix3: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyProjection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 projection matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\r\n\r\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\r\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\r\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyQuaternion: function ( q ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar qx = q.x;\r\n\t\tvar qy = q.y;\r\n\t\tvar qz = q.z;\r\n\t\tvar qw = q.w;\r\n\r\n\t\t// calculate quat * vector\r\n\r\n\t\tvar ix =  qw * x + qy * z - qz * y;\r\n\t\tvar iy =  qw * y + qz * x - qx * z;\r\n\t\tvar iz =  qw * z + qx * y - qy * x;\r\n\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t// calculate result * inverse quat\r\n\r\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tunproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttransformDirection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t// vector interpreted as a direction\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\tthis.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t\tthis.z /= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\tif ( scalar !== 0 ) {\r\n\r\n\t\t\tvar invScalar = 1 / scalar;\r\n\r\n\t\t\tthis.x *= invScalar;\r\n\t\t\tthis.y *= invScalar;\r\n\t\t\tthis.z *= invScalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tif ( this.x > v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y > v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z > v.z ) {\r\n\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tif ( this.x < v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z < v.z ) {\r\n\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tif ( this.x < min.x ) {\r\n\r\n\t\t\tthis.x = min.x;\r\n\r\n\t\t} else if ( this.x > max.x ) {\r\n\r\n\t\t\tthis.x = max.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < min.y ) {\r\n\r\n\t\t\tthis.y = min.y;\r\n\r\n\t\t} else if ( this.y > max.y ) {\r\n\r\n\t\t\tthis.y = max.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z < min.z ) {\r\n\r\n\t\t\tthis.z = min.z;\r\n\r\n\t\t} else if ( this.z > max.z ) {\r\n\r\n\t\t\tthis.z = max.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: ( function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function ( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector3();\r\n\t\t\t\tmax = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( l ) {\r\n\r\n\t\tvar oldLength = this.length();\r\n\r\n\t\tif ( oldLength !== 0 && l !== oldLength  ) {\r\n\r\n\t\t\tthis.multiplyScalar( l / oldLength );\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcross: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tthis.x = y * v.z - z * v.y;\r\n\t\tthis.y = z * v.x - x * v.z;\r\n\t\tthis.z = x * v.y - y * v.x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossVectors: function ( a, b ) {\r\n\r\n\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\tthis.x = ay * bz - az * by;\r\n\t\tthis.y = az * bx - ax * bz;\r\n\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tprojectOnVector: function () {\r\n\r\n\t\tvar v1, dot;\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( vector ).normalize();\r\n\r\n\t\t\tdot = this.dot( v1 );\r\n\r\n\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tprojectOnPlane: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( planeNormal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\treturn this.sub( v1 );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\treflect: function () {\r\n\r\n\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t// normal is assumed to have unit length\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( normal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tangleTo: function ( v ) {\r\n\r\n\t\tvar theta = this.dot( v ) / ( this.length() * v.length() );\r\n\r\n\t\t// clamp, to handle numerical problems\r\n\r\n\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x;\r\n\t\tvar dy = this.y - v.y;\r\n\t\tvar dz = this.z - v.z;\r\n\r\n\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t},\r\n\r\n\tsetEulerFromRotationMatrix: function ( m, order ) {\r\n\r\n\t\tTHREE.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\r\n\t},\r\n\r\n\tsetEulerFromQuaternion: function ( q, order ) {\r\n\r\n\t\tTHREE.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\r\n\t},\r\n\r\n\tgetPositionFromMatrix: function ( m ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\r\n\t\treturn this.setFromMatrixPosition( m );\r\n\r\n\t},\r\n\r\n\tgetScaleFromMatrix: function ( m ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\r\n\t\treturn this.setFromMatrixScale( m );\r\n\t},\r\n\r\n\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\r\n\t\treturn this.setFromMatrixColumn( index, matrix );\r\n\r\n\t},\r\n\r\n\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\tthis.x = m.elements[ 12 ];\r\n\t\tthis.y = m.elements[ 13 ];\r\n\t\tthis.z = m.elements[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\tvar sx = this.set( m.elements[ 0 ], m.elements[ 1 ], m.elements[  2 ] ).length();\r\n\t\tvar sy = this.set( m.elements[ 4 ], m.elements[ 5 ], m.elements[  6 ] ).length();\r\n\t\tvar sz = this.set( m.elements[ 8 ], m.elements[ 9 ], m.elements[ 10 ] ).length();\r\n\r\n\t\tthis.x = sx;\r\n\t\tthis.y = sy;\r\n\t\tthis.z = sz;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetFromMatrixColumn: function ( index, matrix ) {\r\n\t\t\r\n\t\tvar offset = index * 4;\r\n\r\n\t\tvar me = matrix.elements;\r\n\r\n\t\tthis.x = me[ offset ];\r\n\t\tthis.y = me[ offset + 1 ];\r\n\t\tthis.z = me[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Vector3( this.x, this.y, this.z );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function ( x, y, z, w ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n\tconstructor: THREE.Vector4,\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( w ) {\r\n\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tcase 3: this.w = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tcase 3: return this.w;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\t\tthis.w += v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\t\tthis.w += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\t\tthis.w = a.w + b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\t\tthis.w -= v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\t\tthis.w -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\t\tthis.w = a.w - b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tthis.x *= scalar;\r\n\t\tthis.y *= scalar;\r\n\t\tthis.z *= scalar;\r\n\t\tthis.w *= scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\t\tvar w = this.w;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\tif ( scalar !== 0 ) {\r\n\r\n\t\t\tvar invScalar = 1 / scalar;\r\n\r\n\t\t\tthis.x *= invScalar;\r\n\t\t\tthis.y *= invScalar;\r\n\t\t\tthis.z *= invScalar;\r\n\t\t\tthis.w *= invScalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\t\t\tthis.w = 1;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t// q is assumed to be normalized\r\n\r\n\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t this.x = 1;\r\n\t\t\t this.y = 0;\r\n\t\t\t this.z = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t this.x = q.x / s;\r\n\t\t\t this.y = q.y / s;\r\n\t\t\t this.z = q.z / s;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\tte = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon )\r\n\t\t   && ( Math.abs( m13 - m31 ) < epsilon )\r\n\t\t   && ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t// singularity found\r\n\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m13 + m31 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m23 + m32 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\tangle = Math.PI;\r\n\r\n\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) { // m11 is the largest diagonal term\r\n\r\n\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( yy > zz ) { // m22 is the largest diagonal term\r\n\r\n\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else { // m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t}\r\n\r\n\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 )\r\n\t\t\t\t\t\t  + ( m13 - m31 ) * ( m13 - m31 )\r\n\t\t\t\t\t\t  + ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\r\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tif ( this.x > v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y > v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z > v.z ) {\r\n\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.w > v.w ) {\r\n\r\n\t\t\tthis.w = v.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tif ( this.x < v.x ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < v.y ) {\r\n\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z < v.z ) {\r\n\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.w < v.w ) {\r\n\r\n\t\t\tthis.w = v.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tif ( this.x < min.x ) {\r\n\r\n\t\t\tthis.x = min.x;\r\n\r\n\t\t} else if ( this.x > max.x ) {\r\n\r\n\t\t\tthis.x = max.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.y < min.y ) {\r\n\r\n\t\t\tthis.y = min.y;\r\n\r\n\t\t} else if ( this.y > max.y ) {\r\n\r\n\t\t\tthis.y = max.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.z < min.z ) {\r\n\r\n\t\t\tthis.z = min.z;\r\n\r\n\t\t} else if ( this.z > max.z ) {\r\n\r\n\t\t\tthis.z = max.z;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.w < min.w ) {\r\n\r\n\t\t\tthis.w = min.w;\r\n\r\n\t\t} else if ( this.w > max.w ) {\r\n\r\n\t\t\tthis.w = max.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: ( function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function ( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector4();\r\n\t\t\t\tmax = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n  floor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n  },\r\n\r\n  ceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\treturn this;\r\n\r\n  },\r\n\r\n  round: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\t\tthis.w = Math.round( this.w );\r\n\r\n\t\treturn this;\r\n\r\n  },\r\n\r\n  roundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n  },\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\t\tthis.w = - this.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( l ) {\r\n\r\n\t\tvar oldLength = this.length();\r\n\r\n\t\tif ( oldLength !== 0 && l !== oldLength ) {\r\n\r\n\t\t\tthis.multiplyScalar( l / oldLength );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\tthis.w = attribute.array[ index + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Vector4( this.x, this.y, this.z, this.w );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Euler = function ( x, y, z, order ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n\tconstructor: THREE.Euler,\r\n\r\n\t_x: 0, _y: 0, _z: 0, _order: THREE.Euler.DefaultOrder,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget order () {\r\n\r\n\t\treturn this._order;\r\n\r\n\t},\r\n\r\n\tset order ( value ) {\r\n\r\n\t\tthis._order = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, order ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._order = order || this._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( euler ) {\r\n\r\n\t\tthis._x = euler._x;\r\n\t\tthis._y = euler._y;\r\n\t\tthis._z = euler._z;\r\n\t\tthis._order = euler._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\tvar clamp = THREE.Math.clamp;\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements;\r\n\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\torder = order || this._order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order )\r\n\r\n\t\t}\r\n\r\n\t\tthis._order = order;\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromQuaternion: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( q, order, update ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\t\t\tthis.setFromRotationMatrix( matrix, order, update );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t},\r\n\r\n\treorder: function () {\r\n\r\n\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\tvar q = new THREE.Quaternion();\r\n\r\n\t\treturn function ( newOrder ) {\r\n\r\n\t\t\tq.setFromEuler( this );\r\n\t\t\tthis.setFromQuaternion( q, newOrder );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( euler ) {\r\n\r\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis._x = array[ 0 ];\r\n\t\tthis._y = array[ 1 ];\r\n\t\tthis._z = array[ 2 ];\r\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\treturn array;\r\n\t},\r\n\r\n\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\tif ( optionalResult ) {\r\n\r\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Euler( this._x, this._y, this._z, this._order );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Line3 = function ( start, end ) {\r\n\r\n\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\r\n\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n\tconstructor: THREE.Line3,\r\n\r\n\tset: function ( start, end ) {\r\n\r\n\t\tthis.start.copy( start );\r\n\t\tthis.end.copy( end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( line ) {\r\n\r\n\t\tthis.start.copy( line.start );\r\n\t\tthis.end.copy( line.end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tdelta: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.end, this.start );\r\n\r\n\t},\r\n\r\n\tdistanceSq: function () {\r\n\r\n\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t},\r\n\r\n\tdistance: function () {\r\n\r\n\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tclosestPointToPointParameter: function () {\r\n\r\n\t\tvar startP = new THREE.Vector3();\r\n\t\tvar startEnd = new THREE.Vector3();\r\n\r\n\t\treturn function ( point, clampToLine ) {\r\n\r\n\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\r\n\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\r\n\r\n\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.start.applyMatrix4( matrix );\r\n\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( line ) {\r\n\r\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Line3().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Box2 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( Infinity, Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n\tconstructor: THREE.Box2,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] )\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = Infinity;\r\n\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Box2().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( Infinity, Infinity, Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n\tconstructor: THREE.Box3,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] )\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromObject: function () {\r\n\r\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t// accounting for both the object's, and childrens', world transforms\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tobject.traverse( function ( node ) {\r\n\r\n\t\t\t\tvar geometry = node.geometry;\r\n\r\n\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tv1.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = this.min.z = Infinity;\r\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ||\r\n\t\t     point.z < this.min.z || point.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\r\n\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t     box.max.z < this.min.z || box.min.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetBoundingSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Sphere();\r\n\r\n\t\t\tresult.center = this.center();\r\n\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar points = [\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3()\r\n\t\t];\r\n\r\n\t\treturn function ( matrix ) {\r\n\r\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );  // 111\r\n\r\n\t\t\tthis.makeEmpty();\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Box3().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Matrix3 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0,\r\n\t\t0, 1, 0,\r\n\t\t0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n\tconstructor: THREE.Matrix3,\r\n\r\n\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 3 ] = n12; te[ 6 ] = n13;\r\n\t\tte[ 1 ] = n21; te[ 4 ] = n22; te[ 7 ] = n23;\r\n\t\tte[ 2 ] = n31; te[ 5 ] = n32; te[ 8 ] = n33;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\r\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\r\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix3( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector3Array: function ( a ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.x = array[ j ];\r\n\t\t\t\tv1.y = array[ j + 1 ];\r\n\t\t\t\tv1.z = array[ j + 2 ];\r\n\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\r\n\t\t\t\tarray[ j ]     = v1.x;\r\n\t\t\t\tarray[ j + 1 ] = v1.y;\r\n\t\t\t\tarray[ j + 2 ] = v1.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( matrix, throwOnInvertible ) {\r\n\r\n\t\t// input: THREE.Matrix4\r\n\t\t// ( based on http://code.google.com/p/webgl-mjs/ )\r\n\r\n\t\tvar me = matrix.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] =   me[ 10 ] * me[ 5 ] - me[ 6 ] * me[ 9 ];\r\n\t\tte[ 1 ] = - me[ 10 ] * me[ 1 ] + me[ 2 ] * me[ 9 ];\r\n\t\tte[ 2 ] =   me[ 6 ] * me[ 1 ] - me[ 2 ] * me[ 5 ];\r\n\t\tte[ 3 ] = - me[ 10 ] * me[ 4 ] + me[ 6 ] * me[ 8 ];\r\n\t\tte[ 4 ] =   me[ 10 ] * me[ 0 ] - me[ 2 ] * me[ 8 ];\r\n\t\tte[ 5 ] = - me[ 6 ] * me[ 0 ] + me[ 2 ] * me[ 4 ];\r\n\t\tte[ 6 ] =   me[ 9 ] * me[ 4 ] - me[ 5 ] * me[ 8 ];\r\n\t\tte[ 7 ] = - me[ 9 ] * me[ 0 ] + me[ 1 ] * me[ 8 ];\r\n\t\tte[ 8 ] =   me[ 5 ] * me[ 0 ] - me[ 1 ] * me[ 4 ];\r\n\r\n\t\tvar det = me[ 0 ] * te[ 0 ] + me[ 1 ] * te[ 3 ] + me[ 2 ] * te[ 6 ];\r\n\r\n\t\t// no inverse\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnInvertible || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tTHREE.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.identity();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tthis.multiplyScalar( 1.0 / det );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar tmp, m = this.elements;\r\n\r\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset     ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tgetNormalMatrix: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4\r\n\r\n\t\tthis.getInverse( m ).transpose();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\tvar m = this.elements;\r\n\r\n\t\tr[ 0 ] = m[ 0 ];\r\n\t\tr[ 1 ] = m[ 3 ];\r\n\t\tr[ 2 ] = m[ 6 ];\r\n\t\tr[ 3 ] = m[ 1 ];\r\n\t\tr[ 4 ] = m[ 4 ];\r\n\t\tr[ 5 ] = m[ 7 ];\r\n\t\tr[ 6 ] = m[ 2 ];\r\n\t\tr[ 7 ] = m[ 5 ];\r\n\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\treturn [\r\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ],\r\n\t\t\tte[ 3 ], te[ 4 ], te[ 5 ],\r\n\t\t\tte[ 6 ], te[ 7 ], te[ 8 ]\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Matrix3().fromArray( this.elements );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0, 0,\r\n\t\t0, 1, 0, 0,\r\n\t\t0, 0, 1, 0,\r\n\t\t0, 0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n\tconstructor: THREE.Matrix4,\r\n\r\n\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tthis.elements.set( m.elements );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractPosition: function ( m ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\treturn this.copyPosition( m );\r\n\r\n\t},\r\n\r\n\tcopyPosition: function ( m ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tte[ 12 ] = me[ 12 ];\r\n\t\tte[ 13 ] = me[ 13 ];\r\n\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n \r\n\t\tvar te = this.elements;\r\n \r\n\t\txAxis.set( te[ 0 ], te[ 1 ], te[ 2 ] );\r\n\t\tyAxis.set( te[ 4 ], te[ 5 ], te[ 6 ] );\r\n\t\tzAxis.set( te[ 8 ], te[ 9 ], te[ 10 ] );\r\n \r\n\t\treturn this;\r\n \t\t\r\n\t},\r\n \r\n\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\tthis.set(\r\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t0,       0,       0,       1\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractRotation: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / v1.set( me[ 0 ], me[ 1 ], me[ 2 ] ).length();\r\n\t\t\tvar scaleY = 1 / v1.set( me[ 4 ], me[ 5 ], me[ 6 ] ).length();\r\n\t\t\tvar scaleZ = 1 / v1.set( me[ 8 ], me[ 9 ], me[ 10 ] ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - c * f;\r\n\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\tte[ 1 ] = a * f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\tte[ 4 ] = - a * f;\r\n\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\tte[ 2 ] = - a * d;\r\n\t\t\tte[ 6 ] = b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\tte[ 1 ] = c * f;\r\n\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\tte[ 2 ] = - d;\r\n\t\t\tte[ 6 ] = b * c;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\tte[ 1 ] = f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\tte[ 2 ] = - d * e;\r\n\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - f;\r\n\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\tte[ 6 ] = b * e;\r\n\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t}\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\r\n\t\treturn this.makeRotationFromQuaternion( q );\r\n\r\n\t},\r\n\r\n\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\r\n\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\r\n\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\tte[ 0 ] = 1 - ( yy + zz );\r\n\t\tte[ 4 ] = xy - wz;\r\n\t\tte[ 8 ] = xz + wy;\r\n\r\n\t\tte[ 1 ] = xy + wz;\r\n\t\tte[ 5 ] = 1 - ( xx + zz );\r\n\t\tte[ 9 ] = yz - wx;\r\n\r\n\t\tte[ 2 ] = xz - wy;\r\n\t\tte[ 6 ] = yz + wx;\r\n\t\tte[ 10 ] = 1 - ( xx + yy );\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar x = new THREE.Vector3();\r\n\t\tvar y = new THREE.Vector3();\r\n\t\tvar z = new THREE.Vector3();\r\n\r\n\t\treturn function ( eye, target, up ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tz.subVectors( eye, target ).normalize();\r\n\r\n\t\t\tif ( z.length() === 0 ) {\r\n\r\n\t\t\t\tz.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\tif ( x.length() === 0 ) {\r\n\r\n\t\t\t\tz.x += 0.0001;\r\n\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ty.crossVectors( z, x );\r\n\r\n\r\n\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiply: function ( m, n ) {\r\n\r\n\t\tif ( n !== undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t},\r\n\r\n\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\tvar ae = a.elements;\r\n\t\tvar be = b.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyToArray: function ( a, b, r ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tthis.multiplyMatrices( a, b );\r\n\r\n\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\r\n\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\r\n\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\r\n\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\r\n\t\treturn vector.applyProjection( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector4: function ( vector ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector3Array: function ( a ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.x = array[ j ];\r\n\t\t\t\tv1.y = array[ j + 1 ];\r\n\t\t\t\tv1.z = array[ j + 2 ];\r\n\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\r\n\t\t\t\tarray[ j ]     = v1.x;\r\n\t\t\t\tarray[ j + 1 ] = v1.y;\r\n\t\t\t\tarray[ j + 2 ] = v1.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateAxis: function ( v ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\r\n\t\tv.transformDirection( this );\r\n\r\n\t},\r\n\r\n\tcrossVector: function ( vector ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t//TODO: make this more efficient\r\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\treturn (\r\n\t\t\tn41 * (\r\n\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t - n12 * n23 * n34\r\n\t\t\t) +\r\n\t\t\tn42 * (\r\n\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t - n14 * n23 * n31\r\n\t\t\t) +\r\n\t\t\tn43 * (\r\n\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t - n12 * n24 * n31\r\n\t\t\t) +\r\n\t\t\tn44 * (\r\n\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t + n12 * n23 * n31\r\n\t\t\t)\r\n\r\n\t\t);\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar tmp;\r\n\r\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset     ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\tarray[ offset + 9 ]  = te[ 9 ];\r\n\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tgetPosition: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\treturn v1.set( te[ 12 ], te[ 13 ], te[ 14 ] );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetPosition: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 12 ] = v.x;\r\n\t\tte[ 13 ] = v.y;\r\n\t\tte[ 14 ] = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( m, throwOnInvertible ) {\r\n\r\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tvar n11 = me[ 0 ], n12 = me[ 4 ], n13 = me[ 8 ], n14 = me[ 12 ];\r\n\t\tvar n21 = me[ 1 ], n22 = me[ 5 ], n23 = me[ 9 ], n24 = me[ 13 ];\r\n\t\tvar n31 = me[ 2 ], n32 = me[ 6 ], n33 = me[ 10 ], n34 = me[ 14 ];\r\n\t\tvar n41 = me[ 3 ], n42 = me[ 7 ], n43 = me[ 11 ], n44 = me[ 15 ];\r\n\r\n\t\tte[ 0 ] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n\t\tte[ 4 ] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n\t\tte[ 8 ] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n\t\tte[ 12 ] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\t\tte[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n\t\tte[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n\t\tte[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n\t\tte[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n\t\tte[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n\t\tte[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n\t\tte[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n\t\tte[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n\t\tte[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n\t\tte[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n\t\tte[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n\t\tte[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n\t\tvar det = n11 * te[ 0 ] + n21 * te[ 4 ] + n31 * te[ 8 ] + n41 * te[ 12 ];\r\n\r\n\t\tif ( det == 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnInvertible || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tTHREE.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.identity();\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tthis.multiplyScalar( 1 / det );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( v ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateX: function ( angle ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateY: function ( angle ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateZ: function ( angle ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateByAxis: function ( axis, angle ) {\r\n\r\n\t\tTHREE.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\r\n\t},\r\n\r\n\tscale: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\treturn Math.sqrt( Math.max( scaleXSq, Math.max( scaleYSq, scaleZSq ) ) );\r\n\r\n\t},\r\n\r\n\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, x,\r\n\t\t\t0, 1, 0, y,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationX: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0,  0, 0,\r\n\t\t\t0, c, - s, 0,\r\n\t\t\t0, s,  c, 0,\r\n\t\t\t0, 0,  0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationY: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t c, 0, s, 0,\r\n\t\t\t 0, 1, 0, 0,\r\n\t\t\t- s, 0, c, 0,\r\n\t\t\t 0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tc, - s, 0, 0,\r\n\t\t\ts,  c, 0, 0,\r\n\t\t\t0,  0, 1, 0,\r\n\t\t\t0,  0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\tvar c = Math.cos( angle );\r\n\t\tvar s = Math.sin( angle );\r\n\t\tvar t = 1 - c;\r\n\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\t return this;\r\n\r\n\t},\r\n\r\n\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tx, 0, 0, 0,\r\n\t\t\t0, y, 0, 0,\r\n\t\t\t0, 0, z, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\tthis.makeRotationFromQuaternion( quaternion );\r\n\t\tthis.scale( scale );\r\n\t\tthis.setPosition( position );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdecompose: function () {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\treturn function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) {\r\n\t\t\t\tsx = - sx;\r\n\t\t\t}\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\r\n\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\r\n\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\r\n\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = 2 * near / ( right - left );\r\n\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\tvar a = ( right + left ) / ( right - left );\r\n\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakePerspective: function ( fov, aspect, near, far ) {\r\n\r\n\t\tvar ymax = near * Math.tan( THREE.Math.degToRad( fov * 0.5 ) );\r\n\t\tvar ymin = - ymax;\r\n\t\tvar xmin = ymin * aspect;\r\n\t\tvar xmax = ymax * aspect;\r\n\r\n\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\r\n\r\n\t},\r\n\r\n\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar w = right - left;\r\n\t\tvar h = top - bottom;\r\n\t\tvar p = far - near;\r\n\r\n\t\tvar x = ( right + left ) / w;\r\n\t\tvar y = ( top + bottom ) / h;\r\n\t\tvar z = ( far + near ) / p;\r\n\r\n\t\tte[ 0 ] = 2 / w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 / h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 / p;\tte[ 14 ] = - z;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\treturn [\r\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ], te[ 3 ],\r\n\t\t\tte[ 4 ], te[ 5 ], te[ 6 ], te[ 7 ],\r\n\t\t\tte[ 8 ], te[ 9 ], te[ 10 ], te[ 11 ],\r\n\t\t\tte[ 12 ], te[ 13 ], te[ 14 ], te[ 15 ]\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Matrix4().fromArray( this.elements );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Ray = function ( origin, direction ) {\r\n\r\n\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\r\n\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n\tconstructor: THREE.Ray,\r\n\r\n\tset: function ( origin, direction ) {\r\n\r\n\t\tthis.origin.copy( origin );\r\n\t\tthis.direction.copy( direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( ray ) {\r\n\r\n\t\tthis.origin.copy( ray.origin );\r\n\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t},\r\n\r\n\trecast: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( t ) {\r\n\r\n\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.subVectors( point, this.origin );\r\n\t\tvar directionDistance = result.dot( this.direction );\r\n\r\n\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\treturn result.copy( this.origin );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t// point behind the ray\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn this.origin.distanceTo( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\treturn v1.distanceTo( point );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdistanceSqToSegment: function () {\r\n\r\n\t\tvar segCenter = new THREE.Vector3();\r\n\t\tvar segDir = new THREE.Vector3();\r\n\t\tvar diff = new THREE.Vector3();\r\n\r\n\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t// defined by v0 and v1\r\n\t\t\t// It can also set two optional targets :\r\n\t\t\t// - The closest point on the ray\r\n\t\t\t// - The closest point on the segment\r\n\r\n\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\r\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\tvar c = diff.lengthSq();\r\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn sqrDist;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\r\n\t},\r\n\r\n\tintersectSphere: function () {\r\n\r\n\t\t// from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( sphere, optionalTarget ) {\r\n\r\n\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\r\n\t\t\tvar tca = v1.dot( this.direction );\r\n\r\n\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\r\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\tif ( d2 > radius2 ) return null;\r\n\r\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\r\n\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\r\n\r\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0 \r\n\t\t\treturn this.at( t0, optionalTarget );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tisIntersectionPlane: function ( plane ) {\r\n\r\n\t\t// check if the ray lies on the plane first\r\n\r\n\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\t\tif ( denominator == 0 ) {\r\n\r\n\t\t\t// line is coplanar, return origin\r\n\t\t\tif ( plane.distanceToPoint( this.origin ) == 0 ) {\r\n\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t// Return if the ray never intersects the plane\r\n\r\n\t\treturn t >= 0 ? t :  null;\r\n\r\n\t},\r\n\r\n\tintersectPlane: function ( plane, optionalTarget ) {\r\n\r\n\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\tif ( t === null ) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn this.at( t, optionalTarget );\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectBox: function ( box, optionalTarget ) {\r\n\r\n\t\t// http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\r\n\t\tvar tmin,tmax,tymin,tymax,tzmin,tzmax;\r\n\r\n\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\tvar origin = this.origin;\r\n\r\n\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\t\t}\r\n\r\n\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\r\n\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\r\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\r\n\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\r\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\r\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\r\n\t\t//return point closest to the ray (positive side)\r\n\r\n\t\tif ( tmax < 0 ) return null;\r\n\r\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\r\n\r\n\t},\r\n\r\n\tintersectTriangle: function () {\r\n\r\n\t\t// Compute the offset origin, edges, and normal.\r\n\t\tvar diff = new THREE.Vector3();\r\n\t\tvar edge1 = new THREE.Vector3();\r\n\t\tvar edge2 = new THREE.Vector3();\r\n\t\tvar normal = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n\t\t\tedge1.subVectors( b, a );\r\n\t\t\tedge2.subVectors( c, a );\r\n\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\r\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\tvar sign;\r\n\r\n\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\tsign = 1;\r\n\r\n\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\tsign = - 1;\r\n\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\r\n\t\t\t// b1 < 0, no intersection\r\n\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\r\n\t\t\t// b2 < 0, no intersection\r\n\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\r\n\t\t\t// t < 0, no intersection\r\n\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ray intersects triangle.\r\n\t\t\treturn this.at( QdN / DdN, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\r\n\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\tthis.direction.sub( this.origin );\r\n\t\tthis.direction.normalize();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tequals: function ( ray ) {\r\n\r\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Ray().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function ( center, radius ) {\r\n\r\n\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\r\n\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n\tconstructor: THREE.Sphere,\r\n\r\n\tset: function ( center, radius ) {\r\n\r\n\t\tthis.center.copy( center );\r\n\t\tthis.radius = radius;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tsetFromPoints: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\r\n\t\treturn function ( points, optionalCenter ) {\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbox.setFromPoints( points ).center( center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcopy: function ( sphere ) {\r\n\r\n\t\tthis.center.copy( sphere.center );\r\n\t\tthis.radius = sphere.radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\treturn ( this.radius <= 0 );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.copy( point );\r\n\r\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\tresult.sub( this.center ).normalize();\r\n\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\tgetBoundingBox: function ( optionalTarget ) {\r\n\r\n\t\tvar box = optionalTarget || new THREE.Box3();\r\n\r\n\t\tbox.set( this.center, this.center );\r\n\t\tbox.expandByScalar( this.radius );\r\n\r\n\t\treturn box;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.center.applyMatrix4( matrix );\r\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.center.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( sphere ) {\r\n\r\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Sphere().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\tthis.planes = [\r\n\r\n\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\r\n\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\r\n\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\r\n\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\r\n\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\r\n\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\r\n\r\n\t];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n\tconstructor: THREE.Frustum,\r\n\r\n\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tplanes[ 0 ].copy( p0 );\r\n\t\tplanes[ 1 ].copy( p1 );\r\n\t\tplanes[ 2 ].copy( p2 );\r\n\t\tplanes[ 3 ].copy( p3 );\r\n\t\tplanes[ 4 ].copy( p4 );\r\n\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( frustum ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix: function ( m ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar me = m.elements;\r\n\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tintersectsObject: function () {\r\n\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar center = sphere.center;\r\n\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsBox: function () {\r\n\r\n\t\tvar p1 = new THREE.Vector3(),\r\n\t\t\tp2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\r\n\r\n\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\r\n\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\r\n\r\n\t\t\t\t// if both outside plane, no intersection\r\n\r\n\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Frustum().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Plane = function ( normal, constant ) {\r\n\r\n\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\r\n\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n\tconstructor: THREE.Plane,\r\n\r\n\tset: function ( normal, constant ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\tthis.normal.set( x, y, z );\r\n\t\tthis.constant = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCoplanarPoints: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c ) {\r\n\r\n\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcopy: function ( plane ) {\r\n\r\n\t\tthis.normal.copy( plane.normal );\r\n\t\tthis.constant = plane.constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.constant *= - 1;\r\n\t\tthis.normal.negate();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t},\r\n\r\n\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t},\r\n\r\n\tprojectPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\r\n\r\n\t},\r\n\r\n\torthoPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\r\n\r\n\t},\r\n\r\n\tisIntersectionLine: function ( line ) {\r\n\r\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t},\r\n\r\n\tintersectLine: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( line, optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tvar direction = line.delta( v1 );\r\n\r\n\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\tif ( denominator == 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( this.distanceToPoint( line.start ) == 0 ) {\r\n\r\n\t\t\t\t\treturn result.copy( line.start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcoplanarPoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\tvar m1 = new THREE.Matrix3();\r\n\r\n\t\treturn function ( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\t// compute new normal based on theory here:\r\n\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\r\n\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\t\t\tvar newNormal = v1.copy( this.normal ).applyMatrix3( normalMatrix );\r\n\r\n\t\t\tvar newCoplanarPoint = this.coplanarPoint( v2 );\r\n\t\t\tnewCoplanarPoint.applyMatrix4( matrix );\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( newNormal, newCoplanarPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.constant = this.constant - offset.dot( this.normal );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( plane ) {\r\n\r\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant == this.constant );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Plane().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n\tgenerateUUID: function () {\r\n\r\n\t\t// http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\r\n\t\tvar uuid = new Array( 36 );\r\n\t\tvar rnd = 0, r;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tfor ( var i = 0; i < 36; i ++ ) {\r\n\r\n\t\t\t\tif ( i == 8 || i == 13 || i == 18 || i == 23 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '-';\r\n\r\n\t\t\t\t} else if ( i == 14 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '4';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\r\n\t\t\t\t\tr = rnd & 0xf;\r\n\t\t\t\t\trnd = rnd >> 4;\r\n\t\t\t\t\tuuid[ i ] = chars[ ( i == 19 ) ? ( r & 0x3 ) | 0x8 : r ];\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn uuid.join( '' );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\t// Clamp value to range <a, b>\r\n\r\n\tclamp: function ( x, a, b ) {\r\n\r\n\t\treturn ( x < a ) ? a : ( ( x > b ) ? b : x );\r\n\r\n\t},\r\n\r\n\t// Clamp value to range <a, inf)\r\n\r\n\tclampBottom: function ( x, a ) {\r\n\r\n\t\treturn x < a ? a : x;\r\n\r\n\t},\r\n\r\n\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t},\r\n\r\n\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t},\r\n\r\n\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t},\r\n\r\n\t// Random float from <0, 1> with 16 bits of randomness\r\n\t// (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\r\n\trandom16: function () {\r\n\r\n\t\treturn ( 65280 * Math.random() + 255 * Math.random() ) / 65535;\r\n\r\n\t},\r\n\r\n\t// Random integer from <low, high> interval\r\n\r\n\trandInt: function ( low, high ) {\r\n\r\n\t\treturn Math.floor( this.randFloat( low, high ) );\r\n\r\n\t},\r\n\r\n\t// Random float from <low, high> interval\r\n\r\n\trandFloat: function ( low, high ) {\r\n\r\n\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t},\r\n\r\n\t// Random float from <-range/2, range/2> interval\r\n\r\n\trandFloatSpread: function ( range ) {\r\n\r\n\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t},\r\n\r\n\tdegToRad: function () {\r\n\r\n\t\tvar degreeToRadiansFactor = Math.PI / 180;\r\n\r\n\t\treturn function ( degrees ) {\r\n\r\n\t\t\treturn degrees * degreeToRadiansFactor;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tradToDeg: function () {\r\n\r\n\t\tvar radianToDegreesFactor = 180 / Math.PI;\r\n\r\n\t\treturn function ( radians ) {\r\n\r\n\t\t\treturn radians * radianToDegreesFactor;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t},\r\n\r\n\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\tvalue --;\r\n\t\tvalue |= value >> 1;\r\n\t\tvalue |= value >> 2;\r\n\t\tvalue |= value >> 4;\r\n\t\tvalue |= value >> 8;\r\n\t\tvalue |= value >> 16;\r\n\t\tvalue ++;\r\n\r\n\t\treturn value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function ( points ) {\r\n\r\n\tthis.points = points;\r\n\r\n\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\r\n\tpoint, intPoint, weight, w2, w3,\r\n\tpa, pb, pc, pd;\r\n\r\n\tthis.initFromArray = function ( a ) {\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0; i < a.length; i ++ ) {\r\n\r\n\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getPoint = function ( k ) {\r\n\r\n\t\tpoint = ( this.points.length - 1 ) * k;\r\n\t\tintPoint = Math.floor( point );\r\n\t\tweight = point - intPoint;\r\n\r\n\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\tc[ 1 ] = intPoint;\r\n\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n\t\tpa = this.points[ c[ 0 ] ];\r\n\t\tpb = this.points[ c[ 1 ] ];\r\n\t\tpc = this.points[ c[ 2 ] ];\r\n\t\tpd = this.points[ c[ 3 ] ];\r\n\r\n\t\tw2 = weight * weight;\r\n\t\tw3 = weight * w2;\r\n\r\n\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\r\n\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\r\n\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\r\n\r\n\t\treturn v3;\r\n\r\n\t};\r\n\r\n\tthis.getControlPointsArray = function () {\r\n\r\n\t\tvar i, p, l = this.points.length,\r\n\t\t\tcoords = [];\r\n\r\n\t\tfor ( i = 0; i < l; i ++ ) {\r\n\r\n\t\t\tp = this.points[ i ];\r\n\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\r\n\r\n\t\t}\r\n\r\n\t\treturn coords;\r\n\r\n\t};\r\n\r\n\t// approximate length by summing linear segments\r\n\r\n\tthis.getLength = function ( nSubDivisions ) {\r\n\r\n\t\tvar i, index, nSamples, position,\r\n\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\r\n\t\t\toldPosition = new THREE.Vector3(),\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tchunkLengths = [],\r\n\t\t\ttotalLength = 0;\r\n\r\n\t\t// first point has 0 length\r\n\r\n\t\tchunkLengths[ 0 ] = 0;\r\n\r\n\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\r\n\r\n\t\tnSamples = this.points.length * nSubDivisions;\r\n\r\n\t\toldPosition.copy( this.points[ 0 ] );\r\n\r\n\t\tfor ( i = 1; i < nSamples; i ++ ) {\r\n\r\n\t\t\tindex = i / nSamples;\r\n\r\n\t\t\tposition = this.getPoint( index );\r\n\t\t\ttmpVec.copy( position );\r\n\r\n\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\r\n\r\n\t\t\toldPosition.copy( position );\r\n\r\n\t\t\tpoint = ( this.points.length - 1 ) * index;\r\n\t\t\tintPoint = Math.floor( point );\r\n\r\n\t\t\tif ( intPoint != oldIntPoint ) {\r\n\r\n\t\t\t\tchunkLengths[ intPoint ] = totalLength;\r\n\t\t\t\toldIntPoint = intPoint;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// last point ends with total length\r\n\r\n\t\tchunkLengths[ chunkLengths.length ] = totalLength;\r\n\r\n\t\treturn { chunks: chunkLengths, total: totalLength };\r\n\r\n\t};\r\n\r\n\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\r\n\r\n\t\tvar i, j,\r\n\t\t\tindex, indexCurrent, indexNext,\r\n\t\t\trealDistance,\r\n\t\t\tsampling, position,\r\n\t\t\tnewpoints = [],\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tsl = this.getLength();\r\n\r\n\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\r\n\r\n\t\tfor ( i = 1; i < this.points.length; i ++ ) {\r\n\r\n\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\r\n\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\r\n\r\n\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\r\n\r\n\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\r\n\t\t\tindexNext = i / ( this.points.length - 1 );\r\n\r\n\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\r\n\r\n\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\r\n\r\n\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.points = newpoints;\r\n\r\n\t};\r\n\r\n\t// Catmull-Rom\r\n\r\n\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\r\n\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function ( a, b, c ) {\r\n\r\n\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\r\n\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\r\n\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\r\n\treturn function ( a, b, c, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.subVectors( c, b );\r\n\t\tv0.subVectors( a, b );\r\n\t\tresult.cross( v0 );\r\n\r\n\t\tvar resultLengthSq = result.lengthSq();\r\n\t\tif ( resultLengthSq > 0 ) {\r\n\r\n\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.set( 0, 0, 0 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycoordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c, optionalTarget ) {\r\n\r\n\t\tv0.subVectors( c, a );\r\n\t\tv1.subVectors( b, a );\r\n\t\tv2.subVectors( point, a );\r\n\r\n\t\tvar dot00 = v0.dot( v0 );\r\n\t\tvar dot01 = v0.dot( v1 );\r\n\t\tvar dot02 = v0.dot( v2 );\r\n\t\tvar dot11 = v1.dot( v1 );\r\n\t\tvar dot12 = v1.dot( v2 );\r\n\r\n\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t// colinear or singular triangle\r\n\t\tif ( denom == 0 ) {\r\n\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\treturn result.set( - 2, - 1, - 1 );\r\n\t\t}\r\n\r\n\t\tvar invDenom = 1 / denom;\r\n\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t// barycoordinates must always sum to 1\r\n\t\treturn result.set( 1 - u - v, v, u );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c ) {\r\n\r\n\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\r\n\r\n\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n\tconstructor: THREE.Triangle,\r\n\r\n\tset: function ( a, b, c ) {\r\n\r\n\t\tthis.a.copy( a );\r\n\t\tthis.b.copy( b );\r\n\t\tthis.c.copy( c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\tthis.a.copy( points[ i0 ] );\r\n\t\tthis.b.copy( points[ i1 ] );\r\n\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( triangle ) {\r\n\r\n\t\tthis.a.copy( triangle.a );\r\n\t\tthis.b.copy( triangle.b );\r\n\t\tthis.c.copy( triangle.c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tarea: function () {\r\n\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\tv1.subVectors( this.a, this.b );\r\n\r\n\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmidpoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t},\r\n\r\n\tnormal: function ( optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tplane: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Plane();\r\n\r\n\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tbarycoordFromPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tequals: function ( triangle ) {\r\n\r\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Triangle().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function ( autoStart ) {\r\n\r\n\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.oldTime = 0;\r\n\tthis.elapsedTime = 0;\r\n\r\n\tthis.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n\tconstructor: THREE.Clock,\r\n\r\n\tstart: function () {\r\n\r\n\t\tthis.startTime = self.performance !== undefined && self.performance.now !== undefined\r\n\t\t\t\t\t ? self.performance.now()\r\n\t\t\t\t\t : Date.now();\r\n\r\n\t\tthis.oldTime = this.startTime;\r\n\t\tthis.running = true;\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tthis.getElapsedTime();\r\n\t\tthis.running = false;\r\n\r\n\t},\r\n\r\n\tgetElapsedTime: function () {\r\n\r\n\t\tthis.getDelta();\r\n\t\treturn this.elapsedTime;\r\n\r\n\t},\r\n\r\n\tgetDelta: function () {\r\n\r\n\t\tvar diff = 0;\r\n\r\n\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\tthis.start();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.running ) {\r\n\r\n\t\t\tvar newTime = self.performance !== undefined && self.performance.now !== undefined\r\n\t\t\t\t\t ? self.performance.now()\r\n\t\t\t\t\t : Date.now();\r\n\r\n\t\t\tdiff = 0.001 * ( newTime - this.oldTime );\r\n\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function () {}\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n\tconstructor: THREE.EventDispatcher,\r\n\r\n\tapply: function ( object ) {\r\n\r\n\t\tobject.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n\t\tobject.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n\t\tobject.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n\t\tobject.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n\t},\r\n\r\n\taddEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\thasEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tdispatchEvent: function ( event ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tevent.target = this;\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar length = listenerArray.length;\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://exocortex.com/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n( function ( THREE ) {\r\n\r\n\tTHREE.Raycaster = function ( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new THREE.Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\r\n\t\tthis.params = {\r\n\t\t\tSprite: {},\r\n\t\t\tMesh: {},\r\n\t\t\tPointCloud: { threshold: 1 },\r\n\t\t\tLOD: {},\r\n\t\t\tLine: {}\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tvar descSort = function ( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t};\r\n\r\n\tvar intersectObject = function ( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tTHREE.Raycaster.prototype = {\r\n\r\n\t\tconstructor: THREE.Raycaster,\r\n\r\n\t\tprecision: 0.0001,\r\n\t\tlinePrecision: 1,\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\t// camera is assumed _not_ to be a child of a transformed object\r\n\r\n\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.copy( camera.position );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( camera.position ).normalize();\r\n\r\n\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tTHREE.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( descSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tif ( objects instanceof Array === false ) {\r\n\r\n\t\t\t\tTHREE.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( descSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}( THREE ) );\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Object3D = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Object3D';\r\n\r\n\tthis.parent = undefined;\r\n\tthis.children = [];\r\n\r\n\tthis.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar rotation = new THREE.Euler();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tvar onRotationChange = function () {\r\n\t\tquaternion.setFromEuler( rotation, false );\r\n\t};\r\n\r\n\tvar onQuaternionChange = function () {\r\n\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\t};\r\n\r\n\trotation.onChange( onRotationChange );\r\n\tquaternion.onChange( onQuaternionChange );\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tposition: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: position\r\n\t\t},\r\n\t\trotation: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: rotation\r\n\t\t},\r\n\t\tquaternion: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: quaternion\r\n\t\t},\r\n\t\tscale: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: scale\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.rotationAutoUpdate = true;\r\n\r\n\tthis.matrix = new THREE.Matrix4();\r\n\tthis.matrixWorld = new THREE.Matrix4();\r\n\r\n\tthis.matrixAutoUpdate = true;\r\n\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis.castShadow = false;\r\n\tthis.receiveShadow = false;\r\n\r\n\tthis.frustumCulled = true;\r\n\tthis.renderOrder = 0;\r\n\r\n\tthis.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n\tconstructor: THREE.Object3D,\r\n\r\n\tget eulerOrder () {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .eulerOrder has been moved to .rotation.order.' );\r\n\r\n\t\treturn this.rotation.order;\r\n\r\n\t},\r\n\r\n\tset eulerOrder ( value ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .eulerOrder has been moved to .rotation.order.' );\r\n\r\n\t\tthis.rotation.order = value;\r\n\r\n\t},\r\n\r\n\tget useQuaternion () {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t},\r\n\r\n\tset useQuaternion ( value ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t},\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\r\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t},\r\n\r\n\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t},\r\n\r\n\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t},\r\n\r\n\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t// assumes q is normalized\r\n\r\n\t\tthis.quaternion.copy( q );\r\n\r\n\t},\r\n\r\n\trotateOnAxis: function () {\r\n\r\n\t\t// rotate object on axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar q1 = new THREE.Quaternion();\r\n\r\n\t\treturn function ( axis, angle ) {\r\n\r\n\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.multiply( q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\trotateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateOnAxis: function () {\r\n\r\n\t\t// translate object by distance along axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( axis, distance ) {\r\n\r\n\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( distance, axis ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\treturn this.translateOnAxis( axis, distance );\r\n\r\n\t},\r\n\r\n\ttranslateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlocalToWorld: function ( vector ) {\r\n\r\n\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tworldToLocal: function () {\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\t// This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tadd: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t\tif ( object === this ) {\r\n\r\n\t\t\tTHREE.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object instanceof THREE.Object3D ) {\r\n\r\n\t\t\tif ( object.parent !== undefined ) {\r\n\r\n\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.parent = this;\r\n\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\r\n\t\t\tthis.children.push( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tTHREE.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremove: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tobject.parent = undefined;\r\n\r\n\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\r\n\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetChildByName: function ( name ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\treturn this.getObjectByName( name );\r\n\r\n\t},\r\n\r\n\tgetObjectById: function ( id ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t},\r\n\r\n\tgetObjectByName: function ( name ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t},\r\n\r\n\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\tif ( this[ name ] === value ) return this;\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar child = this.children[ i ];\r\n\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\treturn object;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\r\n\t},\r\n\r\n\tgetWorldPosition: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\treturn result.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tgetWorldQuaternion: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar scale = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Quaternion();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, result, scale );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tgetWorldRotation: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Euler();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tgetWorldScale: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tgetWorldDirection: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\traycast: function () {},\r\n\r\n\ttraverse: function ( callback ) {\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].traverse( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseVisible: function ( callback ) {\r\n\r\n\t\tif ( this.visible === false ) return;\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].traverseVisible( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\tif ( this.parent ) {\r\n\r\n\t\t\tcallback( this.parent );\r\n\r\n\t\t\tthis.parent.traverseAncestors( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdateMatrix: function () {\r\n\r\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\r\n\r\n\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\r\n\r\n\t\t\tif ( this.parent === undefined ) {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\tforce = true;\r\n\r\n\t\t}\r\n\r\n\t\t// update children\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.3,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'ObjectExporter'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tvar geometries = {};\r\n\r\n\t\tvar parseGeometry = function ( geometry ) {\r\n\r\n\t\t\tif ( output.geometries === undefined ) {\r\n\r\n\t\t\t\toutput.geometries = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometries[ geometry.uuid ] === undefined ) {\r\n\r\n\t\t\t\tvar json = geometry.toJSON();\r\n\r\n\t\t\t\tdelete json.metadata;\r\n\r\n\t\t\t\tgeometries[ geometry.uuid ] = json;\r\n\r\n\t\t\t\toutput.geometries.push( json );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry.uuid;\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tvar materials = {};\r\n\r\n\t\tvar parseMaterial = function ( material ) {\r\n\r\n\t\t\tif ( output.materials === undefined ) {\r\n\r\n\t\t\t\toutput.materials = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( materials[ material.uuid ] === undefined ) {\r\n\r\n\t\t\t\tvar json = material.toJSON();\r\n\r\n\t\t\t\tdelete json.metadata;\r\n\r\n\t\t\t\tmaterials[ material.uuid ] = json;\r\n\r\n\t\t\t\toutput.materials.push( json );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material.uuid;\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tvar parseObject = function ( object ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tdata.uuid = object.uuid;\r\n\t\t\tdata.type = object.type;\r\n\r\n\t\t\tif ( object.name !== '' ) data.name = object.name;\r\n\t\t\tif ( JSON.stringify( object.userData ) !== '{}' ) data.userData = object.userData;\r\n\t\t\tif ( object.visible !== true ) data.visible = object.visible;\r\n\r\n\t\t\tif ( object instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\tdata.fov = object.fov;\r\n\t\t\t\tdata.aspect = object.aspect;\r\n\t\t\t\tdata.near = object.near;\r\n\t\t\t\tdata.far = object.far;\r\n\r\n\t\t\t} else if ( object instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\tdata.left = object.left;\r\n\t\t\t\tdata.right = object.right;\r\n\t\t\t\tdata.top = object.top;\r\n\t\t\t\tdata.bottom = object.bottom;\r\n\t\t\t\tdata.near = object.near;\r\n\t\t\t\tdata.far = object.far;\r\n\r\n\t\t\t} else if ( object instanceof THREE.AmbientLight ) {\r\n\r\n\t\t\t\tdata.color = object.color.getHex();\r\n\r\n\t\t\t} else if ( object instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\tdata.color = object.color.getHex();\r\n\t\t\t\tdata.intensity = object.intensity;\r\n\r\n\t\t\t} else if ( object instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tdata.color = object.color.getHex();\r\n\t\t\t\tdata.intensity = object.intensity;\r\n\t\t\t\tdata.distance = object.distance;\r\n\t\t\t\tdata.decay = object.decay;\r\n\r\n\t\t\t} else if ( object instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\tdata.color = object.color.getHex();\r\n\t\t\t\tdata.intensity = object.intensity;\r\n\t\t\t\tdata.distance = object.distance;\r\n\t\t\t\tdata.angle = object.angle;\r\n\t\t\t\tdata.exponent = object.exponent;\r\n\t\t\t\tdata.decay = object.decay;\r\n\r\n\t\t\t} else if ( object instanceof THREE.HemisphereLight ) {\r\n\r\n\t\t\t\tdata.color = object.color.getHex();\r\n\t\t\t\tdata.groundColor = object.groundColor.getHex();\r\n\r\n\t\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\t\tdata.geometry = parseGeometry( object.geometry );\r\n\t\t\t\tdata.material = parseMaterial( object.material );\r\n\r\n\t\t\t\tif ( object instanceof THREE.Line ) data.mode = object.mode;\r\n\r\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\tdata.material = parseMaterial( object.material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.matrix = object.matrix.toArray();\r\n\r\n\t\t\tif ( object.children.length > 0 ) {\r\n\r\n\t\t\t\tdata.children = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\t\t\t\tdata.children.push( parseObject( object.children[ i ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\toutput.object = parseObject( this );\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function ( object, recursive ) {\r\n\r\n\t\tif ( object === undefined ) object = new THREE.Object3D();\r\n\t\tif ( recursive === undefined ) recursive = true;\r\n\r\n\t\tobject.name = this.name;\r\n\r\n\t\tobject.up.copy( this.up );\r\n\r\n\t\tobject.position.copy( this.position );\r\n\t\tobject.quaternion.copy( this.quaternion );\r\n\t\tobject.scale.copy( this.scale );\r\n\r\n\t\tobject.rotationAutoUpdate = this.rotationAutoUpdate;\r\n\r\n\t\tobject.matrix.copy( this.matrix );\r\n\t\tobject.matrixWorld.copy( this.matrixWorld );\r\n\r\n\t\tobject.matrixAutoUpdate = this.matrixAutoUpdate;\r\n\t\tobject.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate;\r\n\r\n\t\tobject.visible = this.visible;\r\n\r\n\t\tobject.castShadow = this.castShadow;\r\n\t\tobject.receiveShadow = this.receiveShadow;\r\n\r\n\t\tobject.frustumCulled = this.frustumCulled;\r\n\r\n\t\tobject.userData = JSON.parse( JSON.stringify( this.userData ) );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = this.children[ i ];\r\n\t\t\t\tobject.add( child.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Object3D.prototype );\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\tthis.c = c;\r\n\r\n\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n\tthis.vertexNormals = normal instanceof Array ? normal : [];\r\n\r\n\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n\tthis.vertexColors = color instanceof Array ? color : [];\r\n\r\n\tthis.vertexTangents = [];\r\n\r\n\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n\tconstructor: THREE.Face3,\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar face = new THREE.Face3( this.a, this.b, this.c );\r\n\r\n\t\tface.normal.copy( this.normal );\r\n\t\tface.color.copy( this.color );\r\n\r\n\t\tface.materialIndex = this.materialIndex;\r\n\r\n\t\tfor ( var i = 0, il = this.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\tface.vertexNormals[ i ] = this.vertexNormals[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\tface.vertexColors[ i ] = this.vertexColors[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.vertexTangents.length; i < il; i ++ ) {\r\n\r\n\t\t\tface.vertexTangents[ i ] = this.vertexTangents[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn face;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Face4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Face4 = function ( a, b, c, d, normal, color, materialIndex ) {\r\n\r\n\tTHREE.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' )\r\n\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function ( array, itemSize ) {\r\n\r\n\tthis.array = array;\r\n\tthis.itemSize = itemSize;\r\n\r\n\tthis.needsUpdate = false;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.BufferAttribute,\r\n\r\n\tget length () {\r\n\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.itemSize;\r\n\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index     ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index     ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index     ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.BufferAttribute( new this.array.constructor( this.array ), this.itemSize );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function ( data, itemSize ) {\r\n\r\n\tTHREE.warn( 'THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.' );\r\n\treturn new THREE.BufferAttribute( data, itemSize );\r\n\r\n};\r\n\r\n// File:src/core/DynamicBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\r\n\r\n\tTHREE.BufferAttribute.call( this, array, itemSize );\r\n\r\n\tthis.updateRange = { offset: 0, count: -1 };\r\n\r\n};\r\n\r\nTHREE.DynamicBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\r\nTHREE.DynamicBufferAttribute.prototype.constructor = THREE.DynamicBufferAttribute;\r\n\r\nTHREE.DynamicBufferAttribute.prototype.clone = function () {\r\n\r\n\treturn new THREE.DynamicBufferAttribute( new this.array.constructor( this.array ), this.itemSize );\r\n\r\n};\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'BufferGeometry';\r\n\r\n\tthis.attributes = {};\r\n\tthis.attributesKeys = [];\r\n\r\n\tthis.drawcalls = [];\r\n\tthis.offsets = this.drawcalls; // backwards compatibility\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometry,\r\n\r\n\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.BufferAttribute === false ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\tthis.attributes[ name ] = { array: arguments[ 1 ], itemSize: arguments[ 2 ] };\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.attributes[ name ] = attribute;\r\n\t\tthis.attributesKeys = Object.keys( this.attributes );\r\n\r\n\t},\r\n\r\n\tgetAttribute: function ( name ) {\r\n\r\n\t\treturn this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\taddDrawCall: function ( start, count, indexOffset ) {\r\n\r\n\t\tthis.drawcalls.push( {\r\n\r\n\t\t\tstart: start,\r\n\t\t\tcount: count,\r\n\t\t\tindex: indexOffset !== undefined ? indexOffset : 0\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar position = this.attributes.position;\r\n\r\n\t\tif ( position !== undefined ) {\r\n\r\n\t\t\tmatrix.applyToVector3Array( position.array );\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tvar normal = this.attributes.normal;\r\n\r\n\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tnormalMatrix.applyToVector3Array( normal.array );\r\n\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.applyMatrix( new THREE.Matrix4().setPosition( offset ) );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry, settings ) {\r\n\r\n\t\tsettings = settings || { 'vertexColors': THREE.NoColors };\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\t\tvar vertexColors = settings.vertexColors;\r\n\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ].length > 0;\r\n\t\tvar hasFaceVertexNormals = faces[ 0 ].vertexNormals.length == 3;\r\n\r\n\t\tvar positions = new Float32Array( faces.length * 3 * 3 );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\r\n\t\tvar normals = new Float32Array( faces.length * 3 * 3 );\r\n\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\r\n\t\tif ( vertexColors !== THREE.NoColors ) {\r\n\r\n\t\t\tvar colors = new Float32Array( faces.length * 3 * 3 );\r\n\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\tvar uvs = new Float32Array( faces.length * 3 * 2 );\r\n\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, i2 = 0, i3 = 0; i < faces.length; i ++, i2 += 6, i3 += 9 ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tvar a = vertices[ face.a ];\r\n\t\t\tvar b = vertices[ face.b ];\r\n\t\t\tvar c = vertices[ face.c ];\r\n\r\n\t\t\tpositions[ i3     ] = a.x;\r\n\t\t\tpositions[ i3 + 1 ] = a.y;\r\n\t\t\tpositions[ i3 + 2 ] = a.z;\r\n\r\n\t\t\tpositions[ i3 + 3 ] = b.x;\r\n\t\t\tpositions[ i3 + 4 ] = b.y;\r\n\t\t\tpositions[ i3 + 5 ] = b.z;\r\n\r\n\t\t\tpositions[ i3 + 6 ] = c.x;\r\n\t\t\tpositions[ i3 + 7 ] = c.y;\r\n\t\t\tpositions[ i3 + 8 ] = c.z;\r\n\r\n\t\t\tif ( hasFaceVertexNormals === true ) {\r\n\r\n\t\t\t\tvar na = face.vertexNormals[ 0 ];\r\n\t\t\t\tvar nb = face.vertexNormals[ 1 ];\r\n\t\t\t\tvar nc = face.vertexNormals[ 2 ];\r\n\r\n\t\t\t\tnormals[ i3     ] = na.x;\r\n\t\t\t\tnormals[ i3 + 1 ] = na.y;\r\n\t\t\t\tnormals[ i3 + 2 ] = na.z;\r\n\r\n\t\t\t\tnormals[ i3 + 3 ] = nb.x;\r\n\t\t\t\tnormals[ i3 + 4 ] = nb.y;\r\n\t\t\t\tnormals[ i3 + 5 ] = nb.z;\r\n\r\n\t\t\t\tnormals[ i3 + 6 ] = nc.x;\r\n\t\t\t\tnormals[ i3 + 7 ] = nc.y;\r\n\t\t\t\tnormals[ i3 + 8 ] = nc.z;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar n = face.normal;\r\n\r\n\t\t\t\tnormals[ i3     ] = n.x;\r\n\t\t\t\tnormals[ i3 + 1 ] = n.y;\r\n\t\t\t\tnormals[ i3 + 2 ] = n.z;\r\n\r\n\t\t\t\tnormals[ i3 + 3 ] = n.x;\r\n\t\t\t\tnormals[ i3 + 4 ] = n.y;\r\n\t\t\t\tnormals[ i3 + 5 ] = n.z;\r\n\r\n\t\t\t\tnormals[ i3 + 6 ] = n.x;\r\n\t\t\t\tnormals[ i3 + 7 ] = n.y;\r\n\t\t\t\tnormals[ i3 + 8 ] = n.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( vertexColors === THREE.FaceColors ) {\r\n\r\n\t\t\t\tvar fc = face.color;\r\n\r\n\t\t\t\tcolors[ i3     ] = fc.r;\r\n\t\t\t\tcolors[ i3 + 1 ] = fc.g;\r\n\t\t\t\tcolors[ i3 + 2 ] = fc.b;\r\n\r\n\t\t\t\tcolors[ i3 + 3 ] = fc.r;\r\n\t\t\t\tcolors[ i3 + 4 ] = fc.g;\r\n\t\t\t\tcolors[ i3 + 5 ] = fc.b;\r\n\r\n\t\t\t\tcolors[ i3 + 6 ] = fc.r;\r\n\t\t\t\tcolors[ i3 + 7 ] = fc.g;\r\n\t\t\t\tcolors[ i3 + 8 ] = fc.b;\r\n\r\n\t\t\t} else if ( vertexColors === THREE.VertexColors ) {\r\n\r\n\t\t\t\tvar vca = face.vertexColors[ 0 ];\r\n\t\t\t\tvar vcb = face.vertexColors[ 1 ];\r\n\t\t\t\tvar vcc = face.vertexColors[ 2 ];\r\n\r\n\t\t\t\tcolors[ i3     ] = vca.r;\r\n\t\t\t\tcolors[ i3 + 1 ] = vca.g;\r\n\t\t\t\tcolors[ i3 + 2 ] = vca.b;\r\n\r\n\t\t\t\tcolors[ i3 + 3 ] = vcb.r;\r\n\t\t\t\tcolors[ i3 + 4 ] = vcb.g;\r\n\t\t\t\tcolors[ i3 + 5 ] = vcb.b;\r\n\r\n\t\t\t\tcolors[ i3 + 6 ] = vcc.r;\r\n\t\t\t\tcolors[ i3 + 7 ] = vcc.g;\r\n\t\t\t\tcolors[ i3 + 8 ] = vcc.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\tvar uva = faceVertexUvs[ 0 ][ i ][ 0 ];\r\n\t\t\t\tvar uvb = faceVertexUvs[ 0 ][ i ][ 1 ];\r\n\t\t\t\tvar uvc = faceVertexUvs[ 0 ][ i ][ 2 ];\r\n\r\n\t\t\t\tuvs[ i2     ] = uva.x;\r\n\t\t\t\tuvs[ i2 + 1 ] = uva.y;\r\n\r\n\t\t\t\tuvs[ i2 + 2 ] = uvb.x;\r\n\t\t\t\tuvs[ i2 + 3 ] = uvb.y;\r\n\r\n\t\t\t\tuvs[ i2 + 4 ] = uvc.x;\r\n\t\t\t\tuvs[ i2 + 5 ] = uvc.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeBoundingSphere()\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tvar bb = this.boundingBox;\r\n\t\t\t\tbb.makeEmpty();\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\t\t\t\t\tbb.expandByPoint( vector );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( positions === undefined || positions.length === 0 ) {\r\n\r\n\t\t\t\tthis.boundingBox.min.set( 0, 0, 0 );\r\n\t\t\t\tthis.boundingBox.max.set( 0, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\t\tTHREE.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tbox.makeEmpty();\r\n\r\n\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\t\t\t\t\tbox.expandByPoint( vector );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbox.center( center );\r\n\r\n\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t// boundingSphere of the boundingBox:  sqrt(3) smaller in the best case\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\tTHREE.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\t// backwards compatibility\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tif ( attributes.position ) {\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = normals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tnormals[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\tvar vA, vB, vC,\r\n\r\n\t\t\tpA = new THREE.Vector3(),\r\n\t\t\tpB = new THREE.Vector3(),\r\n\t\t\tpC = new THREE.Vector3(),\r\n\r\n\t\t\tcb = new THREE.Vector3(),\r\n\t\t\tab = new THREE.Vector3();\r\n\r\n\t\t\t// indexed elements\r\n\r\n\t\t\tif ( attributes.index ) {\r\n\r\n\t\t\t\tvar indices = attributes.index.array;\r\n\r\n\t\t\t\tvar offsets = ( this.offsets.length > 0 ? this.offsets : [ { start: 0, count: indices.length, index: 0 } ] );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = offsets.length; j < jl; ++ j ) {\r\n\r\n\t\t\t\t\tvar start = offsets[ j ].start;\r\n\t\t\t\t\tvar count = offsets[ j ].count;\r\n\t\t\t\t\tvar index = offsets[ j ].index;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = ( index + indices[ i     ] ) * 3;\r\n\t\t\t\t\t\tvB = ( index + indices[ i + 1 ] ) * 3;\r\n\t\t\t\t\t\tvC = ( index + indices[ i + 2 ] ) * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA     ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB     ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC     ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tnormals[ i     ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\t// based on http://www.terathon.com/code/tangent.html\r\n\t\t// (per vertex tangents)\r\n\r\n\t\tif ( this.attributes.index === undefined ||\r\n\t\t\t this.attributes.position === undefined ||\r\n\t\t\t this.attributes.normal === undefined ||\r\n\t\t\t this.attributes.uv === undefined ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar indices = this.attributes.index.array;\r\n\t\tvar positions = this.attributes.position.array;\r\n\t\tvar normals = this.attributes.normal.array;\r\n\t\tvar uvs = this.attributes.uv.array;\r\n\r\n\t\tvar nVertices = positions.length / 3;\r\n\r\n\t\tif ( this.attributes.tangent === undefined ) {\r\n\r\n\t\t\tthis.addAttribute( 'tangent', new THREE.BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar tangents = this.attributes.tangent.array;\r\n\r\n\t\tvar tan1 = [], tan2 = [];\r\n\r\n\t\tfor ( var k = 0; k < nVertices; k ++ ) {\r\n\r\n\t\t\ttan1[ k ] = new THREE.Vector3();\r\n\t\t\ttan2[ k ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tvar vA = new THREE.Vector3(),\r\n\t\t\tvB = new THREE.Vector3(),\r\n\t\t\tvC = new THREE.Vector3(),\r\n\r\n\t\t\tuvA = new THREE.Vector2(),\r\n\t\t\tuvB = new THREE.Vector2(),\r\n\t\t\tuvC = new THREE.Vector2(),\r\n\r\n\t\t\tx1, x2, y1, y2, z1, z2,\r\n\t\t\ts1, s2, t1, t2, r;\r\n\r\n\t\tvar sdir = new THREE.Vector3(), tdir = new THREE.Vector3();\r\n\r\n\t\tfunction handleTriangle( a, b, c ) {\r\n\r\n\t\t\tvA.fromArray( positions, a * 3 );\r\n\t\t\tvB.fromArray( positions, b * 3 );\r\n\t\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\r\n\t\t\tx1 = vB.x - vA.x;\r\n\t\t\tx2 = vC.x - vA.x;\r\n\r\n\t\t\ty1 = vB.y - vA.y;\r\n\t\t\ty2 = vC.y - vA.y;\r\n\r\n\t\t\tz1 = vB.z - vA.z;\r\n\t\t\tz2 = vC.z - vA.z;\r\n\r\n\t\t\ts1 = uvB.x - uvA.x;\r\n\t\t\ts2 = uvC.x - uvA.x;\r\n\r\n\t\t\tt1 = uvB.y - uvA.y;\r\n\t\t\tt2 = uvC.y - uvA.y;\r\n\r\n\t\t\tr = 1.0 / ( s1 * t2 - s2 * t1 );\r\n\r\n\t\t\tsdir.set(\r\n\t\t\t\t( t2 * x1 - t1 * x2 ) * r,\r\n\t\t\t\t( t2 * y1 - t1 * y2 ) * r,\r\n\t\t\t\t( t2 * z1 - t1 * z2 ) * r\r\n\t\t\t);\r\n\r\n\t\t\ttdir.set(\r\n\t\t\t\t( s1 * x2 - s2 * x1 ) * r,\r\n\t\t\t\t( s1 * y2 - s2 * y1 ) * r,\r\n\t\t\t\t( s1 * z2 - s2 * z1 ) * r\r\n\t\t\t);\r\n\r\n\t\t\ttan1[ a ].add( sdir );\r\n\t\t\ttan1[ b ].add( sdir );\r\n\t\t\ttan1[ c ].add( sdir );\r\n\r\n\t\t\ttan2[ a ].add( tdir );\r\n\t\t\ttan2[ b ].add( tdir );\r\n\t\t\ttan2[ c ].add( tdir );\r\n\r\n\t\t}\r\n\r\n\t\tvar i, il;\r\n\t\tvar j, jl;\r\n\t\tvar iA, iB, iC;\r\n\r\n\t\tif ( this.drawcalls.length === 0 ) {\r\n\r\n\t\t\tthis.addDrawCall( 0, indices.length, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tvar drawcalls = this.drawcalls;\r\n\r\n\t\tfor ( j = 0, jl = drawcalls.length; j < jl; ++ j ) {\r\n\r\n\t\t\tvar start = drawcalls[ j ].start;\r\n\t\t\tvar count = drawcalls[ j ].count;\r\n\t\t\tvar index = drawcalls[ j ].index;\r\n\r\n\t\t\tfor ( i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\tiA = index + indices[ i ];\r\n\t\t\t\tiB = index + indices[ i + 1 ];\r\n\t\t\t\tiC = index + indices[ i + 2 ];\r\n\r\n\t\t\t\thandleTriangle( iA, iB, iC );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar tmp = new THREE.Vector3(), tmp2 = new THREE.Vector3();\r\n\t\tvar n = new THREE.Vector3(), n2 = new THREE.Vector3();\r\n\t\tvar w, t, test;\r\n\r\n\t\tfunction handleVertex( v ) {\r\n\r\n\t\t\tn.fromArray( normals, v * 3 );\r\n\t\t\tn2.copy( n );\r\n\r\n\t\t\tt = tan1[ v ];\r\n\r\n\t\t\t// Gram-Schmidt orthogonalize\r\n\r\n\t\t\ttmp.copy( t );\r\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\r\n\r\n\t\t\t// Calculate handedness\r\n\r\n\t\t\ttmp2.crossVectors( n2, t );\r\n\t\t\ttest = tmp2.dot( tan2[ v ] );\r\n\t\t\tw = ( test < 0.0 ) ? - 1.0 : 1.0;\r\n\r\n\t\t\ttangents[ v * 4     ] = tmp.x;\r\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\r\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\r\n\t\t\ttangents[ v * 4 + 3 ] = w;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( j = 0, jl = drawcalls.length; j < jl; ++ j ) {\r\n\r\n\t\t\tvar start = drawcalls[ j ].start;\r\n\t\t\tvar count = drawcalls[ j ].count;\r\n\t\t\tvar index = drawcalls[ j ].index;\r\n\r\n\t\t\tfor ( i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\tiA = index + indices[ i ];\r\n\t\t\t\tiB = index + indices[ i + 1 ];\r\n\t\t\t\tiC = index + indices[ i + 2 ];\r\n\r\n\t\t\t\thandleVertex( iA );\r\n\t\t\t\thandleVertex( iB );\r\n\t\t\t\thandleVertex( iC );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t/*\r\n\tCompute the draw offset for large models by chunking the index buffer into chunks of 65k addressable vertices.\r\n\tThis method will effectively rewrite the index buffer and remap all attributes to match the new indices.\r\n\tWARNING: This method will also expand the vertex count to prevent sprawled triangles across draw offsets.\r\n\tsize - Defaults to 65535, but allows for larger or smaller chunks.\r\n\t*/\r\n\tcomputeOffsets: function ( size ) {\r\n\r\n\t\tif ( size === undefined ) size = 65535; // WebGL limits type of index buffer values to 16-bit.\r\n\r\n\t\tvar indices = this.attributes.index.array;\r\n\t\tvar vertices = this.attributes.position.array;\r\n\r\n\t\tvar facesCount = ( indices.length / 3 );\r\n\r\n\t\t/*\r\n\t\tconsole.log(\"Computing buffers in offsets of \"+size+\" -> indices:\"+indices.length+\" vertices:\"+vertices.length);\r\n\t\tconsole.log(\"Faces to process: \"+(indices.length/3));\r\n\t\tconsole.log(\"Reordering \"+verticesCount+\" vertices.\");\r\n\t\t*/\r\n\r\n\t\tvar sortedIndices = new Uint16Array( indices.length ); //16-bit buffers\r\n\t\tvar indexPtr = 0;\r\n\t\tvar vertexPtr = 0;\r\n\r\n\t\tvar offsets = [ { start:0, count:0, index:0 } ];\r\n\t\tvar offset = offsets[ 0 ];\r\n\r\n\t\tvar duplicatedVertices = 0;\r\n\t\tvar newVerticeMaps = 0;\r\n\t\tvar faceVertices = new Int32Array( 6 );\r\n\t\tvar vertexMap = new Int32Array( vertices.length );\r\n\t\tvar revVertexMap = new Int32Array( vertices.length );\r\n\t\tfor ( var j = 0; j < vertices.length; j ++ ) { vertexMap[ j ] = - 1; revVertexMap[ j ] = - 1; }\r\n\r\n\t\t/*\r\n\t\t\tTraverse every face and reorder vertices in the proper offsets of 65k.\r\n\t\t\tWe can have more than 65k entries in the index buffer per offset, but only reference 65k values.\r\n\t\t*/\r\n\t\tfor ( var findex = 0; findex < facesCount; findex ++ ) {\r\n\t\t\tnewVerticeMaps = 0;\r\n\r\n\t\t\tfor ( var vo = 0; vo < 3; vo ++ ) {\r\n\t\t\t\tvar vid = indices[ findex * 3 + vo ];\r\n\t\t\t\tif ( vertexMap[ vid ] == - 1 ) {\r\n\t\t\t\t\t//Unmapped vertice\r\n\t\t\t\t\tfaceVertices[ vo * 2 ] = vid;\r\n\t\t\t\t\tfaceVertices[ vo * 2 + 1 ] = - 1;\r\n\t\t\t\t\tnewVerticeMaps ++;\r\n\t\t\t\t} else if ( vertexMap[ vid ] < offset.index ) {\r\n\t\t\t\t\t//Reused vertices from previous block (duplicate)\r\n\t\t\t\t\tfaceVertices[ vo * 2 ] = vid;\r\n\t\t\t\t\tfaceVertices[ vo * 2 + 1 ] = - 1;\r\n\t\t\t\t\tduplicatedVertices ++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//Reused vertice in the current block\r\n\t\t\t\t\tfaceVertices[ vo * 2 ] = vid;\r\n\t\t\t\t\tfaceVertices[ vo * 2 + 1 ] = vertexMap[ vid ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar faceMax = vertexPtr + newVerticeMaps;\r\n\t\t\tif ( faceMax > ( offset.index + size ) ) {\r\n\t\t\t\tvar new_offset = { start:indexPtr, count:0, index:vertexPtr };\r\n\t\t\t\toffsets.push( new_offset );\r\n\t\t\t\toffset = new_offset;\r\n\r\n\t\t\t\t//Re-evaluate reused vertices in light of new offset.\r\n\t\t\t\tfor ( var v = 0; v < 6; v += 2 ) {\r\n\t\t\t\t\tvar new_vid = faceVertices[ v + 1 ];\r\n\t\t\t\t\tif ( new_vid > - 1 && new_vid < offset.index )\r\n\t\t\t\t\t\tfaceVertices[ v + 1 ] = - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Reindex the face.\r\n\t\t\tfor ( var v = 0; v < 6; v += 2 ) {\r\n\t\t\t\tvar vid = faceVertices[ v ];\r\n\t\t\t\tvar new_vid = faceVertices[ v + 1 ];\r\n\r\n\t\t\t\tif ( new_vid === - 1 )\r\n\t\t\t\t\tnew_vid = vertexPtr ++;\r\n\r\n\t\t\t\tvertexMap[ vid ] = new_vid;\r\n\t\t\t\trevVertexMap[ new_vid ] = vid;\r\n\t\t\t\tsortedIndices[ indexPtr ++ ] = new_vid - offset.index; //XXX overflows at 16bit\r\n\t\t\t\toffset.count ++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Move all attribute values to map to the new computed indices , also expand the vertice stack to match our new vertexPtr. */\r\n\t\tthis.reorderBuffers( sortedIndices, revVertexMap, vertexPtr );\r\n\t\tthis.offsets = offsets; // TODO: Deprecate\r\n\t\tthis.drawcalls = offsets;\r\n\r\n\t\t/*\r\n\t\tvar orderTime = Date.now();\r\n\t\tconsole.log(\"Reorder time: \"+(orderTime-s)+\"ms\");\r\n\t\tconsole.log(\"Duplicated \"+duplicatedVertices+\" vertices.\");\r\n\t\tconsole.log(\"Compute Buffers time: \"+(Date.now()-s)+\"ms\");\r\n\t\tconsole.log(\"Draw offsets: \"+offsets.length);\r\n\t\t*/\r\n\r\n\t\treturn offsets;\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, offset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\r\n\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\tvar attributeSize = attribute2.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\r\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalizeNormals: function () {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\r\n\t\tvar x, y, z, n;\r\n\r\n\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\r\n\r\n\t\t\tx = normals[ i ];\r\n\t\t\ty = normals[ i + 1 ];\r\n\t\t\tz = normals[ i + 2 ];\r\n\r\n\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tnormals[ i     ] *= n;\r\n\t\t\tnormals[ i + 1 ] *= n;\r\n\t\t\tnormals[ i + 2 ] *= n;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t/*\r\n\t\treoderBuffers:\r\n\t\tReorder attributes based on a new indexBuffer and indexMap.\r\n\t\tindexBuffer - Uint16Array of the new ordered indices.\r\n\t\tindexMap - Int32Array where the position is the new vertex ID and the value the old vertex ID for each vertex.\r\n\t\tvertexCount - Amount of total vertices considered in this reordering (in case you want to grow the vertice stack).\r\n\t*/\r\n\treorderBuffers: function ( indexBuffer, indexMap, vertexCount ) {\r\n\r\n\t\t/* Create a copy of all attributes for reordering. */\r\n\t\tvar sortedAttributes = {};\r\n\t\tfor ( var attr in this.attributes ) {\r\n\t\t\tif ( attr == 'index' )\r\n\t\t\t\tcontinue;\r\n\t\t\tvar sourceArray = this.attributes[ attr ].array;\r\n\t\t\tsortedAttributes[ attr ] = new sourceArray.constructor( this.attributes[ attr ].itemSize * vertexCount );\r\n\t\t}\r\n\r\n\t\t/* Move attribute positions based on the new index map */\r\n\t\tfor ( var new_vid = 0; new_vid < vertexCount; new_vid ++ ) {\r\n\t\t\tvar vid = indexMap[ new_vid ];\r\n\t\t\tfor ( var attr in this.attributes ) {\r\n\t\t\t\tif ( attr == 'index' )\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tvar attrArray = this.attributes[ attr ].array;\r\n\t\t\t\tvar attrSize = this.attributes[ attr ].itemSize;\r\n\t\t\t\tvar sortedAttr = sortedAttributes[ attr ];\r\n\t\t\t\tfor ( var k = 0; k < attrSize; k ++ )\r\n\t\t\t\t\tsortedAttr[ new_vid * attrSize + k ] = attrArray[ vid * attrSize + k ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Carry the new sorted buffers locally */\r\n\t\tthis.attributes[ 'index' ].array = indexBuffer;\r\n\t\tfor ( var attr in this.attributes ) {\r\n\t\t\tif ( attr == 'index' )\r\n\t\t\t\tcontinue;\r\n\t\t\tthis.attributes[ attr ].array = sortedAttributes[ attr ];\r\n\t\t\tthis.attributes[ attr ].numItems = this.attributes[ attr ].itemSize * vertexCount;\r\n\t\t}\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.0,\r\n\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\tgenerator: 'BufferGeometryExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type,\r\n\t\t\tdata: {\r\n\t\t\t\tattributes: {}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar attributes = this.attributes;\r\n\t\tvar offsets = this.offsets;\r\n\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\r\n\t\t\toutput.data.attributes[ key ] = {\r\n\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\tarray: array\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( offsets.length > 0 ) {\r\n\r\n\t\t\toutput.data.offsets = JSON.parse( JSON.stringify( offsets ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\toutput.data.boundingSphere = {\r\n\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\t\tfor ( var attr in this.attributes ) {\r\n\r\n\t\t\tvar sourceAttr = this.attributes[ attr ];\r\n\t\t\tgeometry.addAttribute( attr, sourceAttr.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar offset = this.offsets[ i ];\r\n\r\n\t\t\tgeometry.offsets.push( {\r\n\r\n\t\t\t\tstart: offset.start,\r\n\t\t\t\tindex: offset.index,\r\n\t\t\t\tcount: offset.count\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.BufferGeometry.prototype );\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Geometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Geometry';\r\n\r\n\tthis.vertices = [];\r\n\tthis.colors = [];  // one-to-one vertex colors, used in Points and Line\r\n\r\n\tthis.faces = [];\r\n\r\n\tthis.faceVertexUvs = [ [] ];\r\n\r\n\tthis.morphTargets = [];\r\n\tthis.morphColors = [];\r\n\tthis.morphNormals = [];\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\tthis.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\tthis.hasTangents = false;\r\n\r\n\tthis.dynamic = true; // the intermediate typed arrays will be deleted when set to false\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.elementsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.tangentsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.lineDistancesNeedUpdate = false;\r\n\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n\tconstructor: THREE.Geometry,\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.verticesNeedUpdate = true;\r\n\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t},\r\n\r\n\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tvar vertices = attributes.position.array;\r\n\t\tvar indices = attributes.index !== undefined ? attributes.index.array : undefined;\r\n\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\r\n\t\tvar tempNormals = [];\r\n\t\tvar tempUVs = [];\r\n\r\n\t\tfor ( var i = 0, j = 0; i < vertices.length; i += 3, j += 2 ) {\r\n\r\n\t\t\tscope.vertices.push( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t\t\tif ( normals !== undefined ) {\r\n\r\n\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar addFace = function ( a, b, c ) {\r\n\r\n\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\r\n\t\t\tscope.faces.push( new THREE.Face3( a, b, c, vertexNormals, vertexColors ) );\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\tvar drawcalls = geometry.drawcalls;\r\n\r\n\t\t\tif ( drawcalls.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < drawcalls.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar drawcall = drawcalls[ i ];\r\n\r\n\t\t\t\t\tvar start = drawcall.start;\r\n\t\t\t\t\tvar count = drawcall.count;\r\n\t\t\t\t\tvar index = drawcall.index;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( index + indices[ j ], index + indices[ j + 1 ], index + indices[ j + 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < vertices.length / 3; i += 3 ) {\r\n\r\n\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeFaceNormals();\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.applyMatrix( new THREE.Matrix4().setPosition( offset ) );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\tcb.subVectors( vC, vB );\r\n\t\t\tab.subVectors( vA, vB );\r\n\t\t\tcb.cross( ab );\r\n\r\n\t\t\tcb.normalize();\r\n\r\n\t\t\tface.normal.copy( cb );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\tvar vA, vB, vC;\r\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tface.vertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\tface.vertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\tface.vertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeMorphNormals: function () {\r\n\r\n\t\tvar i, il, f, fl, face;\r\n\r\n\t\t// save original normals\r\n\t\t// - create temp variables on first access\r\n\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\r\n\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\tvar tmpGeo = new THREE.Geometry();\r\n\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t// create on first access\r\n\r\n\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tfaceNormal = new THREE.Vector3();\r\n\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\r\n\r\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t// set vertices to morph target\r\n\r\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t// compute morph normals\r\n\r\n\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t// store morph normals\r\n\r\n\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore original normals\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\t// based on http://www.terathon.com/code/tangent.html\r\n\t\t// tangents go to vertices\r\n\r\n\t\tvar f, fl, v, vl, i, vertexIndex,\r\n\t\t\tface, uv, vA, vB, vC, uvA, uvB, uvC,\r\n\t\t\tx1, x2, y1, y2, z1, z2,\r\n\t\t\ts1, s2, t1, t2, r, t, test,\r\n\t\t\ttan1 = [], tan2 = [],\r\n\t\t\tsdir = new THREE.Vector3(), tdir = new THREE.Vector3(),\r\n\t\t\ttmp = new THREE.Vector3(), tmp2 = new THREE.Vector3(),\r\n\t\t\tn = new THREE.Vector3(), w;\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\ttan1[ v ] = new THREE.Vector3();\r\n\t\t\ttan2[ v ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tfunction handleTriangle( context, a, b, c, ua, ub, uc ) {\r\n\r\n\t\t\tvA = context.vertices[ a ];\r\n\t\t\tvB = context.vertices[ b ];\r\n\t\t\tvC = context.vertices[ c ];\r\n\r\n\t\t\tuvA = uv[ ua ];\r\n\t\t\tuvB = uv[ ub ];\r\n\t\t\tuvC = uv[ uc ];\r\n\r\n\t\t\tx1 = vB.x - vA.x;\r\n\t\t\tx2 = vC.x - vA.x;\r\n\t\t\ty1 = vB.y - vA.y;\r\n\t\t\ty2 = vC.y - vA.y;\r\n\t\t\tz1 = vB.z - vA.z;\r\n\t\t\tz2 = vC.z - vA.z;\r\n\r\n\t\t\ts1 = uvB.x - uvA.x;\r\n\t\t\ts2 = uvC.x - uvA.x;\r\n\t\t\tt1 = uvB.y - uvA.y;\r\n\t\t\tt2 = uvC.y - uvA.y;\r\n\r\n\t\t\tr = 1.0 / ( s1 * t2 - s2 * t1 );\r\n\t\t\tsdir.set( ( t2 * x1 - t1 * x2 ) * r,\r\n\t\t\t\t\t  ( t2 * y1 - t1 * y2 ) * r,\r\n\t\t\t\t\t  ( t2 * z1 - t1 * z2 ) * r );\r\n\t\t\ttdir.set( ( s1 * x2 - s2 * x1 ) * r,\r\n\t\t\t\t\t  ( s1 * y2 - s2 * y1 ) * r,\r\n\t\t\t\t\t  ( s1 * z2 - s2 * z1 ) * r );\r\n\r\n\t\t\ttan1[ a ].add( sdir );\r\n\t\t\ttan1[ b ].add( sdir );\r\n\t\t\ttan1[ c ].add( sdir );\r\n\r\n\t\t\ttan2[ a ].add( tdir );\r\n\t\t\ttan2[ b ].add( tdir );\r\n\t\t\ttan2[ c ].add( tdir );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\t\t\tuv = this.faceVertexUvs[ 0 ][ f ]; // use UV layer 0 for tangents\r\n\r\n\t\t\thandleTriangle( this, face.a, face.b, face.c, 0, 1, 2 );\r\n\r\n\t\t}\r\n\r\n\t\tvar faceIndex = [ 'a', 'b', 'c', 'd' ];\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tfor ( i = 0; i < Math.min( face.vertexNormals.length, 3 ); i ++ ) {\r\n\r\n\t\t\t\tn.copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\tvertexIndex = face[ faceIndex[ i ] ];\r\n\r\n\t\t\t\tt = tan1[ vertexIndex ];\r\n\r\n\t\t\t\t// Gram-Schmidt orthogonalize\r\n\r\n\t\t\t\ttmp.copy( t );\r\n\t\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\r\n\r\n\t\t\t\t// Calculate handedness\r\n\r\n\t\t\t\ttmp2.crossVectors( face.vertexNormals[ i ], t );\r\n\t\t\t\ttest = tmp2.dot( tan2[ vertexIndex ] );\r\n\t\t\t\tw = ( test < 0.0 ) ? - 1.0 : 1.0;\r\n\r\n\t\t\t\tface.vertexTangents[ i ] = new THREE.Vector4( tmp.x, tmp.y, tmp.z, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.hasTangents = true;\r\n\r\n\t},\r\n\r\n\tcomputeLineDistances: function () {\r\n\r\n\t\tvar d = 0;\r\n\t\tvar vertices = this.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tif ( i > 0 ) {\r\n\r\n\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.lineDistances[ i ] = d;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.Geometry === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar normalMatrix,\r\n\t\tvertexOffset = this.vertices.length,\r\n\t\tvertices1 = this.vertices,\r\n\t\tvertices2 = geometry.vertices,\r\n\t\tfaces1 = this.faces,\r\n\t\tfaces2 = geometry.faces,\r\n\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\r\n\r\n\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\r\n\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t}\r\n\r\n\t\t// vertices\r\n\r\n\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\r\n\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// faces\r\n\r\n\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// uvs\r\n\r\n\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\r\n\t\t\tif ( uv === undefined ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvs1.push( uvCopy );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmergeMesh: function ( mesh ) {\r\n\r\n\t\tif ( mesh instanceof THREE.Mesh === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t},\r\n\r\n\t/*\r\n\t * Checks for duplicate vertices with hashmap.\r\n\t * Duplicated vertices are removed\r\n\t * and faces' vertices are updated.\r\n\t */\r\n\r\n\tmergeVertices: function () {\r\n\r\n\t\tvar verticesMap = {}; // Hashmap for looking up vertice by position coordinates (and making sure they are unique)\r\n\t\tvar unique = [], changes = [];\r\n\r\n\t\tvar v, key;\r\n\t\tvar precisionPoints = 4; // number of decimal points, eg. 4 for epsilon of 0.0001\r\n\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\tvar i, il, face;\r\n\t\tvar indices, j, jl;\r\n\r\n\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tv = this.vertices[ i ];\r\n\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\r\n\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t// have to remove them from the geometry.\r\n\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\tface.a = changes[ face.a ];\r\n\t\t\tface.b = changes[ face.b ];\r\n\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\tvar dupIndex = - 1;\r\n\r\n\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\t\t\t\tif ( indices[ n ] == indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\tdupIndex = n;\r\n\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Use unique set of vertices\r\n\r\n\t\tvar diff = this.vertices.length - unique.length;\r\n\t\tthis.vertices = unique;\r\n\t\treturn diff;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.0,\r\n\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\tgenerator: 'BufferGeometryExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type\r\n\t\t};\r\n\r\n\t\tif ( this.name !== \"\" ) output.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) output[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = [];\r\n\t\tvar normals = [];\r\n\t\tvar normalsHash = {};\r\n\t\tvar colors = [];\r\n\t\tvar colorsHash = {};\r\n\t\tvar uvs = [];\r\n\t\tvar uvsHash = {};\r\n\r\n\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\tvar hasMaterial = false; // face.materialIndex !== undefined;\r\n\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\tvar faceType = 0;\r\n\r\n\t\t\tfaceType = setBit( faceType, 0, 0 );\r\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\tfaces.push( faceType );\r\n\t\t\tfaces.push( face.a, face.b, face.c );\r\n\r\n\r\n\t\t\t/*\r\n\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\tfaces.push( face.materialIndex );\r\n\r\n\t\t\t}\r\n\t\t\t*/\r\n\r\n\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\toutput.data = {};\r\n\r\n\t\toutput.data.vertices = vertices;\r\n\t\toutput.data.normals = normals;\r\n\t\tif ( colors.length > 0 ) output.data.colors = colors;\r\n\t\tif ( uvs.length > 0 ) output.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\toutput.data.faces = faces;\r\n\r\n\t\t//\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar geometry = new THREE.Geometry();\r\n\r\n\t\tvar vertices = this.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tgeometry.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = this.faces;\r\n\r\n\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tgeometry.faces.push( faces[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar faceVertexUvs = this.faceVertexUvs[ i ];\r\n\r\n\t\t\tif ( geometry.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Geometry.prototype );\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.Camera = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Camera';\r\n\r\n\tthis.matrixWorldInverse = new THREE.Matrix4();\r\n\tthis.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function () {\r\n\r\n\tvar quaternion = new THREE.Quaternion();\r\n\r\n\treturn function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t}\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function () {\r\n\r\n\t// This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n\tvar m1 = new THREE.Matrix4();\r\n\r\n\treturn function ( vector ) {\r\n\r\n\t\tm1.lookAt( this.position, vector, this.up );\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function ( camera ) {\r\n\r\n\tif ( camera === undefined ) camera = new THREE.Camera();\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, camera );\r\n\r\n\tcamera.matrixWorldInverse.copy( this.matrixWorldInverse );\r\n\tcamera.projectionMatrix.copy( this.projectionMatrix );\r\n\r\n\treturn camera;\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function ( near, far, cubeResolution ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'CubeCamera';\r\n\r\n\tvar fov = 90, aspect = 1;\r\n\r\n\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPX.up.set( 0, - 1, 0 );\r\n\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\r\n\tthis.add( cameraPX );\r\n\r\n\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNX.up.set( 0, - 1, 0 );\r\n\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\r\n\tthis.add( cameraNX );\r\n\r\n\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPY.up.set( 0, 0, 1 );\r\n\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\r\n\tthis.add( cameraPY );\r\n\r\n\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNY.up.set( 0, 0, - 1 );\r\n\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\r\n\tthis.add( cameraNY );\r\n\r\n\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPZ.up.set( 0, - 1, 0 );\r\n\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\r\n\tthis.add( cameraPZ );\r\n\r\n\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNZ.up.set( 0, - 1, 0 );\r\n\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\r\n\tthis.add( cameraNZ );\r\n\r\n\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter } );\r\n\r\n\tthis.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tvar renderTarget = this.renderTarget;\r\n\t\tvar generateMipmaps = renderTarget.generateMipmaps;\r\n\r\n\t\trenderTarget.generateMipmaps = false;\r\n\r\n\t\trenderTarget.activeCubeFace = 0;\r\n\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 1;\r\n\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 2;\r\n\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 3;\r\n\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 4;\r\n\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\r\n\t\trenderTarget.generateMipmaps = generateMipmaps;\r\n\r\n\t\trenderTarget.activeCubeFace = 5;\r\n\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'OrthographicCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.left = left;\r\n\tthis.right = right;\r\n\tthis.top = top;\r\n\tthis.bottom = bottom;\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function () {\r\n\r\n\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\tvar cx = ( this.right + this.left ) / 2;\r\n\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.clone = function () {\r\n\r\n\tvar camera = new THREE.OrthographicCamera();\r\n\r\n\tTHREE.Camera.prototype.clone.call( this, camera );\r\n\r\n\tcamera.zoom = this.zoom;\r\n\r\n\tcamera.left = this.left;\r\n\tcamera.right = this.right;\r\n\tcamera.top = this.top;\r\n\tcamera.bottom = this.bottom;\r\n\r\n\tcamera.near = this.near;\r\n\tcamera.far = this.far;\r\n\r\n\tcamera.projectionMatrix.copy( this.projectionMatrix );\r\n\r\n\treturn camera;\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.PerspectiveCamera = function ( fov, aspect, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'PerspectiveCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.fov = fov !== undefined ? fov : 50;\r\n\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\tthis.near = near !== undefined ? near : 0.1;\r\n\tthis.far = far !== undefined ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Uses Focal Length (in mm) to estimate and set FOV\r\n * 35mm (fullframe) camera is used if frame size is not specified;\r\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function ( focalLength, frameHeight ) {\r\n\r\n\tif ( frameHeight === undefined ) frameHeight = 24;\r\n\r\n\tthis.fov = 2 * THREE.Math.radToDeg( Math.atan( frameHeight / ( focalLength * 2 ) ) );\r\n\tthis.updateProjectionMatrix();\r\n\r\n}\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\tthis.fullWidth = fullWidth;\r\n\tthis.fullHeight = fullHeight;\r\n\tthis.x = x;\r\n\tthis.y = y;\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function () {\r\n\r\n\tvar fov = THREE.Math.radToDeg( 2 * Math.atan( Math.tan( THREE.Math.degToRad( this.fov ) * 0.5 ) / this.zoom ) );\r\n\r\n\tif ( this.fullWidth ) {\r\n\r\n\t\tvar aspect = this.fullWidth / this.fullHeight;\r\n\t\tvar top = Math.tan( THREE.Math.degToRad( fov * 0.5 ) ) * this.near;\r\n\t\tvar bottom = - top;\r\n\t\tvar left = aspect * bottom;\r\n\t\tvar right = aspect * top;\r\n\t\tvar width = Math.abs( right - left );\r\n\t\tvar height = Math.abs( top - bottom );\r\n\r\n\t\tthis.projectionMatrix.makeFrustum(\r\n\t\t\tleft + this.x * width / this.fullWidth,\r\n\t\t\tleft + ( this.x + this.width ) * width / this.fullWidth,\r\n\t\t\ttop - ( this.y + this.height ) * height / this.fullHeight,\r\n\t\t\ttop - this.y * height / this.fullHeight,\r\n\t\t\tthis.near,\r\n\t\t\tthis.far\r\n\t\t);\r\n\r\n\t} else {\r\n\r\n\t\tthis.projectionMatrix.makePerspective( fov, this.aspect, this.near, this.far );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.clone = function () {\r\n\r\n\tvar camera = new THREE.PerspectiveCamera();\r\n\r\n\tTHREE.Camera.prototype.clone.call( this, camera );\r\n\r\n\tcamera.zoom = this.zoom;\r\n\r\n\tcamera.fov = this.fov;\r\n\tcamera.aspect = this.aspect;\r\n\tcamera.near = this.near;\r\n\tcamera.far = this.far;\r\n\r\n\tcamera.projectionMatrix.copy( this.projectionMatrix );\r\n\r\n\treturn camera;\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function ( color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Light';\r\n\t\r\n\tthis.color = new THREE.Color( color );\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nTHREE.Light.prototype.clone = function ( light ) {\r\n\r\n\tif ( light === undefined ) light = new THREE.Light();\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, light );\r\n\r\n\tlight.color.copy( this.color );\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function ( color ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'AmbientLight';\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\nTHREE.AmbientLight.prototype.clone = function () {\r\n\r\n\tvar light = new THREE.AmbientLight();\r\n\r\n\tTHREE.Light.prototype.clone.call( this, light );\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/lights/AreaLight.js\r\n\r\n/**\r\n * @author MPanknin / http://www.redplant.de/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.AreaLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'AreaLight';\r\n\r\n\tthis.normal = new THREE.Vector3( 0, - 1, 0 );\r\n\tthis.right = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\r\n\tthis.width = 1.0;\r\n\tthis.height = 1.0;\r\n\r\n\tthis.constantAttenuation = 1.5;\r\n\tthis.linearAttenuation = 0.5;\r\n\tthis.quadraticAttenuation = 0.1;\r\n\r\n};\r\n\r\nTHREE.AreaLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.AreaLight.prototype.constructor = THREE.AreaLight;\r\n\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'DirectionalLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\r\n\tthis.castShadow = false;\r\n\tthis.onlyShadow = false;\r\n\r\n\t//\r\n\r\n\tthis.shadowCameraNear = 50;\r\n\tthis.shadowCameraFar = 5000;\r\n\r\n\tthis.shadowCameraLeft = - 500;\r\n\tthis.shadowCameraRight = 500;\r\n\tthis.shadowCameraTop = 500;\r\n\tthis.shadowCameraBottom = - 500;\r\n\r\n\tthis.shadowCameraVisible = false;\r\n\r\n\tthis.shadowBias = 0;\r\n\tthis.shadowDarkness = 0.5;\r\n\r\n\tthis.shadowMapWidth = 512;\r\n\tthis.shadowMapHeight = 512;\r\n\r\n\t//\r\n\r\n\tthis.shadowCascade = false;\r\n\r\n\tthis.shadowCascadeOffset = new THREE.Vector3( 0, 0, - 1000 );\r\n\tthis.shadowCascadeCount = 2;\r\n\r\n\tthis.shadowCascadeBias = [ 0, 0, 0 ];\r\n\tthis.shadowCascadeWidth = [ 512, 512, 512 ];\r\n\tthis.shadowCascadeHeight = [ 512, 512, 512 ];\r\n\r\n\tthis.shadowCascadeNearZ = [ - 1.000, 0.990, 0.998 ];\r\n\tthis.shadowCascadeFarZ  = [ 0.990, 0.998, 1.000 ];\r\n\r\n\tthis.shadowCascadeArray = [];\r\n\r\n\t//\r\n\r\n\tthis.shadowMap = null;\r\n\tthis.shadowMapSize = null;\r\n\tthis.shadowCamera = null;\r\n\tthis.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.clone = function () {\r\n\r\n\tvar light = new THREE.DirectionalLight();\r\n\r\n\tTHREE.Light.prototype.clone.call( this, light );\r\n\r\n\tlight.target = this.target.clone();\r\n\r\n\tlight.intensity = this.intensity;\r\n\r\n\tlight.castShadow = this.castShadow;\r\n\tlight.onlyShadow = this.onlyShadow;\r\n\r\n\t//\r\n\r\n\tlight.shadowCameraNear = this.shadowCameraNear;\r\n\tlight.shadowCameraFar = this.shadowCameraFar;\r\n\r\n\tlight.shadowCameraLeft = this.shadowCameraLeft;\r\n\tlight.shadowCameraRight = this.shadowCameraRight;\r\n\tlight.shadowCameraTop = this.shadowCameraTop;\r\n\tlight.shadowCameraBottom = this.shadowCameraBottom;\r\n\r\n\tlight.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n\tlight.shadowBias = this.shadowBias;\r\n\tlight.shadowDarkness = this.shadowDarkness;\r\n\r\n\tlight.shadowMapWidth = this.shadowMapWidth;\r\n\tlight.shadowMapHeight = this.shadowMapHeight;\r\n\r\n\t//\r\n\r\n\tlight.shadowCascade = this.shadowCascade;\r\n\r\n\tlight.shadowCascadeOffset.copy( this.shadowCascadeOffset );\r\n\tlight.shadowCascadeCount = this.shadowCascadeCount;\r\n\r\n\tlight.shadowCascadeBias = this.shadowCascadeBias.slice( 0 );\r\n\tlight.shadowCascadeWidth = this.shadowCascadeWidth.slice( 0 );\r\n\tlight.shadowCascadeHeight = this.shadowCascadeHeight.slice( 0 );\r\n\r\n\tlight.shadowCascadeNearZ = this.shadowCascadeNearZ.slice( 0 );\r\n\tlight.shadowCascadeFarZ  = this.shadowCascadeFarZ.slice( 0 );\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\r\n\r\n\tTHREE.Light.call( this, skyColor );\r\n\r\n\tthis.type = 'HemisphereLight';\r\n\r\n\tthis.position.set( 0, 100, 0 );\r\n\r\n\tthis.groundColor = new THREE.Color( groundColor );\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.clone = function () {\r\n\r\n\tvar light = new THREE.HemisphereLight();\r\n\r\n\tTHREE.Light.prototype.clone.call( this, light );\r\n\r\n\tlight.groundColor.copy( this.groundColor );\r\n\tlight.intensity = this.intensity;\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLight = function ( color, intensity, distance, decay ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'PointLight';\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nTHREE.PointLight.prototype.clone = function () {\r\n\r\n\tvar light = new THREE.PointLight();\r\n\r\n\tTHREE.Light.prototype.clone.call( this, light );\r\n\r\n\tlight.intensity = this.intensity;\r\n\tlight.distance = this.distance;\r\n\tlight.decay = this.decay;\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function ( color, intensity, distance, angle, exponent, decay ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'SpotLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\tthis.exponent = ( exponent !== undefined ) ? exponent : 10;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.castShadow = false;\r\n\tthis.onlyShadow = false;\r\n\r\n\t//\r\n\r\n\tthis.shadowCameraNear = 50;\r\n\tthis.shadowCameraFar = 5000;\r\n\tthis.shadowCameraFov = 50;\r\n\r\n\tthis.shadowCameraVisible = false;\r\n\r\n\tthis.shadowBias = 0;\r\n\tthis.shadowDarkness = 0.5;\r\n\r\n\tthis.shadowMapWidth = 512;\r\n\tthis.shadowMapHeight = 512;\r\n\r\n\t//\r\n\r\n\tthis.shadowMap = null;\r\n\tthis.shadowMapSize = null;\r\n\tthis.shadowCamera = null;\r\n\tthis.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nTHREE.SpotLight.prototype.clone = function () {\r\n\r\n\tvar light = new THREE.SpotLight();\r\n\r\n\tTHREE.Light.prototype.clone.call( this, light );\r\n\r\n\tlight.target = this.target.clone();\r\n\r\n\tlight.intensity = this.intensity;\r\n\tlight.distance = this.distance;\r\n\tlight.angle = this.angle;\r\n\tlight.exponent = this.exponent;\r\n\tlight.decay = this.decay;\r\n\r\n\tlight.castShadow = this.castShadow;\r\n\tlight.onlyShadow = this.onlyShadow;\r\n\r\n\t//\r\n\r\n\tlight.shadowCameraNear = this.shadowCameraNear;\r\n\tlight.shadowCameraFar = this.shadowCameraFar;\r\n\tlight.shadowCameraFov = this.shadowCameraFov;\r\n\r\n\tlight.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n\tlight.shadowBias = this.shadowBias;\r\n\tlight.shadowDarkness = this.shadowDarkness;\r\n\r\n\tlight.shadowMapWidth = this.shadowMapWidth;\r\n\tlight.shadowMapHeight = this.shadowMapHeight;\r\n\r\n\treturn light;\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n\tfiles: {},\r\n\r\n\tadd: function ( key, file ) {\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\tthis.files[ key ] = file;\r\n\r\n\t},\r\n\r\n\tget: function ( key ) {\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\treturn this.files[ key ];\r\n\r\n\t},\r\n\r\n\tremove: function ( key ) {\r\n\r\n\t\tdelete this.files[ key ];\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.files = {}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function ( showStatus ) {\r\n\r\n\tthis.showStatus = showStatus;\r\n\tthis.statusDomElement = showStatus ? THREE.Loader.prototype.addStatusElement() : null;\r\n\r\n\tthis.imageLoader = new THREE.ImageLoader();\r\n\r\n\tthis.onLoadStart = function () {};\r\n\tthis.onLoadProgress = function () {};\r\n\tthis.onLoadComplete = function () {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n\tconstructor: THREE.Loader,\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\taddStatusElement: function () {\r\n\r\n\t\tvar e = document.createElement( 'div' );\r\n\r\n\t\te.style.position = 'absolute';\r\n\t\te.style.right = '0px';\r\n\t\te.style.top = '0px';\r\n\t\te.style.fontSize = '0.8em';\r\n\t\te.style.textAlign = 'left';\r\n\t\te.style.background = 'rgba(0,0,0,0.25)';\r\n\t\te.style.color = '#fff';\r\n\t\te.style.width = '120px';\r\n\t\te.style.padding = '0.5em 0.5em 0.5em 0.5em';\r\n\t\te.style.zIndex = 1000;\r\n\r\n\t\te.innerHTML = 'Loading ...';\r\n\r\n\t\treturn e;\r\n\r\n\t},\r\n\r\n\tupdateProgress: function ( progress ) {\r\n\r\n\t\tvar message = 'Loaded ';\r\n\r\n\t\tif ( progress.total ) {\r\n\r\n\t\t\tmessage += ( 100 * progress.loaded / progress.total ).toFixed( 0 ) + '%';\r\n\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmessage += ( progress.loaded / 1024 ).toFixed( 2 ) + ' KB';\r\n\r\n\t\t}\r\n\r\n\t\tthis.statusDomElement.innerHTML = message;\r\n\r\n\t},\r\n\r\n\textractUrlBase: function ( url ) {\r\n\r\n\t\tvar parts = url.split( '/' );\r\n\r\n\t\tif ( parts.length === 1 ) return './';\r\n\r\n\t\tparts.pop();\r\n\r\n\t\treturn parts.join( '/' ) + '/';\r\n\r\n\t},\r\n\r\n\tinitMaterials: function ( materials, texturePath ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\r\n\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath );\r\n\r\n\t\t}\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tneedsTangents: function ( materials ) {\r\n\r\n\t\tfor ( var i = 0, il = materials.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar m = materials[ i ];\r\n\r\n\t\t\tif ( m instanceof THREE.ShaderMaterial ) return true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tcreateMaterial: function ( m, texturePath ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tfunction nearest_pow2( n ) {\r\n\r\n\t\t\tvar l = Math.log( n ) / Math.LN2;\r\n\t\t\treturn Math.pow( 2, Math.round(  l ) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction create_texture( where, name, sourceFile, repeat, offset, wrap, anisotropy ) {\r\n\r\n\t\t\tvar fullPath = texturePath + sourceFile;\r\n\r\n\t\t\tvar texture;\r\n\r\n\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\r\n\r\n\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\ttexture = loader.load( fullPath );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttexture = new THREE.Texture();\r\n\r\n\t\t\t\tloader = scope.imageLoader;\r\n\t\t\t\tloader.crossOrigin = scope.crossOrigin;\r\n\t\t\t\tloader.load( fullPath, function ( image ) {\r\n\r\n\t\t\t\t\tif ( THREE.Math.isPowerOfTwo( image.width ) === false ||\r\n\t\t\t\t\t\t THREE.Math.isPowerOfTwo( image.height ) === false ) {\r\n\r\n\t\t\t\t\t\tvar width = nearest_pow2( image.width );\r\n\t\t\t\t\t\tvar height = nearest_pow2( image.height );\r\n\r\n\t\t\t\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\r\n\r\n\t\t\t\t\t\ttexture.image = canvas;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttexture.image = image;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.sourceFile = sourceFile;\r\n\r\n\t\t\tif ( repeat ) {\r\n\r\n\t\t\t\ttexture.repeat.set( repeat[ 0 ], repeat[ 1 ] );\r\n\r\n\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset ) {\r\n\r\n\t\t\t\ttexture.offset.set( offset[ 0 ], offset[ 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( wrap ) {\r\n\r\n\t\t\t\tvar wrapMap = {\r\n\t\t\t\t\t'repeat': THREE.RepeatWrapping,\r\n\t\t\t\t\t'mirror': THREE.MirroredRepeatWrapping\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( wrapMap[ wrap[ 0 ] ] !== undefined ) texture.wrapS = wrapMap[ wrap[ 0 ] ];\r\n\t\t\t\tif ( wrapMap[ wrap[ 1 ] ] !== undefined ) texture.wrapT = wrapMap[ wrap[ 1 ] ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( anisotropy ) {\r\n\r\n\t\t\t\ttexture.anisotropy = anisotropy;\r\n\r\n\t\t\t}\r\n\r\n\t\t\twhere[ name ] = texture;\r\n\r\n\t\t}\r\n\r\n\t\tfunction rgb2hex( rgb ) {\r\n\r\n\t\t\treturn ( rgb[ 0 ] * 255 << 16 ) + ( rgb[ 1 ] * 255 << 8 ) + rgb[ 2 ] * 255;\r\n\r\n\t\t}\r\n\r\n\t\t// defaults\r\n\r\n\t\tvar mtype = 'MeshLambertMaterial';\r\n\t\tvar mpars = { color: 0xeeeeee, opacity: 1.0, map: null, lightMap: null, normalMap: null, bumpMap: null, wireframe: false };\r\n\r\n\t\t// parameters from model file\r\n\r\n\t\tif ( m.shading ) {\r\n\r\n\t\t\tvar shading = m.shading.toLowerCase();\r\n\r\n\t\t\tif ( shading === 'phong' ) mtype = 'MeshPhongMaterial';\r\n\t\t\telse if ( shading === 'basic' ) mtype = 'MeshBasicMaterial';\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.blending !== undefined && THREE[ m.blending ] !== undefined ) {\r\n\r\n\t\t\tmpars.blending = THREE[ m.blending ];\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.transparent !== undefined ) {\r\n\r\n\t\t\tmpars.transparent = m.transparent;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.opacity !== undefined && m.opacity < 1.0 ) {\r\n\r\n\t\t\tmpars.transparent = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.depthTest !== undefined ) {\r\n\r\n\t\t\tmpars.depthTest = m.depthTest;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.depthWrite !== undefined ) {\r\n\r\n\t\t\tmpars.depthWrite = m.depthWrite;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.visible !== undefined ) {\r\n\r\n\t\t\tmpars.visible = m.visible;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.flipSided !== undefined ) {\r\n\r\n\t\t\tmpars.side = THREE.BackSide;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.doubleSided !== undefined ) {\r\n\r\n\t\t\tmpars.side = THREE.DoubleSide;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.wireframe !== undefined ) {\r\n\r\n\t\t\tmpars.wireframe = m.wireframe;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.vertexColors !== undefined ) {\r\n\r\n\t\t\tif ( m.vertexColors === 'face' ) {\r\n\r\n\t\t\t\tmpars.vertexColors = THREE.FaceColors;\r\n\r\n\t\t\t} else if ( m.vertexColors ) {\r\n\r\n\t\t\t\tmpars.vertexColors = THREE.VertexColors;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// colors\r\n\r\n\t\tif ( m.colorDiffuse ) {\r\n\r\n\t\t\tmpars.color = rgb2hex( m.colorDiffuse );\r\n\r\n\t\t} else if ( m.DbgColor ) {\r\n\r\n\t\t\tmpars.color = m.DbgColor;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.colorSpecular ) {\r\n\r\n\t\t\tmpars.specular = rgb2hex( m.colorSpecular );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.colorEmissive ) {\r\n\r\n\t\t\tmpars.emissive = rgb2hex( m.colorEmissive );\r\n\r\n\t\t}\r\n\r\n\t\t// modifiers\r\n\r\n\t\tif ( m.transparency !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Loader: transparency has been renamed to opacity' );\r\n\t\t\tm.opacity = m.transparency;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.opacity !== undefined ) {\r\n\r\n\t\t\tmpars.opacity = m.opacity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.specularCoef ) {\r\n\r\n\t\t\tmpars.shininess = m.specularCoef;\r\n\r\n\t\t}\r\n\r\n\t\t// textures\r\n\r\n\t\tif ( m.mapDiffuse && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'map', m.mapDiffuse, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapLight && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'lightMap', m.mapLight, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapBump && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'bumpMap', m.mapBump, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapNormal && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'normalMap', m.mapNormal, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapSpecular && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'specularMap', m.mapSpecular, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapAlpha && texturePath ) {\r\n\r\n\t\t\tcreate_texture( mpars, 'alphaMap', m.mapAlpha, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( m.mapBumpScale ) {\r\n\r\n\t\t\tmpars.bumpScale = m.mapBumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( m.mapNormalFactor ) {\r\n\r\n\t\t\tmpars.normalScale = new THREE.Vector2( m.mapNormalFactor, m.mapNormalFactor );\r\n\r\n\t\t}\r\n\r\n\t\tvar material = new THREE[ mtype ]( mpars );\r\n\r\n\t\tif ( m.DbgName !== undefined ) material.name = m.DbgName;\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n\thandlers: [],\r\n\r\n\tadd: function ( regex, loader ) {\r\n\r\n\t\tthis.handlers.push( regex, loader );\r\n\r\n\t},\r\n\r\n\tget: function ( file ) {\r\n\r\n\t\tfor ( var i = 0, l = this.handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\tvar regex = this.handlers[ i ];\r\n\t\t\tvar loader  = this.handlers[ i + 1 ];\r\n\r\n\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\treturn loader;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n\tconstructor: THREE.XHRLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tif ( onLoad ) onLoad( cached );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar request = new XMLHttpRequest();\r\n\t\trequest.open( 'GET', url, true );\r\n\r\n\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tTHREE.Cache.add( url, this.response );\r\n\r\n\t\t\tif ( onLoad ) onLoad( this.response );\r\n\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\tif ( onError !== undefined ) {\r\n\r\n\t\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\t\tonError( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) request.crossOrigin = this.crossOrigin;\r\n\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\r\n\t\trequest.send( null );\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t},\r\n\r\n\tsetResponseType: function ( value ) {\r\n\r\n\t\tthis.responseType = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n\tconstructor: THREE.ImageLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tonLoad( cached );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar image = document.createElement( 'img' );\r\n\r\n\t\timage.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tTHREE.Cache.add( url, this );\r\n\r\n\t\t\tif ( onLoad ) onLoad( this );\r\n\t\t\t\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\timage.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\tif ( onError !== undefined ) {\r\n\r\n\t\t\timage.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\t\tonError( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\r\n\t\timage.src = url;\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\treturn image;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n}\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function ( showStatus ) {\r\n\r\n\tTHREE.Loader.call( this, showStatus );\r\n\r\n\tthis.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = Object.create( THREE.Loader.prototype );\r\nTHREE.JSONLoader.prototype.constructor = THREE.JSONLoader;\r\n\r\nTHREE.JSONLoader.prototype.load = function ( url, callback, texturePath ) {\r\n\r\n\t// todo: unify load API to for easier SceneLoader use\r\n\r\n\ttexturePath = texturePath && ( typeof texturePath === 'string' ) ? texturePath : this.extractUrlBase( url );\r\n\r\n\tthis.onLoadStart();\r\n\tthis.loadAjaxJSON( this, url, callback, texturePath );\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.loadAjaxJSON = function ( context, url, callback, texturePath, callbackProgress ) {\r\n\r\n\tvar xhr = new XMLHttpRequest();\r\n\r\n\tvar length = 0;\r\n\r\n\txhr.onreadystatechange = function () {\r\n\r\n\t\tif ( xhr.readyState === xhr.DONE ) {\r\n\r\n\t\t\tif ( xhr.status === 200 || xhr.status === 0 ) {\r\n\r\n\t\t\t\tif ( xhr.responseText ) {\r\n\r\n\t\t\t\t\tvar json = JSON.parse( xhr.responseText );\r\n\t\t\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\t\t\tif ( metadata !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( metadata.type === 'object' ) {\r\n\r\n\t\t\t\t\t\t\tTHREE.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( metadata.type === 'scene' ) {\r\n\r\n\t\t\t\t\t\t\tTHREE.error( 'THREE.JSONLoader: ' + url + ' seems to be a Scene. Use THREE.SceneLoader instead.' );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar result = context.parse( json, texturePath );\r\n\t\t\t\t\tcallback( result.geometry, result.materials );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tTHREE.error( 'THREE.JSONLoader: ' + url + ' seems to be unreachable or the file is empty.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// in context of more complex asset initialization\r\n\t\t\t\t// do not block on single failed file\r\n\t\t\t\t// maybe should go even one more level up\r\n\r\n\t\t\t\tcontext.onLoadComplete();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tTHREE.error( 'THREE.JSONLoader: Couldn\\'t load ' + url + ' (' + xhr.status + ')' );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( xhr.readyState === xhr.LOADING ) {\r\n\r\n\t\t\tif ( callbackProgress ) {\r\n\r\n\t\t\t\tif ( length === 0 ) {\r\n\r\n\t\t\t\t\tlength = xhr.getResponseHeader( 'Content-Length' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcallbackProgress( { total: length, loaded: xhr.responseText.length } );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( xhr.readyState === xhr.HEADERS_RECEIVED ) {\r\n\r\n\t\t\tif ( callbackProgress !== undefined ) {\r\n\r\n\t\t\t\tlength = xhr.getResponseHeader( 'Content-Length' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\txhr.open( 'GET', url, true );\r\n\txhr.withCredentials = this.withCredentials;\r\n\txhr.send( null );\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.parse = function ( json, texturePath ) {\r\n\r\n\tvar geometry = new THREE.Geometry(),\r\n\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\r\n\r\n\tparseModel( scale );\r\n\r\n\tparseSkin();\r\n\tparseMorphing( scale );\r\n\r\n\tgeometry.computeFaceNormals();\r\n\tgeometry.computeBoundingSphere();\r\n\r\n\tfunction parseModel( scale ) {\r\n\r\n\t\tfunction isBitSet( value, position ) {\r\n\r\n\t\t\treturn value & ( 1 << position );\r\n\r\n\t\t}\r\n\r\n\t\tvar i, j, fi,\r\n\r\n\t\toffset, zLength,\r\n\r\n\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n\t\ttype,\r\n\t\tisQuad,\r\n\t\thasMaterial,\r\n\t\thasFaceVertexUv,\r\n\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\thasFaceColor, hasFaceVertexColor,\r\n\r\n\t\tvertex, face, faceA, faceB, hex, normal,\r\n\r\n\t\tuvLayer, uv, u, v,\r\n\r\n\t\tfaces = json.faces,\r\n\t\tvertices = json.vertices,\r\n\t\tnormals = json.normals,\r\n\t\tcolors = json.colors,\r\n\r\n\t\tnUvLayers = 0;\r\n\r\n\t\tif ( json.uvs !== undefined ) {\r\n\r\n\t\t\t// disregard empty arrays\r\n\r\n\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\r\n\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\toffset = 0;\r\n\t\tzLength = vertices.length;\r\n\r\n\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\tvertex = new THREE.Vector3();\r\n\r\n\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\r\n\t\t\tgeometry.vertices.push( vertex );\r\n\r\n\t\t}\r\n\r\n\t\toffset = 0;\r\n\t\tzLength = faces.length;\r\n\r\n\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\ttype = faces[ offset ++ ];\r\n\r\n\r\n\t\t\tisQuad              = isBitSet( type, 0 );\r\n\t\t\thasMaterial         = isBitSet( type, 1 );\r\n\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\r\n\t\t\thasFaceNormal       = isBitSet( type, 4 );\r\n\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\thasFaceColor\t     = isBitSet( type, 6 );\r\n\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\r\n\r\n\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n\t\t\tif ( isQuad ) {\r\n\r\n\t\t\t\tfaceA = new THREE.Face3();\r\n\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\tfaceB = new THREE.Face3();\r\n\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\toffset += 4;\r\n\r\n\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = []\r\n\r\n\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\r\n\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\tfaceB.color.setHex( hex );\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\r\n\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\tgeometry.faces.push( faceB );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tface = new THREE.Face3();\r\n\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\tface.c = faces[ offset ++ ];\r\n\r\n\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\r\n\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.faces.push( face );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction parseSkin() {\r\n\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\r\n\t\tif ( json.skinWeights ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\tvar x =                               json.skinWeights[ i     ];\r\n\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\r\n\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.skinIndices ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\tvar a =                               json.skinIndices[ i     ];\r\n\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\r\n\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.bones = json.bones;\r\n\r\n\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.JSONLoader: When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// could change this to json.animations[0] or remove completely\r\n\r\n\t\tgeometry.animation = json.animation;\r\n\t\tgeometry.animations = json.animations;\r\n\r\n\t};\r\n\r\n\tfunction parseMorphing( scale ) {\r\n\r\n\t\tif ( json.morphTargets !== undefined ) {\r\n\r\n\t\t\tvar i, l, v, vl, dstVertices, srcVertices;\r\n\r\n\t\t\tfor ( i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\r\n\t\t\t\tdstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\tsrcVertices = json.morphTargets [ i ].vertices;\r\n\r\n\t\t\t\tfor ( v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\r\n\t\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\r\n\t\t\t\t\tdstVertices.push( vertex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.morphColors !== undefined ) {\r\n\r\n\t\t\tvar i, l, c, cl, dstColors, srcColors, color;\r\n\r\n\t\t\tfor ( i = 0, l = json.morphColors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tgeometry.morphColors[ i ] = {};\r\n\t\t\t\tgeometry.morphColors[ i ].name = json.morphColors[ i ].name;\r\n\t\t\t\tgeometry.morphColors[ i ].colors = [];\r\n\r\n\t\t\t\tdstColors = geometry.morphColors[ i ].colors;\r\n\t\t\t\tsrcColors = json.morphColors [ i ].colors;\r\n\r\n\t\t\t\tfor ( c = 0, cl = srcColors.length; c < cl; c += 3 ) {\r\n\r\n\t\t\t\t\tcolor = new THREE.Color( 0xffaa00 );\r\n\t\t\t\t\tcolor.setRGB( srcColors[ c ], srcColors[ c + 1 ], srcColors[ c + 2 ] );\r\n\t\t\t\t\tdstColors.push( color );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\r\n\t\treturn { geometry: geometry };\r\n\r\n\t} else {\r\n\r\n\t\tvar materials = this.initMaterials( json.materials, texturePath );\r\n\r\n\t\tif ( this.needsTangents( materials ) ) {\r\n\r\n\t\t\tgeometry.computeTangents();\r\n\r\n\t\t}\r\n\r\n\t\treturn { geometry: geometry, materials: materials };\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar loaded = 0, total = 0;\r\n\r\n\tthis.onLoad = onLoad;\r\n\tthis.onProgress = onProgress;\r\n\tthis.onError = onError;\r\n\r\n\tthis.itemStart = function ( url ) {\r\n\r\n\t\ttotal ++;\r\n\r\n\t};\r\n\r\n\tthis.itemEnd = function ( url ) {\r\n\r\n\t\tloaded ++;\r\n\r\n\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\tscope.onProgress( url, loaded, total );\r\n\r\n\t\t}\r\n\r\n\t\tif ( loaded === total && scope.onLoad !== undefined ) {\r\n\r\n\t\t\tscope.onLoad();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometryLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\t\tvar attributes = json.data.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\t\t\tvar typedArray = new self[ attribute.type ]( attribute.array );\r\n\r\n\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar offsets = json.data.offsets;\r\n\r\n\t\tif ( offsets !== undefined ) {\r\n\r\n\t\t\tgeometry.offsets = JSON.parse( JSON.stringify( offsets ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\tvar center = new THREE.Vector3();\r\n\r\n\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n\tconstructor: THREE.MaterialLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar material = new THREE[ json.type ];\r\n\r\n\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\r\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\tif ( json.shading !== undefined ) material.shading = json.shading;\r\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\r\n\t\t// for PointCloudMaterial\r\n\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n\t\tif ( json.materials !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n\tconstructor: THREE.ObjectLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.texturePath === '' ) {\r\n\r\n\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tscope.parse( JSON.parse( text ), onLoad );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, onLoad ) {\r\n\r\n\t\tvar geometries = this.parseGeometries( json.geometries );\r\n\r\n\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t} );\r\n\t\tvar textures  = this.parseTextures( json.textures, images );\r\n\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t},\r\n\r\n\tparseGeometries: function ( json ) {\r\n\r\n\t\tvar geometries = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar geometryLoader = new THREE.JSONLoader();\r\n\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar geometry;\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.BoxGeometry(\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CircleGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.CircleGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.segments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CylinderGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.CylinderGeometry(\r\n\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.openEnded\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SphereGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.SphereGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.IcosahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TorusGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TorusKnotGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\tdata.q,\r\n\t\t\t\t\t\t\tdata.heightScale\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data ).geometry;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\r\n\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometries;\r\n\r\n\t},\r\n\r\n\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\tvar materials = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar getTexture = function ( name ) {\r\n\r\n\t\t\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.ObjectLoader: Undefined texture', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn textures[ name ];\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar loader = new THREE.MaterialLoader();\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\t\t\t\tvar material = loader.parse( data );\r\n\r\n\t\t\t\tmaterial.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) material.name = data.name;\r\n\r\n\t\t\t\tif ( data.map !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.map = getTexture( data.map );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.bumpMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.bumpMap = getTexture( data.bumpMap );\r\n\t\t\t\t\tif ( data.bumpScale ) {\r\n\t\t\t\t\t\tmaterial.bumpScale = new THREE.Vector2( data.bumpScale, data.bumpScale );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.alphaMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.alphaMap = getTexture( data.alphaMap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.envMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.envMap = getTexture( data.envMap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.normalMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.normalMap = getTexture( data.normalMap );\r\n\t\t\t\t\tif ( data.normalScale ) {\r\n\t\t\t\t\t\tmaterial.normalScale = new THREE.Vector2( data.normalScale, data.normalScale );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.lightMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.lightMap = getTexture( data.lightMap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( data.specularMap !== undefined ) {\r\n\r\n\t\t\t\t\tmaterial.specularMap = getTexture( data.specularMap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmaterials[ data.uuid ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn materials;\r\n\r\n\t},\r\n\r\n\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar images = {};\r\n\r\n\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\tvar manager = new THREE.LoadingManager( onLoad );\r\n\r\n\t\t\tvar loader = new THREE.ImageLoader( manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\tvar loadImage = function ( url ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar image = json[ i ];\r\n\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\r\n\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn images;\r\n\r\n\t},\r\n\r\n\tparseTextures: function ( json, images ) {\r\n\r\n\t\tvar textures = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.ObjectLoader: No \"image\" speficied for', data.uuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\r\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = THREE[ data.minFilter ];\r\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = THREE[ data.magFilter ];\r\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\t\t\t\tif ( data.wrap instanceof Array ) {\r\n\r\n\t\t\t\t\ttexture.wrapS = THREE[ data.wrap[ 0 ] ];\r\n\t\t\t\t\ttexture.wrapT = THREE[ data.wrap[ 1 ] ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn textures;\r\n\r\n\t},\r\n\r\n\tparseObject: function () {\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\treturn function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tvar getGeometry = function ( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar getMaterial = function ( name ) {\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t};\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new THREE.Scene();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new THREE.AmbientLight( data.color );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tobject = new THREE.Mesh( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\r\n\t\t\t\t\tobject = new THREE.PointCloud( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new THREE.Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new THREE.Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tmatrix.fromArray( data.matrix );\r\n\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tfor ( var child in data.children ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t}()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.TextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.ImageLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\tvar texture = new THREE.Texture( image );\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function () {\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.BinaryTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texture = new THREE.DataTexture( );\r\n\r\n\t\tvar loader = new THREE.XHRLoader();\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar texData = scope._parser( buffer );\r\n\r\n\t\t\tif ( !texData ) return;\r\n\r\n\t\t\tif ( undefined !== texData.image ) {\r\n\r\n\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t} else if ( undefined !== texData.data ) {\r\n\r\n\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n\t\t\tif ( undefined !== texData.format ) {\r\n\r\n\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t}\r\n\t\t\tif ( undefined !== texData.type ) {\r\n\r\n\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\r\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\r\n\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function () {\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CompressedTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar images = [];\r\n\r\n\t\tvar texture = new THREE.CompressedTexture();\r\n\t\ttexture.image = images;\r\n\r\n\t\tvar loader = new THREE.XHRLoader();\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tif ( url instanceof Array ) {\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tvar loadTexture = function ( i ) {\r\n\r\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\t\timages[ i ] = {\r\n\t\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\tif (texDatas.mipmapCount == 1)\r\n \t\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Material';\r\n\r\n\tthis.side = THREE.FrontSide;\r\n\r\n\tthis.opacity = 1;\r\n\tthis.transparent = false;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.blendSrc = THREE.SrcAlphaFactor;\r\n\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n\tthis.blendEquation = THREE.AddEquation;\r\n\tthis.blendSrcAlpha = null;\r\n\tthis.blendDstAlpha = null;\r\n\tthis.blendEquationAlpha = null;\r\n\r\n\tthis.depthTest = true;\r\n\tthis.depthWrite = true;\r\n\r\n\tthis.colorWrite = true;\r\n\r\n\tthis.polygonOffset = false;\r\n\tthis.polygonOffsetFactor = 0;\r\n\tthis.polygonOffsetUnits = 0;\r\n\r\n\tthis.alphaTest = 0;\r\n\r\n\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n\tconstructor: THREE.Material,\r\n\r\n\tget needsUpdate () {\r\n\r\n\t\treturn this._needsUpdate;\r\n\r\n\t},\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.update();\r\n\r\n\t\tthis._needsUpdate = value;\r\n\r\n\t},\r\n\r\n\tsetValues: function ( values ) {\r\n\r\n\t\tif ( values === undefined ) return;\r\n\r\n\t\tfor ( var key in values ) {\r\n\r\n\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\tTHREE.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( key in this ) {\r\n\r\n\t\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\t\tif ( currentValue instanceof THREE.Color ) {\r\n\r\n\t\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\r\n\r\n\t\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t\t} else if ( key == 'overdraw' ) {\r\n\r\n\t\t\t\t\t// ensure overdraw is backwards-compatable with legacy boolean type\r\n\t\t\t\t\tthis[ key ] = Number( newValue );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.2,\r\n\t\t\t\ttype: 'material',\r\n\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type\r\n\t\t};\r\n\r\n\t\tif ( this.name !== \"\" ) output.name = this.name;\r\n\r\n\t\tif ( this instanceof THREE.MeshBasicMaterial ) {\r\n\r\n\t\t\toutput.color = this.color.getHex();\r\n\t\t\tif ( this.vertexColors !== THREE.NoColors ) output.vertexColors = this.vertexColors;\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\t\t\tif ( this.side !== THREE.FrontSide ) output.side = this.side;\r\n\r\n\t\t} else if ( this instanceof THREE.MeshLambertMaterial ) {\r\n\r\n\t\t\toutput.color = this.color.getHex();\r\n\t\t\toutput.emissive = this.emissive.getHex();\r\n\t\t\tif ( this.vertexColors !== THREE.NoColors ) output.vertexColors = this.vertexColors;\r\n\t\t\tif ( this.shading !== THREE.SmoothShading ) output.shading = this.shading;\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\t\t\tif ( this.side !== THREE.FrontSide ) output.side = this.side;\r\n\r\n\t\t} else if ( this instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\toutput.color = this.color.getHex();\r\n\t\t\toutput.emissive = this.emissive.getHex();\r\n\t\t\toutput.specular = this.specular.getHex();\r\n\t\t\toutput.shininess = this.shininess;\r\n\t\t\tif ( this.vertexColors !== THREE.NoColors ) output.vertexColors = this.vertexColors;\r\n\t\t\tif ( this.shading !== THREE.SmoothShading ) output.shading = this.shading;\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\t\t\tif ( this.side !== THREE.FrontSide ) output.side = this.side;\r\n\r\n\t\t} else if ( this instanceof THREE.MeshNormalMaterial ) {\r\n\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\t\t\tif ( this.side !== THREE.FrontSide ) output.side = this.side;\r\n\r\n\t\t} else if ( this instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\t\t\tif ( this.side !== THREE.FrontSide ) output.side = this.side;\r\n\r\n\t\t} else if ( this instanceof THREE.PointCloudMaterial ) {\r\n\r\n\t\t\toutput.size  = this.size;\r\n\t\t\toutput.sizeAttenuation = this.sizeAttenuation;\r\n\t\t\toutput.color = this.color.getHex();\r\n\r\n\t\t\tif ( this.vertexColors !== THREE.NoColors ) output.vertexColors = this.vertexColors;\r\n\t\t\tif ( this.blending !== THREE.NormalBlending ) output.blending = this.blending;\r\n\r\n\t\t} else if ( this instanceof THREE.ShaderMaterial ) {\r\n\r\n\t\t\toutput.uniforms = this.uniforms;\r\n\t\t\toutput.vertexShader = this.vertexShader;\r\n\t\t\toutput.fragmentShader = this.fragmentShader;\r\n\r\n\t\t} else if ( this instanceof THREE.SpriteMaterial ) {\r\n\r\n\t\t\toutput.color = this.color.getHex();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.opacity < 1 ) output.opacity = this.opacity;\r\n\t\tif ( this.transparent !== false ) output.transparent = this.transparent;\r\n\t\tif ( this.wireframe !== false ) output.wireframe = this.wireframe;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function ( material ) {\r\n\r\n\t\tif ( material === undefined ) material = new THREE.Material();\r\n\r\n\t\tmaterial.name = this.name;\r\n\r\n\t\tmaterial.side = this.side;\r\n\r\n\t\tmaterial.opacity = this.opacity;\r\n\t\tmaterial.transparent = this.transparent;\r\n\r\n\t\tmaterial.blending = this.blending;\r\n\r\n\t\tmaterial.blendSrc = this.blendSrc;\r\n\t\tmaterial.blendDst = this.blendDst;\r\n\t\tmaterial.blendEquation = this.blendEquation;\r\n\t\tmaterial.blendSrcAlpha = this.blendSrcAlpha;\r\n\t\tmaterial.blendDstAlpha = this.blendDstAlpha;\r\n\t\tmaterial.blendEquationAlpha = this.blendEquationAlpha;\r\n\r\n\t\tmaterial.depthTest = this.depthTest;\r\n\t\tmaterial.depthWrite = this.depthWrite;\r\n\r\n\t\tmaterial.polygonOffset = this.polygonOffset;\r\n\t\tmaterial.polygonOffsetFactor = this.polygonOffsetFactor;\r\n\t\tmaterial.polygonOffsetUnits = this.polygonOffsetUnits;\r\n\r\n\t\tmaterial.alphaTest = this.alphaTest;\r\n\r\n\t\tmaterial.overdraw = this.overdraw;\r\n\r\n\t\tmaterial.visible = this.visible;\r\n\r\n\t\treturn material;\r\n\r\n\t},\r\n\r\n\tupdate: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'update' } );\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Material.prototype );\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\tthis.linecap = 'round';\r\n\tthis.linejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.LineBasicMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\r\n\tmaterial.linewidth = this.linewidth;\r\n\tmaterial.linecap = this.linecap;\r\n\tmaterial.linejoin = this.linejoin;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineDashedMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.scale = 1;\r\n\tthis.dashSize = 3;\r\n\tthis.gapSize = 1;\r\n\r\n\tthis.vertexColors = false;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.LineDashedMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\r\n\tmaterial.linewidth = this.linewidth;\r\n\r\n\tmaterial.scale = this.scale;\r\n\tmaterial.dashSize = this.dashSize;\r\n\tmaterial.gapSize = this.gapSize;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // emissive\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.MeshBasicMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\r\n\tmaterial.map = this.map;\r\n\r\n\tmaterial.lightMap = this.lightMap;\r\n\r\n\tmaterial.specularMap = this.specularMap;\r\n\r\n\tmaterial.alphaMap = this.alphaMap;\r\n\r\n\tmaterial.envMap = this.envMap;\r\n\tmaterial.combine = this.combine;\r\n\tmaterial.reflectivity = this.reflectivity;\r\n\tmaterial.refractionRatio = this.refractionRatio;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\tmaterial.shading = this.shading;\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\tmaterial.wireframeLinecap = this.wireframeLinecap;\r\n\tmaterial.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.skinning = this.skinning;\r\n\tmaterial.morphTargets = this.morphTargets;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshLambertMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\r\n\tthis.wrapAround = false;\r\n\tthis.wrapRGB = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.MeshLambertMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\tmaterial.emissive.copy( this.emissive );\r\n\r\n\tmaterial.wrapAround = this.wrapAround;\r\n\tmaterial.wrapRGB.copy( this.wrapRGB );\r\n\r\n\tmaterial.map = this.map;\r\n\r\n\tmaterial.lightMap = this.lightMap;\r\n\r\n\tmaterial.specularMap = this.specularMap;\r\n\r\n\tmaterial.alphaMap = this.alphaMap;\r\n\r\n\tmaterial.envMap = this.envMap;\r\n\tmaterial.combine = this.combine;\r\n\tmaterial.reflectivity = this.reflectivity;\r\n\tmaterial.refractionRatio = this.refractionRatio;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\tmaterial.shading = this.shading;\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\tmaterial.wireframeLinecap = this.wireframeLinecap;\r\n\tmaterial.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.skinning = this.skinning;\r\n\tmaterial.morphTargets = this.morphTargets;\r\n\tmaterial.morphNormals = this.morphNormals;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshPhongMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.specular = new THREE.Color( 0x111111 );\r\n\tthis.shininess = 30;\r\n\r\n\tthis.metal = false;\r\n\r\n\tthis.wrapAround = false;\r\n\tthis.wrapRGB = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.MeshPhongMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\tmaterial.emissive.copy( this.emissive );\r\n\tmaterial.specular.copy( this.specular );\r\n\tmaterial.shininess = this.shininess;\r\n\r\n\tmaterial.metal = this.metal;\r\n\r\n\tmaterial.wrapAround = this.wrapAround;\r\n\tmaterial.wrapRGB.copy( this.wrapRGB );\r\n\r\n\tmaterial.map = this.map;\r\n\r\n\tmaterial.lightMap = this.lightMap;\r\n\r\n\tmaterial.bumpMap = this.bumpMap;\r\n\tmaterial.bumpScale = this.bumpScale;\r\n\r\n\tmaterial.normalMap = this.normalMap;\r\n\tmaterial.normalScale.copy( this.normalScale );\r\n\r\n\tmaterial.specularMap = this.specularMap;\r\n\r\n\tmaterial.alphaMap = this.alphaMap;\r\n\r\n\tmaterial.envMap = this.envMap;\r\n\tmaterial.combine = this.combine;\r\n\tmaterial.reflectivity = this.reflectivity;\r\n\tmaterial.refractionRatio = this.refractionRatio;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\tmaterial.shading = this.shading;\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\tmaterial.wireframeLinecap = this.wireframeLinecap;\r\n\tmaterial.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.skinning = this.skinning;\r\n\tmaterial.morphTargets = this.morphTargets;\r\n\tmaterial.morphNormals = this.morphNormals;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshDepthMaterial';\r\n\r\n\tthis.morphTargets = false;\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.MeshDepthMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  shading: THREE.FlatShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this, parameters );\r\n\r\n\tthis.type = 'MeshNormalMaterial';\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.MeshNormalMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshFaceMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MeshFaceMaterial = function ( materials ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.type = 'MeshFaceMaterial';\r\n\t\r\n\tthis.materials = materials instanceof Array ? materials : [];\r\n\r\n};\r\n\r\nTHREE.MeshFaceMaterial.prototype = {\r\n\r\n\tconstructor: THREE.MeshFaceMaterial,\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.2,\r\n\t\t\t\ttype: 'material',\r\n\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type,\r\n\t\t\tmaterials: []\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0, l = this.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\toutput.materials.push( this.materials[ i ].toJSON() );\r\n\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar material = new THREE.MeshFaceMaterial();\r\n\r\n\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\r\n\r\n\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/PointCloudMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointCloudMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'PointCloudMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.size = 1;\r\n\tthis.sizeAttenuation = true;\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.PointCloudMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.PointCloudMaterial.prototype.constructor = THREE.PointCloudMaterial;\r\n\r\nTHREE.PointCloudMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.PointCloudMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\r\n\tmaterial.map = this.map;\r\n\r\n\tmaterial.size = this.size;\r\n\tmaterial.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.ParticleBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.' );\r\n\treturn new THREE.PointCloudMaterial( parameters );\r\n\r\n};\r\n\r\nTHREE.ParticleSystemMaterial = function ( parameters ) {\r\n\r\n\tTHREE.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.' );\r\n\treturn new THREE.PointCloudMaterial( parameters );\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'ShaderMaterial';\r\n\r\n\tthis.defines = {};\r\n\tthis.uniforms = {};\r\n\tthis.attributes = null;\r\n\r\n\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false; // set to use scene fog\r\n\r\n\tthis.lights = false; // set to use scene lights\r\n\r\n\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n\tthis.skinning = false; // set to use skinning attribute streams\r\n\r\n\tthis.morphTargets = false; // set to use morph targets\r\n\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\tthis.defaultAttributeValues = {\r\n\t\t'color': [ 1, 1, 1 ],\r\n\t\t'uv': [ 0, 0 ],\r\n\t\t'uv2': [ 0, 0 ]\r\n\t};\r\n\r\n\tthis.index0AttributeName = undefined;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.ShaderMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.fragmentShader = this.fragmentShader;\r\n\tmaterial.vertexShader = this.vertexShader;\r\n\r\n\tmaterial.uniforms = THREE.UniformsUtils.clone( this.uniforms );\r\n\r\n\tmaterial.attributes = this.attributes;\r\n\tmaterial.defines = this.defines;\r\n\r\n\tmaterial.shading = this.shading;\r\n\r\n\tmaterial.wireframe = this.wireframe;\r\n\tmaterial.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\tmaterial.lights = this.lights;\r\n\r\n\tmaterial.vertexColors = this.vertexColors;\r\n\r\n\tmaterial.skinning = this.skinning;\r\n\r\n\tmaterial.morphTargets = this.morphTargets;\r\n\tmaterial.morphNormals = this.morphNormals;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.ShaderMaterial.call( this, parameters );\r\n\r\n\tthis.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\nTHREE.RawShaderMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.RawShaderMaterial();\r\n\r\n\tTHREE.ShaderMaterial.prototype.clone.call( this, material );\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'SpriteMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\tthis.map = null;\r\n\r\n\tthis.rotation = 0;\r\n\r\n\tthis.fog = false;\r\n\r\n\t// set parameters\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.clone = function () {\r\n\r\n\tvar material = new THREE.SpriteMaterial();\r\n\r\n\tTHREE.Material.prototype.clone.call( this, material );\r\n\r\n\tmaterial.color.copy( this.color );\r\n\tmaterial.map = this.map;\r\n\r\n\tmaterial.rotation = this.rotation;\r\n\r\n\tmaterial.fog = this.fog;\r\n\r\n\treturn material;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.sourceFile = '';\r\n\r\n\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n\tthis.mipmaps = [];\r\n\r\n\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\r\n\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.generateMipmaps = true;\r\n\tthis.premultiplyAlpha = false;\r\n\tthis.flipY = true;\r\n\tthis.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\tthis._needsUpdate = false;\r\n\tthis.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n\tconstructor: THREE.Texture,\r\n\r\n\tget needsUpdate () {\r\n\r\n\t\treturn this._needsUpdate;\r\n\r\n\t},\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.update();\r\n\r\n\t\tthis._needsUpdate = value;\r\n\r\n\t},\r\n\r\n\tclone: function ( texture ) {\r\n\r\n\t\tif ( texture === undefined ) texture = new THREE.Texture();\r\n\r\n\t\ttexture.image = this.image;\r\n\t\ttexture.mipmaps = this.mipmaps.slice( 0 );\r\n\r\n\t\ttexture.mapping = this.mapping;\r\n\r\n\t\ttexture.wrapS = this.wrapS;\r\n\t\ttexture.wrapT = this.wrapT;\r\n\r\n\t\ttexture.magFilter = this.magFilter;\r\n\t\ttexture.minFilter = this.minFilter;\r\n\r\n\t\ttexture.anisotropy = this.anisotropy;\r\n\r\n\t\ttexture.format = this.format;\r\n\t\ttexture.type = this.type;\r\n\r\n\t\ttexture.offset.copy( this.offset );\r\n\t\ttexture.repeat.copy( this.repeat );\r\n\r\n\t\ttexture.generateMipmaps = this.generateMipmaps;\r\n\t\ttexture.premultiplyAlpha = this.premultiplyAlpha;\r\n\t\ttexture.flipY = this.flipY;\r\n\t\ttexture.unpackAlignment = this.unpackAlignment;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tupdate: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'update' } );\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Texture.prototype );\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\t\r\n\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.images = images;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nTHREE.CubeTexture.clone = function ( texture ) {\r\n\r\n\tif ( texture === undefined ) texture = new THREE.CubeTexture();\r\n\r\n\tTHREE.Texture.prototype.clone.call( this, texture );\r\n\r\n\ttexture.images = this.images;\r\n\r\n\treturn texture;\r\n\r\n};\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.image = { width: width, height: height };\r\n\tthis.mipmaps = mipmaps;\r\n\r\n\t// no flipping for cube textures\r\n\t// (also flipping doesn't work for compressed textures )\r\n\r\n\tthis.flipY = false;\r\n\r\n\t// can't generate mipmaps for compressed textures\r\n\t// mips must be embedded in DDS files\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\nTHREE.CompressedTexture.prototype.clone = function () {\r\n\r\n\tvar texture = new THREE.CompressedTexture();\r\n\r\n\tTHREE.Texture.prototype.clone.call( this, texture );\r\n\r\n\treturn texture;\r\n\r\n};\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.image = { data: data, width: width, height: height };\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\nTHREE.DataTexture.prototype.clone = function () {\r\n\r\n\tvar texture = new THREE.DataTexture();\r\n\r\n\tTHREE.Texture.prototype.clone.call( this, texture );\r\n\r\n\treturn texture;\r\n\r\n};\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n\tvar scope = this;\r\n\r\n\tvar update = function () {\r\n\r\n\t\trequestAnimationFrame( update );\r\n\r\n\t\tif ( video.readyState === video.HAVE_ENOUGH_DATA ) {\r\n\r\n\t\t\tscope.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tupdate();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n\r\n// File:src/objects/PointCloud.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.PointCloud = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'PointCloud';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.PointCloudMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.PointCloud.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.PointCloud.prototype.constructor = THREE.PointCloud;\r\n\r\nTHREE.PointCloud.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\r\n\treturn function ( raycaster, intersects ) {\r\n\r\n\t\tvar object = this;\r\n\t\tvar geometry = object.geometry;\r\n\t\tvar threshold = raycaster.params.PointCloud.threshold;\r\n\r\n\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\tvar position = new THREE.Vector3();\r\n\r\n\t\tvar testPoint = function ( point, index ) {\r\n\r\n\t\t\tvar rayPointDistance = ray.distanceToPoint( point );\r\n\r\n\t\t\tif ( rayPointDistance < localThreshold ) {\r\n\r\n\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\r\n\t\t\t\tintersectPoint.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tdistanceToRay: rayPointDistance,\r\n\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\tindex: index,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.index !== undefined ) {\r\n\r\n\t\t\t\tvar indices = attributes.index.array;\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\tvar offset = {\r\n\t\t\t\t\t\tstart: 0,\r\n\t\t\t\t\t\tcount: indices.length,\r\n\t\t\t\t\t\tindex: 0\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\toffsets = [ offset ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var oi = 0, ol = offsets.length; oi < ol; ++ oi ) {\r\n\r\n\t\t\t\t\tvar start = offsets[ oi ].start;\r\n\t\t\t\t\tvar count = offsets[ oi ].count;\r\n\t\t\t\t\tvar index = offsets[ oi ].index;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar a = index + indices[ i ];\r\n\r\n\t\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\t\ttestPoint( position, a );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar pointCount = positions.length / 3;\r\n\r\n\t\t\t\tfor ( var i = 0; i < pointCount; i ++ ) {\r\n\r\n\t\t\t\t\tposition.set(\r\n\t\t\t\t\t\tpositions[ 3 * i ],\r\n\t\t\t\t\t\tpositions[ 3 * i + 1 ],\r\n\t\t\t\t\t\tpositions[ 3 * i + 2 ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\ttestPoint( position, i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar vertices = this.geometry.vertices;\r\n\r\n\t\t\tfor ( var i = 0; i < vertices.length; i ++ ) {\r\n\r\n\t\t\t\ttestPoint( vertices[ i ], i );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.PointCloud.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.PointCloud( this.geometry, this.material );\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.ParticleSystem = function ( geometry, material ) {\r\n\r\n\tTHREE.warn( 'THREE.ParticleSystem has been renamed to THREE.PointCloud.' );\r\n\treturn new THREE.PointCloud( geometry, material );\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function ( geometry, material, mode ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Line';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\tthis.mode = mode !== undefined ? mode : THREE.LineStrip;\r\n\r\n};\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\nTHREE.Line.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\treturn function ( raycaster, intersects ) {\r\n\r\n\t\tvar precision = raycaster.linePrecision;\r\n\t\tvar precisionSq = precision * precision;\r\n\r\n\t\tvar geometry = this.geometry;\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( this.matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tvar vStart = new THREE.Vector3();\r\n\t\tvar vEnd = new THREE.Vector3();\r\n\t\tvar interSegment = new THREE.Vector3();\r\n\t\tvar interRay = new THREE.Vector3();\r\n\t\tvar step = this.mode === THREE.LineStrip ? 1 : 2;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tif ( attributes.index !== undefined ) {\r\n\r\n\t\t\t\tvar indices = attributes.index.array;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\toffsets = [ { start: 0, count: indices.length, index: 0 } ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var oi = 0; oi < offsets.length; oi ++) {\r\n\r\n\t\t\t\t\tvar start = offsets[ oi ].start;\r\n\t\t\t\t\tvar count = offsets[ oi ].count;\r\n\t\t\t\t\tvar index = offsets[ oi ].index;\r\n\r\n\t\t\t\t\tfor ( var i = start; i < start + count - 1; i += step ) {\r\n\r\n\t\t\t\t\t\tvar a = index + indices[ i ];\r\n\t\t\t\t\t\tvar b = index + indices[ i + 1 ];\r\n\r\n\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\tvar distance = ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\toffsetIndex: oi,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tfor ( var i = 0; i < positions.length / 3 - 1; i += step ) {\r\n\r\n\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tvar distance = ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\tvar distance = ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\tindex: i,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Line.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.Line( this.geometry, this.material, this.mode );\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Mesh';\r\n\t\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\tthis.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function () {\r\n\r\n\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\r\n\r\n\t\tthis.morphTargetBase = - 1;\r\n\t\tthis.morphTargetForcedOrder = [];\r\n\t\tthis.morphTargetInfluences = [];\r\n\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\r\n\r\n\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function ( name ) {\r\n\r\n\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\r\n\r\n\t\treturn this.morphTargetDictionary[ name ];\r\n\r\n\t}\r\n\r\n\tTHREE.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\r\n\r\n\treturn 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\tvar vA = new THREE.Vector3();\r\n\tvar vB = new THREE.Vector3();\r\n\tvar vC = new THREE.Vector3();\r\n\r\n\treturn function ( raycaster, intersects ) {\r\n\r\n\t\tvar geometry = this.geometry;\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( this.matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t// Check boundingBox before continuing\r\n\r\n\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar material = this.material;\r\n\r\n\t\t\tif ( material === undefined ) return;\r\n\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tvar a, b, c;\r\n\t\t\tvar precision = raycaster.precision;\r\n\r\n\t\t\tif ( attributes.index !== undefined ) {\r\n\r\n\t\t\t\tvar indices = attributes.index.array;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\toffsets = [ { start: 0, count: indices.length, index: 0 } ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var oi = 0, ol = offsets.length; oi < ol; ++ oi ) {\r\n\r\n\t\t\t\t\tvar start = offsets[ oi ].start;\r\n\t\t\t\t\tvar count = offsets[ oi ].count;\r\n\t\t\t\t\tvar index = offsets[ oi ].index;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\ta = index + indices[ i ];\r\n\t\t\t\t\t\tb = index + indices[ i + 1 ];\r\n\t\t\t\t\t\tc = index + indices[ i + 2 ];\r\n\r\n\t\t\t\t\t\tvA.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\tvB.fromArray( positions, b * 3 );\r\n\t\t\t\t\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\t\t\t\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( vC, vB, vA, true );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( vA, vB, vC, material.side !== THREE.DoubleSide );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( intersectionPoint === null ) continue;\r\n\r\n\t\t\t\t\t\tintersectionPoint.applyMatrix4( this.matrixWorld );\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPoint );\r\n\r\n\t\t\t\t\t\tif ( distance < precision || distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\tpoint: intersectionPoint,\r\n\t\t\t\t\t\t\tface: new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) ),\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tfor ( var i = 0, j = 0, il = positions.length; i < il; i += 3, j += 9 ) {\r\n\r\n\t\t\t\t\ta = i;\r\n\t\t\t\t\tb = i + 1;\r\n\t\t\t\t\tc = i + 2;\r\n\r\n\t\t\t\t\tvA.fromArray( positions, j );\r\n\t\t\t\t\tvB.fromArray( positions, j + 3 );\r\n\t\t\t\t\tvC.fromArray( positions, j + 6 );\r\n\r\n\t\t\t\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( vC, vB, vA, true );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( vA, vB, vC, material.side !== THREE.DoubleSide );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( intersectionPoint === null ) continue;\r\n\r\n\t\t\t\t\tintersectionPoint.applyMatrix4( this.matrixWorld );\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPoint );\r\n\r\n\t\t\t\t\tif ( distance < precision || distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tpoint: intersectionPoint,\r\n\t\t\t\t\t\tface: new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) ),\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar isFaceMaterial = this.material instanceof THREE.MeshFaceMaterial;\r\n\t\t\tvar objectMaterials = isFaceMaterial === true ? this.material.materials : null;\r\n\r\n\t\t\tvar a, b, c;\r\n\t\t\tvar precision = raycaster.precision;\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\tfor ( var f = 0, fl = geometry.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tvar face = geometry.faces[ f ];\r\n\r\n\t\t\t\tvar material = isFaceMaterial === true ? objectMaterials[ face.materialIndex ] : this.material;\r\n\r\n\t\t\t\tif ( material === undefined ) continue;\r\n\r\n\t\t\t\ta = vertices[ face.a ];\r\n\t\t\t\tb = vertices[ face.b ];\r\n\t\t\t\tc = vertices[ face.c ];\r\n\r\n\t\t\t\tif ( material.morphTargets === true ) {\r\n\r\n\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\r\n\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\r\n\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\r\n\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\r\n\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\r\n\t\t\t\t\t\tvA.x += ( targets[ face.a ].x - a.x ) * influence;\r\n\t\t\t\t\t\tvA.y += ( targets[ face.a ].y - a.y ) * influence;\r\n\t\t\t\t\t\tvA.z += ( targets[ face.a ].z - a.z ) * influence;\r\n\r\n\t\t\t\t\t\tvB.x += ( targets[ face.b ].x - b.x ) * influence;\r\n\t\t\t\t\t\tvB.y += ( targets[ face.b ].y - b.y ) * influence;\r\n\t\t\t\t\t\tvB.z += ( targets[ face.b ].z - b.z ) * influence;\r\n\r\n\t\t\t\t\t\tvC.x += ( targets[ face.c ].x - c.x ) * influence;\r\n\t\t\t\t\t\tvC.y += ( targets[ face.c ].y - c.y ) * influence;\r\n\t\t\t\t\t\tvC.z += ( targets[ face.c ].z - c.z ) * influence;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvA.add( a );\r\n\t\t\t\t\tvB.add( b );\r\n\t\t\t\t\tvC.add( c );\r\n\r\n\t\t\t\t\ta = vA;\r\n\t\t\t\t\tb = vB;\r\n\t\t\t\t\tc = vC;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( c, b, a, true );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar intersectionPoint = ray.intersectTriangle( a, b, c, material.side !== THREE.DoubleSide );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( intersectionPoint === null ) continue;\r\n\r\n\t\t\t\tintersectionPoint.applyMatrix4( this.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPoint );\r\n\r\n\t\t\t\tif ( distance < precision || distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tpoint: intersectionPoint,\r\n\t\t\t\t\tface: face,\r\n\t\t\t\t\tfaceIndex: f,\r\n\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Mesh.prototype.clone = function ( object, recursive ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.Mesh( this.geometry, this.material );\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object, recursive );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function ( skin ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Bone';\r\n\r\n\tthis.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\r\n\r\n\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n\tthis.identityMatrix = new THREE.Matrix4();\r\n\r\n\t// copy the bone array\r\n\r\n\tbones = bones || [];\r\n\r\n\tthis.bones = bones.slice( 0 );\r\n\r\n\t// create a bone texture or an array of floats\r\n\r\n\tif ( this.useVertexTexture ) {\r\n\r\n\t\t// layout (1 matrix = 4 pixels)\r\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t//  with  8x8  pixel texture max   16 bones  (8 * 8  / 4)\r\n\t\t//       16x16 pixel texture max   64 bones (16 * 16 / 4)\r\n\t\t//       32x32 pixel texture max  256 bones (32 * 32 / 4)\r\n\t\t//       64x64 pixel texture max 1024 bones (64 * 64 / 4)\r\n\r\n\t\tvar size;\r\n\r\n\t\tif ( this.bones.length > 256 )\r\n\t\t\tsize = 64;\r\n\t\telse if ( this.bones.length > 64 )\r\n\t\t\tsize = 32;\r\n\t\telse if ( this.bones.length > 16 )\r\n\t\t\tsize = 16;\r\n\t\telse\r\n\t\t\tsize = 8;\r\n\r\n\t\tthis.boneTextureWidth = size;\r\n\t\tthis.boneTextureHeight = size;\r\n\r\n\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\r\n\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\r\n\t\tthis.boneTexture.minFilter = THREE.NearestFilter;\r\n\t\tthis.boneTexture.magFilter = THREE.NearestFilter;\r\n\t\tthis.boneTexture.generateMipmaps = false;\r\n\t\tthis.boneTexture.flipY = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\r\n\r\n\t}\r\n\r\n\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\tif ( boneInverses === undefined ) {\r\n\r\n\t\tthis.calculateInverses();\r\n\r\n\t} else {\r\n\r\n\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tTHREE.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function () {\r\n\r\n\tthis.boneInverses = [];\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tvar inverse = new THREE.Matrix4();\r\n\r\n\t\tif ( this.bones[ b ] ) {\r\n\r\n\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tthis.boneInverses.push( inverse );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function () {\r\n\r\n\tvar bone;\r\n\r\n\t// recover the bind-time world matrices\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// compute the local matrices, positions, rotations and scales\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tif ( bone.parent ) {\r\n\r\n\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = ( function () {\r\n\r\n\tvar offsetMatrix = new THREE.Matrix4();\r\n\t\r\n\treturn function () {\r\n\r\n\t\t// flatten bone matrices to array\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\r\n\r\n\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\r\n\t\t\toffsetMatrix.flattenToArrayOffset( this.boneMatrices, b * 16 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.useVertexTexture ) {\r\n\r\n\t\t\tthis.boneTexture.needsUpdate = true;\r\n\r\n\t\t}\r\n\t\t\r\n\t};\r\n\r\n} )();\r\n\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.type = 'SkinnedMesh';\r\n\r\n\tthis.bindMode = \"attached\";\r\n\tthis.bindMatrix = new THREE.Matrix4();\r\n\tthis.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n\t// init bones\r\n\r\n\t// TODO: remove bone creation as there is no reason (other than\r\n\t// convenience) for THREE.SkinnedMesh to do this.\r\n\r\n\tvar bones = [];\r\n\r\n\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\r\n\t\tvar bone, gbone, p, q, s;\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tp = gbone.pos;\r\n\t\t\tq = gbone.rotq;\r\n\t\t\ts = gbone.scl;\r\n\r\n\t\t\tbone = new THREE.Bone( this );\r\n\t\t\tbones.push( bone );\r\n\r\n\t\t\tbone.name = gbone.name;\r\n\t\t\tbone.position.set( p[ 0 ], p[ 1 ], p[ 2 ] );\r\n\t\t\tbone.quaternion.set( q[ 0 ], q[ 1 ], q[ 2 ], q[ 3 ] );\r\n\r\n\t\t\tif ( s !== undefined ) {\r\n\r\n\t\t\t\tbone.scale.set( s[ 0 ], s[ 1 ], s[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbone.scale.set( 1, 1, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tif ( gbone.parent !== - 1 ) {\r\n\r\n\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.add( bones[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.normalizeSkinWeights();\r\n\r\n\tthis.updateMatrixWorld( true );\r\n\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ) );\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function( skeleton, bindMatrix ) {\r\n\r\n\tthis.skeleton = skeleton;\r\n\r\n\tif ( bindMatrix === undefined ) {\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t}\r\n\r\n\tthis.bindMatrix.copy( bindMatrix );\r\n\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function () {\r\n\r\n\tthis.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function () {\r\n\r\n\tif ( this.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tfor ( var i = 0; i < this.geometry.skinIndices.length; i ++ ) {\r\n\r\n\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\r\n\t\t\tvar scale = 1.0 / sw.lengthManhattan();\r\n\r\n\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\tsw.multiplyScalar( scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsw.set( 1 ); // this will be normalized by the shader anyway\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\t// skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function( force ) {\r\n\r\n\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\r\n\r\n\tif ( this.bindMode === \"attached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t} else if ( this.bindMode === \"detached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t} else {\r\n\r\n\t\tTHREE.warn( 'THREE.SkinnedMesh unreckognized bindMode: ' + this.bindMode );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function( object ) {\r\n\r\n\tif ( object === undefined ) {\r\n\r\n\t\tobject = new THREE.SkinnedMesh( this.geometry, this.material, this.useVertexTexture );\r\n\r\n\t}\r\n\r\n\tTHREE.Mesh.prototype.clone.call( this, object );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n\r\n// File:src/objects/MorphAnimMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphAnimMesh = function ( geometry, material ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.type = 'MorphAnimMesh';\r\n\r\n\t// API\r\n\r\n\tthis.duration = 1000; // milliseconds\r\n\tthis.mirroredLoop = false;\r\n\tthis.time = 0;\r\n\r\n\t// internals\r\n\r\n\tthis.lastKeyframe = 0;\r\n\tthis.currentKeyframe = 0;\r\n\r\n\tthis.direction = 1;\r\n\tthis.directionBackwards = false;\r\n\r\n\tthis.setFrameRange( 0, this.geometry.morphTargets.length - 1 );\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;\r\n\r\nTHREE.MorphAnimMesh.prototype.setFrameRange = function ( start, end ) {\r\n\r\n\tthis.startKeyframe = start;\r\n\tthis.endKeyframe = end;\r\n\r\n\tthis.length = this.endKeyframe - this.startKeyframe + 1;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionForward = function () {\r\n\r\n\tthis.direction = 1;\r\n\tthis.directionBackwards = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionBackward = function () {\r\n\r\n\tthis.direction = - 1;\r\n\tthis.directionBackwards = true;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.parseAnimations = function () {\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tif ( ! geometry.animations ) geometry.animations = {};\r\n\r\n\tvar firstAnimation, animations = geometry.animations;\r\n\r\n\tvar pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\tvar parts = morph.name.match( pattern );\r\n\r\n\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\tvar label = parts[ 1 ];\r\n\r\n\t\t\tif ( ! animations[ label ] ) animations[ label ] = { start: Infinity, end: - Infinity };\r\n\r\n\t\t\tvar animation = animations[ label ];\r\n\r\n\t\t\tif ( i < animation.start ) animation.start = i;\r\n\t\t\tif ( i > animation.end ) animation.end = i;\r\n\r\n\t\t\tif ( ! firstAnimation ) firstAnimation = label;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setAnimationLabel = function ( label, start, end ) {\r\n\r\n\tif ( ! this.geometry.animations ) this.geometry.animations = {};\r\n\r\n\tthis.geometry.animations[ label ] = { start: start, end: end };\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.playAnimation = function ( label, fps ) {\r\n\r\n\tvar animation = this.geometry.animations[ label ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tthis.setFrameRange( animation.start, animation.end );\r\n\t\tthis.duration = 1000 * ( ( animation.end - animation.start ) / fps );\r\n\t\tthis.time = 0;\r\n\r\n\t} else {\r\n\r\n\t\tTHREE.warn( 'THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.updateAnimation = function ( delta ) {\r\n\r\n\tvar frameTime = this.duration / this.length;\r\n\r\n\tthis.time += this.direction * delta;\r\n\r\n\tif ( this.mirroredLoop ) {\r\n\r\n\t\tif ( this.time > this.duration || this.time < 0 ) {\r\n\r\n\t\t\tthis.direction *= - 1;\r\n\r\n\t\t\tif ( this.time > this.duration ) {\r\n\r\n\t\t\t\tthis.time = this.duration;\r\n\t\t\t\tthis.directionBackwards = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.time < 0 ) {\r\n\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t\tthis.directionBackwards = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tthis.time = this.time % this.duration;\r\n\r\n\t\tif ( this.time < 0 ) this.time += this.duration;\r\n\r\n\t}\r\n\r\n\tvar keyframe = this.startKeyframe + THREE.Math.clamp( Math.floor( this.time / frameTime ), 0, this.length - 1 );\r\n\r\n\tif ( keyframe !== this.currentKeyframe ) {\r\n\r\n\t\tthis.morphTargetInfluences[ this.lastKeyframe ] = 0;\r\n\t\tthis.morphTargetInfluences[ this.currentKeyframe ] = 1;\r\n\r\n\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\r\n\t\tthis.lastKeyframe = this.currentKeyframe;\r\n\t\tthis.currentKeyframe = keyframe;\r\n\r\n\t}\r\n\r\n\tvar mix = ( this.time % frameTime ) / frameTime;\r\n\r\n\tif ( this.directionBackwards ) {\r\n\r\n\t\tmix = 1 - mix;\r\n\r\n\t}\r\n\r\n\tthis.morphTargetInfluences[ this.currentKeyframe ] = mix;\r\n\tthis.morphTargetInfluences[ this.lastKeyframe ] = 1 - mix;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.interpolateTargets = function ( a, b, t ) {\r\n\r\n\tvar influences = this.morphTargetInfluences;\r\n\r\n\tfor ( var i = 0, l = influences.length; i < l; i ++ ) {\r\n\r\n\t\tinfluences[ i ] = 0;\r\n\r\n\t}\r\n\r\n\tif ( a > -1 ) influences[ a ] = 1 - t;\r\n\tif ( b > -1 ) influences[ b ] = t;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.MorphAnimMesh( this.geometry, this.material );\r\n\r\n\tobject.duration = this.duration;\r\n\tobject.mirroredLoop = this.mirroredLoop;\r\n\tobject.time = this.time;\r\n\r\n\tobject.lastKeyframe = this.lastKeyframe;\r\n\tobject.currentKeyframe = this.currentKeyframe;\r\n\r\n\tobject.direction = this.direction;\r\n\tobject.directionBackwards = this.directionBackwards;\r\n\r\n\tTHREE.Mesh.prototype.clone.call( this, object );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.objects = [];\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function ( object, distance ) {\r\n\r\n\tif ( distance === undefined ) distance = 0;\r\n\r\n\tdistance = Math.abs( distance );\r\n\r\n\tfor ( var l = 0; l < this.objects.length; l ++ ) {\r\n\r\n\t\tif ( distance < this.objects[ l ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.objects.splice( l, 0, { distance: distance, object: object } );\r\n\tthis.add( object );\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function ( distance ) {\r\n\r\n\tfor ( var i = 1, l = this.objects.length; i < l; i ++ ) {\r\n\r\n\t\tif ( distance < this.objects[ i ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn this.objects[ i - 1 ].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function ( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\r\n\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.LOD.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function ( camera ) {\r\n\r\n\t\tif ( this.objects.length > 1 ) {\r\n\r\n\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tvar distance = v1.distanceTo( v2 );\r\n\r\n\t\t\tthis.objects[ 0 ].object.visible = true;\r\n\r\n\t\t\tfor ( var i = 1, l = this.objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tif ( distance >= this.objects[ i ].distance ) {\r\n\r\n\t\t\t\t\tthis.objects[ i - 1 ].object.visible = false;\r\n\t\t\t\t\tthis.objects[ i     ].object.visible = true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.objects[ i ].object.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.LOD();\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object );\r\n\r\n\tfor ( var i = 0, l = this.objects.length; i < l; i ++ ) {\r\n\t\tvar x = this.objects[ i ].object.clone();\r\n\t\tx.visible = i === 0;\r\n\t\tobject.addLevel( x, this.objects[ i ].distance );\r\n\t}\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = ( function () {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 2,  0, 2, 3 ] );\r\n\tvar vertices = new Float32Array( [ - 0.5, - 0.5, 0,   0.5, - 0.5, 0,   0.5, 0.5, 0,   - 0.5, 0.5, 0 ] );\r\n\tvar uvs = new Float32Array( [ 0, 0,   1, 0,   1, 1,   0, 1 ] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'index', new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\treturn function ( material ) {\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tthis.type = 'Sprite';\r\n\r\n\t\tthis.geometry = geometry;\r\n\t\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nTHREE.Sprite.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function ( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.distanceToPoint( matrixPosition );\r\n\r\n\t\tif ( distance > this.scale.x ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tintersects.push( {\r\n\r\n\t\t\tdistance: distance,\r\n\t\t\tpoint: this.position,\r\n\t\t\tface: null,\r\n\t\t\tobject: this\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Sprite.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.Sprite( this.material );\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object );\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.lensFlares = [];\r\n\r\n\tthis.positionScreen = new THREE.Vector3();\r\n\tthis.customUpdateCallback = undefined;\r\n\r\n\tif ( texture !== undefined ) {\r\n\r\n\t\tthis.add( texture, size, distance, blending, color );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function ( texture, size, distance, blending, color, opacity ) {\r\n\r\n\tif ( size === undefined ) size = - 1;\r\n\tif ( distance === undefined ) distance = 0;\r\n\tif ( opacity === undefined ) opacity = 1;\r\n\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\r\n\tif ( blending === undefined ) blending = THREE.NormalBlending;\r\n\r\n\tdistance = Math.min( distance, Math.max( 0, distance ) );\r\n\r\n\tthis.lensFlares.push( {\r\n\t\ttexture: texture, \t\t\t// THREE.Texture\r\n\t\tsize: size, \t\t\t\t// size in pixels (-1 = use texture.width)\r\n\t\tdistance: distance, \t\t// distance (0-1) from light source (0=at light source)\r\n\t\tx: 0, y: 0, z: 0,\t\t\t// screen position (-1 => 1) z = 0 is ontop z = 1 is back\r\n\t\tscale: 1, \t\t\t\t\t// scale\r\n\t\trotation: 1, \t\t\t\t// rotation\r\n\t\topacity: opacity,\t\t\t// opacity\r\n\t\tcolor: color,\t\t\t\t// color\r\n\t\tblending: blending\t\t\t// blending\r\n\t} );\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function () {\r\n\r\n\tvar f, fl = this.lensFlares.length;\r\n\tvar flare;\r\n\tvar vecX = - this.positionScreen.x * 2;\r\n\tvar vecY = - this.positionScreen.y * 2;\r\n\r\n\tfor ( f = 0; f < fl; f ++ ) {\r\n\r\n\t\tflare = this.lensFlares[ f ];\r\n\r\n\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\r\n\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\r\n\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Scene';\r\n\r\n\tthis.fog = null;\r\n\tthis.overrideMaterial = null;\r\n\r\n\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.clone = function ( object ) {\r\n\r\n\tif ( object === undefined ) object = new THREE.Scene();\r\n\r\n\tTHREE.Object3D.prototype.clone.call( this, object );\r\n\r\n\tif ( this.fog !== null ) object.fog = this.fog.clone();\r\n\tif ( this.overrideMaterial !== null ) object.overrideMaterial = this.overrideMaterial.clone();\r\n\r\n\tobject.autoUpdate = this.autoUpdate;\r\n\tobject.matrixAutoUpdate = this.matrixAutoUpdate;\r\n\r\n\treturn object;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function ( color, near, far ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 1;\r\n\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function () {\r\n\r\n\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function ( color, density ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function () {\r\n\r\n\treturn new THREE.FogExp2( this.color.getHex(), this.density );\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk[ 'common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\nfloat square( in float a ) { return a*a; }\\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\\nfloat average( in float a ) { return a; }\\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n}\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\\n\treturn point - distance * planeNormal;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\\n}\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\tif ( decayExponent > 0.0 ) {\\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\\n\t}\\n\treturn 1.0;\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n#ifdef GAMMA_INPUT\\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\nvec3 linearToOutput( in vec3 a ) {\\n#ifdef GAMMA_OUTPUT\\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\ntransformedNormal = normalize( transformedNormal );\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\tfloat dotProduct = dot( transformedNormal, dirVector );\\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\t#ifdef WRAP_AROUND\\n\\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\\n\\n\t#endif\\n\\n}\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tlVector = normalize( lVector );\\n\\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\\n\\n\t\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/default_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'default_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#elif defined( USE_MORPHTARGETS )\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\\n\\n#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\t#ifdef USE_MORPHNORMALS\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\\n\\n\t#else\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_pars_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\nvec3 viewPosition = normalize( vViewPosition );\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\\n\\n\t\t\t\t// specular\\n\\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t\t#else\\n\\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t\t#endif\\n\\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, dirVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\\n\\n\t\t// specular\\n\\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t/*\\n\t\t// fresnel term from skin shader\\n\t\tconst float F0 = 0.128;\\n\\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\\n\t\tfloat exponential = pow( base, 5.0 );\\n\\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\\n\t\t*/\\n\\n\t\t/*\\n\t\t// fresnel term from fresnel shader\\n\t\tconst float mFresnelBias = 0.08;\\n\t\tconst float mFresnelScale = 0.3;\\n\t\tconst float mFresnelPower = 5.0;\\n\\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\\n\t\t*/\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += hemiColor;\\n\\n\t\t// specular (sky light)\\n\\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\\n\\n\t\t// specular (ground light)\\n\\n\t\tvec3 lVectorGround = -lVector;\\n\\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\\n\\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tvec3 morphedNormal = vec3( 0.0 );\\n\\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n\tmorphedNormal += normal;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\tuniform sampler2D lightMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = inputToLinear( color.xyz );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\t#ifdef USE_MORPHTARGETS\\n\\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\\n\t\tfogFactor = whiteCompliment( fogFactor );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'defaultnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec3 objectNormal = skinnedNormal.xyz;\\n\\n#elif defined( USE_MORPHNORMALS )\\n\\n\tvec3 objectNormal = morphedNormal;\\n\\n#else\\n\\n\tvec3 objectNormal = normal;\\n\\n#endif\\n\\n#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\tvec3 morphed = vec3( 0.0 );\\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n\tmorphed += position;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\tint inFrustumCount = 0;\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\t\t// don't shadow pixels outside of light frustum\\n\t\t\t\t// use just first frustum (for cascades)\\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\\n\\n\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\tinFrustumCount += int( inFrustum );\\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\\n\\n\t\t#else\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t#endif\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#else\\n\\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t}\\n\\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\\n\tshadowColor = inputToLinear( shadowColor );\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#elif defined( USE_MORPHTARGETS )\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\t#extension GL_EXT_frag_depth : enable\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n\tmerge: function ( uniforms ) {\r\n\r\n\t\tvar merged = {};\r\n\r\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\r\n\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn merged;\r\n\r\n\t},\r\n\r\n\tclone: function ( uniforms_src ) {\r\n\r\n\t\tvar uniforms_dst = {};\r\n\r\n\t\tfor ( var u in uniforms_src ) {\r\n\r\n\t\t\tuniforms_dst[ u ] = {};\r\n\r\n\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\r\n\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\r\n\t\t\t\tif ( parameter_src instanceof THREE.Color ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\r\n\t\t\t\t} else if ( parameter_src instanceof Array ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms_dst;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n\tcommon: {\r\n\r\n\t\t\"diffuse\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\r\n\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"lightMap\" : { type: \"t\", value: null },\r\n\t\t\"specularMap\" : { type: \"t\", value: null },\r\n\t\t\"alphaMap\" : { type: \"t\", value: null },\r\n\r\n\t\t\"envMap\" : { type: \"t\", value: null },\r\n\t\t\"flipEnvMap\" : { type: \"f\", value: - 1 },\r\n\t\t\"reflectivity\" : { type: \"f\", value: 1.0 },\r\n\t\t\"refractionRatio\" : { type: \"f\", value: 0.98 },\r\n\r\n\t\t\"morphTargetInfluences\" : { type: \"f\", value: 0 }\r\n\r\n\t},\r\n\r\n\tbump: {\r\n\r\n\t\t\"bumpMap\" : { type: \"t\", value: null },\r\n\t\t\"bumpScale\" : { type: \"f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tnormalmap: {\r\n\r\n\t\t\"normalMap\" : { type: \"t\", value: null },\r\n\t\t\"normalScale\" : { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\r\n\t},\r\n\r\n\tfog : {\r\n\r\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tlights: {\r\n\r\n\t\t\"ambientLightColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"directionalLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"directionalLightColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"hemisphereLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"hemisphereLightSkyColor\" : { type: \"fv\", value: [] },\r\n\t\t\"hemisphereLightGroundColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"pointLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\"pointLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\"pointLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\"pointLightDecay\" : { type: \"fv1\", value: [] },\r\n\r\n\t\t\"spotLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightAngleCos\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightExponent\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightDecay\" : { type: \"fv1\", value: [] }\r\n\r\n\t},\r\n\r\n\tparticle: {\r\n\r\n\t\t\"psColor\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\t\t\"size\" : { type: \"f\", value: 1.0 },\r\n\t\t\"scale\" : { type: \"f\", value: 1.0 },\r\n\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tshadowmap: {\r\n\r\n\t\t\"shadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"shadowMapSize\": { type: \"v2v\", value: [] },\r\n\r\n\t\t\"shadowBias\" : { type: \"fv1\", value: [] },\r\n\t\t\"shadowDarkness\": { type: \"fv1\", value: [] },\r\n\r\n\t\t\"shadowMatrix\" : { type: \"m4v\", value: [] }\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n\t'basic': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_ENVMAP\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\t\t// TODO: Light map on an otherwise unlit surface doesn't make sense.\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\t\t// TODO: Shadows on an otherwise unlit surface doesn't make sense.\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\t// TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'lambert': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"wrapRGB\"  : { type: \"v3\", value: new THREE.Vector3( 1, 1, 1 ) }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"#define LAMBERT\",\r\n\r\n\t\t\t\"varying vec3 vLightFront;\",\r\n\r\n\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_lambert_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_lambert_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\t\"varying vec3 vLightFront;\",\r\n\r\n\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\t\t//\"float isFront = float( gl_FrontFacing );\",\r\n\t\t\t\t\t//\"gl_FragColor.xyz *= isFront * vLightFront + ( 1.0 - isFront ) * vLightBack;\",\r\n\r\n\t\t\t\"\t\tif ( gl_FrontFacing )\",\r\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n\t\t\t\"\t\telse\",\r\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\t// TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'phong': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"bump\" ],\r\n\t\t\tTHREE.UniformsLib[ \"normalmap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\r\n\t\t\t\t\"shininess\": { type: \"f\", value: 30 },\r\n\t\t\t\t\"wrapRGB\"  : { type: \"v3\", value: new THREE.Vector3( 1, 1, 1 ) }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"#define PHONG\",\r\n\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\"\tvarying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\t\t\t\"\tvNormal = normalize( transformedNormal );\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"\tvViewPosition = -mvPosition.xyz;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"#define PHONG\",\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\"uniform vec3 specular;\",\r\n\t\t\t\"uniform float shininess;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"bumpmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"normalmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\t// TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'particle_basic': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"particle\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"uniform float size;\",\r\n\t\t\t\"uniform float scale;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\"\t#ifdef USE_SIZEATTENUATION\",\r\n\t\t\t\"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n\t\t\t\"\t#else\",\r\n\t\t\t\"\t\tgl_PointSize = size;\",\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 psColor;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_particle_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_particle_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\t// TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'dashed': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"scale\"    : { type: \"f\", value: 1 },\r\n\t\t\t\t\"dashSize\" : { type: \"f\", value: 1 },\r\n\t\t\t\t\"totalSize\": { type: \"f\", value: 2 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"uniform float scale;\",\r\n\t\t\t\"attribute float lineDistance;\",\r\n\r\n\t\t\t\"varying float vLineDistance;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\"\tvLineDistance = scale * lineDistance;\",\r\n\r\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\t\"uniform float dashSize;\",\r\n\t\t\t\"uniform float totalSize;\",\r\n\r\n\t\t\t\"varying float vLineDistance;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\r\n\t\t\t\"\t\tdiscard;\",\r\n\r\n\t\t\t\"\t}\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\t// TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'depth': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"mNear\": { type: \"f\", value: 1.0 },\r\n\t\t\t\"mFar\" : { type: \"f\", value: 2000.0 },\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform float mNear;\",\r\n\t\t\t\"uniform float mFar;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n\t\t\t\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n\t\t\t\"\tgl_FragColor = vec4( vec3( color ), opacity );\",   // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t'normal': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vNormal;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvNormal = normalize( normalMatrix * normal );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform float opacity;\",\r\n\t\t\t\"varying vec3 vNormal;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'cube': {\r\n\r\n\t\tuniforms: { \"tCube\": { type: \"t\", value: null },\r\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform samplerCube tCube;\",\r\n\t\t\t\"uniform float tFlip;\",\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'equirect': {\r\n\r\n\t\tuniforms: { \"tEquirect\": { type: \"t\", value: null },\r\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform sampler2D tEquirect;\",\r\n\t\t\t\"uniform float tFlip;\",\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t// \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\t\t\t\t\"vec3 direction = normalize( vWorldPosition );\",\r\n\t\t\t\t\"vec2 sampleUV;\",\r\n\t\t\t\t\"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n\t\t\t\t\"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n\t\t\t\t\"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t},\r\n\r\n\t/* Depth encoding into RGBA texture\r\n\t *\r\n\t * based on SpiderGL shadow map example\r\n\t * http://spidergl.org/example.php?id=6\r\n\t *\r\n\t * originally from\r\n\t * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n\t *\r\n\t * see also\r\n\t * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n\t */\r\n\r\n\t'depthRGBA': {\r\n\r\n\t\tuniforms: {},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"default_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\"),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"vec4 pack_depth( const in float depth ) {\",\r\n\r\n\t\t\t\"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n\t\t\t\"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n\t\t\t\"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n\t\t\t\"\tres -= res.xxyz * bit_mask;\",\r\n\t\t\t\"\treturn res;\",\r\n\r\n\t\t\t\"}\",\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n\t\t\t\t//\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n\t\t\t\t//\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join(\"\\n\")\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.WebGLRenderer = function ( parameters ) {\r\n\r\n\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\r\n\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\tpixelRatio = 1,\r\n\r\n\t_precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\r\n\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n\t_logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false,\r\n\r\n\t_clearColor = new THREE.Color( 0x000000 ),\r\n\t_clearAlpha = 0;\r\n\r\n\tvar lights = [];\r\n\r\n\tvar _webglObjects = {};\r\n\tvar _webglObjectsImmediate = [];\r\n\r\n\tvar opaqueObjects = [];\r\n\tvar transparentObjects = [];\r\n\r\n\tvar sprites = [];\r\n\tvar lensFlares = [];\r\n\r\n\t// public properties\r\n\r\n\tthis.domElement = _canvas;\r\n\tthis.context = null;\r\n\r\n\t// clearing\r\n\r\n\tthis.autoClear = true;\r\n\tthis.autoClearColor = true;\r\n\tthis.autoClearDepth = true;\r\n\tthis.autoClearStencil = true;\r\n\r\n\t// scene graph\r\n\r\n\tthis.sortObjects = true;\r\n\r\n\t// physically based shading\r\n\r\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\tthis.gammaInput = false;\r\n\tthis.gammaOutput = false;\r\n\r\n\t// shadow map\r\n\r\n\tthis.shadowMapEnabled = false;\r\n\tthis.shadowMapType = THREE.PCFShadowMap;\r\n\tthis.shadowMapCullFace = THREE.CullFaceFront;\r\n\tthis.shadowMapDebug = false;\r\n\tthis.shadowMapCascade = false;\r\n\r\n\t// morphs\r\n\r\n\tthis.maxMorphTargets = 8;\r\n\tthis.maxMorphNormals = 4;\r\n\r\n\t// flags\r\n\r\n\tthis.autoScaleCubemaps = true;\r\n\r\n\t// info\r\n\r\n\tthis.info = {\r\n\r\n\t\tmemory: {\r\n\r\n\t\t\tprograms: 0,\r\n\t\t\tgeometries: 0,\r\n\t\t\ttextures: 0\r\n\r\n\t\t},\r\n\r\n\t\trender: {\r\n\r\n\t\t\tcalls: 0,\r\n\t\t\tvertices: 0,\r\n\t\t\tfaces: 0,\r\n\t\t\tpoints: 0\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// internal properties\r\n\r\n\tvar _this = this,\r\n\r\n\t_programs = [],\r\n\r\n\t// internal state cache\r\n\r\n\t_currentProgram = null,\r\n\t_currentFramebuffer = null,\r\n\t_currentMaterialId = - 1,\r\n\t_currentGeometryProgram = '',\r\n\t_currentCamera = null,\r\n\r\n\t_usedTextureUnits = 0,\r\n\r\n\t_viewportX = 0,\r\n\t_viewportY = 0,\r\n\t_viewportWidth = _canvas.width,\r\n\t_viewportHeight = _canvas.height,\r\n\t_currentWidth = 0,\r\n\t_currentHeight = 0,\r\n\r\n\t// frustum\r\n\r\n\t_frustum = new THREE.Frustum(),\r\n\r\n\t // camera matrices cache\r\n\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_vector3 = new THREE.Vector3(),\r\n\r\n\t// light arrays cache\r\n\r\n\t_direction = new THREE.Vector3(),\r\n\r\n\t_lightsNeedUpdate = true,\r\n\r\n\t_lights = {\r\n\r\n\t\tambient: [ 0, 0, 0 ],\r\n\t\tdirectional: { length: 0, colors:[], positions: [] },\r\n\t\tpoint: { length: 0, colors: [], positions: [], distances: [], decays: [] },\r\n\t\tspot: { length: 0, colors: [], positions: [], distances: [], directions: [], anglesCos: [], exponents: [], decays: [] },\r\n\t\themi: { length: 0, skyColors: [], groundColors: [], positions: [] }\r\n\r\n\t};\r\n\r\n\t// initialize\r\n\r\n\tvar _gl;\r\n\r\n\ttry {\r\n\r\n\t\tvar attributes = {\r\n\t\t\talpha: _alpha,\r\n\t\t\tdepth: _depth,\r\n\t\t\tstencil: _stencil,\r\n\t\t\tantialias: _antialias,\r\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\r\n\t\t};\r\n\r\n\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\r\n\r\n\t\tif ( _gl === null ) {\r\n\r\n\t\t\tif ( _canvas.getContext( 'webgl') !== null ) {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context.';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_canvas.addEventListener( 'webglcontextlost', function ( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tresetGLState();\r\n\t\t\tsetDefaultGLState();\r\n\r\n\t\t\t_webglObjects = {};\r\n\r\n\t\t}, false);\r\n\r\n\t} catch ( error ) {\r\n\r\n\t\tTHREE.error( 'THREE.WebGLRenderer: ' + error );\r\n\r\n\t}\r\n\r\n\tvar state = new THREE.WebGLState( _gl, paramThreeToGL );\r\n\r\n\tif ( _gl.getShaderPrecisionFormat === undefined ) {\r\n\r\n\t\t_gl.getShaderPrecisionFormat = function () {\r\n\r\n\t\t\treturn {\r\n\t\t\t\t'rangeMin': 1,\r\n\t\t\t\t'rangeMax': 1,\r\n\t\t\t\t'precision': 1\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar extensions = new THREE.WebGLExtensions( _gl );\r\n\r\n\textensions.get( 'OES_texture_float' );\r\n\textensions.get( 'OES_texture_float_linear' );\r\n\textensions.get( 'OES_texture_half_float' );\r\n\textensions.get( 'OES_texture_half_float_linear' );\r\n\textensions.get( 'OES_standard_derivatives' );\r\n\r\n\tif ( _logarithmicDepthBuffer ) {\r\n\r\n\t\textensions.get( 'EXT_frag_depth' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar glClearColor = function ( r, g, b, a ) {\r\n\r\n\t\tif ( _premultipliedAlpha === true ) {\r\n\r\n\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t}\r\n\r\n\t\t_gl.clearColor( r, g, b, a );\r\n\r\n\t};\r\n\r\n\tvar setDefaultGLState = function () {\r\n\r\n\t\t_gl.clearColor( 0, 0, 0, 1 );\r\n\t\t_gl.clearDepth( 1 );\r\n\t\t_gl.clearStencil( 0 );\r\n\r\n\t\t_gl.enable( _gl.DEPTH_TEST );\r\n\t\t_gl.depthFunc( _gl.LEQUAL );\r\n\r\n\t\t_gl.frontFace( _gl.CCW );\r\n\t\t_gl.cullFace( _gl.BACK );\r\n\t\t_gl.enable( _gl.CULL_FACE );\r\n\r\n\t\t_gl.enable( _gl.BLEND );\r\n\t\t_gl.blendEquation( _gl.FUNC_ADD );\r\n\t\t_gl.blendFunc( _gl.SRC_ALPHA, _gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tvar resetGLState = function () {\r\n\r\n\t\t_currentProgram = null;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\r\n\t\t_lightsNeedUpdate = true;\r\n\r\n\t\tstate.reset();\r\n\r\n\t};\r\n\r\n\tsetDefaultGLState();\r\n\r\n\tthis.context = _gl;\r\n\tthis.state = state;\r\n\r\n\t// GPU capabilities\r\n\r\n\tvar _maxTextures = _gl.getParameter( _gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\tvar _maxVertexTextures = _gl.getParameter( _gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\tvar _maxTextureSize = _gl.getParameter( _gl.MAX_TEXTURE_SIZE );\r\n\tvar _maxCubemapSize = _gl.getParameter( _gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\r\n\tvar _supportsVertexTextures = _maxVertexTextures > 0;\r\n\tvar _supportsBoneTextures = _supportsVertexTextures && extensions.get( 'OES_texture_float' );\r\n\r\n\t//\r\n\r\n\tvar _vertexShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat( _gl.VERTEX_SHADER, _gl.HIGH_FLOAT );\r\n\tvar _vertexShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat( _gl.VERTEX_SHADER, _gl.MEDIUM_FLOAT );\r\n\r\n\tvar _fragmentShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat( _gl.FRAGMENT_SHADER, _gl.HIGH_FLOAT );\r\n\tvar _fragmentShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat( _gl.FRAGMENT_SHADER, _gl.MEDIUM_FLOAT );\r\n\r\n\tvar getCompressedTextureFormats = ( function () {\r\n\r\n\t\tvar array;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( array !== undefined ) {\r\n\r\n\t\t\t\treturn array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray = [];\r\n\r\n\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) || extensions.get( 'WEBGL_compressed_texture_s3tc' ) ) {\r\n\r\n\t\t\t\tvar formats = _gl.getParameter( _gl.COMPRESSED_TEXTURE_FORMATS );\r\n\r\n\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\r\n\t\t\t\t\tarray.push( formats[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t} )();\r\n\r\n\t// clamp precision to maximum available\r\n\r\n\tvar highpAvailable = _vertexShaderPrecisionHighpFloat.precision > 0 && _fragmentShaderPrecisionHighpFloat.precision > 0;\r\n\tvar mediumpAvailable = _vertexShaderPrecisionMediumpFloat.precision > 0 && _fragmentShaderPrecisionMediumpFloat.precision > 0;\r\n\r\n\tif ( _precision === 'highp' && ! highpAvailable ) {\r\n\r\n\t\tif ( mediumpAvailable ) {\r\n\r\n\t\t\t_precision = 'mediump';\r\n\t\t\tTHREE.warn( 'THREE.WebGLRenderer: highp not supported, using mediump.' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_precision = 'lowp';\r\n\t\t\tTHREE.warn( 'THREE.WebGLRenderer: highp and mediump not supported, using lowp.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tif ( _precision === 'mediump' && ! mediumpAvailable ) {\r\n\r\n\t\t_precision = 'lowp';\r\n\t\tTHREE.warn( 'THREE.WebGLRenderer: mediump not supported, using lowp.' );\r\n\r\n\t}\r\n\r\n\t// Plugins\r\n\r\n\tvar shadowMapPlugin = new THREE.ShadowMapPlugin( this, lights, _webglObjects, _webglObjectsImmediate );\r\n\r\n\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\r\n\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\r\n\r\n\t// API\r\n\r\n\tthis.getContext = function () {\r\n\r\n\t\treturn _gl;\r\n\r\n\t};\r\n\r\n\tthis.forceContextLoss = function () {\r\n\r\n\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\r\n\r\n\t};\r\n\r\n\tthis.supportsVertexTextures = function () {\r\n\r\n\t\treturn _supportsVertexTextures;\r\n\r\n\t};\r\n\r\n\tthis.supportsFloatTextures = function () {\r\n\r\n\t\treturn extensions.get( 'OES_texture_float' );\r\n\r\n\t};\r\n\r\n\tthis.supportsHalfFloatTextures = function () {\r\n\r\n\t\treturn extensions.get( 'OES_texture_half_float' );\r\n\r\n\t};\r\n\r\n\tthis.supportsStandardDerivatives = function () {\r\n\r\n\t\treturn extensions.get( 'OES_standard_derivatives' );\r\n\r\n\t};\r\n\r\n\tthis.supportsCompressedTextureS3TC = function () {\r\n\r\n\t\treturn extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t};\r\n\r\n\tthis.supportsCompressedTexturePVRTC = function () {\r\n\r\n\t\treturn extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t};\r\n\r\n\tthis.supportsBlendMinMax = function () {\r\n\r\n\t\treturn extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t};\r\n\r\n\tthis.getMaxAnisotropy = ( function () {\r\n\r\n\t\tvar value;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\treturn value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tvalue = extension !== null ? _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT ) : 0;\r\n\r\n\t\t\treturn value;\r\n\r\n\t\t}\r\n\r\n\t} )();\r\n\r\n\tthis.getPrecision = function () {\r\n\r\n\t\treturn _precision;\r\n\r\n\t};\r\n\r\n\tthis.getPixelRatio = function () {\r\n\r\n\t\treturn pixelRatio;\r\n\r\n\t};\r\n\r\n\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\tpixelRatio = value;\r\n\r\n\t};\r\n\r\n\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t_canvas.width = width * pixelRatio;\r\n\t\t_canvas.height = height * pixelRatio;\r\n\r\n\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t}\r\n\r\n\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t};\r\n\r\n\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\t_viewportX = x * pixelRatio;\r\n\t\t_viewportY = y * pixelRatio;\r\n\r\n\t\t_viewportWidth = width * pixelRatio;\r\n\t\t_viewportHeight = height * pixelRatio;\r\n\r\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\r\n\t};\r\n\r\n\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\t_gl.scissor(\r\n\t\t\tx * pixelRatio,\r\n\t\t\ty * pixelRatio,\r\n\t\t\twidth * pixelRatio,\r\n\t\t\theight * pixelRatio\r\n\t\t);\r\n\r\n\t};\r\n\r\n\tthis.enableScissorTest = function ( enable ) {\r\n\r\n\t\tenable ? _gl.enable( _gl.SCISSOR_TEST ) : _gl.disable( _gl.SCISSOR_TEST );\r\n\r\n\t};\r\n\r\n\t// Clearing\r\n\r\n\tthis.getClearColor = function () {\r\n\r\n\t\treturn _clearColor;\r\n\r\n\t};\r\n\r\n\tthis.setClearColor = function ( color, alpha ) {\r\n\r\n\t\t_clearColor.set( color );\r\n\r\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.getClearAlpha = function () {\r\n\r\n\t\treturn _clearAlpha;\r\n\r\n\t};\r\n\r\n\tthis.setClearAlpha = function ( alpha ) {\r\n\r\n\t\t_clearAlpha = alpha;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\tvar bits = 0;\r\n\r\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n\t\t_gl.clear( bits );\r\n\r\n\t};\r\n\r\n\tthis.clearColor = function () {\r\n\r\n\t\t_gl.clear( _gl.COLOR_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function () {\r\n\r\n\t\t_gl.clear( _gl.DEPTH_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function () {\r\n\r\n\t\t_gl.clear( _gl.STENCIL_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\t\tthis.clear( color, depth, stencil );\r\n\r\n\t};\r\n\r\n\t// Reset\r\n\r\n\tthis.resetGLState = resetGLState;\r\n\r\n\t// Buffer allocation\r\n\r\n\tfunction createParticleBuffers ( geometry ) {\r\n\r\n\t\tgeometry.__webglVertexBuffer = _gl.createBuffer();\r\n\t\tgeometry.__webglColorBuffer = _gl.createBuffer();\r\n\r\n\t\t_this.info.memory.geometries ++;\r\n\r\n\t};\r\n\r\n\tfunction createLineBuffers ( geometry ) {\r\n\r\n\t\tgeometry.__webglVertexBuffer = _gl.createBuffer();\r\n\t\tgeometry.__webglColorBuffer = _gl.createBuffer();\r\n\t\tgeometry.__webglLineDistanceBuffer = _gl.createBuffer();\r\n\r\n\t\t_this.info.memory.geometries ++;\r\n\r\n\t};\r\n\r\n\tfunction createMeshBuffers ( geometryGroup ) {\r\n\r\n\t\tgeometryGroup.__webglVertexBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglNormalBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglTangentBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglColorBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglUVBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglUV2Buffer = _gl.createBuffer();\r\n\r\n\t\tgeometryGroup.__webglSkinIndicesBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglSkinWeightsBuffer = _gl.createBuffer();\r\n\r\n\t\tgeometryGroup.__webglFaceBuffer = _gl.createBuffer();\r\n\t\tgeometryGroup.__webglLineBuffer = _gl.createBuffer();\r\n\r\n\t\tvar numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n\t\tif ( numMorphTargets ) {\r\n\r\n\t\t\tgeometryGroup.__webglMorphTargetsBuffers = [];\r\n\r\n\t\t\tfor ( var m = 0, ml = numMorphTargets; m < ml; m ++ ) {\r\n\r\n\t\t\t\tgeometryGroup.__webglMorphTargetsBuffers.push( _gl.createBuffer() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n\t\tif ( numMorphNormals ) {\r\n\r\n\t\t\tgeometryGroup.__webglMorphNormalsBuffers = [];\r\n\r\n\t\t\tfor ( var m = 0, ml = numMorphNormals; m < ml; m ++ ) {\r\n\r\n\t\t\t\tgeometryGroup.__webglMorphNormalsBuffers.push( _gl.createBuffer() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_this.info.memory.geometries ++;\r\n\r\n\t};\r\n\r\n\t// Events\r\n\r\n\tvar onObjectRemoved = function ( event ) {\r\n\r\n\t\tvar object = event.target;\r\n\r\n\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\tchild.removeEventListener( 'remove', onObjectRemoved );\r\n\r\n\t\t\tremoveObject( child );\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tvar onGeometryDispose = function ( event ) {\r\n\r\n\t\tvar geometry = event.target;\r\n\r\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tdeallocateGeometry( geometry );\r\n\r\n\t};\r\n\r\n\tvar onTextureDispose = function ( event ) {\r\n\r\n\t\tvar texture = event.target;\r\n\r\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\tdeallocateTexture( texture );\r\n\r\n\t\t_this.info.memory.textures --;\r\n\r\n\r\n\t};\r\n\r\n\tvar onRenderTargetDispose = function ( event ) {\r\n\r\n\t\tvar renderTarget = event.target;\r\n\r\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t_this.info.memory.textures --;\r\n\r\n\t};\r\n\r\n\tvar onMaterialDispose = function ( event ) {\r\n\r\n\t\tvar material = event.target;\r\n\r\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\tdeallocateMaterial( material );\r\n\r\n\t};\r\n\r\n\t// Buffer deallocation\r\n\r\n\tvar deleteBuffers = function ( geometry ) {\r\n\r\n\t\tvar buffers = [\r\n\t\t\t'__webglVertexBuffer',\r\n\t\t\t'__webglNormalBuffer',\r\n\t\t\t'__webglTangentBuffer',\r\n\t\t\t'__webglColorBuffer',\r\n\t\t\t'__webglUVBuffer',\r\n\t\t\t'__webglUV2Buffer',\r\n\r\n\t\t\t'__webglSkinIndicesBuffer',\r\n\t\t\t'__webglSkinWeightsBuffer',\r\n\r\n\t\t\t'__webglFaceBuffer',\r\n\t\t\t'__webglLineBuffer',\r\n\r\n\t\t\t'__webglLineDistanceBuffer'\r\n\t\t];\r\n\r\n\t\tfor ( var i = 0, l = buffers.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar name = buffers[ i ];\r\n\r\n\t\t\tif ( geometry[ name ] !== undefined ) {\r\n\r\n\t\t\t\t_gl.deleteBuffer( geometry[ name ] );\r\n\r\n\t\t\t\tdelete geometry[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// custom attributes\r\n\r\n\t\tif ( geometry.__webglCustomAttributesList !== undefined ) {\r\n\r\n\t\t\tfor ( var name in geometry.__webglCustomAttributesList ) {\r\n\r\n\t\t\t\t_gl.deleteBuffer( geometry.__webglCustomAttributesList[ name ].buffer );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdelete geometry.__webglCustomAttributesList;\r\n\r\n\t\t}\r\n\r\n\t\t_this.info.memory.geometries --;\r\n\r\n\t};\r\n\r\n\tvar deallocateGeometry = function ( geometry ) {\r\n\r\n\t\tdelete geometry.__webglInit;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tfor ( var name in geometry.attributes ) {\r\n\r\n\t\t\t\tvar attribute = geometry.attributes[ name ];\r\n\r\n\t\t\t\tif ( attribute.buffer !== undefined ) {\r\n\r\n\t\t\t\t\t_gl.deleteBuffer( attribute.buffer );\r\n\r\n\t\t\t\t\tdelete attribute.buffer;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_this.info.memory.geometries --;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar geometryGroupsList = geometryGroups[ geometry.id ];\r\n\r\n\t\t\tif ( geometryGroupsList !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = geometryGroupsList.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar geometryGroup = geometryGroupsList[ i ];\r\n\r\n\t\t\t\t\tif ( geometryGroup.numMorphTargets !== undefined ) {\r\n\r\n\t\t\t\t\t\tfor ( var m = 0, ml = geometryGroup.numMorphTargets; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\t\t_gl.deleteBuffer( geometryGroup.__webglMorphTargetsBuffers[ m ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdelete geometryGroup.__webglMorphTargetsBuffers;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( geometryGroup.numMorphNormals !== undefined ) {\r\n\r\n\t\t\t\t\t\tfor ( var m = 0, ml = geometryGroup.numMorphNormals; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\t\t_gl.deleteBuffer( geometryGroup.__webglMorphNormalsBuffers[ m ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdelete geometryGroup.__webglMorphNormalsBuffers;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdeleteBuffers( geometryGroup );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete geometryGroups[ geometry.id ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdeleteBuffers( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// TOFIX: Workaround for deleted geometry being currently bound\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\r\n\t};\r\n\r\n\tvar deallocateTexture = function ( texture ) {\r\n\r\n\t\tif ( texture.image && texture.image.__webglTextureCube ) {\r\n\r\n\t\t\t// cube texture\r\n\r\n\t\t\t_gl.deleteTexture( texture.image.__webglTextureCube );\r\n\r\n\t\t\tdelete texture.image.__webglTextureCube;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// 2D texture\r\n\r\n\t\t\tif ( texture.__webglInit === undefined ) return;\r\n\r\n\t\t\t_gl.deleteTexture( texture.__webglTexture );\r\n\r\n\t\t\tdelete texture.__webglTexture;\r\n\t\t\tdelete texture.__webglInit;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tvar deallocateRenderTarget = function ( renderTarget ) {\r\n\r\n\t\tif ( ! renderTarget || renderTarget.__webglTexture === undefined ) return;\r\n\r\n\t\t_gl.deleteTexture( renderTarget.__webglTexture );\r\n\r\n\t\tdelete renderTarget.__webglTexture;\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTarget.__webglFramebuffer[ i ] );\r\n\t\t\t\t_gl.deleteRenderbuffer( renderTarget.__webglRenderbuffer[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.deleteFramebuffer( renderTarget.__webglFramebuffer );\r\n\t\t\t_gl.deleteRenderbuffer( renderTarget.__webglRenderbuffer );\r\n\r\n\t\t}\r\n\r\n\t\tdelete renderTarget.__webglFramebuffer;\r\n\t\tdelete renderTarget.__webglRenderbuffer;\r\n\r\n\t};\r\n\r\n\tvar deallocateMaterial = function ( material ) {\r\n\r\n\t\tvar program = material.program.program;\r\n\r\n\t\tif ( program === undefined ) return;\r\n\r\n\t\tmaterial.program = undefined;\r\n\r\n\t\t// only deallocate GL program if this was the last use of shared program\r\n\t\t// assumed there is only single copy of any program in the _programs list\r\n\t\t// (that's how it's constructed)\r\n\r\n\t\tvar i, il, programInfo;\r\n\t\tvar deleteProgram = false;\r\n\r\n\t\tfor ( i = 0, il = _programs.length; i < il; i ++ ) {\r\n\r\n\t\t\tprogramInfo = _programs[ i ];\r\n\r\n\t\t\tif ( programInfo.program === program ) {\r\n\r\n\t\t\t\tprogramInfo.usedTimes --;\r\n\r\n\t\t\t\tif ( programInfo.usedTimes === 0 ) {\r\n\r\n\t\t\t\t\tdeleteProgram = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( deleteProgram === true ) {\r\n\r\n\t\t\t// avoid using array.splice, this is costlier than creating new array from scratch\r\n\r\n\t\t\tvar newPrograms = [];\r\n\r\n\t\t\tfor ( i = 0, il = _programs.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tprogramInfo = _programs[ i ];\r\n\r\n\t\t\t\tif ( programInfo.program !== program ) {\r\n\r\n\t\t\t\t\tnewPrograms.push( programInfo );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_programs = newPrograms;\r\n\r\n\t\t\t_gl.deleteProgram( program );\r\n\r\n\t\t\t_this.info.memory.programs --;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Buffer initialization\r\n\r\n\tfunction initCustomAttributes ( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\t\tvar material = object.material;\r\n\r\n\t\tvar nvertices = geometry.vertices.length;\r\n\r\n\t\tif ( material.attributes ) {\r\n\r\n\t\t\tif ( geometry.__webglCustomAttributesList === undefined ) {\r\n\r\n\t\t\t\tgeometry.__webglCustomAttributesList = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in material.attributes ) {\r\n\r\n\t\t\t\tvar attribute = material.attributes[ name ];\r\n\r\n\t\t\t\tif ( ! attribute.__webglInitialized || attribute.createUniqueBuffers ) {\r\n\r\n\t\t\t\t\tattribute.__webglInitialized = true;\r\n\r\n\t\t\t\t\tvar size = 1;   // \"f\" and \"i\"\r\n\r\n\t\t\t\t\tif ( attribute.type === 'v2' ) size = 2;\r\n\t\t\t\t\telse if ( attribute.type === 'v3' ) size = 3;\r\n\t\t\t\t\telse if ( attribute.type === 'v4' ) size = 4;\r\n\t\t\t\t\telse if ( attribute.type === 'c'  ) size = 3;\r\n\r\n\t\t\t\t\tattribute.size = size;\r\n\r\n\t\t\t\t\tattribute.array = new Float32Array( nvertices * size );\r\n\r\n\t\t\t\t\tattribute.buffer = _gl.createBuffer();\r\n\t\t\t\t\tattribute.buffer.belongsToAttribute = name;\r\n\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.__webglCustomAttributesList.push( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction initParticleBuffers ( geometry, object ) {\r\n\r\n\t\tvar nvertices = geometry.vertices.length;\r\n\r\n\t\tgeometry.__vertexArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometry.__colorArray = new Float32Array( nvertices * 3 );\r\n\r\n\t\tgeometry.__webglParticleCount = nvertices;\r\n\r\n\t\tinitCustomAttributes( object );\r\n\r\n\t};\r\n\r\n\tfunction initLineBuffers ( geometry, object ) {\r\n\r\n\t\tvar nvertices = geometry.vertices.length;\r\n\r\n\t\tgeometry.__vertexArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometry.__colorArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometry.__lineDistanceArray = new Float32Array( nvertices * 1 );\r\n\r\n\t\tgeometry.__webglLineCount = nvertices;\r\n\r\n\t\tinitCustomAttributes( object );\r\n\r\n\t};\r\n\r\n\tfunction initMeshBuffers ( geometryGroup, object ) {\r\n\r\n\t\tvar geometry = object.geometry,\r\n\t\t\tfaces3 = geometryGroup.faces3,\r\n\r\n\t\t\tnvertices = faces3.length * 3,\r\n\t\t\tntris     = faces3.length * 1,\r\n\t\t\tnlines    = faces3.length * 3,\r\n\r\n\t\t\tmaterial = getBufferMaterial( object, geometryGroup );\r\n\r\n\t\tgeometryGroup.__vertexArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometryGroup.__normalArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometryGroup.__colorArray = new Float32Array( nvertices * 3 );\r\n\t\tgeometryGroup.__uvArray = new Float32Array( nvertices * 2 );\r\n\r\n\t\tif ( geometry.faceVertexUvs.length > 1 ) {\r\n\r\n\t\t\tgeometryGroup.__uv2Array = new Float32Array( nvertices * 2 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.hasTangents ) {\r\n\r\n\t\t\tgeometryGroup.__tangentArray = new Float32Array( nvertices * 4 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.geometry.skinWeights.length && object.geometry.skinIndices.length ) {\r\n\r\n\t\t\tgeometryGroup.__skinIndexArray = new Float32Array( nvertices * 4 );\r\n\t\t\tgeometryGroup.__skinWeightArray = new Float32Array( nvertices * 4 );\r\n\r\n\t\t}\r\n\r\n\t\tvar UintArray = extensions.get( 'OES_element_index_uint' ) !== null && ntris > 21845 ? Uint32Array : Uint16Array; // 65535 / 3\r\n\r\n\t\tgeometryGroup.__typeArray = UintArray;\r\n\t\tgeometryGroup.__faceArray = new UintArray( ntris * 3 );\r\n\t\tgeometryGroup.__lineArray = new UintArray( nlines * 2 );\r\n\r\n\t\tvar numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n\t\tif ( numMorphTargets ) {\r\n\r\n\t\t\tgeometryGroup.__morphTargetsArrays = [];\r\n\r\n\t\t\tfor ( var m = 0, ml = numMorphTargets; m < ml; m ++ ) {\r\n\r\n\t\t\t\tgeometryGroup.__morphTargetsArrays.push( new Float32Array( nvertices * 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n\t\tif ( numMorphNormals ) {\r\n\r\n\t\t\tgeometryGroup.__morphNormalsArrays = [];\r\n\r\n\t\t\tfor ( var m = 0, ml = numMorphNormals; m < ml; m ++ ) {\r\n\r\n\t\t\t\tgeometryGroup.__morphNormalsArrays.push( new Float32Array( nvertices * 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometryGroup.__webglFaceCount = ntris * 3;\r\n\t\tgeometryGroup.__webglLineCount = nlines * 2;\r\n\r\n\r\n\t\t// custom attributes\r\n\r\n\t\tif ( material.attributes ) {\r\n\r\n\t\t\tif ( geometryGroup.__webglCustomAttributesList === undefined ) {\r\n\r\n\t\t\t\tgeometryGroup.__webglCustomAttributesList = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in material.attributes ) {\r\n\r\n\t\t\t\t// Do a shallow copy of the attribute object so different geometryGroup chunks use different\r\n\t\t\t\t// attribute buffers which are correctly indexed in the setMeshBuffers function\r\n\r\n\t\t\t\tvar originalAttribute = material.attributes[ name ];\r\n\r\n\t\t\t\tvar attribute = {};\r\n\r\n\t\t\t\tfor ( var property in originalAttribute ) {\r\n\r\n\t\t\t\t\tattribute[ property ] = originalAttribute[ property ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! attribute.__webglInitialized || attribute.createUniqueBuffers ) {\r\n\r\n\t\t\t\t\tattribute.__webglInitialized = true;\r\n\r\n\t\t\t\t\tvar size = 1;   // \"f\" and \"i\"\r\n\r\n\t\t\t\t\tif ( attribute.type === 'v2' ) size = 2;\r\n\t\t\t\t\telse if ( attribute.type === 'v3' ) size = 3;\r\n\t\t\t\t\telse if ( attribute.type === 'v4' ) size = 4;\r\n\t\t\t\t\telse if ( attribute.type === 'c'  ) size = 3;\r\n\r\n\t\t\t\t\tattribute.size = size;\r\n\r\n\t\t\t\t\tattribute.array = new Float32Array( nvertices * size );\r\n\r\n\t\t\t\t\tattribute.buffer = _gl.createBuffer();\r\n\t\t\t\t\tattribute.buffer.belongsToAttribute = name;\r\n\r\n\t\t\t\t\toriginalAttribute.needsUpdate = true;\r\n\t\t\t\t\tattribute.__original = originalAttribute;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometryGroup.__webglCustomAttributesList.push( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometryGroup.__inittedArrays = true;\r\n\r\n\t};\r\n\r\n\tfunction getBufferMaterial( object, geometryGroup ) {\r\n\r\n\t\treturn object.material instanceof THREE.MeshFaceMaterial\r\n\t\t\t ? object.material.materials[ geometryGroup.materialIndex ]\r\n\t\t\t : object.material;\r\n\r\n\t}\r\n\r\n\tfunction materialNeedsFaceNormals ( material ) {\r\n\r\n\t\treturn material instanceof THREE.MeshPhongMaterial === false && material.shading === THREE.FlatShading;\r\n\r\n\t}\r\n\r\n\t// Buffer setting\r\n\r\n\tfunction setParticleBuffers ( geometry, hint, object ) {\r\n\r\n\t\tvar v, c, vertex, offset, color,\r\n\r\n\t\tvertices = geometry.vertices,\r\n\t\tvl = vertices.length,\r\n\r\n\t\tcolors = geometry.colors,\r\n\t\tcl = colors.length,\r\n\r\n\t\tvertexArray = geometry.__vertexArray,\r\n\t\tcolorArray = geometry.__colorArray,\r\n\r\n\t\tdirtyVertices = geometry.verticesNeedUpdate,\r\n\t\tdirtyColors = geometry.colorsNeedUpdate,\r\n\r\n\t\tcustomAttributes = geometry.__webglCustomAttributesList,\r\n\t\ti, il,\r\n\t\tca, cal, value,\r\n\t\tcustomAttribute;\r\n\r\n\t\tif ( dirtyVertices ) {\r\n\r\n\t\t\tfor ( v = 0; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertex = vertices[ v ];\r\n\r\n\t\t\t\toffset = v * 3;\r\n\r\n\t\t\t\tvertexArray[ offset ]     = vertex.x;\r\n\t\t\t\tvertexArray[ offset + 1 ] = vertex.y;\r\n\t\t\t\tvertexArray[ offset + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometry.__webglVertexBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, vertexArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyColors ) {\r\n\r\n\t\t\tfor ( c = 0; c < cl; c ++ ) {\r\n\r\n\t\t\t\tcolor = colors[ c ];\r\n\r\n\t\t\t\toffset = c * 3;\r\n\r\n\t\t\t\tcolorArray[ offset ]     = color.r;\r\n\t\t\t\tcolorArray[ offset + 1 ] = color.g;\r\n\t\t\t\tcolorArray[ offset + 2 ] = color.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometry.__webglColorBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, colorArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( customAttributes ) {\r\n\r\n\t\t\tfor ( i = 0, il = customAttributes.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tcustomAttribute = customAttributes[ i ];\r\n\r\n\t\t\t\tif ( customAttribute.needsUpdate && ( customAttribute.boundTo === undefined ||  customAttribute.boundTo === 'vertices' ) ) {\r\n\r\n\t\t\t\t\tcal = customAttribute.value.length;\r\n\r\n\t\t\t\t\toffset = 0;\r\n\r\n\t\t\t\t\tif ( customAttribute.size === 1 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ ca ] = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 2 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.y;\r\n\r\n\t\t\t\t\t\t\toffset += 2;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 3 ) {\r\n\r\n\t\t\t\t\t\tif ( customAttribute.type === 'c' ) {\r\n\r\n\t\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.r;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.g;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2 ] = value.b;\r\n\r\n\t\t\t\t\t\t\t\toffset += 3;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.x;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.y;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2 ] = value.z;\r\n\r\n\t\t\t\t\t\t\t\toffset += 3;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 4 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset ]      = value.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1  ] = value.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2  ] = value.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 3  ] = value.w;\r\n\r\n\t\t\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, customAttribute.buffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, customAttribute.array, hint );\r\n\r\n\t\t\t\tcustomAttribute.needsUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setLineBuffers ( geometry, hint ) {\r\n\r\n\t\tvar v, c, d, vertex, offset, color,\r\n\r\n\t\tvertices = geometry.vertices,\r\n\t\tcolors = geometry.colors,\r\n\t\tlineDistances = geometry.lineDistances,\r\n\r\n\t\tvl = vertices.length,\r\n\t\tcl = colors.length,\r\n\t\tdl = lineDistances.length,\r\n\r\n\t\tvertexArray = geometry.__vertexArray,\r\n\t\tcolorArray = geometry.__colorArray,\r\n\t\tlineDistanceArray = geometry.__lineDistanceArray,\r\n\r\n\t\tdirtyVertices = geometry.verticesNeedUpdate,\r\n\t\tdirtyColors = geometry.colorsNeedUpdate,\r\n\t\tdirtyLineDistances = geometry.lineDistancesNeedUpdate,\r\n\r\n\t\tcustomAttributes = geometry.__webglCustomAttributesList,\r\n\r\n\t\ti, il,\r\n\t\tca, cal, value,\r\n\t\tcustomAttribute;\r\n\r\n\t\tif ( dirtyVertices ) {\r\n\r\n\t\t\tfor ( v = 0; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertex = vertices[ v ];\r\n\r\n\t\t\t\toffset = v * 3;\r\n\r\n\t\t\t\tvertexArray[ offset ]     = vertex.x;\r\n\t\t\t\tvertexArray[ offset + 1 ] = vertex.y;\r\n\t\t\t\tvertexArray[ offset + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometry.__webglVertexBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, vertexArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyColors ) {\r\n\r\n\t\t\tfor ( c = 0; c < cl; c ++ ) {\r\n\r\n\t\t\t\tcolor = colors[ c ];\r\n\r\n\t\t\t\toffset = c * 3;\r\n\r\n\t\t\t\tcolorArray[ offset ]     = color.r;\r\n\t\t\t\tcolorArray[ offset + 1 ] = color.g;\r\n\t\t\t\tcolorArray[ offset + 2 ] = color.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometry.__webglColorBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, colorArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyLineDistances ) {\r\n\r\n\t\t\tfor ( d = 0; d < dl; d ++ ) {\r\n\r\n\t\t\t\tlineDistanceArray[ d ] = lineDistances[ d ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometry.__webglLineDistanceBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, lineDistanceArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( customAttributes ) {\r\n\r\n\t\t\tfor ( i = 0, il = customAttributes.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tcustomAttribute = customAttributes[ i ];\r\n\r\n\t\t\t\tif ( customAttribute.needsUpdate && ( customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices' ) ) {\r\n\r\n\t\t\t\t\toffset = 0;\r\n\r\n\t\t\t\t\tcal = customAttribute.value.length;\r\n\r\n\t\t\t\t\tif ( customAttribute.size === 1 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ ca ] = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 2 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.y;\r\n\r\n\t\t\t\t\t\t\toffset += 2;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 3 ) {\r\n\r\n\t\t\t\t\t\tif ( customAttribute.type === 'c' ) {\r\n\r\n\t\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.r;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.g;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2 ] = value.b;\r\n\r\n\t\t\t\t\t\t\t\toffset += 3;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset ]   = value.x;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1 ] = value.y;\r\n\t\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2 ] = value.z;\r\n\r\n\t\t\t\t\t\t\t\toffset += 3;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.size === 4 ) {\r\n\r\n\t\t\t\t\t\tfor ( ca = 0; ca < cal; ca ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ ca ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset ]    = value.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 1  ] = value.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 2  ] = value.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset + 3  ] = value.w;\r\n\r\n\t\t\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, customAttribute.buffer );\r\n\t\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, customAttribute.array, hint );\r\n\r\n\t\t\t\t\tcustomAttribute.needsUpdate = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setMeshBuffers( geometryGroup, object, hint, dispose, material ) {\r\n\r\n\t\tif ( ! geometryGroup.__inittedArrays ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar needsFaceNormals = materialNeedsFaceNormals( material );\r\n\r\n\t\tvar f, fl, fi, face,\r\n\t\tvertexNormals, faceNormal,\r\n\t\tvertexColors, faceColor,\r\n\t\tvertexTangents,\r\n\t\tuv, uv2, v1, v2, v3, t1, t2, t3, n1, n2, n3,\r\n\t\tc1, c2, c3,\r\n\t\tsw1, sw2, sw3,\r\n\t\tsi1, si2, si3,\r\n\t\ti, il,\r\n\t\tvn, uvi, uv2i,\r\n\t\tvk, vkl, vka,\r\n\t\tnka, chf, faceVertexNormals,\r\n\r\n\t\tvertexIndex = 0,\r\n\r\n\t\toffset = 0,\r\n\t\toffset_uv = 0,\r\n\t\toffset_uv2 = 0,\r\n\t\toffset_face = 0,\r\n\t\toffset_normal = 0,\r\n\t\toffset_tangent = 0,\r\n\t\toffset_line = 0,\r\n\t\toffset_color = 0,\r\n\t\toffset_skin = 0,\r\n\t\toffset_morphTarget = 0,\r\n\t\toffset_custom = 0,\r\n\r\n\t\tvalue,\r\n\r\n\t\tvertexArray = geometryGroup.__vertexArray,\r\n\t\tuvArray = geometryGroup.__uvArray,\r\n\t\tuv2Array = geometryGroup.__uv2Array,\r\n\t\tnormalArray = geometryGroup.__normalArray,\r\n\t\ttangentArray = geometryGroup.__tangentArray,\r\n\t\tcolorArray = geometryGroup.__colorArray,\r\n\r\n\t\tskinIndexArray = geometryGroup.__skinIndexArray,\r\n\t\tskinWeightArray = geometryGroup.__skinWeightArray,\r\n\r\n\t\tmorphTargetsArrays = geometryGroup.__morphTargetsArrays,\r\n\t\tmorphNormalsArrays = geometryGroup.__morphNormalsArrays,\r\n\r\n\t\tcustomAttributes = geometryGroup.__webglCustomAttributesList,\r\n\t\tcustomAttribute,\r\n\r\n\t\tfaceArray = geometryGroup.__faceArray,\r\n\t\tlineArray = geometryGroup.__lineArray,\r\n\r\n\t\tgeometry = object.geometry, // this is shared for all chunks\r\n\r\n\t\tdirtyVertices = geometry.verticesNeedUpdate,\r\n\t\tdirtyElements = geometry.elementsNeedUpdate,\r\n\t\tdirtyUvs = geometry.uvsNeedUpdate,\r\n\t\tdirtyNormals = geometry.normalsNeedUpdate,\r\n\t\tdirtyTangents = geometry.tangentsNeedUpdate,\r\n\t\tdirtyColors = geometry.colorsNeedUpdate,\r\n\t\tdirtyMorphTargets = geometry.morphTargetsNeedUpdate,\r\n\r\n\t\tvertices = geometry.vertices,\r\n\t\tchunk_faces3 = geometryGroup.faces3,\r\n\t\tobj_faces = geometry.faces,\r\n\r\n\t\tobj_uvs  = geometry.faceVertexUvs[ 0 ],\r\n\t\tobj_uvs2 = geometry.faceVertexUvs[ 1 ],\r\n\r\n\t\tobj_skinIndices = geometry.skinIndices,\r\n\t\tobj_skinWeights = geometry.skinWeights,\r\n\r\n\t\tmorphTargets = geometry.morphTargets,\r\n\t\tmorphNormals = geometry.morphNormals;\r\n\r\n\t\tif ( dirtyVertices ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\tv1 = vertices[ face.a ];\r\n\t\t\t\tv2 = vertices[ face.b ];\r\n\t\t\t\tv3 = vertices[ face.c ];\r\n\r\n\t\t\t\tvertexArray[ offset ]     = v1.x;\r\n\t\t\t\tvertexArray[ offset + 1 ] = v1.y;\r\n\t\t\t\tvertexArray[ offset + 2 ] = v1.z;\r\n\r\n\t\t\t\tvertexArray[ offset + 3 ] = v2.x;\r\n\t\t\t\tvertexArray[ offset + 4 ] = v2.y;\r\n\t\t\t\tvertexArray[ offset + 5 ] = v2.z;\r\n\r\n\t\t\t\tvertexArray[ offset + 6 ] = v3.x;\r\n\t\t\t\tvertexArray[ offset + 7 ] = v3.y;\r\n\t\t\t\tvertexArray[ offset + 8 ] = v3.z;\r\n\r\n\t\t\t\toffset += 9;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, vertexArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyMorphTargets ) {\r\n\r\n\t\t\tfor ( vk = 0, vkl = morphTargets.length; vk < vkl; vk ++ ) {\r\n\r\n\t\t\t\toffset_morphTarget = 0;\r\n\r\n\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tchf = chunk_faces3[ f ];\r\n\t\t\t\t\tface = obj_faces[ chf ];\r\n\r\n\t\t\t\t\t// morph positions\r\n\r\n\t\t\t\t\tv1 = morphTargets[ vk ].vertices[ face.a ];\r\n\t\t\t\t\tv2 = morphTargets[ vk ].vertices[ face.b ];\r\n\t\t\t\t\tv3 = morphTargets[ vk ].vertices[ face.c ];\r\n\r\n\t\t\t\t\tvka = morphTargetsArrays[ vk ];\r\n\r\n\t\t\t\t\tvka[ offset_morphTarget ]     = v1.x;\r\n\t\t\t\t\tvka[ offset_morphTarget + 1 ] = v1.y;\r\n\t\t\t\t\tvka[ offset_morphTarget + 2 ] = v1.z;\r\n\r\n\t\t\t\t\tvka[ offset_morphTarget + 3 ] = v2.x;\r\n\t\t\t\t\tvka[ offset_morphTarget + 4 ] = v2.y;\r\n\t\t\t\t\tvka[ offset_morphTarget + 5 ] = v2.z;\r\n\r\n\t\t\t\t\tvka[ offset_morphTarget + 6 ] = v3.x;\r\n\t\t\t\t\tvka[ offset_morphTarget + 7 ] = v3.y;\r\n\t\t\t\t\tvka[ offset_morphTarget + 8 ] = v3.z;\r\n\r\n\t\t\t\t\t// morph normals\r\n\r\n\t\t\t\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\t\t\t\tif ( needsFaceNormals ) {\r\n\r\n\t\t\t\t\t\t\tn1 = morphNormals[ vk ].faceNormals[ chf ];\r\n\t\t\t\t\t\t\tn2 = n1;\r\n\t\t\t\t\t\t\tn3 = n1;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tfaceVertexNormals = morphNormals[ vk ].vertexNormals[ chf ];\r\n\r\n\t\t\t\t\t\t\tn1 = faceVertexNormals.a;\r\n\t\t\t\t\t\t\tn2 = faceVertexNormals.b;\r\n\t\t\t\t\t\t\tn3 = faceVertexNormals.c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnka = morphNormalsArrays[ vk ];\r\n\r\n\t\t\t\t\t\tnka[ offset_morphTarget ]     = n1.x;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 1 ] = n1.y;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 2 ] = n1.z;\r\n\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 3 ] = n2.x;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 4 ] = n2.y;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 5 ] = n2.z;\r\n\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 6 ] = n3.x;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 7 ] = n3.y;\r\n\t\t\t\t\t\tnka[ offset_morphTarget + 8 ] = n3.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\toffset_morphTarget += 9;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[ vk ] );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, morphTargetsArrays[ vk ], hint );\r\n\r\n\t\t\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[ vk ] );\r\n\t\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, morphNormalsArrays[ vk ], hint );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( obj_skinWeights.length ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t// weights\r\n\r\n\t\t\t\tsw1 = obj_skinWeights[ face.a ];\r\n\t\t\t\tsw2 = obj_skinWeights[ face.b ];\r\n\t\t\t\tsw3 = obj_skinWeights[ face.c ];\r\n\r\n\t\t\t\tskinWeightArray[ offset_skin ]     = sw1.x;\r\n\t\t\t\tskinWeightArray[ offset_skin + 1 ] = sw1.y;\r\n\t\t\t\tskinWeightArray[ offset_skin + 2 ] = sw1.z;\r\n\t\t\t\tskinWeightArray[ offset_skin + 3 ] = sw1.w;\r\n\r\n\t\t\t\tskinWeightArray[ offset_skin + 4 ] = sw2.x;\r\n\t\t\t\tskinWeightArray[ offset_skin + 5 ] = sw2.y;\r\n\t\t\t\tskinWeightArray[ offset_skin + 6 ] = sw2.z;\r\n\t\t\t\tskinWeightArray[ offset_skin + 7 ] = sw2.w;\r\n\r\n\t\t\t\tskinWeightArray[ offset_skin + 8 ]  = sw3.x;\r\n\t\t\t\tskinWeightArray[ offset_skin + 9 ]  = sw3.y;\r\n\t\t\t\tskinWeightArray[ offset_skin + 10 ] = sw3.z;\r\n\t\t\t\tskinWeightArray[ offset_skin + 11 ] = sw3.w;\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\tsi1 = obj_skinIndices[ face.a ];\r\n\t\t\t\tsi2 = obj_skinIndices[ face.b ];\r\n\t\t\t\tsi3 = obj_skinIndices[ face.c ];\r\n\r\n\t\t\t\tskinIndexArray[ offset_skin ]     = si1.x;\r\n\t\t\t\tskinIndexArray[ offset_skin + 1 ] = si1.y;\r\n\t\t\t\tskinIndexArray[ offset_skin + 2 ] = si1.z;\r\n\t\t\t\tskinIndexArray[ offset_skin + 3 ] = si1.w;\r\n\r\n\t\t\t\tskinIndexArray[ offset_skin + 4 ] = si2.x;\r\n\t\t\t\tskinIndexArray[ offset_skin + 5 ] = si2.y;\r\n\t\t\t\tskinIndexArray[ offset_skin + 6 ] = si2.z;\r\n\t\t\t\tskinIndexArray[ offset_skin + 7 ] = si2.w;\r\n\r\n\t\t\t\tskinIndexArray[ offset_skin + 8 ]  = si3.x;\r\n\t\t\t\tskinIndexArray[ offset_skin + 9 ]  = si3.y;\r\n\t\t\t\tskinIndexArray[ offset_skin + 10 ] = si3.z;\r\n\t\t\t\tskinIndexArray[ offset_skin + 11 ] = si3.w;\r\n\r\n\t\t\t\toffset_skin += 12;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset_skin > 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, skinIndexArray, hint );\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, skinWeightArray, hint );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyColors ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\tvertexColors = face.vertexColors;\r\n\t\t\t\tfaceColor = face.color;\r\n\r\n\t\t\t\tif ( vertexColors.length === 3 && material.vertexColors === THREE.VertexColors ) {\r\n\r\n\t\t\t\t\tc1 = vertexColors[ 0 ];\r\n\t\t\t\t\tc2 = vertexColors[ 1 ];\r\n\t\t\t\t\tc3 = vertexColors[ 2 ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tc1 = faceColor;\r\n\t\t\t\t\tc2 = faceColor;\r\n\t\t\t\t\tc3 = faceColor;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolorArray[ offset_color ]     = c1.r;\r\n\t\t\t\tcolorArray[ offset_color + 1 ] = c1.g;\r\n\t\t\t\tcolorArray[ offset_color + 2 ] = c1.b;\r\n\r\n\t\t\t\tcolorArray[ offset_color + 3 ] = c2.r;\r\n\t\t\t\tcolorArray[ offset_color + 4 ] = c2.g;\r\n\t\t\t\tcolorArray[ offset_color + 5 ] = c2.b;\r\n\r\n\t\t\t\tcolorArray[ offset_color + 6 ] = c3.r;\r\n\t\t\t\tcolorArray[ offset_color + 7 ] = c3.g;\r\n\t\t\t\tcolorArray[ offset_color + 8 ] = c3.b;\r\n\r\n\t\t\t\toffset_color += 9;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset_color > 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, colorArray, hint );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyTangents && geometry.hasTangents ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\tvertexTangents = face.vertexTangents;\r\n\r\n\t\t\t\tt1 = vertexTangents[ 0 ];\r\n\t\t\t\tt2 = vertexTangents[ 1 ];\r\n\t\t\t\tt3 = vertexTangents[ 2 ];\r\n\r\n\t\t\t\ttangentArray[ offset_tangent ]     = t1.x;\r\n\t\t\t\ttangentArray[ offset_tangent + 1 ] = t1.y;\r\n\t\t\t\ttangentArray[ offset_tangent + 2 ] = t1.z;\r\n\t\t\t\ttangentArray[ offset_tangent + 3 ] = t1.w;\r\n\r\n\t\t\t\ttangentArray[ offset_tangent + 4 ] = t2.x;\r\n\t\t\t\ttangentArray[ offset_tangent + 5 ] = t2.y;\r\n\t\t\t\ttangentArray[ offset_tangent + 6 ] = t2.z;\r\n\t\t\t\ttangentArray[ offset_tangent + 7 ] = t2.w;\r\n\r\n\t\t\t\ttangentArray[ offset_tangent + 8 ]  = t3.x;\r\n\t\t\t\ttangentArray[ offset_tangent + 9 ]  = t3.y;\r\n\t\t\t\ttangentArray[ offset_tangent + 10 ] = t3.z;\r\n\t\t\t\ttangentArray[ offset_tangent + 11 ] = t3.w;\r\n\r\n\t\t\t\toffset_tangent += 12;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, tangentArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyNormals ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\tvertexNormals = face.vertexNormals;\r\n\t\t\t\tfaceNormal = face.normal;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 && needsFaceNormals === false ) {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\tvn = vertexNormals[ i ];\r\n\r\n\t\t\t\t\t\tnormalArray[ offset_normal ]     = vn.x;\r\n\t\t\t\t\t\tnormalArray[ offset_normal + 1 ] = vn.y;\r\n\t\t\t\t\t\tnormalArray[ offset_normal + 2 ] = vn.z;\r\n\r\n\t\t\t\t\t\toffset_normal += 3;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\tnormalArray[ offset_normal ]     = faceNormal.x;\r\n\t\t\t\t\t\tnormalArray[ offset_normal + 1 ] = faceNormal.y;\r\n\t\t\t\t\t\tnormalArray[ offset_normal + 2 ] = faceNormal.z;\r\n\r\n\t\t\t\t\t\toffset_normal += 3;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, normalArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyUvs && obj_uvs ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tfi = chunk_faces3[ f ];\r\n\r\n\t\t\t\tuv = obj_uvs[ fi ];\r\n\r\n\t\t\t\tif ( uv === undefined ) continue;\r\n\r\n\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\tuvi = uv[ i ];\r\n\r\n\t\t\t\t\tuvArray[ offset_uv ]     = uvi.x;\r\n\t\t\t\t\tuvArray[ offset_uv + 1 ] = uvi.y;\r\n\r\n\t\t\t\t\toffset_uv += 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset_uv > 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, uvArray, hint );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyUvs && obj_uvs2 ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tfi = chunk_faces3[ f ];\r\n\r\n\t\t\t\tuv2 = obj_uvs2[ fi ];\r\n\r\n\t\t\t\tif ( uv2 === undefined ) continue;\r\n\r\n\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\tuv2i = uv2[ i ];\r\n\r\n\t\t\t\t\tuv2Array[ offset_uv2 ]     = uv2i.x;\r\n\t\t\t\t\tuv2Array[ offset_uv2 + 1 ] = uv2i.y;\r\n\r\n\t\t\t\t\toffset_uv2 += 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset_uv2 > 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, uv2Array, hint );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirtyElements ) {\r\n\r\n\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tfaceArray[ offset_face ]   = vertexIndex;\r\n\t\t\t\tfaceArray[ offset_face + 1 ] = vertexIndex + 1;\r\n\t\t\t\tfaceArray[ offset_face + 2 ] = vertexIndex + 2;\r\n\r\n\t\t\t\toffset_face += 3;\r\n\r\n\t\t\t\tlineArray[ offset_line ]     = vertexIndex;\r\n\t\t\t\tlineArray[ offset_line + 1 ] = vertexIndex + 1;\r\n\r\n\t\t\t\tlineArray[ offset_line + 2 ] = vertexIndex;\r\n\t\t\t\tlineArray[ offset_line + 3 ] = vertexIndex + 2;\r\n\r\n\t\t\t\tlineArray[ offset_line + 4 ] = vertexIndex + 1;\r\n\t\t\t\tlineArray[ offset_line + 5 ] = vertexIndex + 2;\r\n\r\n\t\t\t\toffset_line += 6;\r\n\r\n\t\t\t\tvertexIndex += 3;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer );\r\n\t\t\t_gl.bufferData( _gl.ELEMENT_ARRAY_BUFFER, faceArray, hint );\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer );\r\n\t\t\t_gl.bufferData( _gl.ELEMENT_ARRAY_BUFFER, lineArray, hint );\r\n\r\n\t\t}\r\n\r\n\t\tif ( customAttributes ) {\r\n\r\n\t\t\tfor ( i = 0, il = customAttributes.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tcustomAttribute = customAttributes[ i ];\r\n\r\n\t\t\t\tif ( ! customAttribute.__original.needsUpdate ) continue;\r\n\r\n\t\t\t\toffset_custom = 0;\r\n\r\n\t\t\t\tif ( customAttribute.size === 1 ) {\r\n\r\n\t\t\t\t\tif ( customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = customAttribute.value[ face.a ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = customAttribute.value[ face.b ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = customAttribute.value[ face.c ];\r\n\r\n\t\t\t\t\t\t\toffset_custom += 3;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faces' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = value;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = value;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = value;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 3;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( customAttribute.size === 2 ) {\r\n\r\n\t\t\t\t\tif ( customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = customAttribute.value[ face.a ];\r\n\t\t\t\t\t\t\tv2 = customAttribute.value[ face.b ];\r\n\t\t\t\t\t\t\tv3 = customAttribute.value[ face.c ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = v1.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = v1.y;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = v2.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3 ] = v2.y;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4 ] = v3.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5 ] = v3.y;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 6;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faces' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = value;\r\n\t\t\t\t\t\t\tv2 = value;\r\n\t\t\t\t\t\t\tv3 = value;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = v1.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = v1.y;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = v2.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3 ] = v2.y;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4 ] = v3.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5 ] = v3.y;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 6;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( customAttribute.size === 3 ) {\r\n\r\n\t\t\t\t\tvar pp;\r\n\r\n\t\t\t\t\tif ( customAttribute.type === 'c' ) {\r\n\r\n\t\t\t\t\t\tpp = [ 'r', 'g', 'b' ];\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tpp = [ 'x', 'y', 'z' ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = customAttribute.value[ face.a ];\r\n\t\t\t\t\t\t\tv2 = customAttribute.value[ face.b ];\r\n\t\t\t\t\t\t\tv3 = customAttribute.value[ face.c ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = v1[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = v1[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = v1[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3 ] = v2[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4 ] = v2[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5 ] = v2[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6 ] = v3[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7 ] = v3[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8 ] = v3[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\toffset_custom += 9;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faces' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = value;\r\n\t\t\t\t\t\t\tv2 = value;\r\n\t\t\t\t\t\t\tv3 = value;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = v1[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = v1[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = v1[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3 ] = v2[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4 ] = v2[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5 ] = v2[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6 ] = v3[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7 ] = v3[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8 ] = v3[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\toffset_custom += 9;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faceVertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = value[ 0 ];\r\n\t\t\t\t\t\t\tv2 = value[ 1 ];\r\n\t\t\t\t\t\t\tv3 = value[ 2 ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom ]     = v1[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1 ] = v1[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2 ] = v1[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3 ] = v2[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4 ] = v2[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5 ] = v2[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6 ] = v3[ pp[ 0 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7 ] = v3[ pp[ 1 ] ];\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8 ] = v3[ pp[ 2 ] ];\r\n\r\n\t\t\t\t\t\t\toffset_custom += 9;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( customAttribute.size === 4 ) {\r\n\r\n\t\t\t\t\tif ( customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tface = obj_faces[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = customAttribute.value[ face.a ];\r\n\t\t\t\t\t\t\tv2 = customAttribute.value[ face.b ];\r\n\t\t\t\t\t\t\tv3 = customAttribute.value[ face.c ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom  ]   = v1.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1  ] = v1.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2  ] = v1.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3  ] = v1.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4  ] = v2.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5  ] = v2.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6  ] = v2.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7  ] = v2.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8  ] = v3.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 9  ] = v3.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 10 ] = v3.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 11 ] = v3.w;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 12;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faces' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = value;\r\n\t\t\t\t\t\t\tv2 = value;\r\n\t\t\t\t\t\t\tv3 = value;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom  ]   = v1.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1  ] = v1.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2  ] = v1.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3  ] = v1.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4  ] = v2.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5  ] = v2.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6  ] = v2.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7  ] = v2.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8  ] = v3.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 9  ] = v3.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 10 ] = v3.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 11 ] = v3.w;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 12;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( customAttribute.boundTo === 'faceVertices' ) {\r\n\r\n\t\t\t\t\t\tfor ( f = 0, fl = chunk_faces3.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\t\tvalue = customAttribute.value[ chunk_faces3[ f ] ];\r\n\r\n\t\t\t\t\t\t\tv1 = value[ 0 ];\r\n\t\t\t\t\t\t\tv2 = value[ 1 ];\r\n\t\t\t\t\t\t\tv3 = value[ 2 ];\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom  ]   = v1.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 1  ] = v1.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 2  ] = v1.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 3  ] = v1.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 4  ] = v2.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 5  ] = v2.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 6  ] = v2.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 7  ] = v2.w;\r\n\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 8  ] = v3.x;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 9  ] = v3.y;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 10 ] = v3.z;\r\n\t\t\t\t\t\t\tcustomAttribute.array[ offset_custom + 11 ] = v3.w;\r\n\r\n\t\t\t\t\t\t\toffset_custom += 12;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, customAttribute.buffer );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, customAttribute.array, hint );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( dispose ) {\r\n\r\n\t\t\tdelete geometryGroup.__inittedArrays;\r\n\t\t\tdelete geometryGroup.__colorArray;\r\n\t\t\tdelete geometryGroup.__normalArray;\r\n\t\t\tdelete geometryGroup.__tangentArray;\r\n\t\t\tdelete geometryGroup.__uvArray;\r\n\t\t\tdelete geometryGroup.__uv2Array;\r\n\t\t\tdelete geometryGroup.__faceArray;\r\n\t\t\tdelete geometryGroup.__vertexArray;\r\n\t\t\tdelete geometryGroup.__lineArray;\r\n\t\t\tdelete geometryGroup.__skinIndexArray;\r\n\t\t\tdelete geometryGroup.__skinWeightArray;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Buffer rendering\r\n\r\n\tthis.renderBufferImmediate = function ( object, program, material ) {\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tif ( object.hasPositions && ! object.__webglVertexBuffer ) object.__webglVertexBuffer = _gl.createBuffer();\r\n\t\tif ( object.hasNormals && ! object.__webglNormalBuffer ) object.__webglNormalBuffer = _gl.createBuffer();\r\n\t\tif ( object.hasUvs && ! object.__webglUvBuffer ) object.__webglUvBuffer = _gl.createBuffer();\r\n\t\tif ( object.hasColors && ! object.__webglColorBuffer ) object.__webglColorBuffer = _gl.createBuffer();\r\n\r\n\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, object.__webglVertexBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( program.attributes.position );\r\n\r\n\t\t\t_gl.vertexAttribPointer( program.attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, object.__webglNormalBuffer );\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial === false &&\r\n\t\t\t\t   material.shading === THREE.FlatShading ) {\r\n\r\n\t\t\t\tvar nx, ny, nz,\r\n\t\t\t\t\tnax, nbx, ncx, nay, nby, ncy, naz, nbz, ncz,\r\n\t\t\t\t\tnormalArray,\r\n\t\t\t\t\ti, il = object.count * 3;\r\n\r\n\t\t\t\tfor ( i = 0; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\tnormalArray = object.normalArray;\r\n\r\n\t\t\t\t\tnax  = normalArray[ i ];\r\n\t\t\t\t\tnay  = normalArray[ i + 1 ];\r\n\t\t\t\t\tnaz  = normalArray[ i + 2 ];\r\n\r\n\t\t\t\t\tnbx  = normalArray[ i + 3 ];\r\n\t\t\t\t\tnby  = normalArray[ i + 4 ];\r\n\t\t\t\t\tnbz  = normalArray[ i + 5 ];\r\n\r\n\t\t\t\t\tncx  = normalArray[ i + 6 ];\r\n\t\t\t\t\tncy  = normalArray[ i + 7 ];\r\n\t\t\t\t\tncz  = normalArray[ i + 8 ];\r\n\r\n\t\t\t\t\tnx = ( nax + nbx + ncx ) / 3;\r\n\t\t\t\t\tny = ( nay + nby + ncy ) / 3;\r\n\t\t\t\t\tnz = ( naz + nbz + ncz ) / 3;\r\n\r\n\t\t\t\t\tnormalArray[ i ]   = nx;\r\n\t\t\t\t\tnormalArray[ i + 1 ] = ny;\r\n\t\t\t\t\tnormalArray[ i + 2 ] = nz;\r\n\r\n\t\t\t\t\tnormalArray[ i + 3 ] = nx;\r\n\t\t\t\t\tnormalArray[ i + 4 ] = ny;\r\n\t\t\t\t\tnormalArray[ i + 5 ] = nz;\r\n\r\n\t\t\t\t\tnormalArray[ i + 6 ] = nx;\r\n\t\t\t\t\tnormalArray[ i + 7 ] = ny;\r\n\t\t\t\t\tnormalArray[ i + 8 ] = nz;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( program.attributes.normal );\r\n\r\n\t\t\t_gl.vertexAttribPointer( program.attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasUvs && material.map ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, object.__webglUvBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( program.attributes.uv );\r\n\r\n\t\t\t_gl.vertexAttribPointer( program.attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, object.__webglColorBuffer );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( program.attributes.color );\r\n\r\n\t\t\t_gl.vertexAttribPointer( program.attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\r\n\t\tobject.count = 0;\r\n\r\n\t};\r\n\r\n\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\r\n\r\n\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\tvar programAttributes = program.attributes;\r\n\t\tvar programAttributesKeys = program.attributesKeys;\r\n\r\n\t\tfor ( var i = 0, l = programAttributesKeys.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar key = programAttributesKeys[ i ];\r\n\t\t\tvar programAttribute = programAttributes[ key ];\r\n\r\n\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\tvar geometryAttribute = geometryAttributes[ key ];\r\n\r\n\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryAttribute.buffer );\r\n\r\n\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4 ); // 4 bytes per Float32\r\n\r\n\t\t\t\t} else if ( material.defaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\tif ( material.defaultAttributeValues[ key ].length === 2 ) {\r\n\r\n\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, material.defaultAttributeValues[ key ] );\r\n\r\n\t\t\t\t\t} else if ( material.defaultAttributeValues[ key ].length === 3 ) {\r\n\r\n\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, material.defaultAttributeValues[ key ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t}\r\n\r\n\tthis.renderBufferDirect = function ( camera, lights, fog, material, geometry, object ) {\r\n\r\n\t\tif ( material.visible === false ) return;\r\n\r\n\t\tupdateObject( object );\r\n\r\n\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\r\n\t\tvar updateBuffers = false,\r\n\t\t\twireframeBit = material.wireframe ? 1 : 0,\r\n\t\t\tgeometryProgram = 'direct_' + geometry.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\r\n\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t}\r\n\r\n\t\t// render mesh\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tvar mode = material.wireframe === true ? _gl.LINES : _gl.TRIANGLES;\r\n\r\n\t\t\tvar index = geometry.attributes.index;\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\t// indexed triangles\r\n\r\n\t\t\t\tvar type, size;\r\n\r\n\t\t\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\t\t\tsize = 4;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\t\t\tsize = 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.drawElements( mode, index.array.length, type, 0 );\r\n\r\n\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t_this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n\t\t\t\t\t_this.info.render.faces += index.array.length / 3;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// if there is more than 1 chunk\r\n\t\t\t\t\t// must set attribute pointers to use new offsets for each chunk\r\n\t\t\t\t\t// even if geometry and materials didn't change\r\n\r\n\t\t\t\t\tupdateBuffers = true;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar startIndex = offsets[ i ].index;\r\n\r\n\t\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, startIndex );\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// render indexed triangles\r\n\r\n\t\t\t\t\t\t_gl.drawElements( mode, offsets[ i ].count, type, offsets[ i ].start * size );\r\n\r\n\t\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t\t_this.info.render.vertices += offsets[ i ].count; // not really true, here vertices can be shared\r\n\t\t\t\t\t\t_this.info.render.faces += offsets[ i ].count / 3;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed triangles\r\n\r\n\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar position = geometry.attributes[ 'position' ];\r\n\r\n\t\t\t\t// render non-indexed triangles\r\n\r\n\t\t\t\t_gl.drawArrays( mode, 0, position.array.length / position.itemSize );\r\n\r\n\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t_this.info.render.vertices += position.array.length / position.itemSize;\r\n\t\t\t\t_this.info.render.faces += position.array.length / ( 3 * position.itemSize );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\t// render particles\r\n\r\n\t\t\tvar mode = _gl.POINTS;\r\n\r\n\t\t\tvar index = geometry.attributes.index;\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\t// indexed points\r\n\r\n\t\t\t\tvar type, size;\r\n\r\n\t\t\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\t\t\tsize = 4;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\t\t\tsize = 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.drawElements( mode, index.array.length, type, 0);\r\n\r\n\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t_this.info.render.points += index.array.length;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// if there is more than 1 chunk\r\n\t\t\t\t\t// must set attribute pointers to use new offsets for each chunk\r\n\t\t\t\t\t// even if geometry and materials didn't change\r\n\r\n\t\t\t\t\tif ( offsets.length > 1 ) updateBuffers = true;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar startIndex = offsets[ i ].index;\r\n\r\n\t\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, startIndex );\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// render indexed points\r\n\r\n\t\t\t\t\t\t_gl.drawElements( mode, offsets[ i ].count, type, offsets[ i ].start * size );\r\n\r\n\t\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t\t_this.info.render.points += offsets[ i ].count;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed points\r\n\r\n\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar position = geometry.attributes.position;\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\t_gl.drawArrays( mode, 0, position.array.length / 3 );\r\n\r\n\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t_this.info.render.points += position.array.length / 3;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t_gl.drawArrays( mode, offsets[ i ].index, offsets[ i ].count );\r\n\r\n\t\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t\t_this.info.render.points += offsets[ i ].count;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar mode = ( object.mode === THREE.LineStrip ) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n\t\t\tstate.setLineWidth( material.linewidth * pixelRatio );\r\n\r\n\t\t\tvar index = geometry.attributes.index;\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\t// indexed lines\r\n\r\n\t\t\t\tvar type, size;\r\n\r\n\t\t\t\tif ( index.array instanceof Uint32Array ) {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\t\t\tsize = 4;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\t\t\tsize = 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.drawElements( mode, index.array.length, type, 0 ); // 2 bytes per Uint16Array\r\n\r\n\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t_this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// if there is more than 1 chunk\r\n\t\t\t\t\t// must set attribute pointers to use new offsets for each chunk\r\n\t\t\t\t\t// even if geometry and materials didn't change\r\n\r\n\t\t\t\t\tif ( offsets.length > 1 ) updateBuffers = true;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar startIndex = offsets[ i ].index;\r\n\r\n\t\t\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\t\t\tsetupVertexAttributes( material, program, geometry, startIndex );\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, index.buffer );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// render indexed lines\r\n\r\n\t\t\t\t\t\t_gl.drawElements( mode, offsets[ i ].count, type, offsets[ i ].start * size ); // 2 bytes per Uint16Array\r\n\r\n\t\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t\t_this.info.render.vertices += offsets[ i ].count; // not really true, here vertices can be shared\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed lines\r\n\r\n\t\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t\tsetupVertexAttributes( material, program, geometry, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar position = geometry.attributes.position;\r\n\t\t\t\tvar offsets = geometry.offsets;\r\n\r\n\t\t\t\tif ( offsets.length === 0 ) {\r\n\r\n\t\t\t\t\t_gl.drawArrays( mode, 0, position.array.length / 3 );\r\n\r\n\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t_this.info.render.vertices += position.array.length / 3;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = offsets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t_gl.drawArrays( mode, offsets[ i ].index, offsets[ i ].count );\r\n\r\n\t\t\t\t\t\t_this.info.render.calls ++;\r\n\t\t\t\t\t\t_this.info.render.vertices += offsets[ i ].count;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.renderBuffer = function ( camera, lights, fog, material, geometryGroup, object ) {\r\n\r\n\t\tif ( material.visible === false ) return;\r\n\r\n\t\tupdateObject( object );\r\n\r\n\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\r\n\t\tvar attributes = program.attributes;\r\n\r\n\t\tvar updateBuffers = false,\r\n\t\t\twireframeBit = material.wireframe ? 1 : 0,\r\n\t\t\tgeometryProgram = geometryGroup.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\r\n\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t}\r\n\r\n\t\t// vertices\r\n\r\n\t\tif ( ! material.morphTargets && attributes.position >= 0 ) {\r\n\r\n\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.position );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( object.morphTargetBase ) {\r\n\r\n\t\t\t\tsetupMorphTargets( material, geometryGroup, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t// custom attributes\r\n\r\n\t\t\t// Use the per-geometryGroup custom attribute arrays which are setup in initMeshBuffers\r\n\r\n\t\t\tif ( geometryGroup.__webglCustomAttributesList ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = geometryGroup.__webglCustomAttributesList.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar attribute = geometryGroup.__webglCustomAttributesList[ i ];\r\n\r\n\t\t\t\t\tif ( attributes[ attribute.buffer.belongsToAttribute ] >= 0 ) {\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, attribute.buffer );\r\n\r\n\t\t\t\t\t\tstate.enableAttribute( attributes[ attribute.buffer.belongsToAttribute ] );\r\n\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( attributes[ attribute.buffer.belongsToAttribute ], attribute.size, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// colors\r\n\r\n\t\t\tif ( attributes.color >= 0 ) {\r\n\r\n\t\t\t\tif ( object.geometry.colors.length > 0 || object.geometry.faces.length > 0 ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer );\r\n\r\n\t\t\t\t\tstate.enableAttribute( attributes.color );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t} else if ( material.defaultAttributeValues !== undefined ) {\r\n\r\n\r\n\t\t\t\t\t_gl.vertexAttrib3fv( attributes.color, material.defaultAttributeValues.color );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// normals\r\n\r\n\t\t\tif ( attributes.normal >= 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.normal );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// tangents\r\n\r\n\t\t\tif ( attributes.tangent >= 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.tangent );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.tangent, 4, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uvs\r\n\r\n\t\t\tif ( attributes.uv >= 0 ) {\r\n\r\n\t\t\t\tif ( object.geometry.faceVertexUvs[ 0 ] ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer );\r\n\r\n\t\t\t\t\tstate.enableAttribute( attributes.uv );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t} else if ( material.defaultAttributeValues !== undefined ) {\r\n\r\n\r\n\t\t\t\t\t_gl.vertexAttrib2fv( attributes.uv, material.defaultAttributeValues.uv );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( attributes.uv2 >= 0 ) {\r\n\r\n\t\t\t\tif ( object.geometry.faceVertexUvs[ 1 ] ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer );\r\n\r\n\t\t\t\t\tstate.enableAttribute( attributes.uv2 );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( attributes.uv2, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t} else if ( material.defaultAttributeValues !== undefined ) {\r\n\r\n\r\n\t\t\t\t\t_gl.vertexAttrib2fv( attributes.uv2, material.defaultAttributeValues.uv2 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.skinning &&\r\n\t\t\t\t attributes.skinIndex >= 0 && attributes.skinWeight >= 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.skinIndex );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.skinIndex, 4, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.skinWeight );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.skinWeight, 4, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// line distances\r\n\r\n\t\t\tif ( attributes.lineDistance >= 0 ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglLineDistanceBuffer );\r\n\r\n\t\t\t\tstate.enableAttribute( attributes.lineDistance );\r\n\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.lineDistance, 1, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t// render mesh\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tvar type = geometryGroup.__typeArray === Uint32Array ? _gl.UNSIGNED_INT : _gl.UNSIGNED_SHORT;\r\n\r\n\t\t\t// wireframe\r\n\r\n\t\t\tif ( material.wireframe ) {\r\n\r\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * pixelRatio );\r\n\r\n\t\t\t\tif ( updateBuffers ) _gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer );\r\n\t\t\t\t_gl.drawElements( _gl.LINES, geometryGroup.__webglLineCount, type, 0 );\r\n\r\n\t\t\t// triangles\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( updateBuffers ) _gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer );\r\n\t\t\t\t_gl.drawElements( _gl.TRIANGLES, geometryGroup.__webglFaceCount, type, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_this.info.render.calls ++;\r\n\t\t\t_this.info.render.vertices += geometryGroup.__webglFaceCount;\r\n\t\t\t_this.info.render.faces += geometryGroup.__webglFaceCount / 3;\r\n\r\n\t\t// render lines\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar mode = ( object.mode === THREE.LineStrip ) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n\t\t\tstate.setLineWidth( material.linewidth * pixelRatio );\r\n\r\n\t\t\t_gl.drawArrays( mode, 0, geometryGroup.__webglLineCount );\r\n\r\n\t\t\t_this.info.render.calls ++;\r\n\r\n\t\t// render particles\r\n\r\n\t\t} else if ( object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\t_gl.drawArrays( _gl.POINTS, 0, geometryGroup.__webglParticleCount );\r\n\r\n\t\t\t_this.info.render.calls ++;\r\n\t\t\t_this.info.render.points += geometryGroup.__webglParticleCount;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction setupMorphTargets ( material, geometryGroup, object ) {\r\n\r\n\t\t// set base\r\n\r\n\t\tvar attributes = material.program.attributes;\r\n\r\n\t\tif ( object.morphTargetBase !== - 1 && attributes.position >= 0 ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[ object.morphTargetBase ] );\r\n\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t} else if ( attributes.position >= 0 ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer );\r\n\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.morphTargetForcedOrder.length ) {\r\n\r\n\t\t\t// set forced order\r\n\r\n\t\t\tvar m = 0;\r\n\t\t\tvar order = object.morphTargetForcedOrder;\r\n\t\t\tvar influences = object.morphTargetInfluences;\r\n\r\n\t\t\tvar attribute;\r\n\r\n\t\t\twhile ( m < material.numSupportedMorphTargets && m < order.length ) {\r\n\r\n\t\t\t\tattribute = attributes[ 'morphTarget' + m ];\r\n\r\n\t\t\t\tif ( attribute >= 0 ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[ order[ m ] ] );\r\n\r\n\t\t\t\t\tstate.enableAttribute( attribute );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( attribute, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tattribute = attributes[ 'morphNormal' + m ];\r\n\r\n\t\t\t\tif ( attribute >= 0 && material.morphNormals ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[ order[ m ] ] );\r\n\r\n\t\t\t\t\tstate.enableAttribute( attribute );\r\n\r\n\t\t\t\t\t_gl.vertexAttribPointer( attribute, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.__webglMorphTargetInfluences[ m ] = influences[ order[ m ] ];\r\n\r\n\t\t\t\tm ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// find the most influencing\r\n\r\n\t\t\tvar activeInfluenceIndices = [];\r\n\t\t\tvar influences = object.morphTargetInfluences;\r\n\t\t\tvar morphTargets = object.geometry.morphTargets;\r\n\r\n\t\t\tif ( influences.length > morphTargets.length ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Influences array is bigger than morphTargets array.' );\r\n\t\t\t\tinfluences.length = morphTargets.length;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, il = influences.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tactiveInfluenceIndices.push( [ influence, i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( activeInfluenceIndices.length > material.numSupportedMorphTargets ) {\r\n\r\n\t\t\t\tactiveInfluenceIndices.sort( numericalSort );\r\n\t\t\t\tactiveInfluenceIndices.length = material.numSupportedMorphTargets;\r\n\r\n\t\t\t} else if ( activeInfluenceIndices.length > material.numSupportedMorphNormals ) {\r\n\r\n\t\t\t\tactiveInfluenceIndices.sort( numericalSort );\r\n\r\n\t\t\t} else if ( activeInfluenceIndices.length === 0 ) {\r\n\r\n\t\t\t\tactiveInfluenceIndices.push( [ 0, 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute;\r\n\r\n\t\t\tfor ( var m = 0, ml = material.numSupportedMorphTargets; m < ml; m ++ ) {\r\n\r\n\t\t\t\tif ( activeInfluenceIndices[ m ] ) {\r\n\r\n\t\t\t\t\tvar influenceIndex = activeInfluenceIndices[ m ][ 1 ];\r\n\r\n\t\t\t\t\tattribute = attributes[ 'morphTarget' + m ];\r\n\r\n\t\t\t\t\tif ( attribute >= 0 ) {\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[ influenceIndex ] );\r\n\r\n\t\t\t\t\t\tstate.enableAttribute( attribute );\r\n\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( attribute, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tattribute = attributes[ 'morphNormal' + m ];\r\n\r\n\t\t\t\t\tif ( attribute >= 0 && material.morphNormals ) {\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[ influenceIndex ] );\r\n\r\n\t\t\t\t\t\tstate.enableAttribute( attribute );\r\n\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( attribute, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.__webglMorphTargetInfluences[ m ] = influences[ influenceIndex ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t_gl.vertexAttribPointer( attributes[ \"morphTarget\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( attributes[ \"morphNormal\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t*/\r\n\r\n\t\t\t\t\tobject.__webglMorphTargetInfluences[ m ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// load updated influences uniform\r\n\r\n\t\tif ( material.program.uniforms.morphTargetInfluences !== null ) {\r\n\r\n\t\t\t_gl.uniform1fv( material.program.uniforms.morphTargetInfluences, object.__webglMorphTargetInfluences );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Sorting\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction numericalSort ( a, b ) {\r\n\r\n\t\treturn b[ 0 ] - a[ 0 ];\r\n\r\n\t}\r\n\r\n\t// Rendering\r\n\r\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\r\n\t\tif ( camera instanceof THREE.Camera === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\t// reset caching for this frame\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\t\t_currentCamera = null;\r\n\t\t_lightsNeedUpdate = true;\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t// update camera matrices and frustum\r\n\r\n\t\tif ( camera.parent === undefined ) camera.updateMatrixWorld();\r\n\r\n\t\t// update Skeleton objects\r\n\r\n\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\tobject.skeleton.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\tlights.length = 0;\r\n\t\topaqueObjects.length = 0;\r\n\t\ttransparentObjects.length = 0;\r\n\r\n\t\tsprites.length = 0;\r\n\t\tlensFlares.length = 0;\r\n\r\n\t\tprojectObject( scene );\r\n\r\n\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\topaqueObjects.sort( painterSortStable );\r\n\t\t\ttransparentObjects.sort( reversePainterSortStable );\r\n\r\n\t\t}\r\n\r\n\t\t// custom render plugins (pre pass)\r\n\r\n\t\tshadowMapPlugin.render( scene, camera );\r\n\r\n\t\t//\r\n\r\n\t\t_this.info.render.calls = 0;\r\n\t\t_this.info.render.vertices = 0;\r\n\t\t_this.info.render.faces = 0;\r\n\t\t_this.info.render.points = 0;\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\tif ( this.autoClear || forceClear ) {\r\n\r\n\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\r\n\r\n\t\t}\r\n\r\n\t\t// set matrices for immediate objects\r\n\r\n\t\tfor ( var i = 0, il = _webglObjectsImmediate.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar webglObject = _webglObjectsImmediate[ i ];\r\n\t\t\tvar object = webglObject.object;\r\n\r\n\t\t\tif ( object.visible ) {\r\n\r\n\t\t\t\tsetupMatrices( object, camera );\r\n\r\n\t\t\t\tunrollImmediateBufferMaterial( webglObject );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\tsetMaterial( overrideMaterial );\r\n\r\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog, overrideMaterial );\r\n\t\t\trenderObjects( transparentObjects, camera, lights, fog, overrideMaterial );\r\n\t\t\trenderObjectsImmediate( _webglObjectsImmediate, '', camera, lights, fog, overrideMaterial );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\r\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog, null );\r\n\t\t\trenderObjectsImmediate( _webglObjectsImmediate, 'opaque', camera, lights, fog, null );\r\n\r\n\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\trenderObjects( transparentObjects, camera, lights, fog, null );\r\n\t\t\trenderObjectsImmediate( _webglObjectsImmediate, 'transparent', camera, lights, fog, null );\r\n\r\n\t\t}\r\n\r\n\t\t// custom render plugins (post pass)\r\n\r\n\t\tspritePlugin.render( scene, camera );\r\n\t\tlensFlarePlugin.render( scene, camera, _currentWidth, _currentHeight );\r\n\r\n\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\tif ( renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\tupdateRenderTargetMipmap( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\tstate.setDepthTest( true );\r\n\t\tstate.setDepthWrite( true );\r\n\t\tstate.setColorWrite( true );\r\n\r\n\t\t// _gl.finish();\r\n\r\n\t};\r\n\r\n\tfunction projectObject( object ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object instanceof THREE.Scene || object instanceof THREE.Group ) {\r\n\r\n\t\t\t// skip\r\n\r\n\t\t} else {\r\n\r\n\t\t\tinitObject( object );\r\n\r\n\t\t\tif ( object instanceof THREE.Light ) {\r\n\r\n\t\t\t\tlights.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\tsprites.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.LensFlare ) {\r\n\r\n\t\t\t\tlensFlares.push( object );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar webglObjects = _webglObjects[ object.id ];\r\n\r\n\t\t\t\tif ( webglObjects && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = webglObjects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar webglObject = webglObjects[ i ];\r\n\r\n\t\t\t\t\t\tunrollBufferMaterial( webglObject );\r\n\r\n\t\t\t\t\t\twebglObject.render = true;\r\n\r\n\t\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t\twebglObject.z = _vector3.z;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( object.children[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction renderObjects( renderList, camera, lights, fog, overrideMaterial ) {\r\n\r\n\t\tvar material;\r\n\r\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar webglObject = renderList[ i ];\r\n\r\n\t\t\tvar object = webglObject.object;\r\n\t\t\tvar buffer = webglObject.buffer;\r\n\r\n\t\t\tsetupMatrices( object, camera );\r\n\r\n\t\t\tif ( overrideMaterial ) {\r\n\r\n\t\t\t\tmaterial = overrideMaterial;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaterial = webglObject.material;\r\n\r\n\t\t\t\tif ( ! material ) continue;\r\n\r\n\t\t\t\tsetMaterial( material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_this.setMaterialFaces( material );\r\n\r\n\t\t\tif ( buffer instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, lights, fog, material, buffer, object );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBuffer( camera, lights, fog, material, buffer, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction renderObjectsImmediate ( renderList, materialType, camera, lights, fog, overrideMaterial ) {\r\n\r\n\t\tvar material;\r\n\r\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar webglObject = renderList[ i ];\r\n\t\t\tvar object = webglObject.object;\r\n\r\n\t\t\tif ( object.visible ) {\r\n\r\n\t\t\t\tif ( overrideMaterial ) {\r\n\r\n\t\t\t\t\tmaterial = overrideMaterial;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmaterial = webglObject[ materialType ];\r\n\r\n\t\t\t\t\tif ( ! material ) continue;\r\n\r\n\t\t\t\t\tsetMaterial( material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_this.renderImmediateObject( camera, lights, fog, material, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.renderImmediateObject = function ( camera, lights, fog, material, object ) {\r\n\r\n\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\r\n\t\t_this.setMaterialFaces( material );\r\n\r\n\t\tif ( object.immediateRenderCallback ) {\r\n\r\n\t\t\tobject.immediateRenderCallback( program, _gl, _frustum );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tobject.render( function ( object ) { _this.renderBufferImmediate( object, program, material ); } );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction unrollImmediateBufferMaterial ( globject ) {\r\n\r\n\t\tvar object = globject.object,\r\n\t\t\tmaterial = object.material;\r\n\r\n\t\tif ( material.transparent ) {\r\n\r\n\t\t\tglobject.transparent = material;\r\n\t\t\tglobject.opaque = null;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tglobject.opaque = material;\r\n\t\t\tglobject.transparent = null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction unrollBufferMaterial ( globject ) {\r\n\r\n\t\tvar object = globject.object;\r\n\t\tvar buffer = globject.buffer;\r\n\r\n\t\tvar geometry = object.geometry;\r\n\t\tvar material = object.material;\r\n\r\n\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\r\n\r\n\t\t\tvar materialIndex = geometry instanceof THREE.BufferGeometry ? 0 : buffer.materialIndex;\r\n\r\n\t\t\tmaterial = material.materials[ materialIndex ];\r\n\r\n\t\t\tglobject.material = material;\r\n\r\n\t\t\tif ( material.transparent ) {\r\n\r\n\t\t\t\ttransparentObjects.push( globject );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\topaqueObjects.push( globject );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( material ) {\r\n\r\n\t\t\tglobject.material = material;\r\n\r\n\t\t\tif ( material.transparent ) {\r\n\r\n\t\t\t\ttransparentObjects.push( globject );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\topaqueObjects.push( globject );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction initObject( object ) {\r\n\r\n\t\tif ( object.__webglInit === undefined ) {\r\n\r\n\t\t\tobject.__webglInit = true;\r\n\t\t\tobject._modelViewMatrix = new THREE.Matrix4();\r\n\t\t\tobject._normalMatrix = new THREE.Matrix3();\r\n\r\n\t\t\tobject.addEventListener( 'removed', onObjectRemoved );\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry === undefined ) {\r\n\r\n\t\t\t// ImmediateRenderObject\r\n\r\n\t\t} else if ( geometry.__webglInit === undefined ) {\r\n\r\n\t\t\tgeometry.__webglInit = true;\r\n\t\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\t_this.info.memory.geometries ++;\r\n\r\n\t\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\t\tinitGeometryGroups( object, geometry );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\t\tif ( geometry.__webglVertexBuffer === undefined ) {\r\n\r\n\t\t\t\t\tcreateLineBuffers( geometry );\r\n\t\t\t\t\tinitLineBuffers( geometry, object );\r\n\r\n\t\t\t\t\tgeometry.verticesNeedUpdate = true;\r\n\t\t\t\t\tgeometry.colorsNeedUpdate = true;\r\n\t\t\t\t\tgeometry.lineDistancesNeedUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\t\tif ( geometry.__webglVertexBuffer === undefined ) {\r\n\r\n\t\t\t\t\tcreateParticleBuffers( geometry );\r\n\t\t\t\t\tinitParticleBuffers( geometry, object );\r\n\r\n\t\t\t\t\tgeometry.verticesNeedUpdate = true;\r\n\t\t\t\t\tgeometry.colorsNeedUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.__webglActive === undefined) {\r\n\r\n\t\t\tobject.__webglActive = true;\r\n\r\n\t\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\t\taddBuffer( _webglObjects, geometry, object );\r\n\r\n\t\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\t\tvar geometryGroupsList = geometryGroups[ geometry.id ];\r\n\r\n\t\t\t\t\tfor ( var i = 0,l = geometryGroupsList.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\taddBuffer( _webglObjects, geometryGroupsList[ i ], object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object instanceof THREE.Line || object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\t\taddBuffer( _webglObjects, geometry, object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback ) {\r\n\r\n\t\t\t\taddBufferImmediate( _webglObjectsImmediate, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Geometry splitting\r\n\r\n\tvar geometryGroups = {};\r\n\tvar geometryGroupCounter = 0;\r\n\r\n\tfunction makeGroups( geometry, usesFaceMaterial ) {\r\n\r\n\t\tvar maxVerticesInGroup = extensions.get( 'OES_element_index_uint' ) ? 4294967296 : 65535;\r\n\r\n\t\tvar groupHash, hash_map = {};\r\n\r\n\t\tvar numMorphTargets = geometry.morphTargets.length;\r\n\t\tvar numMorphNormals = geometry.morphNormals.length;\r\n\r\n\t\tvar group;\r\n\t\tvar groups = {};\r\n\t\tvar groupsList = [];\r\n\r\n\t\tfor ( var f = 0, fl = geometry.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tvar face = geometry.faces[ f ];\r\n\t\t\tvar materialIndex = usesFaceMaterial ? face.materialIndex : 0;\r\n\r\n\t\t\tif ( ! ( materialIndex in hash_map ) ) {\r\n\r\n\t\t\t\thash_map[ materialIndex ] = { hash: materialIndex, counter: 0 };\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgroupHash = hash_map[ materialIndex ].hash + '_' + hash_map[ materialIndex ].counter;\r\n\r\n\t\t\tif ( ! ( groupHash in groups ) ) {\r\n\r\n\t\t\t\tgroup = {\r\n\t\t\t\t\tid: geometryGroupCounter ++,\r\n\t\t\t\t\tfaces3: [],\r\n\t\t\t\t\tmaterialIndex: materialIndex,\r\n\t\t\t\t\tvertices: 0,\r\n\t\t\t\t\tnumMorphTargets: numMorphTargets,\r\n\t\t\t\t\tnumMorphNormals: numMorphNormals\r\n\t\t\t\t};\r\n\r\n\t\t\t\tgroups[ groupHash ] = group;\r\n\t\t\t\tgroupsList.push( group );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( groups[ groupHash ].vertices + 3 > maxVerticesInGroup ) {\r\n\r\n\t\t\t\thash_map[ materialIndex ].counter += 1;\r\n\t\t\t\tgroupHash = hash_map[ materialIndex ].hash + '_' + hash_map[ materialIndex ].counter;\r\n\r\n\t\t\t\tif ( ! ( groupHash in groups ) ) {\r\n\r\n\t\t\t\t\tgroup = {\r\n\t\t\t\t\t\tid: geometryGroupCounter ++,\r\n\t\t\t\t\t\tfaces3: [],\r\n\t\t\t\t\t\tmaterialIndex: materialIndex,\r\n\t\t\t\t\t\tvertices: 0,\r\n\t\t\t\t\t\tnumMorphTargets: numMorphTargets,\r\n\t\t\t\t\t\tnumMorphNormals: numMorphNormals\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tgroups[ groupHash ] = group;\r\n\t\t\t\t\tgroupsList.push( group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgroups[ groupHash ].faces3.push( f );\r\n\t\t\tgroups[ groupHash ].vertices += 3;\r\n\r\n\t\t}\r\n\r\n\t\treturn groupsList;\r\n\r\n\t}\r\n\r\n\tfunction initGeometryGroups( object, geometry ) {\r\n\r\n\t\tvar material = object.material, addBuffers = false;\r\n\r\n\t\tif ( geometryGroups[ geometry.id ] === undefined || geometry.groupsNeedUpdate === true ) {\r\n\r\n\t\t\tdelete _webglObjects[ object.id ];\r\n\r\n\t\t\tgeometryGroups[ geometry.id ] = makeGroups( geometry, material instanceof THREE.MeshFaceMaterial );\r\n\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometryGroupsList = geometryGroups[ geometry.id ];\r\n\r\n\t\t// create separate VBOs per geometry chunk\r\n\r\n\t\tfor ( var i = 0, il = geometryGroupsList.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar geometryGroup = geometryGroupsList[ i ];\r\n\r\n\t\t\t// initialise VBO on the first access\r\n\r\n\t\t\tif ( geometryGroup.__webglVertexBuffer === undefined ) {\r\n\r\n\t\t\t\tcreateMeshBuffers( geometryGroup );\r\n\t\t\t\tinitMeshBuffers( geometryGroup, object );\r\n\r\n\t\t\t\tgeometry.verticesNeedUpdate = true;\r\n\t\t\t\tgeometry.morphTargetsNeedUpdate = true;\r\n\t\t\t\tgeometry.elementsNeedUpdate = true;\r\n\t\t\t\tgeometry.uvsNeedUpdate = true;\r\n\t\t\t\tgeometry.normalsNeedUpdate = true;\r\n\t\t\t\tgeometry.tangentsNeedUpdate = true;\r\n\t\t\t\tgeometry.colorsNeedUpdate = true;\r\n\r\n\t\t\t\taddBuffers = true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\taddBuffers = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( addBuffers || object.__webglActive === undefined ) {\r\n\r\n\t\t\t\taddBuffer( _webglObjects, geometryGroup, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tobject.__webglActive = true;\r\n\r\n\t}\r\n\r\n\tfunction addBuffer( objlist, buffer, object ) {\r\n\r\n\t\tvar id = object.id;\r\n\t\tobjlist[id] = objlist[id] || [];\r\n\t\tobjlist[id].push(\r\n\t\t\t{\r\n\t\t\t\tid: id,\r\n\t\t\t\tbuffer: buffer,\r\n\t\t\t\tobject: object,\r\n\t\t\t\tmaterial: null,\r\n\t\t\t\tz: 0\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t};\r\n\r\n\tfunction addBufferImmediate( objlist, object ) {\r\n\r\n\t\tobjlist.push(\r\n\t\t\t{\r\n\t\t\t\tid: null,\r\n\t\t\t\tobject: object,\r\n\t\t\t\topaque: null,\r\n\t\t\t\ttransparent: null,\r\n\t\t\t\tz: 0\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t};\r\n\r\n\t// Objects updates\r\n\r\n\tfunction updateObject( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar attributesKeys = geometry.attributesKeys;\r\n\r\n\t\t\tfor ( var i = 0, l = attributesKeys.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar key = attributesKeys[ i ];\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\t\t\t\tvar bufferType = ( key === 'index' ) ? _gl.ELEMENT_ARRAY_BUFFER : _gl.ARRAY_BUFFER;\r\n\r\n\t\t\t\tif ( attribute.buffer === undefined ) {\r\n\r\n\t\t\t\t\tattribute.buffer = _gl.createBuffer();\r\n\t\t\t\t\t_gl.bindBuffer( bufferType, attribute.buffer );\r\n\t\t\t\t\t_gl.bufferData( bufferType, attribute.array, ( attribute instanceof THREE.DynamicBufferAttribute ) ? _gl.DYNAMIC_DRAW : _gl.STATIC_DRAW );\r\n\r\n\t\t\t\t\tattribute.needsUpdate = false;\r\n\r\n\t\t\t\t} else if ( attribute.needsUpdate === true ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( bufferType, attribute.buffer );\r\n\r\n\t\t\t\t\tif ( attribute.updateRange === undefined || attribute.updateRange.count === -1 ) { // Not using update ranges\r\n\r\n\t\t\t\t\t\t_gl.bufferSubData( bufferType, 0, attribute.array );\r\n\r\n\t\t\t\t\t} else if ( attribute.updateRange.count === 0 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually.' );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t_gl.bufferSubData( bufferType, attribute.updateRange.offset * attribute.array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\t\t\t\t\t   attribute.array.subarray( attribute.updateRange.offset, attribute.updateRange.offset + attribute.updateRange.count ) );\r\n\r\n\t\t\t\t\t\tattribute.updateRange.count = 0; // reset range\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tattribute.needsUpdate = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\t// check all geometry groups\r\n\r\n\t\t\tif ( geometry.groupsNeedUpdate === true ) {\r\n\r\n\t\t\t\tinitGeometryGroups( object, geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometryGroupsList = geometryGroups[ geometry.id ];\r\n\r\n\t\t\tfor ( var i = 0, il = geometryGroupsList.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar geometryGroup = geometryGroupsList[ i ];\r\n\t\t\t\tvar material = getBufferMaterial( object, geometryGroup );\r\n\r\n\t\t\t\tvar customAttributesDirty = material.attributes && areCustomAttributesDirty( material );\r\n\r\n\t\t\t\tif ( geometry.verticesNeedUpdate || geometry.morphTargetsNeedUpdate || geometry.elementsNeedUpdate ||\r\n\t\t\t\t\t geometry.uvsNeedUpdate || geometry.normalsNeedUpdate ||\r\n\t\t\t\t\t geometry.colorsNeedUpdate || geometry.tangentsNeedUpdate || customAttributesDirty ) {\r\n\r\n\t\t\t\t\tsetMeshBuffers( geometryGroup, object, _gl.DYNAMIC_DRAW, ! geometry.dynamic, material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.morphTargetsNeedUpdate = false;\r\n\t\t\tgeometry.elementsNeedUpdate = false;\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\tgeometry.tangentsNeedUpdate = false;\r\n\r\n\t\t\tmaterial.attributes && clearCustomAttributes( material );\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar material = getBufferMaterial( object, geometry );\r\n\t\t\tvar customAttributesDirty = material.attributes && areCustomAttributesDirty( material );\r\n\r\n\t\t\tif ( geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || geometry.lineDistancesNeedUpdate || customAttributesDirty ) {\r\n\r\n\t\t\t\tsetLineBuffers( geometry, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t\tmaterial.attributes && clearCustomAttributes( material );\r\n\r\n\t\t} else if ( object instanceof THREE.PointCloud ) {\r\n\r\n\t\t\tvar material = getBufferMaterial( object, geometry );\r\n\t\t\tvar customAttributesDirty = material.attributes && areCustomAttributesDirty( material );\r\n\r\n\t\t\tif ( geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || customAttributesDirty ) {\r\n\r\n\t\t\t\tsetParticleBuffers( geometry, _gl.DYNAMIC_DRAW, object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t\tmaterial.attributes && clearCustomAttributes( material );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Objects updates - custom attributes check\r\n\r\n\tfunction areCustomAttributesDirty( material ) {\r\n\r\n\t\tfor ( var name in material.attributes ) {\r\n\r\n\t\t\tif ( material.attributes[ name ].needsUpdate ) return true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tfunction clearCustomAttributes( material ) {\r\n\r\n\t\tfor ( var name in material.attributes ) {\r\n\r\n\t\t\tmaterial.attributes[ name ].needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Objects removal\r\n\r\n\tfunction removeObject( object ) {\r\n\r\n\t\tif ( object instanceof THREE.Mesh  ||\r\n\t\t\t object instanceof THREE.PointCloud ||\r\n\t\t\t object instanceof THREE.Line ) {\r\n\r\n\t\t\tdelete _webglObjects[ object.id ];\r\n\r\n\t\t} else if ( object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback ) {\r\n\r\n\t\t\tremoveInstances( _webglObjectsImmediate, object );\r\n\r\n\t\t}\r\n\r\n\t\tdelete object.__webglInit;\r\n\t\tdelete object._modelViewMatrix;\r\n\t\tdelete object._normalMatrix;\r\n\r\n\t\tdelete object.__webglActive;\r\n\r\n\t}\r\n\r\n\tfunction removeInstances( objlist, object ) {\r\n\r\n\t\tfor ( var o = objlist.length - 1; o >= 0; o -- ) {\r\n\r\n\t\t\tif ( objlist[ o ].object === object ) {\r\n\r\n\t\t\t\tobjlist.splice( o, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Materials\r\n\r\n\tvar shaderIDs = {\r\n\t\tMeshDepthMaterial: 'depth',\r\n\t\tMeshNormalMaterial: 'normal',\r\n\t\tMeshBasicMaterial: 'basic',\r\n\t\tMeshLambertMaterial: 'lambert',\r\n\t\tMeshPhongMaterial: 'phong',\r\n\t\tLineBasicMaterial: 'basic',\r\n\t\tLineDashedMaterial: 'dashed',\r\n\t\tPointCloudMaterial: 'particle_basic'\r\n\t};\r\n\r\n\tfunction initMaterial( material, lights, fog, object ) {\r\n\r\n\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\tvar shaderID = shaderIDs[ material.type ];\r\n\r\n\t\tif ( shaderID ) {\r\n\r\n\t\t\tvar shader = THREE.ShaderLib[ shaderID ];\r\n\r\n\t\t\tmaterial.__webglShader = {\r\n\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmaterial.__webglShader = {\r\n\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t// (not to blow over maxLights budget)\r\n\r\n\t\tvar maxLightCount = allocateLights( lights );\r\n\t\tvar maxShadows = allocateShadows( lights );\r\n\t\tvar maxBones = allocateBones( object );\r\n\r\n\t\tvar parameters = {\r\n\r\n\t\t\tprecision: _precision,\r\n\t\t\tsupportsVertexTextures: _supportsVertexTextures,\r\n\r\n\t\t\tmap: !! material.map,\r\n\t\t\tenvMap: !! material.envMap,\r\n\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\tlightMap: !! material.lightMap,\r\n\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\tcombine: material.combine,\r\n\r\n\t\t\tvertexColors: material.vertexColors,\r\n\r\n\t\t\tfog: fog,\r\n\t\t\tuseFog: material.fog,\r\n\t\t\tfogExp: fog instanceof THREE.FogExp2,\r\n\r\n\t\t\tflatShading: material.shading === THREE.FlatShading,\r\n\r\n\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\tlogarithmicDepthBuffer: _logarithmicDepthBuffer,\r\n\r\n\t\t\tskinning: material.skinning,\r\n\t\t\tmaxBones: maxBones,\r\n\t\t\tuseVertexTexture: _supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\tmaxMorphTargets: _this.maxMorphTargets,\r\n\t\t\tmaxMorphNormals: _this.maxMorphNormals,\r\n\r\n\t\t\tmaxDirLights: maxLightCount.directional,\r\n\t\t\tmaxPointLights: maxLightCount.point,\r\n\t\t\tmaxSpotLights: maxLightCount.spot,\r\n\t\t\tmaxHemiLights: maxLightCount.hemi,\r\n\r\n\t\t\tmaxShadows: maxShadows,\r\n\t\t\tshadowMapEnabled: _this.shadowMapEnabled && object.receiveShadow && maxShadows > 0,\r\n\t\t\tshadowMapType: _this.shadowMapType,\r\n\t\t\tshadowMapDebug: _this.shadowMapDebug,\r\n\t\t\tshadowMapCascade: _this.shadowMapCascade,\r\n\r\n\t\t\talphaTest: material.alphaTest,\r\n\t\t\tmetal: material.metal,\r\n\t\t\twrapAround: material.wrapAround,\r\n\t\t\tdoubleSided: material.side === THREE.DoubleSide,\r\n\t\t\tflipSided: material.side === THREE.BackSide\r\n\r\n\t\t};\r\n\r\n\t\t// Generate code\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tif ( shaderID ) {\r\n\r\n\t\t\tchunks.push( shaderID );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tchunks.push( material.fragmentShader );\r\n\t\t\tchunks.push( material.vertexShader );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.defines !== undefined ) {\r\n\r\n\t\t\tfor ( var name in material.defines ) {\r\n\r\n\t\t\t\tchunks.push( name );\r\n\t\t\t\tchunks.push( material.defines[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var name in parameters ) {\r\n\r\n\t\t\tchunks.push( name );\r\n\t\t\tchunks.push( parameters[ name ] );\r\n\r\n\t\t}\r\n\r\n\t\tvar code = chunks.join();\r\n\r\n\t\tvar program;\r\n\r\n\t\t// Check if code has been already compiled\r\n\r\n\t\tfor ( var p = 0, pl = _programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\tvar programInfo = _programs[ p ];\r\n\r\n\t\t\tif ( programInfo.code === code ) {\r\n\r\n\t\t\t\tprogram = programInfo;\r\n\t\t\t\tprogram.usedTimes ++;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tprogram = new THREE.WebGLProgram( _this, code, material, parameters );\r\n\t\t\t_programs.push( program );\r\n\r\n\t\t\t_this.info.memory.programs = _programs.length;\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.program = program;\r\n\r\n\t\tvar attributes = program.attributes;\r\n\r\n\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\tvar id, base = 'morphTarget';\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tid = base + i;\r\n\r\n\t\t\t\tif ( attributes[ id ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\tvar id, base = 'morphNormal';\r\n\r\n\t\t\tfor ( i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\tid = base + i;\r\n\r\n\t\t\t\tif ( attributes[ id ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.uniformsList = [];\r\n\r\n\t\tfor ( var u in material.__webglShader.uniforms ) {\r\n\r\n\t\t\tvar location = material.program.uniforms[ u ];\r\n\r\n\t\t\tif ( location ) {\r\n\t\t\t\tmaterial.uniformsList.push( [ material.__webglShader.uniforms[ u ], location ] );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setMaterial( material ) {\r\n\r\n\t\tif ( material.transparent === true ) {\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\r\n\t\t}\r\n\r\n\t\tstate.setDepthTest( material.depthTest );\r\n\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\tstate.setColorWrite( material.colorWrite );\r\n\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t}\r\n\r\n\tfunction setProgram( camera, lights, fog, material, object ) {\r\n\r\n\t\t_usedTextureUnits = 0;\r\n\r\n\t\tif ( material.needsUpdate ) {\r\n\r\n\t\t\tif ( material.program ) deallocateMaterial( material );\r\n\r\n\t\t\tinitMaterial( material, lights, fog, object );\r\n\t\t\tmaterial.needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\tif ( ! object.__webglMorphTargetInfluences ) {\r\n\r\n\t\t\t\tobject.__webglMorphTargetInfluences = new Float32Array( _this.maxMorphTargets );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar refreshProgram = false;\r\n\t\tvar refreshMaterial = false;\r\n\t\tvar refreshLights = false;\r\n\r\n\t\tvar program = material.program,\r\n\t\t\tp_uniforms = program.uniforms,\r\n\t\t\tm_uniforms = material.__webglShader.uniforms;\r\n\r\n\t\tif ( program.id !== _currentProgram ) {\r\n\r\n\t\t\t_gl.useProgram( program.program );\r\n\t\t\t_currentProgram = program.id;\r\n\r\n\t\t\trefreshProgram = true;\r\n\t\t\trefreshMaterial = true;\r\n\t\t\trefreshLights = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\tif ( _currentMaterialId === -1 ) refreshLights = true;\r\n\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\trefreshMaterial = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshProgram || camera !== _currentCamera ) {\r\n\r\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\t\tif ( _logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\t_gl.uniform1f( p_uniforms.logDepthBufFC, 2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( camera !== _currentCamera ) _currentCamera = camera;\r\n\r\n\t\t\t// load material specific uniforms\r\n\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\tif ( material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material.envMap ) {\r\n\r\n\t\t\t\tif ( p_uniforms.cameraPosition !== null ) {\r\n\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t\t_gl.uniform3f( p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material.skinning ) {\r\n\r\n\t\t\t\tif ( p_uniforms.viewMatrix !== null ) {\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t// not sure why, but otherwise weird things happen\r\n\r\n\t\tif ( material.skinning ) {\r\n\r\n\t\t\tif ( object.bindMatrix && p_uniforms.bindMatrix !== null ) {\r\n\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrix, false, object.bindMatrix.elements );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== null ) {\r\n\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _supportsBoneTextures && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\t\tif ( p_uniforms.boneTexture !== null ) {\r\n\r\n\t\t\t\t\tvar textureUnit = getTextureUnit();\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTexture, textureUnit );\r\n\t\t\t\t\t_this.setTexture( object.skeleton.boneTexture, textureUnit );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p_uniforms.boneTextureWidth !== null ) {\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p_uniforms.boneTextureHeight !== null ) {\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.skeleton && object.skeleton.boneMatrices ) {\r\n\r\n\t\t\t\tif ( p_uniforms.boneGlobalMatrices !== null ) {\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material.lights ) {\r\n\r\n\t\t\t\tif ( _lightsNeedUpdate ) {\r\n\r\n\t\t\t\t\trefreshLights = true;\r\n\t\t\t\t\tsetupLights( lights );\r\n\t\t\t\t\t_lightsNeedUpdate = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( refreshLights ) {\r\n\t\t\t\t\trefreshUniformsLights( m_uniforms, _lights );\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, true );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, false );\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh single material specific uniforms\r\n\r\n\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.PointCloudMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsParticle( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshLambertMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLambert( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.mNear.value = camera.near;\r\n\t\t\t\tm_uniforms.mFar.value = camera.far;\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.receiveShadow && ! material._shadowPass ) {\r\n\r\n\t\t\t\trefreshUniformsShadow( m_uniforms, lights );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// load common uniforms\r\n\r\n\t\t\tloadUniformsGeneric( material.uniformsList );\r\n\r\n\t\t}\r\n\r\n\t\tloadUniformsMatrices( p_uniforms, object );\r\n\r\n\t\tif ( p_uniforms.modelMatrix !== null ) {\r\n\r\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.modelMatrix, false, object.matrixWorld.elements );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\t// Uniforms (refresh uniforms objects)\r\n\r\n\tfunction refreshUniformsCommon ( uniforms, material ) {\r\n\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\tuniforms.specularMap.value = material.specularMap;\r\n\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\t// uv repeat and offset setting priorities\r\n\t\t//  1. color map\r\n\t\t//  2. specular map\r\n\t\t//  3. normal map\r\n\t\t//  4. bump map\r\n\t\t//  5. alpha map\r\n\r\n\t\tvar uvScaleMap;\r\n\r\n\t\tif ( material.map ) {\r\n\r\n\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\tvar offset = uvScaleMap.offset;\r\n\t\t\tvar repeat = uvScaleMap.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.envMap.value = material.envMap;\r\n\t\tuniforms.flipEnvMap.value = ( material.envMap instanceof THREE.WebGLRenderTargetCube ) ? 1 : - 1;\r\n\r\n\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLine ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsDash ( uniforms, material ) {\r\n\r\n\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\tuniforms.scale.value = material.scale;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsParticle ( uniforms, material ) {\r\n\r\n\t\tuniforms.psColor.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\t\tuniforms.size.value = material.size;\r\n\t\tuniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\r\n\t\tif ( material.map !== null ) {\r\n\r\n\t\t\tvar offset = material.map.offset;\r\n\t\t\tvar repeat = material.map.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsFog ( uniforms, fog ) {\r\n\r\n\t\tuniforms.fogColor.value = fog.color;\r\n\r\n\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhong ( uniforms, material ) {\r\n\r\n\t\tuniforms.shininess.value = material.shininess;\r\n\r\n\t\tuniforms.emissive.value = material.emissive;\r\n\t\tuniforms.specular.value = material.specular;\r\n\r\n\t\tif ( material.wrapAround ) {\r\n\r\n\t\t\tuniforms.wrapRGB.value.copy( material.wrapRGB );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLambert ( uniforms, material ) {\r\n\r\n\t\tuniforms.emissive.value = material.emissive;\r\n\r\n\t\tif ( material.wrapAround ) {\r\n\r\n\t\t\tuniforms.wrapRGB.value.copy( material.wrapRGB );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLights ( uniforms, lights ) {\r\n\r\n\t\tuniforms.ambientLightColor.value = lights.ambient;\r\n\r\n\t\tuniforms.directionalLightColor.value = lights.directional.colors;\r\n\t\tuniforms.directionalLightDirection.value = lights.directional.positions;\r\n\r\n\t\tuniforms.pointLightColor.value = lights.point.colors;\r\n\t\tuniforms.pointLightPosition.value = lights.point.positions;\r\n\t\tuniforms.pointLightDistance.value = lights.point.distances;\r\n\t\tuniforms.pointLightDecay.value = lights.point.decays;\r\n\r\n\t\tuniforms.spotLightColor.value = lights.spot.colors;\r\n\t\tuniforms.spotLightPosition.value = lights.spot.positions;\r\n\t\tuniforms.spotLightDistance.value = lights.spot.distances;\r\n\t\tuniforms.spotLightDirection.value = lights.spot.directions;\r\n\t\tuniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n\t\tuniforms.spotLightExponent.value = lights.spot.exponents;\r\n\t\tuniforms.spotLightDecay.value = lights.spot.decays;\r\n\r\n\t\tuniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n\t\tuniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n\t\tuniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\r\n\t}\r\n\r\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\r\n\r\n\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\r\n\t\tuniforms.directionalLightColor.needsUpdate = value;\r\n\t\tuniforms.directionalLightDirection.needsUpdate = value;\r\n\r\n\t\tuniforms.pointLightColor.needsUpdate = value;\r\n\t\tuniforms.pointLightPosition.needsUpdate = value;\r\n\t\tuniforms.pointLightDistance.needsUpdate = value;\r\n\t\tuniforms.pointLightDecay.needsUpdate = value;\r\n\r\n\t\tuniforms.spotLightColor.needsUpdate = value;\r\n\t\tuniforms.spotLightPosition.needsUpdate = value;\r\n\t\tuniforms.spotLightDistance.needsUpdate = value;\r\n\t\tuniforms.spotLightDirection.needsUpdate = value;\r\n\t\tuniforms.spotLightAngleCos.needsUpdate = value;\r\n\t\tuniforms.spotLightExponent.needsUpdate = value;\r\n\t\tuniforms.spotLightDecay.needsUpdate = value;\r\n\r\n\t\tuniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n\t\tuniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n\t\tuniforms.hemisphereLightDirection.needsUpdate = value;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsShadow ( uniforms, lights ) {\r\n\r\n\t\tif ( uniforms.shadowMatrix ) {\r\n\r\n\t\t\tvar j = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\t\tif ( ! light.castShadow ) continue;\r\n\r\n\t\t\t\tif ( light instanceof THREE.SpotLight || ( light instanceof THREE.DirectionalLight && ! light.shadowCascade ) ) {\r\n\r\n\t\t\t\t\tuniforms.shadowMap.value[ j ] = light.shadowMap;\r\n\t\t\t\t\tuniforms.shadowMapSize.value[ j ] = light.shadowMapSize;\r\n\r\n\t\t\t\t\tuniforms.shadowMatrix.value[ j ] = light.shadowMatrix;\r\n\r\n\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = light.shadowDarkness;\r\n\t\t\t\t\tuniforms.shadowBias.value[ j ] = light.shadowBias;\r\n\r\n\t\t\t\t\tj ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Uniforms (load to GPU)\r\n\r\n\tfunction loadUniformsMatrices ( uniforms, object ) {\r\n\r\n\t\t_gl.uniformMatrix4fv( uniforms.modelViewMatrix, false, object._modelViewMatrix.elements );\r\n\r\n\t\tif ( uniforms.normalMatrix ) {\r\n\r\n\t\t\t_gl.uniformMatrix3fv( uniforms.normalMatrix, false, object._normalMatrix.elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTextureUnit() {\r\n\r\n\t\tvar textureUnit = _usedTextureUnits;\r\n\r\n\t\tif ( textureUnit >= _maxTextures ) {\r\n\r\n\t\t\tTHREE.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + _maxTextures );\r\n\r\n\t\t}\r\n\r\n\t\t_usedTextureUnits += 1;\r\n\r\n\t\treturn textureUnit;\r\n\r\n\t}\r\n\r\n\tfunction loadUniformsGeneric ( uniforms ) {\r\n\r\n\t\tvar texture, textureUnit, offset;\r\n\r\n\t\tfor ( var j = 0, jl = uniforms.length; j < jl; j ++ ) {\r\n\r\n\t\t\tvar uniform = uniforms[ j ][ 0 ];\r\n\r\n\t\t\t// needsUpdate property is not added to all uniforms.\r\n\t\t\tif ( uniform.needsUpdate === false ) continue;\r\n\r\n\t\t\tvar type = uniform.type;\r\n\t\t\tvar value = uniform.value;\r\n\t\t\tvar location = uniforms[ j ][ 1 ];\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase '1i':\r\n\t\t\t\t\t_gl.uniform1i( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1f':\r\n\t\t\t\t\t_gl.uniform1f( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '2f':\r\n\t\t\t\t\t_gl.uniform2f( location, value[ 0 ], value[ 1 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3f':\r\n\t\t\t\t\t_gl.uniform3f( location, value[ 0 ], value[ 1 ], value[ 2 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '4f':\r\n\t\t\t\t\t_gl.uniform4f( location, value[ 0 ], value[ 1 ], value[ 2 ], value[ 3 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1iv':\r\n\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3iv':\r\n\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1fv':\r\n\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '2fv':\r\n\t\t\t\t\t_gl.uniform2fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3fv':\r\n\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '4fv':\r\n\t\t\t\t\t_gl.uniform4fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Matrix3fv':\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Matrix4fv':\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tcase 'i':\r\n\r\n\t\t\t\t\t// single integer\r\n\t\t\t\t\t_gl.uniform1i( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'f':\r\n\r\n\t\t\t\t\t// single float\r\n\t\t\t\t\t_gl.uniform1f( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v2':\r\n\r\n\t\t\t\t\t// single THREE.Vector2\r\n\t\t\t\t\t_gl.uniform2f( location, value.x, value.y );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v3':\r\n\r\n\t\t\t\t\t// single THREE.Vector3\r\n\t\t\t\t\t_gl.uniform3f( location, value.x, value.y, value.z );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v4':\r\n\r\n\t\t\t\t\t// single THREE.Vector4\r\n\t\t\t\t\t_gl.uniform4f( location, value.x, value.y, value.z, value.w );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'c':\r\n\r\n\t\t\t\t\t// single THREE.Color\r\n\t\t\t\t\t_gl.uniform3f( location, value.r, value.g, value.b );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'iv1':\r\n\r\n\t\t\t\t\t// flat array of integers (JS or typed array)\r\n\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'iv':\r\n\r\n\t\t\t\t\t// flat array of integers with 3 x N size (JS or typed array)\r\n\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'fv1':\r\n\r\n\t\t\t\t\t// flat array of floats (JS or typed array)\r\n\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'fv':\r\n\r\n\t\t\t\t\t// flat array of floats with 3 x N size (JS or typed array)\r\n\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v2v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector2\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 2 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\toffset = i * 2;\r\n\r\n\t\t\t\t\t\tuniform._array[ offset ]   = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ offset + 1 ] = value[ i ].y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform2fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v3v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector3\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 3 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\toffset = i * 3;\r\n\r\n\t\t\t\t\t\tuniform._array[ offset ]   = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ offset + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\tuniform._array[ offset + 2 ] = value[ i ].z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform3fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v4v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector4\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 4 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\toffset = i * 4;\r\n\r\n\t\t\t\t\t\tuniform._array[ offset ]   = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ offset + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\tuniform._array[ offset + 2 ] = value[ i ].z;\r\n\t\t\t\t\t\tuniform._array[ offset + 3 ] = value[ i ].w;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform4fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm3':\r\n\r\n\t\t\t\t\t// single THREE.Matrix3\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value.elements );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm3v':\r\n\r\n\t\t\t\t\t// array of THREE.Matrix3\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 9 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 9 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm4':\r\n\r\n\t\t\t\t\t// single THREE.Matrix4\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value.elements );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm4v':\r\n\r\n\t\t\t\t\t// array of THREE.Matrix4\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 16 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 16 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 't':\r\n\r\n\t\t\t\t\t// single THREE.Texture (2d or cube)\r\n\r\n\t\t\t\t\ttexture = value;\r\n\t\t\t\t\ttextureUnit = getTextureUnit();\r\n\r\n\t\t\t\t\t_gl.uniform1i( location, textureUnit );\r\n\r\n\t\t\t\t\tif ( ! texture ) continue;\r\n\r\n\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t\t   ( texture.image instanceof Array && texture.image.length === 6 ) ) { // CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\t\t\t\tsetCubeTextureDynamic( texture, textureUnit );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'tv':\r\n\r\n\t\t\t\t\t// array of THREE.Texture (2d)\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = [];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tuniform._array[ i ] = getTextureUnit();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform1iv( location, uniform._array );\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\ttexture = uniform.value[ i ];\r\n\t\t\t\t\t\ttextureUnit = uniform._array[ i ];\r\n\r\n\t\t\t\t\t\tif ( ! texture ) continue;\r\n\r\n\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tTHREE.warn( 'THREE.WebGLRenderer: Unknown uniform type: ' + type );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setupMatrices ( object, camera ) {\r\n\r\n\t\tobject._modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\tobject._normalMatrix.getNormalMatrix( object._modelViewMatrix );\r\n\r\n\t}\r\n\r\n\tfunction setColorLinear( array, offset, color, intensity ) {\r\n\r\n\t\tarray[ offset ]     = color.r * intensity;\r\n\t\tarray[ offset + 1 ] = color.g * intensity;\r\n\t\tarray[ offset + 2 ] = color.b * intensity;\r\n\r\n\t}\r\n\r\n\tfunction setupLights ( lights ) {\r\n\r\n\t\tvar l, ll, light,\r\n\t\tr = 0, g = 0, b = 0,\r\n\t\tcolor, skyColor, groundColor,\r\n\t\tintensity,\r\n\t\tdistance,\r\n\r\n\t\tzlights = _lights,\r\n\r\n\t\tdirColors = zlights.directional.colors,\r\n\t\tdirPositions = zlights.directional.positions,\r\n\r\n\t\tpointColors = zlights.point.colors,\r\n\t\tpointPositions = zlights.point.positions,\r\n\t\tpointDistances = zlights.point.distances,\r\n\t\tpointDecays = zlights.point.decays,\r\n\r\n\t\tspotColors = zlights.spot.colors,\r\n\t\tspotPositions = zlights.spot.positions,\r\n\t\tspotDistances = zlights.spot.distances,\r\n\t\tspotDirections = zlights.spot.directions,\r\n\t\tspotAnglesCos = zlights.spot.anglesCos,\r\n\t\tspotExponents = zlights.spot.exponents,\r\n\t\tspotDecays = zlights.spot.decays,\r\n\r\n\t\themiSkyColors = zlights.hemi.skyColors,\r\n\t\themiGroundColors = zlights.hemi.groundColors,\r\n\t\themiPositions = zlights.hemi.positions,\r\n\r\n\t\tdirLength = 0,\r\n\t\tpointLength = 0,\r\n\t\tspotLength = 0,\r\n\t\themiLength = 0,\r\n\r\n\t\tdirCount = 0,\r\n\t\tpointCount = 0,\r\n\t\tspotCount = 0,\r\n\t\themiCount = 0,\r\n\r\n\t\tdirOffset = 0,\r\n\t\tpointOffset = 0,\r\n\t\tspotOffset = 0,\r\n\t\themiOffset = 0;\r\n\r\n\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tlight = lights[ l ];\r\n\r\n\t\t\tif ( light.onlyShadow ) continue;\r\n\r\n\t\t\tcolor = light.color;\r\n\t\t\tintensity = light.intensity;\r\n\t\t\tdistance = light.distance;\r\n\r\n\t\t\tif ( light instanceof THREE.AmbientLight ) {\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tr += color.r;\r\n\t\t\t\tg += color.g;\r\n\t\t\t\tb += color.b;\r\n\r\n\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\tdirCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t_direction.normalize();\r\n\r\n\t\t\t\tdirOffset = dirLength * 3;\r\n\r\n\t\t\t\tdirPositions[ dirOffset ]     = _direction.x;\r\n\t\t\t\tdirPositions[ dirOffset + 1 ] = _direction.y;\r\n\t\t\t\tdirPositions[ dirOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tsetColorLinear( dirColors, dirOffset, color, intensity );\r\n\r\n\t\t\t\tdirLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tpointCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tpointOffset = pointLength * 3;\r\n\r\n\t\t\t\tsetColorLinear( pointColors, pointOffset, color, intensity );\r\n\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld );\r\n\r\n\t\t\t\tpointPositions[ pointOffset ]     = _vector3.x;\r\n\t\t\t\tpointPositions[ pointOffset + 1 ] = _vector3.y;\r\n\t\t\t\tpointPositions[ pointOffset + 2 ] = _vector3.z;\r\n\r\n\t\t\t\t// distance is 0 if decay is 0, because there is no attenuation at all.\r\n\t\t\t\tpointDistances[ pointLength ] = distance;\r\n\t\t\t\tpointDecays[ pointLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tpointLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\tspotCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tspotOffset = spotLength * 3;\r\n\r\n\t\t\t\tsetColorLinear( spotColors, spotOffset, color, intensity );\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\r\n\t\t\t\tspotPositions[ spotOffset ]     = _direction.x;\r\n\t\t\t\tspotPositions[ spotOffset + 1 ] = _direction.y;\r\n\t\t\t\tspotPositions[ spotOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tspotDistances[ spotLength ] = distance;\r\n\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t_direction.normalize();\r\n\r\n\t\t\t\tspotDirections[ spotOffset ]     = _direction.x;\r\n\t\t\t\tspotDirections[ spotOffset + 1 ] = _direction.y;\r\n\t\t\t\tspotDirections[ spotOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tspotAnglesCos[ spotLength ] = Math.cos( light.angle );\r\n\t\t\t\tspotExponents[ spotLength ] = light.exponent;\r\n\t\t\t\tspotDecays[ spotLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tspotLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\r\n\r\n\t\t\t\themiCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_direction.normalize();\r\n\r\n\t\t\t\themiOffset = hemiLength * 3;\r\n\r\n\t\t\t\themiPositions[ hemiOffset ]     = _direction.x;\r\n\t\t\t\themiPositions[ hemiOffset + 1 ] = _direction.y;\r\n\t\t\t\themiPositions[ hemiOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tskyColor = light.color;\r\n\t\t\t\tgroundColor = light.groundColor;\r\n\r\n\t\t\t\tsetColorLinear( hemiSkyColors, hemiOffset, skyColor, intensity );\r\n\t\t\t\tsetColorLinear( hemiGroundColors, hemiOffset, groundColor, intensity );\r\n\r\n\t\t\t\themiLength += 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// null eventual remains from removed lights\r\n\t\t// (this is to avoid if in shader)\r\n\r\n\t\tfor ( l = dirLength * 3, ll = Math.max( dirColors.length, dirCount * 3 ); l < ll; l ++ ) dirColors[ l ] = 0.0;\r\n\t\tfor ( l = pointLength * 3, ll = Math.max( pointColors.length, pointCount * 3 ); l < ll; l ++ ) pointColors[ l ] = 0.0;\r\n\t\tfor ( l = spotLength * 3, ll = Math.max( spotColors.length, spotCount * 3 ); l < ll; l ++ ) spotColors[ l ] = 0.0;\r\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiSkyColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiSkyColors[ l ] = 0.0;\r\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiGroundColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiGroundColors[ l ] = 0.0;\r\n\r\n\t\tzlights.directional.length = dirLength;\r\n\t\tzlights.point.length = pointLength;\r\n\t\tzlights.spot.length = spotLength;\r\n\t\tzlights.hemi.length = hemiLength;\r\n\r\n\t\tzlights.ambient[ 0 ] = r;\r\n\t\tzlights.ambient[ 1 ] = g;\r\n\t\tzlights.ambient[ 2 ] = b;\r\n\r\n\t}\r\n\r\n\t// GL state setting\r\n\r\n\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\r\n\r\n\t\tif ( cullFace === THREE.CullFaceNone ) {\r\n\r\n\t\t\t_gl.disable( _gl.CULL_FACE );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( frontFaceDirection === THREE.FrontFaceDirectionCW ) {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( cullFace === THREE.CullFaceBack ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT_AND_BACK );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.enable( _gl.CULL_FACE );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setMaterialFaces = function ( material ) {\r\n\r\n\t\tstate.setDoubleSided( material.side === THREE.DoubleSide );\r\n\t\tstate.setFlipSided( material.side === THREE.BackSide );\r\n\r\n\t};\r\n\r\n\t// Textures\r\n\r\n\tfunction setTextureParameters ( textureType, texture, isImagePowerOfTwo ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( isImagePowerOfTwo ) {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\r\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\tTHREE.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tTHREE.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\tif ( extension && texture.type !== THREE.FloatType && texture.type !== THREE.HalfFloatType ) {\r\n\r\n\t\t\tif ( texture.anisotropy > 1 || texture.__currentAnisotropy ) {\r\n\r\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\r\n\t\t\t\ttexture.__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.uploadTexture = function ( texture ) {\r\n\r\n\t\tif ( texture.__webglInit === undefined ) {\r\n\r\n\t\t\ttexture.__webglInit = true;\r\n\r\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\ttexture.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_this.info.memory.textures ++;\r\n\r\n\t\t}\r\n\r\n\t\t_gl.bindTexture( _gl.TEXTURE_2D, texture.__webglTexture );\r\n\r\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\r\n\t\ttexture.image = clampToMaxSize( texture.image, _maxTextureSize );\r\n\r\n\t\tvar image = texture.image,\r\n\t\tisImagePowerOfTwo = THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height ),\r\n\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isImagePowerOfTwo );\r\n\r\n\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\tif ( texture instanceof THREE.DataTexture ) {\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\r\n\r\n\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\tif ( getCompressedTextureFormats().indexOf( glFormat ) > -1 ) {\r\n\r\n\t\t\t\t\t\t_gl.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tTHREE.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else { // regular Texture (image, video, canvas)\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\ttexture.needsUpdate = false;\r\n\r\n\t\tif ( texture.onUpdate ) texture.onUpdate();\r\n\r\n\t};\r\n\r\n\tthis.setTexture = function ( texture, slot ) {\r\n\r\n\t\t_gl.activeTexture( _gl.TEXTURE0 + slot );\r\n\r\n\t\tif ( texture.needsUpdate ) {\r\n\r\n\t\t\t_this.uploadTexture( texture );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.bindTexture( _gl.TEXTURE_2D, texture.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction clampToMaxSize ( image, maxSize ) {\r\n\r\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t// premultiplied alpha.\r\n\r\n\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tTHREE.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction setCubeTexture ( texture, slot ) {\r\n\r\n\t\tif ( texture.image.length === 6 ) {\r\n\r\n\t\t\tif ( texture.needsUpdate ) {\r\n\r\n\t\t\t\tif ( ! texture.image.__webglTextureCube ) {\r\n\r\n\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\t\ttexture.image.__webglTextureCube = _gl.createTexture();\r\n\r\n\t\t\t\t\t_this.info.memory.textures ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube );\r\n\r\n\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\r\n\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\r\n\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\r\n\r\n\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], _maxCubemapSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\tisImagePowerOfTwo = THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height ),\r\n\t\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( getCompressedTextureFormats().indexOf( glFormat ) > -1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t_gl.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tTHREE.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\" );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.needsUpdate = false;\r\n\r\n\t\t\t\tif ( texture.onUpdate ) texture.onUpdate();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setCubeTextureDynamic ( texture, slot ) {\r\n\r\n\t\t_gl.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, texture.__webglTexture );\r\n\r\n\t}\r\n\r\n\t// Render targets\r\n\r\n\tfunction setupFrameBuffer ( framebuffer, renderTarget, textureTarget ) {\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, renderTarget.__webglTexture, 0 );\r\n\r\n\t}\r\n\r\n\tfunction setupRenderBuffer ( renderbuffer, renderTarget  ) {\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t/* For some reason this is not working. Defaulting to RGBA4.\r\n\t\t} else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\t\t*/\r\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setRenderTarget = function ( renderTarget ) {\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\r\n\t\tif ( renderTarget && renderTarget.__webglFramebuffer === undefined ) {\r\n\r\n\t\t\tif ( renderTarget.depthBuffer === undefined ) renderTarget.depthBuffer = true;\r\n\t\t\tif ( renderTarget.stencilBuffer === undefined ) renderTarget.stencilBuffer = true;\r\n\r\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\trenderTarget.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_this.info.memory.textures ++;\r\n\r\n\t\t\t// Setup texture, create render and frame buffers\r\n\r\n\t\t\tvar isTargetPowerOfTwo = THREE.Math.isPowerOfTwo( renderTarget.width ) && THREE.Math.isPowerOfTwo( renderTarget.height ),\r\n\t\t\t\tglFormat = paramThreeToGL( renderTarget.format ),\r\n\t\t\t\tglType = paramThreeToGL( renderTarget.type );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTarget.__webglFramebuffer = [];\r\n\t\t\t\trenderTarget.__webglRenderbuffer = [];\r\n\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture );\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget, isTargetPowerOfTwo );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\trenderTarget.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\t\t\t\t\trenderTarget.__webglRenderbuffer[ i ] = _gl.createRenderbuffer();\r\n\r\n\t\t\t\t\t_gl.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t\t\tsetupFrameBuffer( renderTarget.__webglFramebuffer[ i ], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\t\t\t\t\tsetupRenderBuffer( renderTarget.__webglRenderbuffer[ i ], renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderTarget.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\r\n\t\t\t\t\trenderTarget.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderTarget.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_2D, renderTarget.__webglTexture );\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget, isTargetPowerOfTwo );\r\n\r\n\t\t\t\t_gl.texImage2D( _gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t\tsetupFrameBuffer( renderTarget.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D );\r\n\r\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\r\n\t\t\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer );\r\n\r\n\t\t\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsetupRenderBuffer( renderTarget.__webglRenderbuffer, renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Release everything\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t\t}\r\n\r\n\t\tvar framebuffer, width, height, vx, vy;\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tframebuffer = renderTarget.__webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tframebuffer = renderTarget.__webglFramebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\twidth = renderTarget.width;\r\n\t\t\theight = renderTarget.height;\r\n\r\n\t\t\tvx = 0;\r\n\t\t\tvy = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tframebuffer = null;\r\n\r\n\t\t\twidth = _viewportWidth;\r\n\t\t\theight = _viewportHeight;\r\n\r\n\t\t\tvx = _viewportX;\r\n\t\t\tvy = _viewportY;\r\n\r\n\t\t}\r\n\r\n\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_gl.viewport( vx, vy, width, height );\r\n\r\n\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t}\r\n\r\n\t\t_currentWidth = width;\r\n\t\t_currentHeight = height;\r\n\r\n\t};\r\n\r\n\tthis.readRenderTargetPixels = function( renderTarget, x, y, width, height, buffer ) {\r\n\r\n\t\tif ( ! ( renderTarget instanceof THREE.WebGLRenderTarget ) ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( renderTarget.__webglFramebuffer ) {\r\n\r\n\t\t\tif ( renderTarget.format !== THREE.RGBAFormat ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar restore = false;\r\n\r\n\t\t\tif ( renderTarget.__webglFramebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTarget.__webglFramebuffer );\r\n\r\n\t\t\t\trestore = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\r\n\t\t\t\t_gl.readPixels( x, y, width, height, _gl.RGBA, _gl.UNSIGNED_BYTE, buffer );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction updateRenderTargetMipmap ( renderTarget ) {\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture );\r\n\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\t\t\t_gl.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.bindTexture( _gl.TEXTURE_2D, renderTarget.__webglTexture );\r\n\t\t\t_gl.generateMipmap( _gl.TEXTURE_2D );\r\n\t\t\t_gl.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Fallback filters for non-power-of-2 textures\r\n\r\n\tfunction filterFallback ( f ) {\r\n\r\n\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\r\n\r\n\t\t\treturn _gl.NEAREST;\r\n\r\n\t\t}\r\n\r\n\t\treturn _gl.LINEAR;\r\n\r\n\t}\r\n\r\n\t// Map three.js constants to WebGL constants\r\n\r\n\tfunction paramThreeToGL ( p ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\r\n\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\r\n\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\r\n\r\n\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\r\n\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\r\n\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\r\n\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\r\n\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\r\n\t\tif ( p === THREE.IntType ) return _gl.INT;\r\n\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\r\n\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\r\n\r\n\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\r\n\r\n\t\t}\r\n\r\n\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\r\n\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\r\n\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\r\n\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\r\n\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\r\n\r\n\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\r\n\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\r\n\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\r\n\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\r\n\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\r\n\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\r\n\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\r\n\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\r\n\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\r\n\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\r\n\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\r\n\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n\t// Allocations\r\n\r\n\tfunction allocateBones ( object ) {\r\n\r\n\t\tif ( _supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\treturn 1024;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// default for when object is not specified\r\n\t\t\t// ( for example when prebuilding shader\r\n\t\t\t//   to be used with multiple objects )\r\n\t\t\t//\r\n\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\tvar nVertexUniforms = _gl.getParameter( _gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\tvar maxBones = nVertexMatrices;\r\n\r\n\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\r\n\r\n\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\r\n\r\n\t\t\t\t\tTHREE.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxBones;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction allocateLights( lights ) {\r\n\r\n\t\tvar dirLights = 0;\r\n\t\tvar pointLights = 0;\r\n\t\tvar spotLights = 0;\r\n\t\tvar hemiLights = 0;\r\n\r\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tvar light = lights[ l ];\r\n\r\n\t\t\tif ( light.onlyShadow || light.visible === false ) continue;\r\n\r\n\t\t\tif ( light instanceof THREE.DirectionalLight ) dirLights ++;\r\n\t\t\tif ( light instanceof THREE.PointLight ) pointLights ++;\r\n\t\t\tif ( light instanceof THREE.SpotLight ) spotLights ++;\r\n\t\t\tif ( light instanceof THREE.HemisphereLight ) hemiLights ++;\r\n\r\n\t\t}\r\n\r\n\t\treturn { 'directional': dirLights, 'point': pointLights, 'spot': spotLights, 'hemi': hemiLights };\r\n\r\n\t}\r\n\r\n\tfunction allocateShadows( lights ) {\r\n\r\n\t\tvar maxShadows = 0;\r\n\r\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tvar light = lights[ l ];\r\n\r\n\t\t\tif ( ! light.castShadow ) continue;\r\n\r\n\t\t\tif ( light instanceof THREE.SpotLight ) maxShadows ++;\r\n\t\t\tif ( light instanceof THREE.DirectionalLight && ! light.shadowCascade ) maxShadows ++;\r\n\r\n\t\t}\r\n\r\n\t\treturn maxShadows;\r\n\r\n\t}\r\n\r\n\t// DEPRECATED\r\n\r\n\tthis.initMaterial = function () {\r\n\r\n\t\tTHREE.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.addPrePlugin = function () {\r\n\r\n\t\tTHREE.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.addPostPlugin = function () {\r\n\r\n\t\tTHREE.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.updateShadowMap = function () {\r\n\r\n\t\tTHREE.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.WebGLRenderTarget = function ( width, height, options ) {\r\n\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\toptions = options || {};\r\n\r\n\tthis.wrapS = options.wrapS !== undefined ? options.wrapS : THREE.ClampToEdgeWrapping;\r\n\tthis.wrapT = options.wrapT !== undefined ? options.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\tthis.magFilter = options.magFilter !== undefined ? options.magFilter : THREE.LinearFilter;\r\n\tthis.minFilter = options.minFilter !== undefined ? options.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\tthis.anisotropy = options.anisotropy !== undefined ? options.anisotropy : 1;\r\n\r\n\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.format = options.format !== undefined ? options.format : THREE.RGBAFormat;\r\n\tthis.type = options.type !== undefined ? options.type : THREE.UnsignedByteType;\r\n\r\n\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\r\n\tthis.generateMipmaps = true;\r\n\r\n\tthis.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n\tconstructor: THREE.WebGLRenderTarget,\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar tmp = new THREE.WebGLRenderTarget( this.width, this.height );\r\n\r\n\t\ttmp.wrapS = this.wrapS;\r\n\t\ttmp.wrapT = this.wrapT;\r\n\r\n\t\ttmp.magFilter = this.magFilter;\r\n\t\ttmp.minFilter = this.minFilter;\r\n\r\n\t\ttmp.anisotropy = this.anisotropy;\r\n\r\n\t\ttmp.offset.copy( this.offset );\r\n\t\ttmp.repeat.copy( this.repeat );\r\n\r\n\t\ttmp.format = this.format;\r\n\t\ttmp.type = this.type;\r\n\r\n\t\ttmp.depthBuffer = this.depthBuffer;\r\n\t\ttmp.stencilBuffer = this.stencilBuffer;\r\n\r\n\t\ttmp.generateMipmaps = this.generateMipmaps;\r\n\r\n\t\ttmp.shareDepthFrom = this.shareDepthFrom;\r\n\r\n\t\treturn tmp;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.WebGLRenderTarget.prototype );\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\r\n\r\n\tTHREE.WebGLRenderTarget.call( this, width, height, options );\r\n\r\n\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLExtensions = function ( gl ) {\r\n\r\n\tvar extensions = {};\r\n\r\n\tthis.get = function ( name ) {\r\n\r\n\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\treturn extensions[ name ];\r\n\r\n\t\t}\r\n\r\n\t\tvar extension;\r\n\r\n\t\tswitch ( name ) {\r\n\r\n\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t}\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\textensions[ name ] = extension;\r\n\r\n\t\treturn extension;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = ( function () {\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tvar generateDefines = function ( defines ) {\r\n\r\n\t\tvar value, chunk, chunks = [];\r\n\r\n\t\tfor ( var d in defines ) {\r\n\r\n\t\t\tvalue = defines[ d ];\r\n\t\t\tif ( value === false ) continue;\r\n\r\n\t\t\tchunk = '#define ' + d + ' ' + value;\r\n\t\t\tchunks.push( chunk );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t};\r\n\r\n\tvar cacheUniformLocations = function ( gl, program, identifiers ) {\r\n\r\n\t\tvar uniforms = {};\r\n\r\n\t\tfor ( var i = 0, l = identifiers.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar id = identifiers[ i ];\r\n\t\t\tuniforms[ id ] = gl.getUniformLocation( program, id );\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms;\r\n\r\n\t};\r\n\r\n\tvar cacheAttributeLocations = function ( gl, program, identifiers ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tfor ( var i = 0, l = identifiers.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar id = identifiers[ i ];\r\n\t\t\tattributes[ id ] = gl.getAttribLocation( program, id );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t};\r\n\r\n\treturn function ( renderer, code, material, parameters ) {\r\n\r\n\t\tvar _this = renderer;\r\n\t\tvar _gl = _this.context;\r\n\r\n\t\tvar defines = material.defines;\r\n\t\tvar uniforms = material.__webglShader.uniforms;\r\n\t\tvar attributes = material.attributes;\r\n\r\n\t\tvar vertexShader = material.__webglShader.vertexShader;\r\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n\t\tvar index0AttributeName = material.index0AttributeName;\r\n\r\n\t\tif ( index0AttributeName === undefined && parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\r\n\t\t\tindex0AttributeName = 'position';\r\n\r\n\t\t}\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t}\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeReflectionMapping:\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.EquirectangularReflectionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.combine ) {\r\n\r\n\t\t\t\tcase THREE.MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\t// console.log( 'building new program ' );\r\n\r\n\t\t//\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\t//\r\n\r\n\t\tvar program = _gl.createProgram();\r\n\r\n\t\tvar prefix_vertex, prefix_fragment;\r\n\r\n\t\tif ( material instanceof THREE.RawShaderMaterial ) {\r\n\r\n\t\t\tprefix_vertex = '';\r\n\t\t\tprefix_fragment = '';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefix_vertex = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\t_this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\t_this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED': '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\tparameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t//_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\t\t\t\t'attribute vec2 uv2;',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t''\r\n\r\n\t\t\t].join( '\\n' );\r\n\r\n\t\t\tprefix_fragment = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t( parameters.bumpMap || parameters.normalMap || parameters.flatShading ) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n\t\t\t\t_this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\t_this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED': '',\r\n\r\n\t\t\t\tparameters.metal ? '#define METAL' : '',\r\n\t\t\t\tparameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\tparameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t//_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\t\t\t\t''\r\n\r\n\t\t\t].join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvar glVertexShader = new THREE.WebGLShader( _gl, _gl.VERTEX_SHADER, prefix_vertex + vertexShader );\r\n\t\tvar glFragmentShader = new THREE.WebGLShader( _gl, _gl.FRAGMENT_SHADER, prefix_fragment + fragmentShader );\r\n\r\n\t\t_gl.attachShader( program, glVertexShader );\r\n\t\t_gl.attachShader( program, glFragmentShader );\r\n\r\n\t\tif ( index0AttributeName !== undefined ) {\r\n\r\n\t\t\t// Force a particular attribute to index 0.\r\n\t\t\t// because potentially expensive emulation is done by browser if attribute 0 is disabled.\r\n\t\t\t// And, color, for example is often automatically bound to index 0 so disabling it\r\n\r\n\t\t\t_gl.bindAttribLocation( program, 0, index0AttributeName );\r\n\r\n\t\t}\r\n\r\n\t\t_gl.linkProgram( program );\r\n\r\n\t\tvar programLogInfo = _gl.getProgramInfoLog( program );\r\n\r\n\t\tif ( _gl.getProgramParameter( program, _gl.LINK_STATUS ) === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.WebGLProgram: shader error: ' + _gl.getError(), 'gl.VALIDATE_STATUS', _gl.getProgramParameter( program, _gl.VALIDATE_STATUS ), 'gl.getPRogramInfoLog', programLogInfo );\r\n\r\n\t\t}\r\n\r\n\t\tif ( programLogInfo !== '' ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()' + programLogInfo );\r\n\t\t\t// THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n\t\t\t// THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\t_gl.deleteShader( glVertexShader );\r\n\t\t_gl.deleteShader( glFragmentShader );\r\n\r\n\t\t// cache uniform locations\r\n\r\n\t\tvar identifiers = [\r\n\r\n\t\t\t'viewMatrix',\r\n\t\t\t'modelViewMatrix',\r\n\t\t\t'projectionMatrix',\r\n\t\t\t'normalMatrix',\r\n\t\t\t'modelMatrix',\r\n\t\t\t'cameraPosition',\r\n\t\t\t'morphTargetInfluences',\r\n\t\t\t'bindMatrix',\r\n\t\t\t'bindMatrixInverse'\r\n\r\n\t\t];\r\n\r\n\t\tif ( parameters.useVertexTexture ) {\r\n\r\n\t\t\tidentifiers.push( 'boneTexture' );\r\n\t\t\tidentifiers.push( 'boneTextureWidth' );\r\n\t\t\tidentifiers.push( 'boneTextureHeight' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tidentifiers.push( 'boneGlobalMatrices' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( parameters.logarithmicDepthBuffer ) {\r\n\r\n\t\t\tidentifiers.push('logDepthBufFC');\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfor ( var u in uniforms ) {\r\n\r\n\t\t\tidentifiers.push( u );\r\n\r\n\t\t}\r\n\r\n\t\tthis.uniforms = cacheUniformLocations( _gl, program, identifiers );\r\n\r\n\t\t// cache attributes locations\r\n\r\n\t\tidentifiers = [\r\n\r\n\t\t\t'position',\r\n\t\t\t'normal',\r\n\t\t\t'uv',\r\n\t\t\t'uv2',\r\n\t\t\t'tangent',\r\n\t\t\t'color',\r\n\t\t\t'skinIndex',\r\n\t\t\t'skinWeight',\r\n\t\t\t'lineDistance'\r\n\r\n\t\t];\r\n\r\n\t\tfor ( var i = 0; i < parameters.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\tidentifiers.push( 'morphTarget' + i );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < parameters.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\tidentifiers.push( 'morphNormal' + i );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var a in attributes ) {\r\n\r\n\t\t\tidentifiers.push( a );\r\n\r\n\t\t}\r\n\r\n\t\tthis.attributes = cacheAttributeLocations( _gl, program, identifiers );\r\n\t\tthis.attributesKeys = Object.keys( this.attributes );\r\n\r\n\t\t//\r\n\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.code = code;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = ( function () {\r\n\r\n\tvar addLineNumbers = function ( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t};\r\n\r\n\treturn function ( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type ); \r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\r\n\t\t\tTHREE.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\r\n\t\t\tTHREE.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\r\n\t\t}\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\treturn shader;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLState = function ( gl, paramThreeToGL ) {\r\n\r\n\tvar newAttributes = new Uint8Array( 16 );\r\n\tvar enabledAttributes = new Uint8Array( 16 );\r\n\r\n\tvar currentBlending = null;\r\n\tvar currentBlendEquation = null;\r\n\tvar currentBlendSrc = null;\r\n\tvar currentBlendDst = null;\r\n\tvar currentBlendEquationAlpha = null;\r\n\tvar currentBlendSrcAlpha = null;\r\n\tvar currentBlendDstAlpha = null;\r\n\r\n\tvar currentDepthTest = null;\r\n\tvar currentDepthWrite = null;\r\n\r\n\tvar currentColorWrite = null;\r\n\r\n\tvar currentDoubleSided = null;\r\n\tvar currentFlipSided = null;\r\n\r\n\tvar currentLineWidth = null;\r\n\r\n\tvar currentPolygonOffset = null;\r\n\tvar currentPolygonOffsetFactor = null;\r\n\tvar currentPolygonOffsetUnits = null;\r\n\r\n\tthis.initAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttribute = function ( attribute ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disableUnusedAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = enabledAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha ) {\r\n\r\n\t\tif ( blending !== currentBlending ) {\r\n\r\n\t\t\tif ( blending === THREE.NoBlending ) {\r\n\r\n\t\t\t\tgl.disable( gl.BLEND );\r\n\r\n\t\t\t} else if ( blending === THREE.AdditiveBlending ) {\r\n\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\r\n\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\r\n\r\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\r\n\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\r\n\r\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\r\n\t\t\t} else if ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcurrentBlendEquation = null;\r\n\t\t\tcurrentBlendSrc = null;\r\n\t\t\tcurrentBlendDst = null;\r\n\t\t\tcurrentBlendEquationAlpha = null;\r\n\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthTest = function ( depthTest ) {\r\n\r\n\t\tif ( currentDepthTest !== depthTest ) {\r\n\r\n\t\t\tif ( depthTest ) {\r\n\r\n\t\t\t\tgl.enable( gl.DEPTH_TEST );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.disable( gl.DEPTH_TEST );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentDepthTest = depthTest;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthWrite = function ( depthWrite ) {\r\n\r\n\t\tif ( currentDepthWrite !== depthWrite ) {\r\n\r\n\t\t\tgl.depthMask( depthWrite );\r\n\t\t\tcurrentDepthWrite = depthWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setColorWrite = function ( colorWrite ) {\r\n\r\n\t\tif ( currentColorWrite !== colorWrite ) {\r\n\r\n\t\t\tgl.colorMask( colorWrite, colorWrite, colorWrite, colorWrite );\r\n\t\t\tcurrentColorWrite = colorWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDoubleSided = function ( doubleSided ) {\r\n\r\n\t\tif ( currentDoubleSided !== doubleSided ) {\r\n\r\n\t\t\tif ( doubleSided ) {\r\n\r\n\t\t\t\tgl.disable( gl.CULL_FACE );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.enable( gl.CULL_FACE );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentDoubleSided = doubleSided;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setFlipSided = function ( flipSided ) {\r\n\r\n\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\tgl.frontFace( gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.frontFace( gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLineWidth = function ( width ) {\r\n\r\n\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\tgl.lineWidth( width );\r\n\r\n\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setPolygonOffset = function ( polygonoffset, factor, units ) {\r\n\r\n\t\tif ( currentPolygonOffset !== polygonoffset ) {\r\n\r\n\t\t\tif ( polygonoffset ) {\r\n\r\n\t\t\t\tgl.enable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.disable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentPolygonOffset = polygonoffset;\r\n\r\n\t\t}\r\n\r\n\t\tif ( polygonoffset && ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) ) {\r\n\r\n\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t}\r\n\r\n\t\tcurrentBlending = null;\r\n\t\tcurrentDepthTest = null;\r\n\t\tcurrentDepthWrite = null;\r\n\t\tcurrentColorWrite = null;\r\n\t\tcurrentDoubleSided = null;\r\n\t\tcurrentFlipSided = null;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function ( renderer, flares ) {\r\n\r\n\tvar gl = renderer.context;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\tvar hasVertexTexture;\r\n\r\n\tvar tempTexture, occlusionTexture;\r\n\r\n\tvar init = function () {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t-1, -1,  0, 0,\r\n\t\t\t 1, -1,  1, 0,\r\n\t\t\t 1,  1,  1, 1,\r\n\t\t\t-1,  1,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\t// buffers\r\n\r\n\t\tvertexBuffer     = gl.createBuffer();\r\n\t\telementBuffer    = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\t// textures\r\n\r\n\t\ttempTexture      = gl.createTexture();\r\n\t\tocclusionTexture = gl.createTexture();\r\n\r\n\t\tgl.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tgl.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\thasVertexTexture = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) > 0;\r\n\r\n\t\tvar shader;\r\n\r\n\t\tif ( hasVertexTexture ) {\r\n\r\n\t\t\tshader = {\r\n\r\n\t\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\r\n\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\t\"if( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n\t\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\t\"if( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n\t\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\t\"} else if( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" )\r\n\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\r\n\t\t\tshader = {\r\n\r\n\t\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\t\"if( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\t\"precision mediump float;\",\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\t\"if( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\r\n\t\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\t\"} else if( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\t\"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\"texture.a *= opacity * visibility;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" )\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tprogram = createProgram( shader );\r\n\r\n\t\tattributes = {\r\n\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\r\n\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\r\n\t\t}\r\n\r\n\t\tuniforms = {\r\n\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\r\n\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\r\n\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\r\n\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\r\n\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\r\n\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\r\n\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\r\n\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\r\n\t\t};\r\n\r\n\t};\r\n\r\n\t/*\r\n\t * Render lens flares\r\n\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n\t *         reads these back and calculates occlusion.\r\n\t */\r\n\r\n\tthis.render = function ( scene, camera, viewportWidth, viewportHeight ) {\r\n\r\n\t\tif ( flares.length === 0 ) return;\r\n\r\n\t\tvar tempPosition = new THREE.Vector3();\r\n\r\n\t\tvar invAspect = viewportHeight / viewportWidth,\r\n\t\t\thalfViewportWidth = viewportWidth * 0.5,\r\n\t\t\thalfViewportHeight = viewportHeight * 0.5;\r\n\r\n\t\tvar size = 16 / viewportHeight,\r\n\t\t\tscale = new THREE.Vector2( size * invAspect, size );\r\n\r\n\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\r\n\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tgl.enableVertexAttribArray( attributes.vertex );\r\n\t\tgl.enableVertexAttribArray( attributes.uv );\r\n\r\n\t\t// loop through all lens flares to update their occlusion and positions\r\n\t\t// setup gl and common used attribs/unforms\r\n\r\n\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\r\n\t\tgl.uniform1i( uniforms.map, 1 );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tgl.disable( gl.CULL_FACE );\r\n\t\tgl.depthMask( false );\r\n\r\n\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\r\n\r\n\t\t\tsize = 16 / viewportHeight;\r\n\t\t\tscale.set( size * invAspect, size );\r\n\r\n\t\t\t// calc object screen position\r\n\r\n\t\t\tvar flare = flares[ i ];\r\n\r\n\t\t\ttempPosition.set( flare.matrixWorld.elements[12], flare.matrixWorld.elements[13], flare.matrixWorld.elements[14] );\r\n\r\n\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\r\n\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\r\n\r\n\t\t\t// setup arrays for gl programs\r\n\r\n\t\t\tscreenPosition.copy( tempPosition )\r\n\r\n\t\t\tscreenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n\t\t\tscreenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\r\n\t\t\t// screen cull\r\n\r\n\t\t\tif ( hasVertexTexture || (\r\n\t\t\t\tscreenPositionPixels.x > 0 &&\r\n\t\t\t\tscreenPositionPixels.x < viewportWidth &&\r\n\t\t\t\tscreenPositionPixels.y > 0 &&\r\n\t\t\t\tscreenPositionPixels.y < viewportHeight ) ) {\r\n\r\n\t\t\t\t// save current RGB to temp texture\r\n\r\n\t\t\t\tgl.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// render pink quad\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\r\n\t\t\t\tgl.disable( gl.BLEND );\r\n\t\t\t\tgl.enable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// copy result to occlusionMap\r\n\r\n\t\t\t\tgl.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// restore graphics\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\r\n\t\t\t\tgl.disable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tgl.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// update object positions\r\n\r\n\t\t\t\tflare.positionScreen.copy( screenPosition )\r\n\r\n\t\t\t\tif ( flare.customUpdateCallback ) {\r\n\r\n\t\t\t\t\tflare.customUpdateCallback( flare );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tflare.updateLensFlares();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// render flares\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\r\n\t\t\t\tgl.enable( gl.BLEND );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\r\n\r\n\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\r\n\r\n\t\t\t\t\t\tscreenPosition.x = sprite.x;\r\n\t\t\t\t\t\tscreenPosition.y = sprite.y;\r\n\t\t\t\t\t\tscreenPosition.z = sprite.z;\r\n\r\n\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewportHeight;\r\n\r\n\t\t\t\t\t\tscale.x = size * invAspect;\r\n\t\t\t\t\t\tscale.y = size;\r\n\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\r\n\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\r\n\r\n\t\t\t\t\t\trenderer.state.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\r\n\t\t\t\t\t\trenderer.setTexture( sprite.texture, 1 );\r\n\r\n\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tgl.enable( gl.CULL_FACE );\r\n\t\tgl.enable( gl.DEPTH_TEST );\r\n\t\tgl.depthMask( true );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram ( shader ) {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\r\n\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\r\n\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\r\n\r\n\t\tgl.compileShader( fragmentShader );\r\n\t\tgl.compileShader( vertexShader );\r\n\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\t\tgl.attachShader( program, vertexShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/ShadowMapPlugin.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ShadowMapPlugin = function ( _renderer, _lights, _webglObjects, _webglObjectsImmediate ) {\r\n\r\n\tvar _gl = _renderer.context;\r\n\r\n\tvar _depthMaterial, _depthMaterialMorph, _depthMaterialSkin, _depthMaterialMorphSkin,\r\n\r\n\t_frustum = new THREE.Frustum(),\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_min = new THREE.Vector3(),\r\n\t_max = new THREE.Vector3(),\r\n\r\n\t_matrixPosition = new THREE.Vector3(),\r\n\r\n\t_renderList = [];\r\n\r\n\t// init\r\n\r\n\tvar depthShader = THREE.ShaderLib[ \"depthRGBA\" ];\r\n\tvar depthUniforms = THREE.UniformsUtils.clone( depthShader.uniforms );\r\n\r\n\t_depthMaterial = new THREE.ShaderMaterial( {\r\n\t\tuniforms: depthUniforms,\r\n\t\tvertexShader: depthShader.vertexShader,\r\n\t\tfragmentShader: depthShader.fragmentShader\r\n\t } );\r\n\r\n\t_depthMaterialMorph = new THREE.ShaderMaterial( {\r\n\t\tuniforms: depthUniforms,\r\n\t\tvertexShader: depthShader.vertexShader,\r\n\t\tfragmentShader: depthShader.fragmentShader,\r\n\t\tmorphTargets: true\r\n\t} );\r\n\r\n\t_depthMaterialSkin = new THREE.ShaderMaterial( {\r\n\t\tuniforms: depthUniforms,\r\n\t\tvertexShader: depthShader.vertexShader,\r\n\t\tfragmentShader: depthShader.fragmentShader,\r\n\t\tskinning: true\r\n\t} );\r\n\r\n\t_depthMaterialMorphSkin = new THREE.ShaderMaterial( {\r\n\t\tuniforms: depthUniforms,\r\n\t\tvertexShader: depthShader.vertexShader,\r\n\t\tfragmentShader: depthShader.fragmentShader,\r\n\t\tmorphTargets: true,\r\n\t\tskinning: true\r\n\t} );\r\n\r\n\t_depthMaterial._shadowPass = true;\r\n\t_depthMaterialMorph._shadowPass = true;\r\n\t_depthMaterialSkin._shadowPass = true;\r\n\t_depthMaterialMorphSkin._shadowPass = true;\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( _renderer.shadowMapEnabled === false ) return;\r\n\r\n\t\tvar i, il, j, jl, n,\r\n\r\n\t\tshadowMap, shadowMatrix, shadowCamera,\r\n\t\tbuffer, material,\r\n\t\twebglObject, object, light,\r\n\r\n\t\tlights = [],\r\n\t\tk = 0,\r\n\r\n\t\tfog = null;\r\n\r\n\t\t// set GL state for depth map\r\n\r\n\t\t_gl.clearColor( 1, 1, 1, 1 );\r\n\t\t_gl.disable( _gl.BLEND );\r\n\r\n\t\t_gl.enable( _gl.CULL_FACE );\r\n\t\t_gl.frontFace( _gl.CCW );\r\n\r\n\t\tif ( _renderer.shadowMapCullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t_gl.cullFace( _gl.FRONT );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.state.setDepthTest( true );\r\n\r\n\t\t// preprocess lights\r\n\t\t// \t- skip lights that are not casting shadows\r\n\t\t//\t- create virtual lights for cascaded shadow maps\r\n\r\n\t\tfor ( i = 0, il = _lights.length; i < il; i ++ ) {\r\n\r\n\t\t\tlight = _lights[ i ];\r\n\r\n\t\t\tif ( ! light.castShadow ) continue;\r\n\r\n\t\t\tif ( ( light instanceof THREE.DirectionalLight ) && light.shadowCascade ) {\r\n\r\n\t\t\t\tfor ( n = 0; n < light.shadowCascadeCount; n ++ ) {\r\n\r\n\t\t\t\t\tvar virtualLight;\r\n\r\n\t\t\t\t\tif ( ! light.shadowCascadeArray[ n ] ) {\r\n\r\n\t\t\t\t\t\tvirtualLight = createVirtualLight( light, n );\r\n\t\t\t\t\t\tvirtualLight.originalCamera = camera;\r\n\r\n\t\t\t\t\t\tvar gyro = new THREE.Gyroscope();\r\n\t\t\t\t\t\tgyro.position.copy( light.shadowCascadeOffset );\r\n\r\n\t\t\t\t\t\tgyro.add( virtualLight );\r\n\t\t\t\t\t\tgyro.add( virtualLight.target );\r\n\r\n\t\t\t\t\t\tcamera.add( gyro );\r\n\r\n\t\t\t\t\t\tlight.shadowCascadeArray[ n ] = virtualLight;\r\n\r\n\t\t\t\t\t\t//console.log( \"Created virtualLight\", virtualLight );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvirtualLight = light.shadowCascadeArray[ n ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tupdateVirtualLight( light, n );\r\n\r\n\t\t\t\t\tlights[ k ] = virtualLight;\r\n\t\t\t\t\tk ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlights[ k ] = light;\r\n\t\t\t\tk ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// render depth map\r\n\r\n\t\tfor ( i = 0, il = lights.length; i < il; i ++ ) {\r\n\r\n\t\t\tlight = lights[ i ];\r\n\r\n\t\t\tif ( ! light.shadowMap ) {\r\n\r\n\t\t\t\tvar shadowFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\tif ( _renderer.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\t\t\tshadowFilter = THREE.NearestFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar pars = { minFilter: shadowFilter, magFilter: shadowFilter, format: THREE.RGBAFormat };\r\n\r\n\t\t\t\tlight.shadowMap = new THREE.WebGLRenderTarget( light.shadowMapWidth, light.shadowMapHeight, pars );\r\n\t\t\t\tlight.shadowMapSize = new THREE.Vector2( light.shadowMapWidth, light.shadowMapHeight );\r\n\r\n\t\t\t\tlight.shadowMatrix = new THREE.Matrix4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! light.shadowCamera ) {\r\n\r\n\t\t\t\tif ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\t\tlight.shadowCamera = new THREE.PerspectiveCamera( light.shadowCameraFov, light.shadowMapWidth / light.shadowMapHeight, light.shadowCameraNear, light.shadowCameraFar );\r\n\r\n\t\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\t\tlight.shadowCamera = new THREE.OrthographicCamera( light.shadowCameraLeft, light.shadowCameraRight, light.shadowCameraTop, light.shadowCameraBottom, light.shadowCameraNear, light.shadowCameraFar );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tTHREE.error( \"THREE.ShadowMapPlugin: Unsupported light type for shadow\", light );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscene.add( light.shadowCamera );\r\n\r\n\t\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( light.shadowCameraVisible && ! light.cameraHelper ) {\r\n\r\n\t\t\t\tlight.cameraHelper = new THREE.CameraHelper( light.shadowCamera );\r\n\t\t\t\tscene.add( light.cameraHelper );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( light.isVirtual && virtualLight.originalCamera == camera ) {\r\n\r\n\t\t\t\tupdateShadowCamera( camera, light );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tshadowMap = light.shadowMap;\r\n\t\t\tshadowMatrix = light.shadowMatrix;\r\n\t\t\tshadowCamera = light.shadowCamera;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tshadowCamera.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t_matrixPosition.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\tshadowCamera.lookAt( _matrixPosition );\r\n\t\t\tshadowCamera.updateMatrixWorld();\r\n\r\n\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( light.cameraHelper ) light.cameraHelper.visible = light.shadowCameraVisible;\r\n\t\t\tif ( light.shadowCameraVisible ) light.cameraHelper.update();\r\n\r\n\t\t\t// compute shadow matrix\r\n\r\n\t\t\tshadowMatrix.set(\r\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t);\r\n\r\n\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t// render shadow map\r\n\r\n\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t_renderer.clear();\r\n\r\n\t\t\t// set object matrices & frustum culling\r\n\r\n\t\t\t_renderList.length = 0;\r\n\r\n\t\t\tprojectObject( scene, scene, shadowCamera );\r\n\r\n\r\n\t\t\t// render regular objects\r\n\r\n\t\t\tvar objectMaterial, useMorphing, useSkinning;\r\n\r\n\t\t\tfor ( j = 0, jl = _renderList.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\twebglObject = _renderList[ j ];\r\n\r\n\t\t\t\tobject = webglObject.object;\r\n\t\t\t\tbuffer = webglObject.buffer;\r\n\r\n\t\t\t\t// culling is overriden globally for all objects\r\n\t\t\t\t// while rendering depth map\r\n\r\n\t\t\t\t// need to deal with MeshFaceMaterial somehow\r\n\t\t\t\t// in that case just use the first of material.materials for now\r\n\t\t\t\t// (proper solution would require to break objects by materials\r\n\t\t\t\t//  similarly to regular rendering and then set corresponding\r\n\t\t\t\t//  depth materials per each chunk instead of just once per object)\r\n\r\n\t\t\t\tobjectMaterial = getObjectMaterial( object );\r\n\r\n\t\t\t\tuseMorphing = object.geometry.morphTargets !== undefined && object.geometry.morphTargets.length > 0 && objectMaterial.morphTargets;\r\n\t\t\t\tuseSkinning = object instanceof THREE.SkinnedMesh && objectMaterial.skinning;\r\n\r\n\t\t\t\tif ( object.customDepthMaterial ) {\r\n\r\n\t\t\t\t\tmaterial = object.customDepthMaterial;\r\n\r\n\t\t\t\t} else if ( useSkinning ) {\r\n\r\n\t\t\t\t\tmaterial = useMorphing ? _depthMaterialMorphSkin : _depthMaterialSkin;\r\n\r\n\t\t\t\t} else if ( useMorphing ) {\r\n\r\n\t\t\t\t\tmaterial = _depthMaterialMorph;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmaterial = _depthMaterial;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_renderer.setMaterialFaces( objectMaterial );\r\n\r\n\t\t\t\tif ( buffer instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, fog, material, buffer, object );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_renderer.renderBuffer( shadowCamera, _lights, fog, material, buffer, object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// set matrices and render immediate objects\r\n\r\n\t\t\tfor ( j = 0, jl = _webglObjectsImmediate.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\twebglObject = _webglObjectsImmediate[ j ];\r\n\t\t\t\tobject = webglObject.object;\r\n\r\n\t\t\t\tif ( object.visible && object.castShadow ) {\r\n\r\n\t\t\t\t\tobject._modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\r\n\t\t\t\t\t_renderer.renderImmediateObject( shadowCamera, _lights, fog, _depthMaterial, object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore GL state\r\n\r\n\t\tvar clearColor = _renderer.getClearColor(),\r\n\t\tclearAlpha = _renderer.getClearAlpha();\r\n\r\n\t\t_gl.clearColor( clearColor.r, clearColor.g, clearColor.b, clearAlpha );\r\n\t\t_gl.enable( _gl.BLEND );\r\n\r\n\t\tif ( _renderer.shadowMapCullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction projectObject( scene, object, shadowCamera ) {\r\n\r\n\t\tif ( object.visible ) {\r\n\r\n\t\t\tvar webglObjects = _webglObjects[ object.id ];\r\n\r\n\t\t\tif ( webglObjects && object.castShadow && (object.frustumCulled === false || _frustum.intersectsObject( object ) === true) ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = webglObjects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar webglObject = webglObjects[ i ];\r\n\r\n\t\t\t\t\tobject._modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\t\t_renderList.push( webglObject );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tprojectObject( scene, object.children[ i ], shadowCamera );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createVirtualLight( light, cascade ) {\r\n\r\n\t\tvar virtualLight = new THREE.DirectionalLight();\r\n\r\n\t\tvirtualLight.isVirtual = true;\r\n\r\n\t\tvirtualLight.onlyShadow = true;\r\n\t\tvirtualLight.castShadow = true;\r\n\r\n\t\tvirtualLight.shadowCameraNear = light.shadowCameraNear;\r\n\t\tvirtualLight.shadowCameraFar = light.shadowCameraFar;\r\n\r\n\t\tvirtualLight.shadowCameraLeft = light.shadowCameraLeft;\r\n\t\tvirtualLight.shadowCameraRight = light.shadowCameraRight;\r\n\t\tvirtualLight.shadowCameraBottom = light.shadowCameraBottom;\r\n\t\tvirtualLight.shadowCameraTop = light.shadowCameraTop;\r\n\r\n\t\tvirtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n\r\n\t\tvirtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n\t\tvirtualLight.shadowBias = light.shadowCascadeBias[ cascade ];\r\n\t\tvirtualLight.shadowMapWidth = light.shadowCascadeWidth[ cascade ];\r\n\t\tvirtualLight.shadowMapHeight = light.shadowCascadeHeight[ cascade ];\r\n\r\n\t\tvirtualLight.pointsWorld = [];\r\n\t\tvirtualLight.pointsFrustum = [];\r\n\r\n\t\tvar pointsWorld = virtualLight.pointsWorld,\r\n\t\t\tpointsFrustum = virtualLight.pointsFrustum;\r\n\r\n\t\tfor ( var i = 0; i < 8; i ++ ) {\r\n\r\n\t\t\tpointsWorld[ i ] = new THREE.Vector3();\r\n\t\t\tpointsFrustum[ i ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tvar nearZ = light.shadowCascadeNearZ[ cascade ];\r\n\t\tvar farZ = light.shadowCascadeFarZ[ cascade ];\r\n\r\n\t\tpointsFrustum[ 0 ].set( - 1, - 1, nearZ );\r\n\t\tpointsFrustum[ 1 ].set(  1, - 1, nearZ );\r\n\t\tpointsFrustum[ 2 ].set( - 1,  1, nearZ );\r\n\t\tpointsFrustum[ 3 ].set(  1,  1, nearZ );\r\n\r\n\t\tpointsFrustum[ 4 ].set( - 1, - 1, farZ );\r\n\t\tpointsFrustum[ 5 ].set(  1, - 1, farZ );\r\n\t\tpointsFrustum[ 6 ].set( - 1,  1, farZ );\r\n\t\tpointsFrustum[ 7 ].set(  1,  1, farZ );\r\n\r\n\t\treturn virtualLight;\r\n\r\n\t}\r\n\r\n\t// Synchronize virtual light with the original light\r\n\r\n\tfunction updateVirtualLight( light, cascade ) {\r\n\r\n\t\tvar virtualLight = light.shadowCascadeArray[ cascade ];\r\n\r\n\t\tvirtualLight.position.copy( light.position );\r\n\t\tvirtualLight.target.position.copy( light.target.position );\r\n\t\tvirtualLight.lookAt( virtualLight.target );\r\n\r\n\t\tvirtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n\t\tvirtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n\t\tvirtualLight.shadowBias = light.shadowCascadeBias[ cascade ];\r\n\r\n\t\tvar nearZ = light.shadowCascadeNearZ[ cascade ];\r\n\t\tvar farZ = light.shadowCascadeFarZ[ cascade ];\r\n\r\n\t\tvar pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n\t\tpointsFrustum[ 0 ].z = nearZ;\r\n\t\tpointsFrustum[ 1 ].z = nearZ;\r\n\t\tpointsFrustum[ 2 ].z = nearZ;\r\n\t\tpointsFrustum[ 3 ].z = nearZ;\r\n\r\n\t\tpointsFrustum[ 4 ].z = farZ;\r\n\t\tpointsFrustum[ 5 ].z = farZ;\r\n\t\tpointsFrustum[ 6 ].z = farZ;\r\n\t\tpointsFrustum[ 7 ].z = farZ;\r\n\r\n\t}\r\n\r\n\t// Fit shadow camera's ortho frustum to camera frustum\r\n\r\n\tfunction updateShadowCamera( camera, light ) {\r\n\r\n\t\tvar shadowCamera = light.shadowCamera,\r\n\t\t\tpointsFrustum = light.pointsFrustum,\r\n\t\t\tpointsWorld = light.pointsWorld;\r\n\r\n\t\t_min.set( Infinity, Infinity, Infinity );\r\n\t\t_max.set( - Infinity, - Infinity, - Infinity );\r\n\r\n\t\tfor ( var i = 0; i < 8; i ++ ) {\r\n\r\n\t\t\tvar p = pointsWorld[ i ];\r\n\r\n\t\t\tp.copy( pointsFrustum[ i ] );\r\n\t\t\tp.unproject( camera );\r\n\r\n\t\t\tp.applyMatrix4( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\tif ( p.x < _min.x ) _min.x = p.x;\r\n\t\t\tif ( p.x > _max.x ) _max.x = p.x;\r\n\r\n\t\t\tif ( p.y < _min.y ) _min.y = p.y;\r\n\t\t\tif ( p.y > _max.y ) _max.y = p.y;\r\n\r\n\t\t\tif ( p.z < _min.z ) _min.z = p.z;\r\n\t\t\tif ( p.z > _max.z ) _max.z = p.z;\r\n\r\n\t\t}\r\n\r\n\t\tshadowCamera.left = _min.x;\r\n\t\tshadowCamera.right = _max.x;\r\n\t\tshadowCamera.top = _max.y;\r\n\t\tshadowCamera.bottom = _min.y;\r\n\r\n\t\t// can't really fit near/far\r\n\t\t//shadowCamera.near = _min.z;\r\n\t\t//shadowCamera.far = _max.z;\r\n\r\n\t\tshadowCamera.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\t// For the moment just ignore objects that have multiple materials with different animation methods\r\n\t// Only the first material will be taken into account for deciding which depth material to use for shadow maps\r\n\r\n\tfunction getObjectMaterial( object ) {\r\n\r\n\t\treturn object.material instanceof THREE.MeshFaceMaterial\r\n\t\t\t? object.material.materials[ 0 ]\r\n\t\t\t: object.material;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function ( renderer, sprites ) {\r\n\r\n\tvar gl = renderer.context;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\r\n\tvar texture;\r\n\r\n\t// decompose matrixWorld\r\n\r\n\tvar spritePosition = new THREE.Vector3();\r\n\tvar spriteRotation = new THREE.Quaternion();\r\n\tvar spriteScale = new THREE.Vector3();\r\n\r\n\tvar init = function () {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 0.5, - 0.5,  0, 0,\r\n\t\t\t  0.5, - 0.5,  1, 0,\r\n\t\t\t  0.5,   0.5,  1, 1,\r\n\t\t\t- 0.5,   0.5,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\tvertexBuffer  = gl.createBuffer();\r\n\t\telementBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\tprogram = createProgram();\r\n\r\n\t\tattributes = {\r\n\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\r\n\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\r\n\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\r\n\r\n\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\r\n\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\r\n\r\n\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\r\n\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\r\n\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\r\n\r\n\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\r\n\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\r\n\r\n\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\r\n\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\r\n\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\r\n\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\r\n\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\r\n\r\n\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\r\n\t\t};\r\n\r\n\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = 8;\r\n\t\tcanvas.height = 8;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tcontext.fillStyle = 'white';\r\n\t\tcontext.fillRect( 0, 0, 8, 8 );\r\n\r\n\t\ttexture = new THREE.Texture( canvas );\r\n\t\ttexture.needsUpdate = true;\r\n\r\n\t};\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( sprites.length === 0 ) return;\r\n\r\n\t\t// setup gl\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tgl.enableVertexAttribArray( attributes.position );\r\n\t\tgl.enableVertexAttribArray( attributes.uv );\r\n\r\n\t\tgl.disable( gl.CULL_FACE );\r\n\t\tgl.enable( gl.BLEND );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\tgl.activeTexture( gl.TEXTURE0 );\r\n\t\tgl.uniform1i( uniforms.map, 0 );\r\n\r\n\t\tvar oldFogType = 0;\r\n\t\tvar sceneFogType = 0;\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\tif ( fog ) {\r\n\r\n\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\r\n\r\n\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\r\n\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\r\n\t\t\t\toldFogType = 1;\r\n\t\t\t\tsceneFogType = 1;\r\n\r\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\r\n\t\t\t\toldFogType = 2;\r\n\t\t\t\tsceneFogType = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.uniform1i( uniforms.fogType, 0 );\r\n\t\t\toldFogType = 0;\r\n\t\t\tsceneFogType = 0;\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// update positions and sort\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\r\n\t\t\tsprite._modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\r\n\t\t\tsprite.z = - sprite._modelViewMatrix.elements[ 14 ];\r\n\r\n\t\t}\r\n\r\n\t\tsprites.sort( painterSortStable );\r\n\r\n\t\t// render all sprites\r\n\r\n\t\tvar scale = [];\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\t\t\tvar material = sprite.material;\r\n\r\n\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\r\n\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite._modelViewMatrix.elements );\r\n\r\n\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\r\n\r\n\t\t\tscale[ 0 ] = spriteScale.x;\r\n\t\t\tscale[ 1 ] = spriteScale.y;\r\n\r\n\t\t\tvar fogType = 0;\r\n\r\n\t\t\tif ( scene.fog && material.fog ) {\r\n\r\n\t\t\t\tfogType = sceneFogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( oldFogType !== fogType ) {\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\r\n\t\t\t\toldFogType = fogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\r\n\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\r\n\r\n\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\r\n\t\t\tgl.uniform2fv( uniforms.scale, scale );\r\n\r\n\t\t\trenderer.state.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\r\n\t\t\trenderer.state.setDepthTest( material.depthTest );\r\n\t\t\trenderer.state.setDepthWrite( material.depthWrite );\r\n\r\n\t\t\tif ( material.map && material.map.image && material.map.image.width ) {\r\n\r\n\t\t\t\trenderer.setTexture( material.map, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setTexture( texture, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tgl.enable( gl.CULL_FACE );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram () {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\r\n\t\tgl.shaderSource( vertexShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t'uniform float rotation;',\r\n\t\t\t'uniform vec2 scale;',\r\n\t\t\t'uniform vec2 uvOffset;',\r\n\t\t\t'uniform vec2 uvScale;',\r\n\r\n\t\t\t'attribute vec2 position;',\r\n\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vUV = uvOffset + uv * uvScale;',\r\n\r\n\t\t\t\t'vec2 alignedPosition = position * scale;',\r\n\r\n\t\t\t\t'vec2 rotatedPosition;',\r\n\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n\t\t\t\t'vec4 finalPosition;',\r\n\r\n\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n\t\t\t\t'finalPosition.xy += rotatedPosition;',\r\n\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n\t\t\t\t'gl_Position = finalPosition;',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.shaderSource( fragmentShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform vec3 color;',\r\n\t\t\t'uniform sampler2D map;',\r\n\t\t\t'uniform float opacity;',\r\n\r\n\t\t\t'uniform int fogType;',\r\n\t\t\t'uniform vec3 fogColor;',\r\n\t\t\t'uniform float fogDensity;',\r\n\t\t\t'uniform float fogNear;',\r\n\t\t\t'uniform float fogFar;',\r\n\t\t\t'uniform float alphaTest;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vec4 texture = texture2D( map, vUV );',\r\n\r\n\t\t\t\t'if ( texture.a < alphaTest ) discard;',\r\n\r\n\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n\t\t\t\t'if ( fogType > 0 ) {',\r\n\r\n\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n\t\t\t\t\t'float fogFactor = 0.0;',\r\n\r\n\t\t\t\t\t'if ( fogType == 1 ) {',\r\n\r\n\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n\t\t\t\t\t'} else {',\r\n\r\n\t\t\t\t\t\t'const float LOG2 = 1.442695;',\r\n\t\t\t\t\t\t'float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n\t\t\t\t\t'}',\r\n\r\n\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n\t\t\t\t'}',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.compileShader( vertexShader );\r\n\t\tgl.compileShader( fragmentShader );\r\n\r\n\t\tgl.attachShader( program, vertexShader );\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t};\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn b.id - a.id;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/extras/GeometryUtils.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\tTHREE.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\r\n\t\tvar matrix;\r\n\r\n\t\tif ( geometry2 instanceof THREE.Mesh ) {\r\n\r\n\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\tmatrix = geometry2.matrix;\r\n\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t},\r\n\r\n\tcenter: function ( geometry ) {\r\n\r\n\t\tTHREE.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\treturn geometry.center();\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/ImageUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n */\r\n\r\nTHREE.ImageUtils = {\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\tloadTexture: function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tvar loader = new THREE.ImageLoader();\r\n\t\tloader.crossOrigin = this.crossOrigin;\r\n\r\n\t\tvar texture = new THREE.Texture( undefined, mapping );\r\n\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\ttexture.image = image;\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t}, undefined, function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t} );\r\n\r\n\t\ttexture.sourceFile = url;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadTextureCube: function ( array, mapping, onLoad, onError ) {\r\n\r\n\t\tvar images = [];\r\n\r\n\t\tvar loader = new THREE.ImageLoader();\r\n\t\tloader.crossOrigin = this.crossOrigin;\r\n\r\n\t\tvar texture = new THREE.CubeTexture( images, mapping );\r\n\r\n\t\t// no flipping needed for cube textures\r\n\r\n\t\ttexture.flipY = false;\r\n\r\n\t\tvar loaded = 0;\r\n\r\n\t\tvar loadTexture = function ( i ) {\r\n\r\n\t\t\tloader.load( array[ i ], function ( image ) {\r\n\r\n\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, undefined, onError );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = array.length; i < il; ++ i ) {\r\n\r\n\t\t\tloadTexture( i );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadCompressedTexture: function () {\r\n\r\n\t\tTHREE.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' )\r\n\r\n\t},\r\n\r\n\tloadCompressedTextureCube: function () {\r\n\r\n\t\tTHREE.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' )\r\n\r\n\t},\r\n\r\n\tgetNormalMap: function ( image, depth ) {\r\n\r\n\t\t// Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\r\n\r\n\t\tvar cross = function ( a, b ) {\r\n\r\n\t\t\treturn [ a[ 1 ] * b[ 2 ] - a[ 2 ] * b[ 1 ], a[ 2 ] * b[ 0 ] - a[ 0 ] * b[ 2 ], a[ 0 ] * b[ 1 ] - a[ 1 ] * b[ 0 ] ];\r\n\r\n\t\t}\r\n\r\n\t\tvar subtract = function ( a, b ) {\r\n\r\n\t\t\treturn [ a[ 0 ] - b[ 0 ], a[ 1 ] - b[ 1 ], a[ 2 ] - b[ 2 ] ];\r\n\r\n\t\t}\r\n\r\n\t\tvar normalize = function ( a ) {\r\n\r\n\t\t\tvar l = Math.sqrt( a[ 0 ] * a[ 0 ] + a[ 1 ] * a[ 1 ] + a[ 2 ] * a[ 2 ] );\r\n\t\t\treturn [ a[ 0 ] / l, a[ 1 ] / l, a[ 2 ] / l ];\r\n\r\n\t\t}\r\n\r\n\t\tdepth = depth | 1;\r\n\r\n\t\tvar width = image.width;\r\n\t\tvar height = image.height;\r\n\r\n\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = width;\r\n\t\tcanvas.height = height;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tcontext.drawImage( image, 0, 0 );\r\n\r\n\t\tvar data = context.getImageData( 0, 0, width, height ).data;\r\n\t\tvar imageData = context.createImageData( width, height );\r\n\t\tvar output = imageData.data;\r\n\r\n\t\tfor ( var x = 0; x < width; x ++ ) {\r\n\r\n\t\t\tfor ( var y = 0; y < height; y ++ ) {\r\n\r\n\t\t\t\tvar ly = y - 1 < 0 ? 0 : y - 1;\r\n\t\t\t\tvar uy = y + 1 > height - 1 ? height - 1 : y + 1;\r\n\t\t\t\tvar lx = x - 1 < 0 ? 0 : x - 1;\r\n\t\t\t\tvar ux = x + 1 > width - 1 ? width - 1 : x + 1;\r\n\r\n\t\t\t\tvar points = [];\r\n\t\t\t\tvar origin = [ 0, 0, data[ ( y * width + x ) * 4 ] / 255 * depth ];\r\n\t\t\t\tpoints.push( [ - 1, 0, data[ ( y * width + lx ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ - 1, - 1, data[ ( ly * width + lx ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ 0, - 1, data[ ( ly * width + x ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ 1, - 1, data[ ( ly * width + ux ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ 1, 0, data[ ( y * width + ux ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ 1, 1, data[ ( uy * width + ux ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ 0, 1, data[ ( uy * width + x ) * 4 ] / 255 * depth ] );\r\n\t\t\t\tpoints.push( [ - 1, 1, data[ ( uy * width + lx ) * 4 ] / 255 * depth ] );\r\n\r\n\t\t\t\tvar normals = [];\r\n\t\t\t\tvar num_points = points.length;\r\n\r\n\t\t\t\tfor ( var i = 0; i < num_points; i ++ ) {\r\n\r\n\t\t\t\t\tvar v1 = points[ i ];\r\n\t\t\t\t\tvar v2 = points[ ( i + 1 ) % num_points ];\r\n\t\t\t\t\tv1 = subtract( v1, origin );\r\n\t\t\t\t\tv2 = subtract( v2, origin );\r\n\t\t\t\t\tnormals.push( normalize( cross( v1, v2 ) ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar normal = [ 0, 0, 0 ];\r\n\r\n\t\t\t\tfor ( var i = 0; i < normals.length; i ++ ) {\r\n\r\n\t\t\t\t\tnormal[ 0 ] += normals[ i ][ 0 ];\r\n\t\t\t\t\tnormal[ 1 ] += normals[ i ][ 1 ];\r\n\t\t\t\t\tnormal[ 2 ] += normals[ i ][ 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnormal[ 0 ] /= normals.length;\r\n\t\t\t\tnormal[ 1 ] /= normals.length;\r\n\t\t\t\tnormal[ 2 ] /= normals.length;\r\n\r\n\t\t\t\tvar idx = ( y * width + x ) * 4;\r\n\r\n\t\t\t\toutput[ idx ] = ( ( normal[ 0 ] + 1.0 ) / 2.0 * 255 ) | 0;\r\n\t\t\t\toutput[ idx + 1 ] = ( ( normal[ 1 ] + 1.0 ) / 2.0 * 255 ) | 0;\r\n\t\t\t\toutput[ idx + 2 ] = ( normal[ 2 ] * 255 ) | 0;\r\n\t\t\t\toutput[ idx + 3 ] = 255;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcontext.putImageData( imageData, 0, 0 );\r\n\r\n\t\treturn canvas;\r\n\r\n\t},\r\n\r\n\tgenerateDataTexture: function ( width, height, color ) {\r\n\r\n\t\tvar size = width * height;\r\n\t\tvar data = new Uint8Array( 3 * size );\r\n\r\n\t\tvar r = Math.floor( color.r * 255 );\r\n\t\tvar g = Math.floor( color.g * 255 );\r\n\t\tvar b = Math.floor( color.b * 255 );\r\n\r\n\t\tfor ( var i = 0; i < size; i ++ ) {\r\n\r\n\t\t\tdata[ i * 3 ] \t   = r;\r\n\t\t\tdata[ i * 3 + 1 ] = g;\r\n\t\t\tdata[ i * 3 + 2 ] = b;\r\n\r\n\t\t}\r\n\r\n\t\tvar texture = new THREE.DataTexture( data, width, height, THREE.RGBFormat );\r\n\t\ttexture.needsUpdate = true;\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n\tcreateMultiMaterialObject: function ( geometry, materials ) {\r\n\r\n\t\tvar group = new THREE.Object3D();\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn group;\r\n\r\n\t},\r\n\r\n\tdetach: function ( child, parent, scene ) {\r\n\r\n\t\tchild.applyMatrix( parent.matrixWorld );\r\n\t\tparent.remove( child );\r\n\t\tscene.add( child );\r\n\r\n\t},\r\n\r\n\tattach: function ( child, scene, parent ) {\r\n\r\n\t\tvar matrixWorldInverse = new THREE.Matrix4();\r\n\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\t\tchild.applyMatrix( matrixWorldInverse );\r\n\r\n\t\tscene.remove( child );\r\n\t\tparent.add( child );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/FontUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For Text operations in three.js (See TextGeometry)\r\n *\r\n * It uses techniques used in:\r\n *\r\n * \ttypeface.js and canvastext\r\n * \t\tFor converting fonts and rendering with javascript\r\n *\t\thttp://typeface.neocracy.org\r\n *\r\n *\tTriangulation ported from AS3\r\n *\t\tSimple Polygon Triangulation\r\n *\t\thttp://actionsnippet.com/?p=1462\r\n *\r\n * \tA Method to triangulate shapes with holes\r\n *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\r\n *\r\n */\r\n\r\nTHREE.FontUtils = {\r\n\r\n\tfaces: {},\r\n\r\n\t// Just for now. face[weight][style]\r\n\r\n\tface: 'helvetiker',\r\n\tweight: 'normal',\r\n\tstyle: 'normal',\r\n\tsize: 150,\r\n\tdivisions: 10,\r\n\r\n\tgetFace: function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\treturn this.faces[ this.face ][ this.weight ][ this.style ];\r\n\r\n\t\t} catch (e) {\r\n\r\n\t\t\tthrow \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\"\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\tloadFace: function ( data ) {\r\n\r\n\t\tvar family = data.familyName.toLowerCase();\r\n\r\n\t\tvar ThreeFont = this;\r\n\r\n\t\tThreeFont.faces[ family ] = ThreeFont.faces[ family ] || {};\r\n\r\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ] = ThreeFont.faces[ family ][ data.cssFontWeight ] || {};\r\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ][ data.cssFontStyle ] = data;\r\n\r\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ][ data.cssFontStyle ] = data;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tdrawText: function ( text ) {\r\n\r\n\t\t// RenderText\r\n\r\n\t\tvar i,\r\n\t\t\tface = this.getFace(),\r\n\t\t\tscale = this.size / face.resolution,\r\n\t\t\toffset = 0,\r\n\t\t\tchars = String( text ).split( '' ),\r\n\t\t\tlength = chars.length;\r\n\r\n\t\tvar fontPaths = [];\r\n\r\n\t\tfor ( i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tvar path = new THREE.Path();\r\n\r\n\t\t\tvar ret = this.extractGlyphPoints( chars[ i ], face, scale, offset, path );\r\n\t\t\toffset += ret.offset;\r\n\r\n\t\t\tfontPaths.push( ret.path );\r\n\r\n\t\t}\r\n\r\n\t\t// get the width\r\n\r\n\t\tvar width = offset / 2;\r\n\t\t//\r\n\t\t// for ( p = 0; p < allPts.length; p++ ) {\r\n\t\t//\r\n\t\t// \tallPts[ p ].x -= width;\r\n\t\t//\r\n\t\t// }\r\n\r\n\t\t//var extract = this.extractPoints( allPts, characterPts );\r\n\t\t//extract.contour = allPts;\r\n\r\n\t\t//extract.paths = fontPaths;\r\n\t\t//extract.offset = width;\r\n\r\n\t\treturn { paths: fontPaths, offset: width };\r\n\r\n\t},\r\n\r\n\r\n\r\n\r\n\textractGlyphPoints: function ( c, face, scale, offset, path ) {\r\n\r\n\t\tvar pts = [];\r\n\r\n\t\tvar i, i2, divisions,\r\n\t\t\toutline, action, length,\r\n\t\t\tscaleX, scaleY,\r\n\t\t\tx, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2,\r\n\t\t\tlaste,\r\n\t\t\tglyph = face.glyphs[ c ] || face.glyphs[ '?' ];\r\n\r\n\t\tif ( ! glyph ) return;\r\n\r\n\t\tif ( glyph.o ) {\r\n\r\n\t\t\toutline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\r\n\t\t\tlength = outline.length;\r\n\r\n\t\t\tscaleX = scale;\r\n\t\t\tscaleY = scale;\r\n\r\n\t\t\tfor ( i = 0; i < length; ) {\r\n\r\n\t\t\t\taction = outline[ i ++ ];\r\n\r\n\t\t\t\t//console.log( action );\r\n\r\n\t\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\tcase 'm':\r\n\r\n\t\t\t\t\t// Move To\r\n\r\n\t\t\t\t\tx = outline[ i ++ ] * scaleX + offset;\r\n\t\t\t\t\ty = outline[ i ++ ] * scaleY;\r\n\r\n\t\t\t\t\tpath.moveTo( x, y );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'l':\r\n\r\n\t\t\t\t\t// Line To\r\n\r\n\t\t\t\t\tx = outline[ i ++ ] * scaleX + offset;\r\n\t\t\t\t\ty = outline[ i ++ ] * scaleY;\r\n\t\t\t\t\tpath.lineTo( x, y );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'q':\r\n\r\n\t\t\t\t\t// QuadraticCurveTo\r\n\r\n\t\t\t\t\tcpx  = outline[ i ++ ] * scaleX + offset;\r\n\t\t\t\t\tcpy  = outline[ i ++ ] * scaleY;\r\n\t\t\t\t\tcpx1 = outline[ i ++ ] * scaleX + offset;\r\n\t\t\t\t\tcpy1 = outline[ i ++ ] * scaleY;\r\n\r\n\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\r\n\r\n\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\tfor ( i2 = 1, divisions = this.divisions; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b2( t, cpy0, cpy1, cpy );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'b':\r\n\r\n\t\t\t\t\t// Cubic Bezier Curve\r\n\r\n\t\t\t\t\tcpx  = outline[ i ++ ] *  scaleX + offset;\r\n\t\t\t\t\tcpy  = outline[ i ++ ] *  scaleY;\r\n\t\t\t\t\tcpx1 = outline[ i ++ ] *  scaleX + offset;\r\n\t\t\t\t\tcpy1 = outline[ i ++ ] *  scaleY;\r\n\t\t\t\t\tcpx2 = outline[ i ++ ] *  scaleX + offset;\r\n\t\t\t\t\tcpy2 = outline[ i ++ ] *  scaleY;\r\n\r\n\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\r\n\r\n\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\tfor ( i2 = 1, divisions = this.divisions; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\treturn { offset: glyph.ha * scale, path:path };\r\n\t}\r\n\r\n};\r\n\r\n\r\nTHREE.FontUtils.generateShapes = function ( text, parameters ) {\r\n\r\n\t// Parameters \r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar size = parameters.size !== undefined ? parameters.size : 100;\r\n\tvar curveSegments = parameters.curveSegments !== undefined ? parameters.curveSegments : 4;\r\n\r\n\tvar font = parameters.font !== undefined ? parameters.font : 'helvetiker';\r\n\tvar weight = parameters.weight !== undefined ? parameters.weight : 'normal';\r\n\tvar style = parameters.style !== undefined ? parameters.style : 'normal';\r\n\r\n\tTHREE.FontUtils.size = size;\r\n\tTHREE.FontUtils.divisions = curveSegments;\r\n\r\n\tTHREE.FontUtils.face = font;\r\n\tTHREE.FontUtils.weight = weight;\r\n\tTHREE.FontUtils.style = style;\r\n\r\n\t// Get a Font data json object\r\n\r\n\tvar data = THREE.FontUtils.drawText( text );\r\n\r\n\tvar paths = data.paths;\r\n\tvar shapes = [];\r\n\r\n\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\r\n\r\n\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\r\n\r\n\t}\r\n\r\n\treturn shapes;\r\n\r\n};\r\n\r\n\r\n/**\r\n * This code is a quick port of code written in C++ which was submitted to\r\n * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n * See original code and more information here:\r\n * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n *\r\n * ported to actionscript by Zevan Rosser\r\n * www.actionsnippet.com\r\n *\r\n * ported to javascript by Joshua Koo\r\n * http://www.lab4games.net/zz85/blog\r\n *\r\n */\r\n\r\n\r\n( function ( namespace ) {\r\n\r\n\tvar EPSILON = 0.0000000001;\r\n\r\n\t// takes in an contour array and returns\r\n\r\n\tvar process = function ( contour, indices ) {\r\n\r\n\t\tvar n = contour.length;\r\n\r\n\t\tif ( n < 3 ) return null;\r\n\r\n\t\tvar result = [],\r\n\t\t\tverts = [],\r\n\t\t\tvertIndices = [];\r\n\r\n\t\t/* we want a counter-clockwise polygon in verts */\r\n\r\n\t\tvar u, v, w;\r\n\r\n\t\tif ( area( contour ) > 0.0 ) {\r\n\r\n\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\r\n\r\n\t\t}\r\n\r\n\t\tvar nv = n;\r\n\r\n\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n\t\tvar count = 2 * nv;   /* error detection */\r\n\r\n\t\tfor ( v = nv - 1; nv > 2; ) {\r\n\r\n\t\t\t/* if we loop, it is probably a non-simple polygon */\r\n\r\n\t\t\tif ( ( count -- ) <= 0 ) {\r\n\r\n\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\r\n\r\n\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\r\n\t\t\t\t//return null;\r\n\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n\t\t\t\tTHREE.warn( 'THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()' );\r\n\r\n\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\treturn result;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\r\n\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\r\n\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\r\n\r\n\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\r\n\r\n\t\t\t\tvar a, b, c, s, t;\r\n\r\n\t\t\t\t/* true names of the vertices */\r\n\r\n\t\t\t\ta = verts[ u ];\r\n\t\t\t\tb = verts[ v ];\r\n\t\t\t\tc = verts[ w ];\r\n\r\n\t\t\t\t/* output Triangle */\r\n\r\n\t\t\t\tresult.push( [ contour[ a ],\r\n\t\t\t\t\tcontour[ b ],\r\n\t\t\t\t\tcontour[ c ] ] );\r\n\r\n\r\n\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\r\n\r\n\t\t\t\t/* remove v from the remaining polygon */\r\n\r\n\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\r\n\r\n\t\t\t\t\tverts[ s ] = verts[ t ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnv --;\r\n\r\n\t\t\t\t/* reset error detection counter */\r\n\r\n\t\t\t\tcount = 2 * nv;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( indices ) return vertIndices;\r\n\t\treturn result;\r\n\r\n\t};\r\n\r\n\t// calculate area of the contour polygon\r\n\r\n\tvar area = function ( contour ) {\r\n\r\n\t\tvar n = contour.length;\r\n\t\tvar a = 0.0;\r\n\r\n\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t}\r\n\r\n\t\treturn a * 0.5;\r\n\r\n\t};\r\n\r\n\tvar snip = function ( contour, u, v, w, n, verts ) {\r\n\r\n\t\tvar p;\r\n\t\tvar ax, ay, bx, by;\r\n\t\tvar cx, cy, px, py;\r\n\r\n\t\tax = contour[ verts[ u ] ].x;\r\n\t\tay = contour[ verts[ u ] ].y;\r\n\r\n\t\tbx = contour[ verts[ v ] ].x;\r\n\t\tby = contour[ verts[ v ] ].y;\r\n\r\n\t\tcx = contour[ verts[ w ] ].x;\r\n\t\tcy = contour[ verts[ w ] ].y;\r\n\r\n\t\tif ( EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\r\n\r\n\t\tvar aX, aY, bX, bY, cX, cY;\r\n\t\tvar apx, apy, bpx, bpy, cpx, cpy;\r\n\t\tvar cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n\t\taX = cx - bx;  aY = cy - by;\r\n\t\tbX = ax - cx;  bY = ay - cy;\r\n\t\tcX = bx - ax;  cY = by - ay;\r\n\r\n\t\tfor ( p = 0; p < n; p ++ ) {\r\n\r\n\t\t\tpx = contour[ verts[ p ] ].x\r\n\t\t\tpy = contour[ verts[ p ] ].y\r\n\r\n\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\r\n\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\r\n\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\r\n\r\n\t\t\tapx = px - ax;  apy = py - ay;\r\n\t\t\tbpx = px - bx;  bpy = py - by;\r\n\t\t\tcpx = px - cx;  cpy = py - cy;\r\n\r\n\t\t\t// see if p is inside triangle abc\r\n\r\n\t\t\taCROSSbp = aX * bpy - aY * bpx;\r\n\t\t\tcCROSSap = cX * apy - cY * apx;\r\n\t\t\tbCROSScp = bX * cpy - bY * cpx;\r\n\r\n\t\t\tif ( ( aCROSSbp >= - EPSILON ) && ( bCROSScp >= - EPSILON ) && ( cCROSSap >= - EPSILON ) ) return false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t};\r\n\r\n\r\n\tnamespace.Triangulate = process;\r\n\tnamespace.Triangulate.area = area;\r\n\r\n\treturn namespace;\r\n\r\n} )( THREE.FontUtils );\r\n\r\n// To use the typeface.js face files, hook up the API\r\nself._typeface_js = { faces: THREE.FontUtils.faces, loadFace: THREE.FontUtils.loadFace };\r\nTHREE.typeface_js = self._typeface_js;\r\n\r\n// File:src/extras/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Audio = function ( listener ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Audio';\r\n\r\n\tthis.context = listener.context;\r\n\tthis.source = this.context.createBufferSource();\r\n\tthis.source.onended = this.onEnded.bind(this);\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( this.context.destination );\r\n\r\n\tthis.panner = this.context.createPanner();\r\n\tthis.panner.connect( this.gain );\r\n\r\n\tthis.autoplay = false;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.load = function ( file ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar request = new XMLHttpRequest();\r\n\trequest.open( 'GET', file, true );\r\n\trequest.responseType = 'arraybuffer';\r\n\trequest.onload = function ( e ) {\r\n\r\n\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\r\n\r\n\t\t\tscope.source.buffer = buffer;\r\n\r\n\t\t\tif( scope.autoplay ) scope.play();\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\trequest.send();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function () {\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tTHREE.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tvar source = this.context.createBufferSource();\r\n\r\n\tsource.buffer = this.source.buffer;\r\n\tsource.loop = this.source.loop;\r\n\tsource.onended = this.source.onended;\r\n\tsource.connect( this.panner );\r\n\tsource.start( 0, this.startTime );\r\n\r\n\tthis.isPlaying = true;\r\n\r\n\tthis.source = source;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function () {\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function () {\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function() {\r\n\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function ( value ) {\r\n\r\n\tthis.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRefDistance = function ( value ) {\r\n\r\n\tthis.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\r\n\r\n\tthis.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setVolume = function ( value ) {\r\n\r\n\tthis.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\r\n\treturn function ( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tposition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tthis.panner.setPosition( position.x, position.y, position.z );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'AudioListener';\r\n\r\n\tthis.context = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3();\r\n\r\n\tvar orientation = new THREE.Vector3();\r\n\tvar velocity = new THREE.Vector3();\r\n\r\n\tvar positionPrev = new THREE.Vector3();\r\n\r\n\treturn function ( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tvar listener = this.context.listener;\r\n\t\tvar up = this.up;\r\n\r\n\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\torientation.set( 0, 0, -1 ).applyQuaternion( quaternion );\r\n\t\tvelocity.subVectors( position, positionPrev );\r\n\r\n\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\t\tlistener.setVelocity( velocity.x, velocity.y, velocity.z );\r\n\r\n\t\tpositionPrev.copy( position );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n * THREE.ClosedSplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function () {\r\n\r\n};\r\n\r\n// Virtual base class method to overwrite and implement in subclasses\r\n//\t- t [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPoint = function ( t ) {\r\n\r\n\tTHREE.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\r\n\treturn null;\r\n\r\n};\r\n\r\n// Get point at relative position in curve according to arc length\r\n// - u [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPointAt = function ( u ) {\r\n\r\n\tvar t = this.getUtoTmapping( u );\r\n\treturn this.getPoint( t );\r\n\r\n};\r\n\r\n// Get sequence of points using getPoint( t )\r\n\r\nTHREE.Curve.prototype.getPoints = function ( divisions ) {\r\n\r\n\tif ( ! divisions ) divisions = 5;\r\n\r\n\tvar d, pts = [];\r\n\r\n\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\tpts.push( this.getPoint( d / divisions ) );\r\n\r\n\t}\r\n\r\n\treturn pts;\r\n\r\n};\r\n\r\n// Get sequence of points using getPointAt( u )\r\n\r\nTHREE.Curve.prototype.getSpacedPoints = function ( divisions ) {\r\n\r\n\tif ( ! divisions ) divisions = 5;\r\n\r\n\tvar d, pts = [];\r\n\r\n\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\tpts.push( this.getPointAt( d / divisions ) );\r\n\r\n\t}\r\n\r\n\treturn pts;\r\n\r\n};\r\n\r\n// Get total curve arc length\r\n\r\nTHREE.Curve.prototype.getLength = function () {\r\n\r\n\tvar lengths = this.getLengths();\r\n\treturn lengths[ lengths.length - 1 ];\r\n\r\n};\r\n\r\n// Get list of cumulative segment lengths\r\n\r\nTHREE.Curve.prototype.getLengths = function ( divisions ) {\r\n\r\n\tif ( ! divisions ) divisions = (this.__arcLengthDivisions) ? (this.__arcLengthDivisions) : 200;\r\n\r\n\tif ( this.cacheArcLengths\r\n\t\t&& ( this.cacheArcLengths.length == divisions + 1 )\r\n\t\t&& ! this.needsUpdate) {\r\n\r\n\t\t//console.log( \"cached\", this.cacheArcLengths );\r\n\t\treturn this.cacheArcLengths;\r\n\r\n\t}\r\n\r\n\tthis.needsUpdate = false;\r\n\r\n\tvar cache = [];\r\n\tvar current, last = this.getPoint( 0 );\r\n\tvar p, sum = 0;\r\n\r\n\tcache.push( 0 );\r\n\r\n\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\tcurrent = this.getPoint ( p / divisions );\r\n\t\tsum += current.distanceTo( last );\r\n\t\tcache.push( sum );\r\n\t\tlast = current;\r\n\r\n\t}\r\n\r\n\tthis.cacheArcLengths = cache;\r\n\r\n\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.updateArcLengths = function() {\r\n\tthis.needsUpdate = true;\r\n\tthis.getLengths();\r\n};\r\n\r\n// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equi distance\r\n\r\nTHREE.Curve.prototype.getUtoTmapping = function ( u, distance ) {\r\n\r\n\tvar arcLengths = this.getLengths();\r\n\r\n\tvar i = 0, il = arcLengths.length;\r\n\r\n\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\tif ( distance ) {\r\n\r\n\t\ttargetArcLength = distance;\r\n\r\n\t} else {\r\n\r\n\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t}\r\n\r\n\t//var time = Date.now();\r\n\r\n\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\tvar low = 0, high = il - 1, comparison;\r\n\r\n\twhile ( low <= high ) {\r\n\r\n\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\tlow = i + 1;\r\n\r\n\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\thigh = i - 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\thigh = i;\r\n\t\t\tbreak;\r\n\r\n\t\t\t// DONE\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\ti = high;\r\n\r\n\t//console.log('b' , i, low, high, Date.now()- time);\r\n\r\n\tif ( arcLengths[ i ] == targetArcLength ) {\r\n\r\n\t\tvar t = i / ( il - 1 );\r\n\t\treturn t;\r\n\r\n\t}\r\n\r\n\t// we could get finer grain at lengths, or use simple interpolatation between two points\r\n\r\n\tvar lengthBefore = arcLengths[ i ];\r\n\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n    // determine where we are between the 'before' and 'after' points\r\n\r\n\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n    // add that fractional amount to t\r\n\r\n\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\treturn t;\r\n\r\n};\r\n\r\n// Returns a unit vector tangent at t\r\n// In case any sub curve does not implement its tangent derivation,\r\n// 2 points a small delta apart will be used to find its gradient\r\n// which seems to give a reasonable approximation\r\n\r\nTHREE.Curve.prototype.getTangent = function( t ) {\r\n\r\n\tvar delta = 0.0001;\r\n\tvar t1 = t - delta;\r\n\tvar t2 = t + delta;\r\n\r\n\t// Capping in case of danger\r\n\r\n\tif ( t1 < 0 ) t1 = 0;\r\n\tif ( t2 > 1 ) t2 = 1;\r\n\r\n\tvar pt1 = this.getPoint( t1 );\r\n\tvar pt2 = this.getPoint( t2 );\r\n\r\n\tvar vec = pt2.clone().sub(pt1);\r\n\treturn vec.normalize();\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.getTangentAt = function ( u ) {\r\n\r\n\tvar t = this.getUtoTmapping( u );\r\n\treturn this.getTangent( t );\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Curve.Utils = {\r\n\r\n\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\r\n\r\n\t},\r\n\r\n\t// Puay Bing, thanks for helping with this derivative!\r\n\r\n\ttangentCubicBezier: function (t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn - 3 * p0 * (1 - t) * (1 - t)  +\r\n\t\t\t3 * p1 * (1 - t) * (1 - t) - 6 * t * p1 * (1 - t) +\r\n\t\t\t6 * t *  p2 * (1 - t) - 3 * t * t * p2 +\r\n\t\t\t3 * t * t * p3;\r\n\r\n\t},\r\n\r\n\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t// To check if my formulas are correct\r\n\r\n\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3 − 3t^2 + 1\r\n\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3 − 2t^2 + t\r\n\t\tvar h01 = - 6 * t * t + 6 * t; \t// − 2t3 + 3t2\r\n\t\tvar h11 = 3 * t * t - 2 * t;\t// t3 − t2\r\n\r\n\t\treturn h00 + h10 + h01 + h11;\r\n\r\n\t},\r\n\r\n\t// Catmull-Rom\r\n\r\n\tinterpolate: function( p0, p1, p2, p3, t ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function ( constructor, getPointFunc ) {\r\n\r\n\tconstructor.prototype = Object.create( THREE.Curve.prototype );\r\n\tconstructor.prototype.constructor = constructor;\r\n\tconstructor.prototype.getPoint = getPointFunc;\r\n\r\n\treturn constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function () {\r\n\r\n\tthis.curves = [];\r\n\tthis.bends = [];\r\n\t\r\n\tthis.autoClose = false; // Automatically closes the path\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function ( curve ) {\r\n\r\n\tthis.curves.push( curve );\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n\t// TODO\r\n\t// If the ending of curve is not connected to the starting\r\n\t// or the next curve, then, this is not a real path\r\n};\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n\t// TODO Test\r\n\t// and verify for vector3 (needs to implement equals)\r\n\t// Add a line curve if start and end of lines are not connected\r\n\tvar startPoint = this.curves[0].getPoint(0);\r\n\tvar endPoint = this.curves[this.curves.length - 1].getPoint(1);\r\n\t\r\n\tif (! startPoint.equals(endPoint)) {\r\n\t\tthis.curves.push( new THREE.LineCurve(endPoint, startPoint) );\r\n\t}\r\n\t\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function( t ) {\r\n\r\n\tvar d = t * this.getLength();\r\n\tvar curveLengths = this.getCurveLengths();\r\n\tvar i = 0, diff, curve;\r\n\r\n\t// To think about boundaries points.\r\n\r\n\twhile ( i < curveLengths.length ) {\r\n\r\n\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\tdiff = curveLengths[ i ] - d;\r\n\t\t\tcurve = this.curves[ i ];\r\n\r\n\t\t\tvar u = 1 - diff / curve.getLength();\r\n\r\n\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t}\r\n\r\n\t\ti ++;\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};*/\r\n\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n\tvar lens = this.getCurveLengths();\r\n\treturn lens[ lens.length - 1 ];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n\t// We use cache values if curves and cache array are same length\r\n\r\n\tif ( this.cacheLengths && this.cacheLengths.length == this.curves.length ) {\r\n\r\n\t\treturn this.cacheLengths;\r\n\r\n\t};\r\n\r\n\t// Get length of subsurve\r\n\t// Push sums into cached array\r\n\r\n\tvar lengths = [], sums = 0;\r\n\tvar i, il = this.curves.length;\r\n\r\n\tfor ( i = 0; i < il; i ++ ) {\r\n\r\n\t\tsums += this.curves[ i ].getLength();\r\n\t\tlengths.push( sums );\r\n\r\n\t}\r\n\r\n\tthis.cacheLengths = lengths;\r\n\r\n\treturn lengths;\r\n\r\n};\r\n\r\n\r\n\r\n// Returns min and max coordinates\r\n\r\nTHREE.CurvePath.prototype.getBoundingBox = function () {\r\n\r\n\tvar points = this.getPoints();\r\n\r\n\tvar maxX, maxY, maxZ;\r\n\tvar minX, minY, minZ;\r\n\r\n\tmaxX = maxY = Number.NEGATIVE_INFINITY;\r\n\tminX = minY = Number.POSITIVE_INFINITY;\r\n\r\n\tvar p, i, il, sum;\r\n\r\n\tvar v3 = points[0] instanceof THREE.Vector3;\r\n\r\n\tsum = v3 ? new THREE.Vector3() : new THREE.Vector2();\r\n\r\n\tfor ( i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\tp = points[ i ];\r\n\r\n\t\tif ( p.x > maxX ) maxX = p.x;\r\n\t\telse if ( p.x < minX ) minX = p.x;\r\n\r\n\t\tif ( p.y > maxY ) maxY = p.y;\r\n\t\telse if ( p.y < minY ) minY = p.y;\r\n\r\n\t\tif ( v3 ) {\r\n\r\n\t\t\tif ( p.z > maxZ ) maxZ = p.z;\r\n\t\t\telse if ( p.z < minZ ) minZ = p.z;\r\n\r\n\t\t}\r\n\r\n\t\tsum.add( p );\r\n\r\n\t}\r\n\r\n\tvar ret = {\r\n\r\n\t\tminX: minX,\r\n\t\tminY: minY,\r\n\t\tmaxX: maxX,\r\n\t\tmaxY: maxY\r\n\r\n\t};\r\n\r\n\tif ( v3 ) {\r\n\r\n\t\tret.maxZ = maxZ;\r\n\t\tret.minZ = minZ;\r\n\r\n\t}\r\n\r\n\treturn ret;\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getPoints( divisions, true );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\n// Generate geometry from equidistance sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getSpacedPoints( divisions, true );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function( points ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0; i < points.length; i ++ ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3( points[ i ].x, points[ i ].y, points[ i ].z || 0) );\r\n\r\n\t}\r\n\r\n\treturn geometry;\r\n\r\n};\r\n\r\n\r\n/**************************************************************\r\n *\tBend / Wrap Helper Methods\r\n **************************************************************/\r\n\r\n// Wrap path / Bend modifiers?\r\n\r\nTHREE.CurvePath.prototype.addWrapPath = function ( bendpath ) {\r\n\r\n\tthis.bends.push( bendpath );\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedPoints = function( segments, bends ) {\r\n\r\n\tvar oldPts = this.getPoints( segments ); // getPoints getSpacedPoints\r\n\tvar i, il;\r\n\r\n\tif ( ! bends ) {\r\n\r\n\t\tbends = this.bends;\r\n\r\n\t}\r\n\r\n\tfor ( i = 0, il = bends.length; i < il; i ++ ) {\r\n\r\n\t\toldPts = this.getWrapPoints( oldPts, bends[ i ] );\r\n\r\n\t}\r\n\r\n\treturn oldPts;\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedSpacedPoints = function( segments, bends ) {\r\n\r\n\tvar oldPts = this.getSpacedPoints( segments );\r\n\r\n\tvar i, il;\r\n\r\n\tif ( ! bends ) {\r\n\r\n\t\tbends = this.bends;\r\n\r\n\t}\r\n\r\n\tfor ( i = 0, il = bends.length; i < il; i ++ ) {\r\n\r\n\t\toldPts = this.getWrapPoints( oldPts, bends[ i ] );\r\n\r\n\t}\r\n\r\n\treturn oldPts;\r\n\r\n};\r\n\r\n// This returns getPoints() bend/wrapped around the contour of a path.\r\n// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\r\n\r\nTHREE.CurvePath.prototype.getWrapPoints = function ( oldPts, path ) {\r\n\r\n\tvar bounds = this.getBoundingBox();\r\n\r\n\tvar i, il, p, oldX, oldY, xNorm;\r\n\r\n\tfor ( i = 0, il = oldPts.length; i < il; i ++ ) {\r\n\r\n\t\tp = oldPts[ i ];\r\n\r\n\t\toldX = p.x;\r\n\t\toldY = p.y;\r\n\r\n\t\txNorm = oldX / bounds.maxX;\r\n\r\n\t\t// If using actual distance, for length > path, requires line extrusions\r\n\t\t//xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\r\n\r\n\t\txNorm = path.getUtoTmapping( xNorm, oldX );\r\n\r\n\t\t// check for out of bounds?\r\n\r\n\t\tvar pathPt = path.getPoint( xNorm );\r\n\t\tvar normal = path.getTangent( xNorm );\r\n\t\tnormal.set( - normal.y, normal.x ).multiplyScalar( oldY );\r\n\r\n\t\tp.x = pathPt.x + normal.x;\r\n\t\tp.y = pathPt.y + normal.y;\r\n\r\n\t}\r\n\r\n\treturn oldPts;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/core/Gyroscope.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Gyroscope = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n};\r\n\r\nTHREE.Gyroscope.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Gyroscope.prototype.constructor = THREE.Gyroscope;\r\n\r\nTHREE.Gyroscope.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar translationObject = new THREE.Vector3();\r\n\tvar quaternionObject = new THREE.Quaternion();\r\n\tvar scaleObject = new THREE.Vector3();\r\n\r\n\tvar translationWorld = new THREE.Vector3();\r\n\tvar quaternionWorld = new THREE.Quaternion();\r\n\tvar scaleWorld = new THREE.Vector3();\r\n\r\n\treturn function ( force ) {\r\n\r\n\t\tthis.matrixAutoUpdate && this.updateMatrix();\r\n\r\n\t\t// update matrixWorld\r\n\r\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\r\n\r\n\t\t\tif ( this.parent ) {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t\tthis.matrixWorld.decompose( translationWorld, quaternionWorld, scaleWorld );\r\n\t\t\t\tthis.matrix.decompose( translationObject, quaternionObject, scaleObject );\r\n\r\n\t\t\t\tthis.matrixWorld.compose( translationWorld, quaternionObject, scaleWorld );\r\n\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\tforce = true;\r\n\r\n\t\t}\r\n\r\n\t\t// update children\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\t\r\n}() );\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function ( points ) {\r\n\r\n\tTHREE.CurvePath.call(this);\r\n\r\n\tthis.actions = [];\r\n\r\n\tif ( points ) {\r\n\r\n\t\tthis.fromPoints( points );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create( THREE.CurvePath.prototype );\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\nTHREE.PathActions = {\r\n\r\n\tMOVE_TO: 'moveTo',\r\n\tLINE_TO: 'lineTo',\r\n\tQUADRATIC_CURVE_TO: 'quadraticCurveTo', // Bezier quadratic curve\r\n\tBEZIER_CURVE_TO: 'bezierCurveTo', \t\t// Bezier cubic curve\r\n\tCSPLINE_THRU: 'splineThru',\t\t\t\t// Catmull-rom spline\r\n\tARC: 'arc',\t\t\t\t\t\t\t\t// Circle\r\n\tELLIPSE: 'ellipse'\r\n};\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function ( vectors ) {\r\n\r\n\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\r\n\r\n\tfor ( var v = 1, vlen = vectors.length; v < vlen; v ++ ) {\r\n\r\n\t\tthis.lineTo( vectors[ v ].x, vectors[ v ].y );\r\n\r\n\t};\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function ( x, y ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\tthis.actions.push( { action: THREE.PathActions.MOVE_TO, args: args } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function ( x, y ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: THREE.PathActions.LINE_TO, args: args } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function( aCPx, aCPy, aX, aY ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.QuadraticBezierCurve( new THREE.Vector2( x0, y0 ),\r\n\t\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCPx, aCPy ),\r\n\t\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aX, aY ) );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: THREE.PathActions.QUADRATIC_CURVE_TO, args: args } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function( aCP1x, aCP1y,\r\n\t\t\t\t\t\t\t\t\t\t\t   aCP2x, aCP2y,\r\n\t\t\t\t\t\t\t\t\t\t\t   aX, aY ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.CubicBezierCurve( new THREE.Vector2( x0, y0 ),\r\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCP1x, aCP1y ),\r\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCP2x, aCP2y ),\r\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aX, aY ) );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: THREE.PathActions.BEZIER_CURVE_TO, args: args } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function( pts /*Array of Vector*/ ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n//---\r\n\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\r\n\tArray.prototype.push.apply( npts, pts );\r\n\r\n\tvar curve = new THREE.SplineCurve( npts );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: THREE.PathActions.CSPLINE_THRU, args: args } );\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function ( aX, aY, aRadius,\r\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absarc(aX + x0, aY + y0, aRadius,\r\n\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\n THREE.Path.prototype.absarc = function ( aX, aY, aRadius,\r\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\r\n\tthis.absellipse(aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n };\r\n\r\nTHREE.Path.prototype.ellipse = function ( aX, aY, xRadius, yRadius,\r\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absellipse(aX + x0, aY + y0, xRadius, yRadius,\r\n\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function ( aX, aY, xRadius, yRadius,\r\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius,\r\n\t\t\t\t\t\t\t\t\taStartAngle, aEndAngle, aClockwise );\r\n\tthis.curves.push( curve );\r\n\r\n\tvar lastPoint = curve.getPoint(1);\r\n\targs.push(lastPoint.x);\r\n\targs.push(lastPoint.y);\r\n\r\n\tthis.actions.push( { action: THREE.PathActions.ELLIPSE, args: args } );\r\n\r\n };\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function ( divisions, closedPath ) {\r\n\r\n\tif ( ! divisions ) divisions = 40;\r\n\r\n\tvar points = [];\r\n\r\n\tfor ( var i = 0; i < divisions; i ++ ) {\r\n\r\n\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t//if( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n\t}\r\n\r\n\t// if ( closedPath ) {\r\n\t//\r\n\t// \tpoints.push( points[ 0 ] );\r\n\t//\r\n\t// }\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function( divisions, closedPath ) {\r\n\r\n\tif (this.useSpacedPoints) {\r\n\t\tconsole.log('tata');\r\n\t\treturn this.getSpacedPoints( divisions, closedPath );\r\n\t}\r\n\r\n\tdivisions = divisions || 12;\r\n\r\n\tvar points = [];\r\n\r\n\tvar i, il, item, action, args;\r\n\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n\t\tlaste, j,\r\n\t\tt, tx, ty;\r\n\r\n\tfor ( i = 0, il = this.actions.length; i < il; i ++ ) {\r\n\r\n\t\titem = this.actions[ i ];\r\n\r\n\t\taction = item.action;\r\n\t\targs = item.args;\r\n\r\n\t\tswitch ( action ) {\r\n\r\n\t\tcase THREE.PathActions.MOVE_TO:\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase THREE.PathActions.LINE_TO:\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase THREE.PathActions.QUADRATIC_CURVE_TO:\r\n\r\n\t\t\tcpx  = args[ 2 ];\r\n\t\t\tcpy  = args[ 3 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tt = j / divisions;\r\n\r\n\t\t\t\ttx = THREE.Shape.Utils.b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\tty = THREE.Shape.Utils.b2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase THREE.PathActions.BEZIER_CURVE_TO:\r\n\r\n\t\t\tcpx  = args[ 4 ];\r\n\t\t\tcpy  = args[ 5 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tcpx2 = args[ 2 ];\r\n\t\t\tcpy2 = args[ 3 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfor ( j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tt = j / divisions;\r\n\r\n\t\t\t\ttx = THREE.Shape.Utils.b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\tty = THREE.Shape.Utils.b3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase THREE.PathActions.CSPLINE_THRU:\r\n\r\n\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\r\n\t\t\tvar spts = [ last ];\r\n\r\n\t\t\tvar n = divisions * args[ 0 ].length;\r\n\r\n\t\t\tspts = spts.concat( args[ 0 ] );\r\n\r\n\t\t\tvar spline = new THREE.SplineCurve( spts );\r\n\r\n\t\t\tfor ( j = 1; j <= n; j ++ ) {\r\n\r\n\t\t\t\tpoints.push( spline.getPointAt( j / n ) ) ;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase THREE.PathActions.ARC:\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\taRadius = args[ 2 ],\r\n\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\r\n\t\t\t\taClockwise = !! args[ 5 ];\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tfor ( j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tt = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + aRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + aRadius * Math.sin( angle );\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\t\t  \r\n\t\tcase THREE.PathActions.ELLIPSE:\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\txRadius = args[ 2 ],\r\n\t\t\t\tyRadius = args[ 3 ],\r\n\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\r\n\t\t\t\taClockwise = !! args[ 6 ];\r\n\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tfor ( j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tt = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + xRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + yRadius * Math.sin( angle );\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t} // end switch\r\n\r\n\t}\r\n\r\n\r\n\r\n\t// Normalize to remove the closing point by default.\r\n\tvar lastPoint = points[ points.length - 1];\r\n\tvar EPSILON = 0.0000000001;\r\n\tif ( Math.abs(lastPoint.x - points[ 0 ].x) < EPSILON &&\r\n\t\t\t Math.abs(lastPoint.y - points[ 0 ].y) < EPSILON)\r\n\t\tpoints.splice( points.length - 1, 1);\r\n\tif ( closedPath ) {\r\n\r\n\t\tpoints.push( points[ 0 ] );\r\n\r\n\t}\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function( isCCW, noHoles ) {\r\n\r\n\tfunction extractSubpaths( inActions ) {\r\n\r\n\t\tvar i, il, item, action, args;\r\n\r\n\t\tvar subPaths = [], lastPath = new THREE.Path();\r\n\r\n\t\tfor ( i = 0, il = inActions.length; i < il; i ++ ) {\r\n\r\n\t\t\titem = inActions[ i ];\r\n\r\n\t\t\targs = item.args;\r\n\t\t\taction = item.action;\r\n\r\n\t\t\tif ( action == THREE.PathActions.MOVE_TO ) {\r\n\r\n\t\t\t\tif ( lastPath.actions.length != 0 ) {\r\n\r\n\t\t\t\t\tsubPaths.push( lastPath );\r\n\t\t\t\t\tlastPath = new THREE.Path();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlastPath[ action ].apply( lastPath, args );\r\n\r\n\t\t}\r\n\r\n\t\tif ( lastPath.actions.length != 0 ) {\r\n\r\n\t\t\tsubPaths.push( lastPath );\r\n\r\n\t\t}\r\n\r\n\t\t// console.log(subPaths);\r\n\r\n\t\treturn\tsubPaths;\r\n\t}\r\n\r\n\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\tvar shapes = [];\r\n\r\n\t\tfor ( var i = 0, il = inSubpaths.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\tvar tmpShape = new THREE.Shape();\r\n\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\tshapes.push( tmpShape );\r\n\t\t}\r\n\r\n\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\treturn shapes;\r\n\t};\r\n\r\n\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\t\tvar EPSILON = 0.0000000001;\r\n\r\n\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t// inPt on polygon contour => immediate success    or\r\n\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\tvar inside = false;\r\n\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\t\t\tvar edgeLowPt  = inPolygon[ p ];\r\n\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\tif ( Math.abs(edgeDy) > EPSILON ) {\t\t\t// not parallel\r\n\t\t\t\tif ( edgeDy < 0 ) {\r\n\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\t\t\t\t}\r\n\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\r\n\t\t\t\tif ( inPt.y == edgeLowPt.y ) {\r\n\t\t\t\t\tif ( inPt.x == edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar perpEdge = edgeDy * (inPt.x - edgeLowPt.x) - edgeDx * (inPt.y - edgeLowPt.y);\r\n\t\t\t\t\tif ( perpEdge == 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\t\t\t\t}\r\n\t\t\t} else {\t\t// parallel or colinear\r\n\t\t\t\tif ( inPt.y != edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t// egde lies on the same horizontal line as inPt\r\n\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t// continue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn\tinside;\r\n\t}\r\n\r\n\r\n\tvar subPaths = extractSubpaths( this.actions );\r\n\tif ( subPaths.length == 0 ) return [];\r\n\r\n\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\tif ( subPaths.length == 1) {\r\n\r\n\t\ttmpPath = subPaths[0];\r\n\t\ttmpShape = new THREE.Shape();\r\n\t\ttmpShape.actions = tmpPath.actions;\r\n\t\ttmpShape.curves = tmpPath.curves;\r\n\t\tshapes.push( tmpShape );\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n\tvar holesFirst = ! THREE.Shape.Utils.isClockWise( subPaths[ 0 ].getPoints() );\r\n\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t// console.log(\"Holes first\", holesFirst);\r\n\t\r\n\tvar betterShapeHoles = [];\r\n\tvar newShapes = [];\r\n\tvar newShapeHoles = [];\r\n\tvar mainIdx = 0;\r\n\tvar tmpPoints;\r\n\r\n\tnewShapes[mainIdx] = undefined;\r\n\tnewShapeHoles[mainIdx] = [];\r\n\r\n\tvar i, il;\r\n\r\n\tfor ( i = 0, il = subPaths.length; i < il; i ++ ) {\r\n\r\n\t\ttmpPath = subPaths[ i ];\r\n\t\ttmpPoints = tmpPath.getPoints();\r\n\t\tsolid = THREE.Shape.Utils.isClockWise( tmpPoints );\r\n\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\tif ( solid ) {\r\n\r\n\t\t\tif ( (! holesFirst ) && ( newShapes[mainIdx] ) )\tmainIdx ++;\r\n\r\n\t\t\tnewShapes[mainIdx] = { s: new THREE.Shape(), p: tmpPoints };\r\n\t\t\tnewShapes[mainIdx].s.actions = tmpPath.actions;\r\n\t\t\tnewShapes[mainIdx].s.curves = tmpPath.curves;\r\n\t\t\t\r\n\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\tnewShapeHoles[mainIdx] = [];\r\n\r\n\t\t\t//console.log('cw', i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewShapeHoles[mainIdx].push( { h: tmpPath, p: tmpPoints[0] } );\r\n\r\n\t\t\t//console.log('ccw', i);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// only Holes? -> probably all Shapes with wrong orientation\r\n\tif ( ! newShapes[0] )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tif ( newShapes.length > 1 ) {\r\n\t\tvar ambigious = false;\r\n\t\tvar toChange = [];\r\n\r\n\t\tfor (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\t\t\tbetterShapeHoles[sIdx] = [];\r\n\t\t}\r\n\t\tfor (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\t\t\tvar sho = newShapeHoles[sIdx];\r\n\t\t\tfor (var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\t\t\t\tvar ho = sho[hIdx];\r\n\t\t\t\tvar hole_unassigned = true;\r\n\t\t\t\tfor (var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[s2Idx].p ) ) {\r\n\t\t\t\t\t\tif ( sIdx != s2Idx )\t\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\tbetterShapeHoles[s2Idx].push( ho );\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tambigious = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif ( hole_unassigned ) { betterShapeHoles[sIdx].push( ho ); }\r\n\t\t\t}\r\n\t\t}\r\n\t\t// console.log(\"ambigious: \", ambigious);\r\n\t\tif ( toChange.length > 0 ) {\r\n\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\tif (! ambigious)\tnewShapeHoles = betterShapeHoles;\r\n\t\t}\r\n\t}\r\n\r\n\tvar tmpHoles, j, jl;\r\n\tfor ( i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\t\ttmpShape = newShapes[i].s;\r\n\t\tshapes.push( tmpShape );\r\n\t\ttmpHoles = newShapeHoles[i];\r\n\t\tfor ( j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\t\t\ttmpShape.holes.push( tmpHoles[j].h );\r\n\t\t}\r\n\t}\r\n\r\n\t//console.log(\"shape\", shapes);\r\n\r\n\treturn shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function () {\r\n\r\n\tTHREE.Path.apply( this, arguments );\r\n\tthis.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create( THREE.Path.prototype );\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function ( options ) {\r\n\r\n\tvar extruded = new THREE.ExtrudeGeometry( this, options );\r\n\treturn extruded;\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function ( options ) {\r\n\r\n\tvar geometry = new THREE.ShapeGeometry( this, options );\r\n\treturn geometry;\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function ( divisions ) {\r\n\r\n\tvar i, il = this.holes.length, holesPts = [];\r\n\r\n\tfor ( i = 0; i < il; i ++ ) {\r\n\r\n\t\tholesPts[ i ] = this.holes[ i ].getTransformedPoints( divisions, this.bends );\r\n\r\n\t}\r\n\r\n\treturn holesPts;\r\n\r\n};\r\n\r\n// Get points of holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.getSpacedPointsHoles = function ( divisions ) {\r\n\r\n\tvar i, il = this.holes.length, holesPts = [];\r\n\r\n\tfor ( i = 0; i < il; i ++ ) {\r\n\r\n\t\tholesPts[ i ] = this.holes[ i ].getTransformedSpacedPoints( divisions, this.bends );\r\n\r\n\t}\r\n\r\n\treturn holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function ( divisions ) {\r\n\r\n\treturn {\r\n\r\n\t\tshape: this.getTransformedPoints( divisions ),\r\n\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function ( divisions ) {\r\n\r\n\tif (this.useSpacedPoints) {\r\n\t\treturn this.extractAllSpacedPoints(divisions);\r\n\t}\r\n\r\n\treturn this.extractAllPoints(divisions);\r\n\r\n};\r\n\r\n//\r\n// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\r\n//\r\n// \treturn {\r\n//\r\n// \t\tshape: this.transform( bend, divisions ),\r\n// \t\tholes: this.getPointsHoles( divisions, bend )\r\n//\r\n// \t};\r\n//\r\n// };\r\n\r\n// Get points of shape and holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.extractAllSpacedPoints = function ( divisions ) {\r\n\r\n\treturn {\r\n\r\n\t\tshape: this.getTransformedSpacedPoints( divisions ),\r\n\t\tholes: this.getSpacedPointsHoles( divisions )\r\n\r\n\t};\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Shape.Utils = {\r\n\r\n\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\r\n\t\t\t// inOtherPt needs to be colinear to the inSegment\r\n\t\t\tif ( inSegPt1.x != inSegPt2.x ) {\r\n\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\r\n\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\r\n\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\r\n\t\t\tvar EPSILON = 0.0000000001;\r\n\r\n\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\r\n\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n\t\t\tif ( Math.abs(limit) > EPSILON ) {\t\t\t// not parallel\r\n\r\n\t\t\t\tvar perpSeg2;\r\n\t\t\t\tif ( limit > 0 ) {\r\n\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// i.e. to reduce rounding errors\r\n\t\t\t\t// intersection at endpoint of segment#1?\r\n\t\t\t\tif ( perpSeg2 == 0 ) {\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 == 0 ) || ( perpSeg1 == limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\t\t\t\t}\r\n\t\t\t\tif ( perpSeg2 == limit ) {\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 == 0 ) || ( perpSeg1 == limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt2 ];\r\n\t\t\t\t}\r\n\t\t\t\t// intersection at endpoint of segment#2?\r\n\t\t\t\tif ( perpSeg1 == 0 )\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\tif ( perpSeg1 == limit )\treturn [ inSeg2Pt2 ];\r\n\r\n\t\t\t\t// return real intersection point\r\n\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\r\n\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\r\n\r\n\t\t\t} else {\t\t// parallel or colinear\r\n\t\t\t\tif ( ( perpSeg1 != 0 ) ||\r\n\t\t\t\t\t ( seg2dy * seg1seg2dx != seg2dx * seg1seg2dy ) ) \t\t\treturn [];\r\n\r\n\t\t\t\t// they are collinear or degenerate\r\n\t\t\t\tvar seg1Pt = ( (seg1dx == 0) && (seg1dy == 0) );\t// segment1 ist just a point?\r\n\t\t\t\tvar seg2Pt = ( (seg2dx == 0) && (seg2dy == 0) );\t// segment2 ist just a point?\r\n\t\t\t\t// both segments are points\r\n\t\t\t\tif ( seg1Pt && seg2Pt ) {\r\n\t\t\t\t\tif ( (inSeg1Pt1.x != inSeg2Pt1.x) ||\r\n\t\t\t\t\t\t (inSeg1Pt1.y != inSeg2Pt1.y) )\t\treturn [];   \t// they are distinct  points\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t// they are the same point\r\n\t\t\t\t}\r\n\t\t\t\t// segment#1  is a single point\r\n\t\t\t\tif ( seg1Pt ) {\r\n\t\t\t\t\tif (! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\t\t\t\t}\r\n\t\t\t\t// segment#2  is a single point\r\n\t\t\t\tif ( seg2Pt ) {\r\n\t\t\t\t\tif (! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\r\n\t\t\t\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// they are collinear segments, which might overlap\r\n\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\r\n\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\r\n\t\t\t\tif (seg1dx != 0) {\t\t// the segments are NOT on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\t\t\t\t// the segments are on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif ( seg1minVal <= seg2minVal ) {\r\n\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\r\n\t\t\t\t\tif ( seg1maxVal == seg2minVal )\t{\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg2min ];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg2min, seg2max ];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\r\n\t\t\t\t\tif ( seg1minVal == seg2maxVal )\t{\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg1min ];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg1min, seg2max ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\r\n\t\t\t// The order of legs is important\r\n\r\n\t\t\tvar EPSILON = 0.0000000001;\r\n\r\n\t\t\t// translation of all points, so that Vertex is at (0,0)\r\n\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\r\n\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\r\n\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\r\n\r\n\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n\t\t\tif ( Math.abs(from2toAngle) > EPSILON ) {\t\t\t// angle != 180 deg.\r\n\r\n\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\r\n\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n\t\t\t\tif ( from2toAngle > 0 ) {\t\t\t\t// main angle < 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\r\n\t\t\t\t} else {\t\t\t\t\t\t\t\t// main angle > 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\r\n\t\t\t\t}\r\n\t\t\t} else {\t\t\t\t\t\t\t\t\t\t// angle == 180 deg.\r\n\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n\t\t\t\treturn\t( from2otherAngle > 0 );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction removeHoles( contour, holes ) {\r\n\r\n\t\t\tvar shape = contour.concat(); // work on this shape\r\n\t\t\tvar hole;\r\n\r\n\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\r\n\t\t\t\t// Check if hole point lies within angle around shape point\r\n\t\t\t\tvar lastShapeIdx = shape.length - 1;\r\n\r\n\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\r\n\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\r\n\r\n\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\r\n\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\r\n\r\n\t\t\t\tvar insideAngle = isPointInsideAngle( shape[inShapeIdx], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[inHoleIdx] );\r\n\t\t\t\tif (! insideAngle ) {\r\n\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if shape point lies within angle around hole point\r\n\t\t\t\tvar lastHoleIdx = hole.length - 1;\r\n\r\n\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\r\n\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\r\n\r\n\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\r\n\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\r\n\r\n\t\t\t\tinsideAngle = isPointInsideAngle( hole[inHoleIdx], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[inShapeIdx] );\r\n\t\t\t\tif (! insideAngle ) {\r\n\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\ttrue;\r\n\t\t\t}\r\n\r\n\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\r\n\t\t\t\t// checks for intersections with shape edges\r\n\t\t\t\tvar sIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\r\n\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\r\n\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[sIdx], shape[nextIdx], true );\r\n\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tfalse;\r\n\t\t\t}\r\n\r\n\t\t\tvar indepHoles = [];\r\n\r\n\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\r\n\t\t\t\t// checks for intersections with hole edges\r\n\t\t\t\tvar ihIdx, chkHole,\r\n\t\t\t\t\thIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\r\n\t\t\t\t\tchkHole = holes[indepHoles[ihIdx]];\r\n\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\r\n\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\r\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[hIdx], chkHole[nextIdx], true );\r\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn\tfalse;\r\n\t\t\t}\r\n\r\n\t\t\tvar holeIndex, shapeIndex,\r\n\t\t\t\tshapePt, holePt,\r\n\t\t\t\tholeIdx, cutKey, failedCuts = [],\r\n\t\t\t\ttmpShape1, tmpShape2,\r\n\t\t\t\ttmpHole1, tmpHole2;\r\n\r\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tindepHoles.push( h );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar minShapeIndex = 0;\r\n\t\t\tvar counter = indepHoles.length * 2;\r\n\t\t\twhile ( indepHoles.length > 0 ) {\r\n\t\t\t\tcounter --;\r\n\t\t\t\tif ( counter < 0 ) {\r\n\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// search for shape-vertex and hole-vertex,\r\n\t\t\t\t// which can be connected without intersections\r\n\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\r\n\r\n\t\t\t\t\tshapePt = shape[ shapeIndex ];\r\n\t\t\t\t\tholeIndex\t= - 1;\r\n\r\n\t\t\t\t\t// search for hole which can be reached without intersections\r\n\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\r\n\t\t\t\t\t\tholeIdx = indepHoles[h];\r\n\r\n\t\t\t\t\t\t// prevent multiple checks\r\n\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n\t\t\t\t\t\tif ( failedCuts[cutKey] !== undefined )\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\thole = holes[holeIdx];\r\n\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\r\n\t\t\t\t\t\t\tholePt = hole[ h2 ];\r\n\t\t\t\t\t\t\tif (! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\tholeIndex = h2;\r\n\t\t\t\t\t\t\tindepHoles.splice(h, 1);\r\n\r\n\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\r\n\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\r\n\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\r\n\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\r\n\r\n\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\r\n\r\n\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\r\n\r\n\t\t\t\t\t\t\t// Debug only, to show the selected cuts\r\n\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t\t\tfailedCuts[cutKey] = true;\t\t\t// remember failure\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn shape; \t\t\t/* shape with no holes */\r\n\t\t}\r\n\r\n\r\n\t\tvar i, il, f, face,\r\n\t\t\tkey, index,\r\n\t\t\tallPointsMap = {};\r\n\r\n\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n\t\tvar allpoints = contour.concat();\r\n\r\n\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( allpoints, holes[h] );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n\t\t// prepare all points map\r\n\r\n\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\r\n\r\n\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\r\n\r\n\t\t\tif ( allPointsMap[ key ] !== undefined ) {\r\n\r\n\t\t\t\tTHREE.warn( \"THREE.Shape: Duplicate point\", key );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tallPointsMap[ key ] = i;\r\n\r\n\t\t}\r\n\r\n\t\t// remove holes by cutting paths to holes and adding them to the shape\r\n\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\r\n\r\n\t\tvar triangles = THREE.FontUtils.Triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\r\n\t\t//console.log( \"triangles\",triangles, triangles.length );\r\n\r\n\t\t// check all face vertices against all points map\r\n\r\n\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = triangles[ i ];\r\n\r\n\t\t\tfor ( f = 0; f < 3; f ++ ) {\r\n\r\n\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\r\n\r\n\t\t\t\tindex = allPointsMap[ key ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tface[ f ] = index;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn triangles.concat();\r\n\r\n\t},\r\n\r\n\tisClockWise: function ( pts ) {\r\n\r\n\t\treturn THREE.FontUtils.Triangulate.area( pts ) < 0;\r\n\r\n\t},\r\n\r\n\t// Bezier Curves formulas obtained from\r\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n\t// Quad Bezier Functions\r\n\r\n\tb2p0: function ( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * p;\r\n\r\n\t},\r\n\r\n\tb2p1: function ( t, p ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t},\r\n\r\n\tb2p2: function ( t, p ) {\r\n\r\n\t\treturn t * t * p;\r\n\r\n\t},\r\n\r\n\tb2: function ( t, p0, p1, p2 ) {\r\n\r\n\t\treturn this.b2p0( t, p0 ) + this.b2p1( t, p1 ) + this.b2p2( t, p2 );\r\n\r\n\t},\r\n\r\n\t// Cubic Bezier Functions\r\n\r\n\tb3p0: function ( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * k * p;\r\n\r\n\t},\r\n\r\n\tb3p1: function ( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn 3 * k * k * t * p;\r\n\r\n\t},\r\n\r\n\tb3p2: function ( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn 3 * k * t * t * p;\r\n\r\n\t},\r\n\r\n\tb3p3: function ( t, p ) {\r\n\r\n\t\treturn t * t * t * p;\r\n\r\n\t},\r\n\r\n\tb3: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn this.b3p0( t, p0 ) + this.b3p1( t, p1 ) + this.b3p2( t, p2 ) +  this.b3p3( t, p3 );\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function ( v1, v2 ) {\r\n\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar point = this.v2.clone().sub(this.v1);\r\n\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\treturn point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function ( u ) {\r\n\r\n\treturn this.getPoint( u );\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangent = this.v2.clone().sub(this.v1);\r\n\r\n\treturn tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar vector = new THREE.Vector2();\r\n\r\n\tvector.x = THREE.Shape.Utils.b2( t, this.v0.x, this.v1.x, this.v2.x );\r\n\tvector.y = THREE.Shape.Utils.b2( t, this.v0.y, this.v1.y, this.v2.y );\r\n\r\n\treturn vector;\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar vector = new THREE.Vector2();\r\n\r\n\tvector.x = THREE.Curve.Utils.tangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x );\r\n\tvector.y = THREE.Curve.Utils.tangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y );\r\n\r\n\t// returns unit vector\r\n\r\n\treturn vector.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\tthis.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar tx, ty;\r\n\r\n\ttx = THREE.Shape.Utils.b3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\r\n\tty = THREE.Shape.Utils.b3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\r\n\r\n\treturn new THREE.Vector2( tx, ty );\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tx, ty;\r\n\r\n\ttx = THREE.Curve.Utils.tangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\r\n\tty = THREE.Curve.Utils.tangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\r\n\r\n\tvar tangent = new THREE.Vector2( tx, ty );\r\n\ttangent.normalize();\r\n\r\n\treturn tangent;\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\r\n\r\n\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar points = this.points;\r\n\tvar point = ( points.length - 1 ) * t;\r\n\r\n\tvar intPoint = Math.floor( point );\r\n\tvar weight = point - intPoint;\r\n\r\n\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ]\r\n\tvar point1 = points[ intPoint ]\r\n\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ]\r\n\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ]\r\n\r\n\tvar vector = new THREE.Vector2();\r\n\r\n\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\r\n\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\r\n\r\n\treturn vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tthis.aX = aX;\r\n\tthis.aY = aY;\r\n\r\n\tthis.xRadius = xRadius;\r\n\tthis.yRadius = yRadius;\r\n\r\n\tthis.aStartAngle = aStartAngle;\r\n\tthis.aEndAngle = aEndAngle;\r\n\r\n\tthis.aClockwise = aClockwise;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\r\n\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\r\n\r\n\tvar angle;\r\n\r\n\tif ( this.aClockwise === true ) {\r\n\r\n\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\r\n\r\n\t} else {\r\n\r\n\t\tangle = this.aStartAngle + t * deltaAngle;\r\n\r\n\t}\r\n\t\r\n\tvar vector = new THREE.Vector2();\r\n\r\n\tvector.x = this.aX + this.xRadius * Math.cos( angle );\r\n\tvector.y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\treturn vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v1, v2 ) {\r\n\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\r\n\t\tvector.multiplyScalar( t );\r\n\t\tvector.add( this.v1 );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.x = THREE.Shape.Utils.b2( t, this.v0.x, this.v1.x, this.v2.x );\r\n\t\tvector.y = THREE.Shape.Utils.b2( t, this.v0.y, this.v1.y, this.v2.y );\r\n\t\tvector.z = THREE.Shape.Utils.b2( t, this.v0.z, this.v1.z, this.v2.z );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2, v3 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\tthis.v3 = v3;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.x = THREE.Shape.Utils.b3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\r\n\t\tvector.y = THREE.Shape.Utils.b3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\r\n\t\tvector.z = THREE.Shape.Utils.b3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */) {\r\n\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar point1 = points[ intPoint ];\r\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\r\n\t\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\r\n\t\tvector.z = THREE.Curve.Utils.interpolate( point0.z, point1.z, point2.z, point3.z, weight );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */) {\r\n\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 0 ) * t; // This needs to be from 0-length +1\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\r\n\r\n\t\tvar point0 = points[ ( intPoint - 1 ) % points.length ];\r\n\t\tvar point1 = points[ ( intPoint     ) % points.length ];\r\n\t\tvar point2 = points[ ( intPoint + 1 ) % points.length ];\r\n\t\tvar point3 = points[ ( intPoint + 2 ) % points.length ];\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\r\n\t\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\r\n\t\tvector.z = THREE.Curve.Utils.interpolate( point0.z, point1.z, point2.z, point3.z, weight );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/animation/AnimationHandler.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\nTHREE.AnimationHandler = {\r\n\r\n\tLINEAR: 0,\r\n\tCATMULLROM: 1,\r\n\tCATMULLROM_FORWARD: 2,\r\n\r\n\t//\r\n\r\n\tadd: function () { THREE.warn( 'THREE.AnimationHandler.add() has been deprecated.' ); },\r\n\tget: function () { THREE.warn( 'THREE.AnimationHandler.get() has been deprecated.' ); },\r\n\tremove: function () { THREE.warn( 'THREE.AnimationHandler.remove() has been deprecated.' ); },\r\n\r\n\t//\r\n\r\n\tanimations: [],\r\n\r\n\tinit: function ( data ) {\r\n\r\n\t\tif ( data.initialized === true ) return data;\r\n\r\n\t\t// loop through all keys\r\n\r\n\t\tfor ( var h = 0; h < data.hierarchy.length; h ++ ) {\r\n\r\n\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\r\n\r\n\t\t\t\t// remove minus times\r\n\r\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].time < 0 ) {\r\n\r\n\t\t\t\t\t data.hierarchy[ h ].keys[ k ].time = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create quaternions\r\n\r\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].rot !== undefined &&\r\n\t\t\t\t  ! ( data.hierarchy[ h ].keys[ k ].rot instanceof THREE.Quaternion ) ) {\r\n\r\n\t\t\t\t\tvar quat = data.hierarchy[ h ].keys[ k ].rot;\r\n\t\t\t\t\tdata.hierarchy[ h ].keys[ k ].rot = new THREE.Quaternion().fromArray( quat );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// prepare morph target keys\r\n\r\n\t\t\tif ( data.hierarchy[ h ].keys.length && data.hierarchy[ h ].keys[ 0 ].morphTargets !== undefined ) {\r\n\r\n\t\t\t\t// get all used\r\n\r\n\t\t\t\tvar usedMorphTargets = {};\r\n\r\n\t\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\r\n\r\n\t\t\t\t\tfor ( var m = 0; m < data.hierarchy[ h ].keys[ k ].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\tvar morphTargetName = data.hierarchy[ h ].keys[ k ].morphTargets[ m ];\r\n\t\t\t\t\t\tusedMorphTargets[ morphTargetName ] = - 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.hierarchy[ h ].usedMorphTargets = usedMorphTargets;\r\n\r\n\r\n\t\t\t\t// set all used on all frames\r\n\r\n\t\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\r\n\r\n\t\t\t\t\tvar influences = {};\r\n\r\n\t\t\t\t\tfor ( var morphTargetName in usedMorphTargets ) {\r\n\r\n\t\t\t\t\t\tfor ( var m = 0; m < data.hierarchy[ h ].keys[ k ].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].morphTargets[ m ] === morphTargetName ) {\r\n\r\n\t\t\t\t\t\t\t\tinfluences[ morphTargetName ] = data.hierarchy[ h ].keys[ k ].morphTargetsInfluences[ m ];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( m === data.hierarchy[ h ].keys[ k ].morphTargets.length ) {\r\n\r\n\t\t\t\t\t\t\tinfluences[ morphTargetName ] = 0;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdata.hierarchy[ h ].keys[ k ].morphTargetsInfluences = influences;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// remove all keys that are on the same time\r\n\r\n\t\t\tfor ( var k = 1; k < data.hierarchy[ h ].keys.length; k ++ ) {\r\n\r\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].time === data.hierarchy[ h ].keys[ k - 1 ].time ) {\r\n\r\n\t\t\t\t\tdata.hierarchy[ h ].keys.splice( k, 1 );\r\n\t\t\t\t\tk --;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// set index\r\n\r\n\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\r\n\r\n\t\t\t\tdata.hierarchy[ h ].keys[ k ].index = k;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tdata.initialized = true;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tparse: function ( root ) {\r\n\r\n\t\tvar parseRecurseHierarchy = function ( root, hierarchy ) {\r\n\r\n\t\t\thierarchy.push( root );\r\n\r\n\t\t\tfor ( var c = 0; c < root.children.length; c ++ )\r\n\t\t\t\tparseRecurseHierarchy( root.children[ c ], hierarchy );\r\n\r\n\t\t};\r\n\r\n\t\t// setup hierarchy\r\n\r\n\t\tvar hierarchy = [];\r\n\r\n\t\tif ( root instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\tfor ( var b = 0; b < root.skeleton.bones.length; b ++ ) {\r\n\r\n\t\t\t\thierarchy.push( root.skeleton.bones[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tparseRecurseHierarchy( root, hierarchy );\r\n\r\n\t\t}\r\n\r\n\t\treturn hierarchy;\r\n\r\n\t},\r\n\r\n\tplay: function ( animation ) {\r\n\r\n\t\tif ( this.animations.indexOf( animation ) === - 1 ) {\r\n\r\n\t\t\tthis.animations.push( animation );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tstop: function ( animation ) {\r\n\r\n\t\tvar index = this.animations.indexOf( animation );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tthis.animations.splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdate: function ( deltaTimeMS ) {\r\n\r\n\t\tfor ( var i = 0; i < this.animations.length; i ++ ) {\r\n\r\n\t\t\tthis.animations[ i ].resetBlendWeights( );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.animations.length; i ++ ) {\r\n\r\n\t\t\tthis.animations[ i ].update( deltaTimeMS );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/animation/Animation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Animation = function ( root, data ) {\r\n\r\n\tthis.root = root;\r\n\tthis.data = THREE.AnimationHandler.init( data );\r\n\tthis.hierarchy = THREE.AnimationHandler.parse( root );\r\n\r\n\tthis.currentTime = 0;\r\n\tthis.timeScale = 1;\r\n\r\n\tthis.isPlaying = false;\r\n\tthis.loop = true;\r\n\tthis.weight = 0;\r\n\r\n\tthis.interpolationType = THREE.AnimationHandler.LINEAR;\r\n\r\n};\r\n\r\nTHREE.Animation.prototype = {\r\n\r\n\tconstructor: THREE.Animation,\r\n\r\n\tkeyTypes:  [ \"pos\", \"rot\", \"scl\" ],\r\n\r\n\tplay: function ( startTime, weight ) {\r\n\r\n\t\tthis.currentTime = startTime !== undefined ? startTime : 0;\r\n\t\tthis.weight = weight !== undefined ? weight : 1;\r\n\r\n\t\tthis.isPlaying = true;\r\n\r\n\t\tthis.reset();\r\n\r\n\t\tTHREE.AnimationHandler.play( this );\r\n\r\n\t},\r\n\r\n\tstop: function() {\r\n\r\n\t\tthis.isPlaying = false;\r\n\r\n\t\tTHREE.AnimationHandler.stop( this );\r\n\r\n\t},\r\n\r\n\treset: function () {\r\n\r\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\r\n\r\n\t\t\tvar object = this.hierarchy[ h ];\r\n\r\n\t\t\tif ( object.animationCache === undefined ) {\r\n\r\n\t\t\t\tobject.animationCache = {\r\n\t\t\t\t\tanimations: {},\r\n\t\t\t\t\tblending: {\r\n\t\t\t\t\t\tpositionWeight: 0.0,\r\n\t\t\t\t\t\tquaternionWeight: 0.0,\r\n\t\t\t\t\t\tscaleWeight: 0.0\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tvar name = this.data.name;\r\n\t\t\tvar animations = object.animationCache.animations;\r\n\t\t\tvar animationCache = animations[ name ];\r\n\r\n\t\t\tif ( animationCache === undefined ) {\r\n\r\n\t\t\t\tanimationCache = {\r\n\t\t\t\t\tprevKey: { pos: 0, rot: 0, scl: 0 },\r\n\t\t\t\t\tnextKey: { pos: 0, rot: 0, scl: 0 },\r\n\t\t\t\t\toriginalMatrix: object.matrix\r\n\t\t\t\t};\r\n\r\n\t\t\t\tanimations[ name ] = animationCache;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Get keys to match our current time\r\n\r\n\t\t\tfor ( var t = 0; t < 3; t ++ ) {\r\n\r\n\t\t\t\tvar type = this.keyTypes[ t ];\r\n\r\n\t\t\t\tvar prevKey = this.data.hierarchy[ h ].keys[ 0 ];\r\n\t\t\t\tvar nextKey = this.getNextKeyWith( type, h, 1 );\r\n\r\n\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\r\n\r\n\t\t\t\t\tprevKey = nextKey;\r\n\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, nextKey.index + 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tanimationCache.prevKey[ type ] = prevKey;\r\n\t\t\t\tanimationCache.nextKey[ type ] = nextKey;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tresetBlendWeights: function () {\r\n\r\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\r\n\r\n\t\t\tvar object = this.hierarchy[ h ];\r\n\t\t\tvar animationCache = object.animationCache;\r\n\r\n\t\t\tif ( animationCache !== undefined ) {\r\n\r\n\t\t\t\tvar blending = animationCache.blending;\r\n\r\n\t\t\t\tblending.positionWeight = 0.0;\r\n\t\t\t\tblending.quaternionWeight = 0.0;\r\n\t\t\t\tblending.scaleWeight = 0.0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdate: ( function() {\r\n\r\n\t\tvar points = [];\r\n\t\tvar target = new THREE.Vector3();\r\n\t\tvar newVector = new THREE.Vector3();\r\n\t\tvar newQuat = new THREE.Quaternion();\r\n\r\n\t\t// Catmull-Rom spline\r\n\r\n\t\tvar interpolateCatmullRom = function ( points, scale ) {\r\n\r\n\t\t\tvar c = [], v3 = [],\r\n\t\t\tpoint, intPoint, weight, w2, w3,\r\n\t\t\tpa, pb, pc, pd;\r\n\r\n\t\t\tpoint = ( points.length - 1 ) * scale;\r\n\t\t\tintPoint = Math.floor( point );\r\n\t\t\tweight = point - intPoint;\r\n\r\n\t\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\t\tc[ 1 ] = intPoint;\r\n\t\t\tc[ 2 ] = intPoint > points.length - 2 ? intPoint : intPoint + 1;\r\n\t\t\tc[ 3 ] = intPoint > points.length - 3 ? intPoint : intPoint + 2;\r\n\r\n\t\t\tpa = points[ c[ 0 ] ];\r\n\t\t\tpb = points[ c[ 1 ] ];\r\n\t\t\tpc = points[ c[ 2 ] ];\r\n\t\t\tpd = points[ c[ 3 ] ];\r\n\r\n\t\t\tw2 = weight * weight;\r\n\t\t\tw3 = weight * w2;\r\n\r\n\t\t\tv3[ 0 ] = interpolate( pa[ 0 ], pb[ 0 ], pc[ 0 ], pd[ 0 ], weight, w2, w3 );\r\n\t\t\tv3[ 1 ] = interpolate( pa[ 1 ], pb[ 1 ], pc[ 1 ], pd[ 1 ], weight, w2, w3 );\r\n\t\t\tv3[ 2 ] = interpolate( pa[ 2 ], pb[ 2 ], pc[ 2 ], pd[ 2 ], weight, w2, w3 );\r\n\r\n\t\t\treturn v3;\r\n\r\n\t\t};\r\n\r\n\t\tvar interpolate = function ( p0, p1, p2, p3, t, t2, t3 ) {\r\n\r\n\t\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\r\n\t\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t\t};\r\n\r\n\t\treturn function ( delta ) {\r\n\r\n\t\t\tif ( this.isPlaying === false ) return;\r\n\r\n\t\t\tthis.currentTime += delta * this.timeScale;\r\n\r\n\t\t\tif ( this.weight === 0 )\r\n\t\t\t\treturn;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar duration = this.data.length;\r\n\r\n\t\t\tif ( this.currentTime > duration || this.currentTime < 0 ) {\r\n\r\n\t\t\t\tif ( this.loop ) {\r\n\r\n\t\t\t\t\tthis.currentTime %= duration;\r\n\r\n\t\t\t\t\tif ( this.currentTime < 0 )\r\n\t\t\t\t\t\tthis.currentTime += duration;\r\n\r\n\t\t\t\t\tthis.reset();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.stop();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tvar object = this.hierarchy[ h ];\r\n\t\t\t\tvar animationCache = object.animationCache.animations[this.data.name];\r\n\t\t\t\tvar blending = object.animationCache.blending;\r\n\r\n\t\t\t\t// loop through pos/rot/scl\r\n\r\n\t\t\t\tfor ( var t = 0; t < 3; t ++ ) {\r\n\r\n\t\t\t\t\t// get keys\r\n\r\n\t\t\t\t\tvar type    = this.keyTypes[ t ];\r\n\t\t\t\t\tvar prevKey = animationCache.prevKey[ type ];\r\n\t\t\t\t\tvar nextKey = animationCache.nextKey[ type ];\r\n\r\n\t\t\t\t\tif ( ( this.timeScale > 0 && nextKey.time <= this.currentTime ) ||\r\n\t\t\t\t\t\t( this.timeScale < 0 && prevKey.time >= this.currentTime ) ) {\r\n\r\n\t\t\t\t\t\tprevKey = this.data.hierarchy[ h ].keys[ 0 ];\r\n\t\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, 1 );\r\n\r\n\t\t\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\r\n\r\n\t\t\t\t\t\t\tprevKey = nextKey;\r\n\t\t\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, nextKey.index + 1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tanimationCache.prevKey[ type ] = prevKey;\r\n\t\t\t\t\t\tanimationCache.nextKey[ type ] = nextKey;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar scale = ( this.currentTime - prevKey.time ) / ( nextKey.time - prevKey.time );\r\n\r\n\t\t\t\t\tvar prevXYZ = prevKey[ type ];\r\n\t\t\t\t\tvar nextXYZ = nextKey[ type ];\r\n\r\n\t\t\t\t\tif ( scale < 0 ) scale = 0;\r\n\t\t\t\t\tif ( scale > 1 ) scale = 1;\r\n\r\n\t\t\t\t\t// interpolate\r\n\r\n\t\t\t\t\tif ( type === \"pos\" ) {\r\n\r\n\t\t\t\t\t\tif ( this.interpolationType === THREE.AnimationHandler.LINEAR ) {\r\n\r\n\t\t\t\t\t\t\tnewVector.x = prevXYZ[ 0 ] + ( nextXYZ[ 0 ] - prevXYZ[ 0 ] ) * scale;\r\n\t\t\t\t\t\t\tnewVector.y = prevXYZ[ 1 ] + ( nextXYZ[ 1 ] - prevXYZ[ 1 ] ) * scale;\r\n\t\t\t\t\t\t\tnewVector.z = prevXYZ[ 2 ] + ( nextXYZ[ 2 ] - prevXYZ[ 2 ] ) * scale;\r\n\r\n\t\t\t\t\t\t\t// blend\r\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.positionWeight );\r\n\t\t\t\t\t\t\tobject.position.lerp( newVector, proportionalWeight );\r\n\t\t\t\t\t\t\tblending.positionWeight += this.weight;\r\n\r\n\t\t\t\t\t\t} else if ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n\t\t\t\t\t\t\t\t\tthis.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\r\n\r\n\t\t\t\t\t\t\tpoints[ 0 ] = this.getPrevKeyWith( \"pos\", h, prevKey.index - 1 )[ \"pos\" ];\r\n\t\t\t\t\t\t\tpoints[ 1 ] = prevXYZ;\r\n\t\t\t\t\t\t\tpoints[ 2 ] = nextXYZ;\r\n\t\t\t\t\t\t\tpoints[ 3 ] = this.getNextKeyWith( \"pos\", h, nextKey.index + 1 )[ \"pos\" ];\r\n\r\n\t\t\t\t\t\t\tscale = scale * 0.33 + 0.33;\r\n\r\n\t\t\t\t\t\t\tvar currentPoint = interpolateCatmullRom( points, scale );\r\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.positionWeight );\r\n\t\t\t\t\t\t\tblending.positionWeight += this.weight;\r\n\r\n\t\t\t\t\t\t\t// blend\r\n\r\n\t\t\t\t\t\t\tvar vector = object.position;\r\n\r\n\t\t\t\t\t\t\tvector.x = vector.x + ( currentPoint[ 0 ] - vector.x ) * proportionalWeight;\r\n\t\t\t\t\t\t\tvector.y = vector.y + ( currentPoint[ 1 ] - vector.y ) * proportionalWeight;\r\n\t\t\t\t\t\t\tvector.z = vector.z + ( currentPoint[ 2 ] - vector.z ) * proportionalWeight;\r\n\r\n\t\t\t\t\t\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\r\n\r\n\t\t\t\t\t\t\t\tvar forwardPoint = interpolateCatmullRom( points, scale * 1.01 );\r\n\r\n\t\t\t\t\t\t\t\ttarget.set( forwardPoint[ 0 ], forwardPoint[ 1 ], forwardPoint[ 2 ] );\r\n\t\t\t\t\t\t\t\ttarget.sub( vector );\r\n\t\t\t\t\t\t\t\ttarget.y = 0;\r\n\t\t\t\t\t\t\t\ttarget.normalize();\r\n\r\n\t\t\t\t\t\t\t\tvar angle = Math.atan2( target.x, target.z );\r\n\t\t\t\t\t\t\t\tobject.rotation.set( 0, angle, 0 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( type === \"rot\" ) {\r\n\r\n\t\t\t\t\t\tTHREE.Quaternion.slerp( prevXYZ, nextXYZ, newQuat, scale );\r\n\r\n\t\t\t\t\t\t// Avoid paying the cost of an additional slerp if we don't have to\r\n\t\t\t\t\t\tif ( blending.quaternionWeight === 0 ) {\r\n\r\n\t\t\t\t\t\t\tobject.quaternion.copy(newQuat);\r\n\t\t\t\t\t\t\tblending.quaternionWeight = this.weight;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.quaternionWeight );\r\n\t\t\t\t\t\t\tTHREE.Quaternion.slerp( object.quaternion, newQuat, object.quaternion, proportionalWeight );\r\n\t\t\t\t\t\t\tblending.quaternionWeight += this.weight;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( type === \"scl\" ) {\r\n\r\n\t\t\t\t\t\tnewVector.x = prevXYZ[ 0 ] + ( nextXYZ[ 0 ] - prevXYZ[ 0 ] ) * scale;\r\n\t\t\t\t\t\tnewVector.y = prevXYZ[ 1 ] + ( nextXYZ[ 1 ] - prevXYZ[ 1 ] ) * scale;\r\n\t\t\t\t\t\tnewVector.z = prevXYZ[ 2 ] + ( nextXYZ[ 2 ] - prevXYZ[ 2 ] ) * scale;\r\n\r\n\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.scaleWeight );\r\n\t\t\t\t\t\tobject.scale.lerp( newVector, proportionalWeight );\r\n\t\t\t\t\t\tblending.scaleWeight += this.weight;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tgetNextKeyWith: function ( type, h, key ) {\r\n\r\n\t\tvar keys = this.data.hierarchy[ h ].keys;\r\n\r\n\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n\t\t\t this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\r\n\r\n\t\t\tkey = key < keys.length - 1 ? key : keys.length - 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tkey = key % keys.length;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( ; key < keys.length; key ++ ) {\r\n\r\n\t\t\tif ( keys[ key ][ type ] !== undefined ) {\r\n\r\n\t\t\t\treturn keys[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this.data.hierarchy[ h ].keys[ 0 ];\r\n\r\n\t},\r\n\r\n\tgetPrevKeyWith: function ( type, h, key ) {\r\n\r\n\t\tvar keys = this.data.hierarchy[ h ].keys;\r\n\r\n\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n\t\t\tthis.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\r\n\r\n\t\t\tkey = key > 0 ? key : 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tkey = key >= 0 ? key : key + keys.length;\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfor ( ; key >= 0; key -- ) {\r\n\r\n\t\t\tif ( keys[ key ][ type ] !== undefined ) {\r\n\r\n\t\t\t\treturn keys[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this.data.hierarchy[ h ].keys[ keys.length - 1 ];\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/animation/KeyFrameAnimation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author khang duong\r\n * @author erik kitson\r\n */\r\n\r\nTHREE.KeyFrameAnimation = function ( data ) {\r\n\r\n\tthis.root = data.node;\r\n\tthis.data = THREE.AnimationHandler.init( data );\r\n\tthis.hierarchy = THREE.AnimationHandler.parse( this.root );\r\n\tthis.currentTime = 0;\r\n\tthis.timeScale = 0.001;\r\n\tthis.isPlaying = false;\r\n\tthis.isPaused = true;\r\n\tthis.loop = true;\r\n\r\n\t// initialize to first keyframes\r\n\r\n\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\r\n\r\n\t\tvar keys = this.data.hierarchy[h].keys,\r\n\t\t\tsids = this.data.hierarchy[h].sids,\r\n\t\t\tobj = this.hierarchy[h];\r\n\r\n\t\tif ( keys.length && sids ) {\r\n\r\n\t\t\tfor ( var s = 0; s < sids.length; s ++ ) {\r\n\r\n\t\t\t\tvar sid = sids[ s ],\r\n\t\t\t\t\tnext = this.getNextKeyWith( sid, h, 0 );\r\n\r\n\t\t\t\tif ( next ) {\r\n\r\n\t\t\t\t\tnext.apply( sid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobj.matrixAutoUpdate = false;\r\n\t\t\tthis.data.hierarchy[h].node.updateMatrix();\r\n\t\t\tobj.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.KeyFrameAnimation.prototype = {\r\n\r\n\tconstructor: THREE.KeyFrameAnimation,\r\n\r\n\tplay: function ( startTime ) {\r\n\r\n\t\tthis.currentTime = startTime !== undefined ? startTime : 0;\r\n\r\n\t\tif ( this.isPlaying === false ) {\r\n\r\n\t\t\tthis.isPlaying = true;\r\n\r\n\t\t\t// reset key cache\r\n\r\n\t\t\tvar h, hl = this.hierarchy.length,\r\n\t\t\t\tobject,\r\n\t\t\t\tnode;\r\n\r\n\t\t\tfor ( h = 0; h < hl; h ++ ) {\r\n\r\n\t\t\t\tobject = this.hierarchy[ h ];\r\n\t\t\t\tnode = this.data.hierarchy[ h ];\r\n\r\n\t\t\t\tif ( node.animationCache === undefined ) {\r\n\r\n\t\t\t\t\tnode.animationCache = {};\r\n\t\t\t\t\tnode.animationCache.prevKey = null;\r\n\t\t\t\t\tnode.animationCache.nextKey = null;\r\n\t\t\t\t\tnode.animationCache.originalMatrix = object.matrix;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar keys = this.data.hierarchy[h].keys;\r\n\r\n\t\t\t\tif (keys.length) {\r\n\r\n\t\t\t\t\tnode.animationCache.prevKey = keys[ 0 ];\r\n\t\t\t\t\tnode.animationCache.nextKey = keys[ 1 ];\r\n\r\n\t\t\t\t\tthis.startTime = Math.min( keys[0].time, this.startTime );\r\n\t\t\t\t\tthis.endTime = Math.max( keys[keys.length - 1].time, this.endTime );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.update( 0 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.isPaused = false;\r\n\r\n\t\tTHREE.AnimationHandler.play( this );\r\n\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tthis.isPlaying = false;\r\n\t\tthis.isPaused  = false;\r\n\r\n\t\tTHREE.AnimationHandler.stop( this );\r\n\r\n\t\t// reset JIT matrix and remove cache\r\n\r\n\t\tfor ( var h = 0; h < this.data.hierarchy.length; h ++ ) {\r\n\r\n\t\t\tvar obj = this.hierarchy[ h ];\r\n\t\t\tvar node = this.data.hierarchy[ h ];\r\n\r\n\t\t\tif ( node.animationCache !== undefined ) {\r\n\r\n\t\t\t\tvar original = node.animationCache.originalMatrix;\r\n\r\n\t\t\t\toriginal.copy( obj.matrix );\r\n\t\t\t\tobj.matrix = original;\r\n\r\n\t\t\t\tdelete node.animationCache;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdate: function ( delta ) {\r\n\r\n\t\tif ( this.isPlaying === false ) return;\r\n\r\n\t\tthis.currentTime += delta * this.timeScale;\r\n\r\n\t\t//\r\n\r\n\t\tvar duration = this.data.length;\r\n\r\n\t\tif ( this.loop === true && this.currentTime > duration ) {\r\n\r\n\t\t\tthis.currentTime %= duration;\r\n\r\n\t\t}\r\n\r\n\t\tthis.currentTime = Math.min( this.currentTime, duration );\r\n\r\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\r\n\r\n\t\t\tvar object = this.hierarchy[ h ];\r\n\t\t\tvar node = this.data.hierarchy[ h ];\r\n\r\n\t\t\tvar keys = node.keys,\r\n\t\t\t\tanimationCache = node.animationCache;\r\n\r\n\r\n\t\t\tif ( keys.length ) {\r\n\r\n\t\t\t\tvar prevKey = animationCache.prevKey;\r\n\t\t\t\tvar nextKey = animationCache.nextKey;\r\n\r\n\t\t\t\tif ( nextKey.time <= this.currentTime ) {\r\n\r\n\t\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\r\n\r\n\t\t\t\t\t\tprevKey = nextKey;\r\n\t\t\t\t\t\tnextKey = keys[ prevKey.index + 1 ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tanimationCache.prevKey = prevKey;\r\n\t\t\t\t\tanimationCache.nextKey = nextKey;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( nextKey.time >= this.currentTime ) {\r\n\r\n\t\t\t\t\tprevKey.interpolate( nextKey, this.currentTime );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tprevKey.interpolate( nextKey, nextKey.time );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.data.hierarchy[ h ].node.updateMatrix();\r\n\t\t\t\tobject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetNextKeyWith: function ( sid, h, key ) {\r\n\r\n\t\tvar keys = this.data.hierarchy[ h ].keys;\r\n\t\tkey = key % keys.length;\r\n\r\n\t\tfor ( ; key < keys.length; key ++ ) {\r\n\r\n\t\t\tif ( keys[ key ].hasTarget( sid ) ) {\r\n\r\n\t\t\t\treturn keys[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn keys[ 0 ];\r\n\r\n\t},\r\n\r\n\tgetPrevKeyWith: function ( sid, h, key ) {\r\n\r\n\t\tvar keys = this.data.hierarchy[ h ].keys;\r\n\t\tkey = key >= 0 ? key : key + keys.length;\r\n\r\n\t\tfor ( ; key >= 0; key -- ) {\r\n\r\n\t\t\tif ( keys[ key ].hasTarget( sid ) ) {\r\n\r\n\t\t\t\treturn keys[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn keys[ keys.length - 1 ];\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/animation/MorphAnimation.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com\r\n * @author willy-vvu / http://willy-vvu.github.io\r\n */\r\n\r\nTHREE.MorphAnimation = function ( mesh ) {\r\n\r\n\tthis.mesh = mesh;\r\n\tthis.frames = mesh.morphTargetInfluences.length;\r\n\tthis.currentTime = 0;\r\n\tthis.duration = 1000;\r\n\tthis.loop = true;\r\n\tthis.lastFrame = 0;\r\n\tthis.currentFrame = 0;\r\n\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimation.prototype = {\r\n\r\n\tconstructor: THREE.MorphAnimation,\r\n\r\n\tplay: function () {\r\n\r\n\t\tthis.isPlaying = true;\r\n\r\n\t},\r\n\r\n\tpause: function () {\r\n\r\n\t\tthis.isPlaying = false;\r\n\r\n\t},\r\n\r\n\tupdate: function ( delta ) {\r\n\r\n\t\tif ( this.isPlaying === false ) return;\r\n\r\n\t\tthis.currentTime += delta;\r\n\r\n\t\tif ( this.loop === true && this.currentTime > this.duration ) {\r\n\r\n\t\t\tthis.currentTime %= this.duration;\r\n\r\n\t\t}\r\n\r\n\t\tthis.currentTime = Math.min( this.currentTime, this.duration );\r\n\r\n\t\tvar interpolation = this.duration / this.frames;\r\n\t\tvar frame = Math.floor( this.currentTime / interpolation );\r\n\r\n\t\tvar influences = this.mesh.morphTargetInfluences;\r\n\r\n\t\tif ( frame != this.currentFrame ) {\r\n\r\n\t\t\tinfluences[ this.lastFrame ] = 0;\r\n\t\t\tinfluences[ this.currentFrame ] = 1;\r\n\t\t\tinfluences[ frame ] = 0;\r\n\r\n\t\t\tthis.lastFrame = this.currentFrame;\r\n\t\t\tthis.currentFrame = frame;\r\n\r\n\t\t}\r\n\r\n\t\tinfluences[ frame ] = ( this.currentTime % interpolation ) / interpolation;\r\n\t\tinfluences[ this.lastFrame ] = 1 - influences[ frame ];\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'BoxGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tthis.widthSegments = widthSegments || 1;\r\n\tthis.heightSegments = heightSegments || 1;\r\n\tthis.depthSegments = depthSegments || 1;\r\n\r\n\tvar scope = this;\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\tvar depth_half = depth / 2;\r\n\r\n\tbuildPlane( 'z', 'y', - 1, - 1, depth, height, width_half, 0 ); // px\r\n\tbuildPlane( 'z', 'y',   1, - 1, depth, height, - width_half, 1 ); // nx\r\n\tbuildPlane( 'x', 'z',   1,   1, width, depth, height_half, 2 ); // py\r\n\tbuildPlane( 'x', 'z',   1, - 1, width, depth, - height_half, 3 ); // ny\r\n\tbuildPlane( 'x', 'y',   1, - 1, width, height, depth_half, 4 ); // pz\r\n\tbuildPlane( 'x', 'y', - 1, - 1, width, height, - depth_half, 5 ); // nz\r\n\r\n\tfunction buildPlane( u, v, udir, vdir, width, height, depth, materialIndex ) {\r\n\r\n\t\tvar w, ix, iy,\r\n\t\tgridX = scope.widthSegments,\r\n\t\tgridY = scope.heightSegments,\r\n\t\twidth_half = width / 2,\r\n\t\theight_half = height / 2,\r\n\t\toffset = scope.vertices.length;\r\n\r\n\t\tif ( ( u === 'x' && v === 'y' ) || ( u === 'y' && v === 'x' ) ) {\r\n\r\n\t\t\tw = 'z';\r\n\r\n\t\t} else if ( ( u === 'x' && v === 'z' ) || ( u === 'z' && v === 'x' ) ) {\r\n\r\n\t\t\tw = 'y';\r\n\t\t\tgridY = scope.depthSegments;\r\n\r\n\t\t} else if ( ( u === 'z' && v === 'y' ) || ( u === 'y' && v === 'z' ) ) {\r\n\r\n\t\t\tw = 'x';\r\n\t\t\tgridX = scope.depthSegments;\r\n\r\n\t\t}\r\n\r\n\t\tvar gridX1 = gridX + 1,\r\n\t\tgridY1 = gridY + 1,\r\n\t\tsegment_width = width / gridX,\r\n\t\tsegment_height = height / gridY,\r\n\t\tnormal = new THREE.Vector3();\r\n\r\n\t\tnormal[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar vector = new THREE.Vector3();\r\n\t\t\t\tvector[ u ] = ( ix * segment_width - width_half ) * udir;\r\n\t\t\t\tvector[ v ] = ( iy * segment_height - height_half ) * vdir;\r\n\t\t\t\tvector[ w ] = depth;\r\n\r\n\t\t\t\tscope.vertices.push( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\tvar uva = new THREE.Vector2( ix / gridX, 1 - iy / gridY );\r\n\t\t\t\tvar uvb = new THREE.Vector2( ix / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\tvar uvc = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\tvar uvd = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - iy / gridY );\r\n\r\n\t\t\t\tvar face = new THREE.Face3( a + offset, b + offset, d + offset );\r\n\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\t\tface = new THREE.Face3( b + offset, c + offset, d + offset );\r\n\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CircleGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tvar i, uvs = [],\r\n\tcenter = new THREE.Vector3(), centerUV = new THREE.Vector2( 0.5, 0.5 );\r\n\r\n\tthis.vertices.push(center);\r\n\tuvs.push( centerUV );\r\n\r\n\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\tvar vertex = new THREE.Vector3();\r\n\t\tvar segment = thetaStart + i / segments * thetaLength;\r\n\r\n\t\tvertex.x = radius * Math.cos( segment );\r\n\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\tthis.vertices.push( vertex );\r\n\t\tuvs.push( new THREE.Vector2( ( vertex.x / radius + 1 ) / 2, ( vertex.y / radius + 1 ) / 2 ) );\r\n\r\n\t}\r\n\r\n\tvar n = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\tthis.faces.push( new THREE.Face3( i, i + 1, 0, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ i ].clone(), uvs[ i + 1 ].clone(), centerUV.clone() ] );\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CubeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.CubeGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.warn( 'THREE.CubeGeometry has been renamed to THREE.BoxGeometry.' );\r\n\treturn new THREE.BoxGeometry( width, height, depth, widthSegments, heightSegments, depthSegments );\r\n\r\n };\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CylinderGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n\theight = height !== undefined ? height : 100;\r\n\r\n\tradialSegments = radialSegments || 8;\r\n\theightSegments = heightSegments || 1;\r\n\r\n\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n\tvar heightHalf = height / 2;\r\n\r\n\tvar x, y, vertices = [], uvs = [];\r\n\r\n\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\t\tvar uvsRow = [];\r\n\r\n\t\tvar v = y / heightSegments;\r\n\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\tvertex.y = - v * height + heightHalf;\r\n\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t\tverticesRow.push( this.vertices.length - 1 );\r\n\t\t\tuvsRow.push( new THREE.Vector2( u, 1 - v ) );\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\t\tuvs.push( uvsRow );\r\n\r\n\t}\r\n\r\n\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\r\n\tvar na, nb;\r\n\r\n\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\tif ( radiusTop !== 0 ) {\r\n\r\n\t\t\tna = this.vertices[ vertices[ 0 ][ x ] ].clone();\r\n\t\t\tnb = this.vertices[ vertices[ 0 ][ x + 1 ] ].clone();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tna = this.vertices[ vertices[ 1 ][ x ] ].clone();\r\n\t\t\tnb = this.vertices[ vertices[ 1 ][ x + 1 ] ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tna.setY( Math.sqrt( na.x * na.x + na.z * na.z ) * tanTheta ).normalize();\r\n\t\tnb.setY( Math.sqrt( nb.x * nb.x + nb.z * nb.z ) * tanTheta ).normalize();\r\n\r\n\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x ];\r\n\t\t\tvar v2 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x + 1 ];\r\n\t\t\tvar v4 = vertices[ y ][ x + 1 ];\r\n\r\n\t\t\tvar n1 = na.clone();\r\n\t\t\tvar n2 = na.clone();\r\n\t\t\tvar n3 = nb.clone();\r\n\t\t\tvar n4 = nb.clone();\r\n\r\n\t\t\tvar uv1 = uvs[ y ][ x ].clone();\r\n\t\t\tvar uv2 = uvs[ y + 1 ][ x ].clone();\r\n\t\t\tvar uv3 = uvs[ y + 1 ][ x + 1 ].clone();\r\n\t\t\tvar uv4 = uvs[ y ][ x + 1 ].clone();\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v4, [ n1, n2, n4 ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv4 ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v2, v3, v4, [ n2.clone(), n3, n4.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv2.clone(), uv3, uv4.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// top cap\r\n\r\n\tif ( openEnded === false && radiusTop > 0 ) {\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( 0, heightHalf, 0 ) );\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ 0 ][ x ];\r\n\t\t\tvar v2 = vertices[ 0 ][ x + 1 ];\r\n\t\t\tvar v3 = this.vertices.length - 1;\r\n\r\n\t\t\tvar n1 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\tvar n2 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\tvar n3 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\t\tvar uv1 = uvs[ 0 ][ x ].clone();\r\n\t\t\tvar uv2 = uvs[ 0 ][ x + 1 ].clone();\r\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 0 );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// bottom cap\r\n\r\n\tif ( openEnded === false && radiusBottom > 0 ) {\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( 0, - heightHalf, 0 ) );\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ heightSegments ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ heightSegments ][ x ];\r\n\t\t\tvar v3 = this.vertices.length - 1;\r\n\r\n\t\t\tvar n1 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\tvar n2 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\tvar n3 = new THREE.Vector3( 0, - 1, 0 );\r\n\r\n\t\t\tvar uv1 = uvs[ heightSegments ][ x + 1 ].clone();\r\n\t\t\tvar uv2 = uvs[ heightSegments ][ x ].clone();\r\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 1 );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segements of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  material: <int> // material index for front and back faces\r\n *  extrudeMaterial: <int> // material index for extrusion and beveled faces\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function ( shapes, options ) {\r\n\r\n\tif ( typeof( shapes ) === \"undefined\" ) {\r\n\t\tshapes = [];\r\n\t\treturn;\r\n\t}\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ExtrudeGeometry';\r\n\r\n\tshapes = shapes instanceof Array ? shapes : [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\t// can't really use automatic vertex normals\r\n\t// as then front and back sides get smoothed too\r\n\t// should do separate smoothing just for sides\r\n\r\n\t//this.computeVertexNormals();\r\n\r\n\t//console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\tvar sl = shapes.length;\r\n\r\n\tfor ( var s = 0; s < sl; s ++ ) {\r\n\t\tvar shape = shapes[ s ];\r\n\t\tthis.addShape( shape, options );\r\n\t}\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tvar amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n\tvar extrudePath = options.extrudePath;\r\n\tvar extrudePts, extrudeByPath = false;\r\n\r\n\tvar material = options.material;\r\n\tvar extrudeMaterial = options.extrudeMaterial;\r\n\r\n\t// Use default WorldUVGenerator if no UV generators are specified.\r\n\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n\tvar splineTube, binormal, normal, position2;\r\n\tif ( extrudePath ) {\r\n\r\n\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\textrudeByPath = true;\r\n\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t// SETUP TNB variables\r\n\r\n\t\t// Reuse TNB from TubeGeomtry for now.\r\n\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames(extrudePath, steps, false);\r\n\r\n\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\tbinormal = new THREE.Vector3();\r\n\t\tnormal = new THREE.Vector3();\r\n\t\tposition2 = new THREE.Vector3();\r\n\r\n\t}\r\n\r\n\t// Safeguards if bevels are not enabled\r\n\r\n\tif ( ! bevelEnabled ) {\r\n\r\n\t\tbevelSegments = 0;\r\n\t\tbevelThickness = 0;\r\n\t\tbevelSize = 0;\r\n\r\n\t}\r\n\r\n\t// Variables initalization\r\n\r\n\tvar ahole, h, hl; // looping of holes\r\n\tvar scope = this;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.Shape.Utils.isClockWise( vertices ) ;\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\r\n\t\t\tif ( THREE.Shape.Utils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n\t}\r\n\r\n\r\n\tvar faces = THREE.Shape.Utils.triangulateShape ( vertices, holes );\r\n\r\n\t/* Vertices */\r\n\r\n\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\tvertices = vertices.concat( ahole );\r\n\r\n\t}\r\n\r\n\r\n\tfunction scalePt2 ( pt, vec, size ) {\r\n\r\n\t\tif ( ! vec ) THREE.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\r\n\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t}\r\n\r\n\tvar b, bs, t, z,\r\n\t\tvert, vlen = vertices.length,\r\n\t\tface, flen = faces.length;\r\n\r\n\r\n\t// Find directions for point movement\r\n\r\n\r\n\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\tvar EPSILON = 0.0000000001;\r\n\t\t\r\n\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t//   shiftet by 1 unit (length of normalized vector) to the left\r\n\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t//\r\n\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\t\t\r\n\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\r\n\r\n\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\r\n\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\r\n\t\t\r\n\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\t\t\r\n\t\t// check for colinear edges\r\n\t\tvar colinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\t\t\r\n\t\tif ( Math.abs( colinear0 ) > EPSILON ) {\t\t// not colinear\r\n\t\t\t\r\n\t\t\t// length of vectors for normalizing\r\n\t\r\n\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\t\t\t\r\n\t\t\t// shift adjacent points by unit vectors to the left\r\n\t\r\n\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\t\t\t\r\n\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\t\r\n\t\t\t// scaling factor for v_prev to intersection point\r\n\t\r\n\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\r\n\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\t\r\n\t\t\t// vector from inPt to intersection point\r\n\t\r\n\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\t\r\n\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t//  but prevent crazy spikes\r\n\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y )\r\n\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\r\n\t\t\t} else {\r\n\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else {\t\t// handle special case of colinear edges\r\n\r\n\t\t\tvar direction_eq = false;\t\t// assumes: opposite\r\n\t\t\tif ( v_prev_x > EPSILON ) {\r\n\t\t\t\tif ( v_next_x > EPSILON ) { direction_eq = true; }\r\n\t\t\t} else {\r\n\t\t\t\tif ( v_prev_x < - EPSILON ) {\r\n\t\t\t\t\tif ( v_next_x < - EPSILON ) { direction_eq = true; }\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( Math.sign(v_prev_y) == Math.sign(v_next_y) ) { direction_eq = true; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( direction_eq ) {\r\n\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\tv_trans_y =  v_prev_x;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\t\t\t} else {\r\n\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t}\r\n\r\n\r\n\tvar contourMovements = [];\r\n\r\n\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\tif ( j === il ) j = 0;\r\n\t\tif ( k === il ) k = 0;\r\n\r\n\t\t//  (j)---(i)---(k)\r\n\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t}\r\n\r\n\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\toneHoleMovements = [];\r\n\r\n\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\tif ( j === il ) j = 0;\r\n\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t//  (j)---(i)---(k)\r\n\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t}\r\n\r\n\t\tholesMovements.push( oneHoleMovements );\r\n\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t}\r\n\r\n\r\n\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\r\n\t\t//z = bevelThickness * t;\r\n\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ) ; // curved\r\n\t\t//bs = bevelSize * t ; // linear\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tbs = bevelSize;\r\n\r\n\t// Back facing vertices\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\tnormal.copy( splineTube.normals[0] ).multiplyScalar(vert.x);\r\n\t\t\tbinormal.copy( splineTube.binormals[0] ).multiplyScalar(vert.y);\r\n\r\n\t\t\tposition2.copy( extrudePts[0] ).add(normal).add(binormal);\r\n\r\n\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Add stepped vertices...\r\n\t// Including front facing vertices\r\n\r\n\tvar s;\r\n\r\n\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\tv( vert.x, vert.y, amount / steps * s );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\tnormal.copy( splineTube.normals[s] ).multiplyScalar( vert.x );\r\n\t\t\t\tbinormal.copy( splineTube.binormals[s] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\tposition2.copy( extrudePts[s] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Add bevel segments planes\r\n\r\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 ) ;\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/* Faces */\r\n\r\n\t// Top and bottom faces\r\n\r\n\tbuildLidFaces();\r\n\r\n\t// Sides faces\r\n\r\n\tbuildSideFaces();\r\n\r\n\r\n\t/////  Internal functions\r\n\r\n\tfunction buildLidFaces() {\r\n\r\n\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\tvar layer = 0 ; // steps + 1\r\n\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Create faces for the z-sides of the shape\r\n\r\n\tfunction buildSideFaces() {\r\n\r\n\t\tvar layeroffset = 0;\r\n\t\tsidewalls( contour, layeroffset );\r\n\t\tlayeroffset += contour.length;\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t//, true\r\n\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\tvar j, k;\r\n\t\ti = contour.length;\r\n\r\n\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\tj = i;\r\n\t\t\tk = i - 1;\r\n\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\r\n\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\r\n\r\n\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction v( x, y, z ) {\r\n\r\n\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\r\n\r\n\t}\r\n\r\n\tfunction f3( a, b, c ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\r\n\t\t// normal, color, material\r\n\t\tscope.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\r\n\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( uvs );\r\n\r\n\t}\r\n\r\n\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\t\td += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, d, null, null, extrudeMaterial ) );\r\n\t\tscope.faces.push( new THREE.Face3( b, c, d, null, null, extrudeMaterial ) );\r\n\r\n\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\r\n\t\treturn [\r\n\t\t\tnew THREE.Vector2( a.x, a.y ),\r\n\t\t\tnew THREE.Vector2( b.x, b.y ),\r\n\t\t\tnew THREE.Vector2( c.x, c.y )\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\t\tvar d = vertices[ indexD ];\r\n\r\n\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function ( shapes, options ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ShapeGeometry';\r\n\r\n\tif ( shapes instanceof Array === false ) shapes = [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\tthis.addShape( shapes[ i ], options );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tif ( options === undefined ) options = {};\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar material = options.material;\r\n\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n\t//\r\n\r\n\tvar i, l, hole;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.Shape.Utils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\t\thole = holes[ i ];\r\n\r\n\t\t\tif ( THREE.Shape.Utils.isClockWise( hole ) ) {\r\n\r\n\t\t\t\tholes[ i ] = hole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false;\r\n\r\n\t}\r\n\r\n\tvar faces = THREE.Shape.Utils.triangulateShape( vertices, holes );\r\n\r\n\t// Vertices\r\n\r\n\tvar contour = vertices;\r\n\r\n\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\thole = holes[ i ];\r\n\t\tvertices = vertices.concat( hole );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar vert, vlen = vertices.length;\r\n\tvar face, flen = faces.length;\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = vertices[ i ];\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\r\n\r\n\t}\r\n\r\n\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\tface = faces[ i ];\r\n\r\n\t\tvar a = face[ 0 ] + shapesOffset;\r\n\t\tvar b = face[ 1 ] + shapesOffset;\r\n\t\tvar c = face[ 2 ] + shapesOffset;\r\n\r\n\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points \r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'LatheGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tsegments = segments || 12;\r\n\tphiStart = phiStart || 0;\r\n\tphiLength = phiLength || 2 * Math.PI;\r\n\r\n\tvar inversePointLength = 1.0 / ( points.length - 1 );\r\n\tvar inverseSegments = 1.0 / segments;\r\n\r\n\tfor ( var i = 0, il = segments; i <= il; i ++ ) {\r\n\r\n\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\tvar c = Math.cos( phi ),\r\n\t\t\ts = Math.sin( phi );\r\n\r\n\t\tfor ( var j = 0, jl = points.length; j < jl; j ++ ) {\r\n\r\n\t\t\tvar pt = points[ j ];\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\t\tvertex.x = c * pt.x - s * pt.y;\r\n\t\t\tvertex.y = s * pt.x + c * pt.y;\r\n\t\t\tvertex.z = pt.z;\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar np = points.length;\r\n\r\n\tfor ( var i = 0, il = segments; i < il; i ++ ) {\r\n\r\n\t\tfor ( var j = 0, jl = points.length - 1; j < jl; j ++ ) {\r\n\r\n\t\t\tvar base = j + np * i;\r\n\t\t\tvar a = base;\r\n\t\t\tvar b = base + np;\r\n\t\t\tvar c = base + 1 + np;\r\n\t\t\tvar d = base + 1;\r\n\r\n\t\t\tvar u0 = i * inverseSegments;\r\n\t\t\tvar v0 = j * inversePointLength;\r\n\t\t\tvar u1 = u0 + inverseSegments;\r\n\t\t\tvar v1 = v0 + inversePointLength;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\r\n\t\t\t\tnew THREE.Vector2( u0, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\r\n\t\t\t] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\r\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u1, v1 ),\r\n\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\r\n\t\t\t] );\r\n\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.mergeVertices();\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tconsole.info( 'THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.' );\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PlaneGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\r\n\tvar gridX = widthSegments || 1;\r\n\tvar gridY = heightSegments || 1;\r\n\r\n\tvar gridX1 = gridX + 1;\r\n\tvar gridY1 = gridY + 1;\r\n\r\n\tvar segment_width = width / gridX;\r\n\tvar segment_height = height / gridY;\r\n\r\n\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\r\n\r\n\tvar offset = 0;\r\n\tvar offset2 = 0;\r\n\r\n\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\tvertices[ offset     ] = x;\r\n\t\t\tvertices[ offset + 1 ] = - y;\r\n\r\n\t\t\tnormals[ offset + 2 ] = 1;\r\n\r\n\t\t\tuvs[ offset2     ] = ix / gridX;\r\n\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\toffset += 3;\r\n\t\t\toffset2 += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toffset = 0;\r\n\r\n\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\r\n\r\n\tfor ( var iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\tindices[ offset     ] = a;\r\n\t\t\tindices[ offset + 1 ] = b;\r\n\t\t\tindices[ offset + 2 ] = d;\r\n\r\n\t\t\tindices[ offset + 3 ] = b;\r\n\t\t\tindices[ offset + 4 ] = c;\r\n\t\t\tindices[ offset + 5 ] = d;\r\n\r\n\t\t\toffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.addAttribute( 'index', new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'RingGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tinnerRadius = innerRadius || 0;\r\n\touterRadius = outerRadius || 50;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 8;\r\n\r\n\tvar i, o, uvs = [], radius = innerRadius, radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\r\n\tfor ( i = 0; i < phiSegments + 1; i ++ ) { // concentric circles inside ring\r\n\r\n\t\tfor ( o = 0; o < thetaSegments + 1; o ++ ) { // number of segments per circle\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvar segment = thetaStart + o / thetaSegments * thetaLength;\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\t\t\tuvs.push( new THREE.Vector2( ( vertex.x / outerRadius + 1 ) / 2, ( vertex.y / outerRadius + 1 ) / 2 ) );\r\n\t\t}\r\n\r\n\t\tradius += radiusStep;\r\n\r\n\t}\r\n\r\n\tvar n = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\tfor ( i = 0; i < phiSegments; i ++ ) { // concentric circles inside ring\r\n\r\n\t\tvar thetaSegment = i * (thetaSegments + 1);\r\n\r\n\t\tfor ( o = 0; o < thetaSegments ; o ++ ) { // number of segments per circle\r\n\r\n\t\t\tvar segment = o + thetaSegment;\r\n\r\n\t\t\tvar v1 = segment;\r\n\t\t\tvar v2 = segment + thetaSegments + 1;\r\n\t\t\tvar v3 = segment + thetaSegments + 2;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ]);\r\n\r\n\t\t\tv1 = segment;\r\n\t\t\tv2 = segment + thetaSegments + 2;\r\n\t\t\tv3 = segment + 1;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ]);\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'SphereGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength \r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\r\n\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\tvar x, y, vertices = [], uvs = [];\r\n\r\n\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\t\tvar uvsRow = [];\r\n\r\n\t\tfor ( x = 0; x <= widthSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / widthSegments;\r\n\t\t\tvar v = y / heightSegments;\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t\tverticesRow.push( this.vertices.length - 1 );\r\n\t\t\tuvsRow.push( new THREE.Vector2( u, 1 - v ) );\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\t\tuvs.push( uvsRow );\r\n\r\n\t}\r\n\r\n\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\tfor ( x = 0; x < widthSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ y ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\r\n\r\n\t\t\tvar n1 = this.vertices[ v1 ].clone().normalize();\r\n\t\t\tvar n2 = this.vertices[ v2 ].clone().normalize();\r\n\t\t\tvar n3 = this.vertices[ v3 ].clone().normalize();\r\n\t\t\tvar n4 = this.vertices[ v4 ].clone().normalize();\r\n\r\n\t\t\tvar uv1 = uvs[ y ][ x + 1 ].clone();\r\n\t\t\tvar uv2 = uvs[ y ][ x ].clone();\r\n\t\t\tvar uv3 = uvs[ y + 1 ][ x ].clone();\r\n\t\t\tvar uv4 = uvs[ y + 1 ][ x + 1 ].clone();\r\n\r\n\t\t\tif ( Math.abs( this.vertices[ v1 ].y ) === radius ) {\r\n\r\n\t\t\t\tuv1.x = ( uv1.x + uv2.x ) / 2;\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v3, v4, [ n1, n3, n4 ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv3, uv4 ] );\r\n\r\n\t\t\t} else if ( Math.abs( this.vertices[ v3 ].y ) === radius ) {\r\n\r\n\t\t\t\tuv3.x = ( uv3.x + uv4.x ) / 2;\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v4, [ n1, n2, n4 ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv4 ] );\r\n\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v2, v3, v4, [ n2.clone(), n3, n4.clone() ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv2.clone(), uv3, uv4.clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For creating 3D text geometry in three.js\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  size: \t\t\t<float>, \t// size of the text\r\n *  height: \t\t<float>, \t// thickness to extrude text\r\n *  curveSegments: \t<int>,\t\t// number of points on the curves\r\n *\r\n *  font: \t\t\t<string>,\t\t// font name\r\n *  weight: \t\t<string>,\t\t// font weight (normal, bold)\r\n *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\r\n *\r\n *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\r\n *  bevelThickness: <float>, \t\t// how deep into text bevel goes\r\n *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\r\n *  }\r\n *\r\n */\r\n\r\n/*\tUsage Examples\r\n\r\n\t// TextGeometry wrapper\r\n\r\n\tvar text3d = new TextGeometry( text, options );\r\n\r\n\t// Complete manner\r\n\r\n\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\r\n\tvar text3d = new ExtrudeGeometry( textShapes, options );\r\n\r\n*/\r\n\r\n\r\nTHREE.TextGeometry = function ( text, parameters ) {\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar textShapes = THREE.FontUtils.generateShapes( text, parameters );\r\n\r\n\t// translate parameters to ExtrudeGeometry API\r\n\r\n\tparameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n\t// defaults\r\n\r\n\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\r\n\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\r\n\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\r\n\r\n\tTHREE.ExtrudeGeometry.call( this, textShapes, parameters );\r\n\r\n\tthis.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create( THREE.ExtrudeGeometry.prototype );\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = radialSegments || 8;\r\n\ttubularSegments = tubularSegments || 6;\r\n\tarc = arc || Math.PI * 2;\r\n\r\n\tvar center = new THREE.Vector3(), uvs = [], normals = [];\r\n\r\n\tfor ( var j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( var i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\tcenter.y = radius * Math.sin( u );\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t\tuvs.push( new THREE.Vector2( i / tubularSegments, j / radialSegments ) );\r\n\t\t\tnormals.push( vertex.clone().sub( center ).normalize() );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( var i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\tvar face = new THREE.Face3( a, b, d, [ normals[ a ].clone(), normals[ b ].clone(), normals[ d ].clone() ] );\r\n\t\t\tthis.faces.push( face );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ a ].clone(), uvs[ b ].clone(), uvs[ d ].clone() ] );\r\n\r\n\t\t\tface = new THREE.Face3( b, c, d, [ normals[ b ].clone(), normals[ c ].clone(), normals[ d ].clone() ] );\r\n\t\t\tthis.faces.push( face );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ b ].clone(), uvs[ c ].clone(), uvs[ d ].clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function ( radius, tube, radialSegments, tubularSegments, p, q, heightScale ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tp: p,\r\n\t\tq: q,\r\n\t\theightScale: heightScale\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = radialSegments || 64;\r\n\ttubularSegments = tubularSegments || 8;\r\n\tp = p || 2;\r\n\tq = q || 3;\r\n\theightScale = heightScale || 1;\r\n\t\r\n\tvar grid = new Array( radialSegments );\r\n\tvar tang = new THREE.Vector3();\r\n\tvar n = new THREE.Vector3();\r\n\tvar bitan = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\r\n\t\tgrid[ i ] = new Array( tubularSegments );\r\n\t\tvar u = i / radialSegments * 2 * p * Math.PI;\r\n\t\tvar p1 = getPos( u, q, p, radius, heightScale );\r\n\t\tvar p2 = getPos( u + 0.01, q, p, radius, heightScale );\r\n\t\ttang.subVectors( p2, p1 );\r\n\t\tn.addVectors( p2, p1 );\r\n\r\n\t\tbitan.crossVectors( tang, n );\r\n\t\tn.crossVectors( bitan, tang );\r\n\t\tbitan.normalize();\r\n\t\tn.normalize();\r\n\r\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\r\n\t\t\tvar v = j / tubularSegments * 2 * Math.PI;\r\n\t\t\tvar cx = - tube * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\tvar pos = new THREE.Vector3();\r\n\t\t\tpos.x = p1.x + cx * n.x + cy * bitan.x;\r\n\t\t\tpos.y = p1.y + cx * n.y + cy * bitan.y;\r\n\t\t\tpos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = this.vertices.push( pos ) - 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\r\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\r\n\t\t\tvar ip = ( i + 1 ) % radialSegments;\r\n\t\t\tvar jp = ( j + 1 ) % tubularSegments;\r\n\r\n\t\t\tvar a = grid[ i ][ j ];\r\n\t\t\tvar b = grid[ ip ][ j ];\r\n\t\t\tvar c = grid[ ip ][ jp ];\r\n\t\t\tvar d = grid[ i ][ jp ];\r\n\r\n\t\t\tvar uva = new THREE.Vector2( i / radialSegments, j / tubularSegments );\r\n\t\t\tvar uvb = new THREE.Vector2( ( i + 1 ) / radialSegments, j / tubularSegments );\r\n\t\t\tvar uvc = new THREE.Vector2( ( i + 1 ) / radialSegments, ( j + 1 ) / tubularSegments );\r\n\t\t\tvar uvd = new THREE.Vector2( i / radialSegments, ( j + 1 ) / tubularSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n\tfunction getPos( u, in_q, in_p, radius, heightScale ) {\r\n\r\n\t\tvar cu = Math.cos( u );\r\n\t\tvar su = Math.sin( u );\r\n\t\tvar quOverP = in_q / in_p * u;\r\n\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\tvar tx = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\tvar ty = radius * ( 2 + cs ) * su * 0.5;\r\n\t\tvar tz = heightScale * radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t\treturn new THREE.Vector3( tx, ty, tz );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TubeGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpath: path,\r\n\t\tsegments: segments,\r\n\t\tradius: radius,\r\n\t\tradialSegments: radialSegments,\r\n\t\tclosed: closed\r\n\t};\r\n\r\n\tsegments = segments || 64;\r\n\tradius = radius || 1;\r\n\tradialSegments = radialSegments || 8;\r\n\tclosed = closed || false;\r\n\ttaper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n\tvar grid = [];\r\n\r\n\tvar scope = this,\r\n\r\n\t\ttangent,\r\n\t\tnormal,\r\n\t\tbinormal,\r\n\r\n\t\tnumpoints = segments + 1,\r\n\r\n\t\tu, v, r,\r\n\r\n\t\tcx, cy,\r\n\t\tpos, pos2 = new THREE.Vector3(),\r\n\t\ti, j,\r\n\t\tip, jp,\r\n\t\ta, b, c, d,\r\n\t\tuva, uvb, uvc, uvd;\r\n\r\n\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\r\n\t\ttangents = frames.tangents,\r\n\t\tnormals = frames.normals,\r\n\t\tbinormals = frames.binormals;\r\n\r\n\t// proxy internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\tfunction vert( x, y, z ) {\r\n\r\n\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\r\n\r\n\t}\r\n\r\n\t// consruct the grid\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tgrid[ i ] = [];\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\tpos = path.getPointAt( u );\r\n\r\n\t\ttangent = tangents[ i ];\r\n\t\tnormal = normals[ i ];\r\n\t\tbinormal = binormals[ i ];\r\n\r\n\t\tr = radius * taper( u );\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tv = j / radialSegments * 2 * Math.PI;\r\n\r\n\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tcy = r * Math.sin( v );\r\n\r\n\t\t\tpos2.copy( pos );\r\n\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\r\n\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\r\n\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// construct the mesh\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tip = ( closed ) ? (i + 1) % segments : i + 1;\r\n\t\t\tjp = (j + 1) % radialSegments;\r\n\r\n\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\r\n\t\t\tb = grid[ ip ][ j ];\r\n\t\t\tc = grid[ ip ][ jp ];\r\n\t\t\td = grid[ i ][ jp ];\r\n\r\n\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\r\n\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\r\n\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\r\n\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function ( u ) {\r\n\r\n\treturn 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\r\n\r\n\treturn Math.sin( Math.PI * u );\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\r\n\r\n\tvar\tnormal = new THREE.Vector3(),\r\n\r\n\t\ttangents = [],\r\n\t\tnormals = [],\r\n\t\tbinormals = [],\r\n\r\n\t\tvec = new THREE.Vector3(),\r\n\t\tmat = new THREE.Matrix4(),\r\n\r\n\t\tnumpoints = segments + 1,\r\n\t\ttheta,\r\n\t\tepsilon = 0.0001,\r\n\t\tsmallest,\r\n\r\n\t\ttx, ty, tz,\r\n\t\ti, u;\r\n\r\n\r\n\t// expose internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\t// compute the tangent vectors for each segment on the path\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\ttangents[ i ] = path.getTangentAt( u );\r\n\t\ttangents[ i ].normalize();\r\n\r\n\t}\r\n\r\n\tinitialNormal3();\r\n\r\n\t/*\r\n\tfunction initialNormal1(lastBinormal) {\r\n\t\t// fixed start binormal. Has dangers of 0 vectors\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t}\r\n\r\n\tfunction initialNormal2() {\r\n\r\n\t\t// This uses the Frenet-Serret formula for deriving binormal\r\n\t\tvar t2 = path.getTangentAt( epsilon );\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n\t}\r\n\t*/\r\n\r\n\tfunction initialNormal3() {\r\n\t\t// select an initial normal vector perpenicular to the first tangent vector,\r\n\t\t// and in the direction of the smallest tangent xyz component\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tsmallest = Number.MAX_VALUE;\r\n\t\ttx = Math.abs( tangents[ 0 ].x );\r\n\t\tty = Math.abs( tangents[ 0 ].y );\r\n\t\ttz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\tif ( tx <= smallest ) {\r\n\t\t\tsmallest = tx;\r\n\t\t\tnormal.set( 1, 0, 0 );\r\n\t\t}\r\n\r\n\t\tif ( ty <= smallest ) {\r\n\t\t\tsmallest = ty;\r\n\t\t\tnormal.set( 0, 1, 0 );\r\n\t\t}\r\n\r\n\t\tif ( tz <= smallest ) {\r\n\t\t\tnormal.set( 0, 0, 1 );\r\n\t\t}\r\n\r\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\t}\r\n\r\n\r\n\t// compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\tif ( vec.length() > epsilon ) {\r\n\r\n\t\t\tvec.normalize();\r\n\r\n\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t}\r\n\r\n\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t}\r\n\r\n\r\n\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\tif ( closed ) {\r\n\r\n\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\r\n\t\ttheta /= ( numpoints - 1 );\r\n\r\n\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\r\n\r\n\t\t\ttheta = - theta;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\t\t// twist a little...\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PolyhedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tvertices: vertices,\r\n\t\tindices: indices,\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tradius = radius || 1;\r\n\tdetail = detail || 0;\r\n\r\n\tvar that = this;\r\n\r\n\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\r\n\r\n\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t}\r\n\r\n\tvar p = this.vertices;\r\n\r\n\tvar faces = [];\r\n\r\n\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\r\n\r\n\t\tvar v1 = p[ indices[ i     ] ];\r\n\t\tvar v2 = p[ indices[ i + 1 ] ];\r\n\t\tvar v3 = p[ indices[ i + 2 ] ];\r\n\r\n\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ] );\r\n\r\n\t}\r\n\r\n\tvar centroid = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tsubdivide( faces[ i ], detail );\r\n\r\n\t}\r\n\r\n\r\n\t// Handle case when face straddles the seam\r\n\r\n\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\r\n\r\n\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\tvar x0 = uvs[ 0 ].x;\r\n\t\tvar x1 = uvs[ 1 ].x;\r\n\t\tvar x2 = uvs[ 2 ].x;\r\n\r\n\t\tvar max = Math.max( x0, Math.max( x1, x2 ) );\r\n\t\tvar min = Math.min( x0, Math.min( x1, x2 ) );\r\n\r\n\t\tif ( max > 0.9 && min < 0.1 ) { // 0.9 is somewhat arbitrary\r\n\r\n\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\r\n\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\r\n\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Apply radius\r\n\r\n\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\r\n\r\n\t\tthis.vertices[ i ].multiplyScalar( radius );\r\n\r\n\t}\r\n\r\n\r\n\t// Merge vertices\r\n\r\n\tthis.mergeVertices();\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n\r\n\t// Project vector onto sphere's surface\r\n\r\n\tfunction prepare( vector ) {\r\n\r\n\t\tvar vertex = vector.normalize().clone();\r\n\t\tvertex.index = that.vertices.push( vertex ) - 1;\r\n\r\n\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\r\n\t\tvar v = inclination( vector ) / Math.PI + 0.5;\r\n\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\r\n\r\n\t\treturn vertex;\r\n\r\n\t}\r\n\r\n\r\n\t// Approximate a curved face with recursively sub-divided triangles.\r\n\r\n\tfunction make( v1, v2, v3 ) {\r\n\r\n\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ] );\r\n\t\tthat.faces.push( face );\r\n\r\n\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\r\n\r\n\t\tvar azi = azimuth( centroid );\r\n\r\n\t\tthat.faceVertexUvs[ 0 ].push( [\r\n\t\t\tcorrectUV( v1.uv, v1, azi ),\r\n\t\t\tcorrectUV( v2.uv, v2, azi ),\r\n\t\t\tcorrectUV( v3.uv, v3, azi )\r\n\t\t] );\r\n\r\n\t}\r\n\r\n\r\n\t// Analytically subdivide a face to the required detail level.\r\n\r\n\tfunction subdivide( face, detail ) {\r\n\r\n\t\tvar cols = Math.pow(2, detail);\r\n\t\tvar a = prepare( that.vertices[ face.a ] );\r\n\t\tvar b = prepare( that.vertices[ face.b ] );\r\n\t\tvar c = prepare( that.vertices[ face.c ] );\r\n\t\tvar v = [];\r\n\r\n\t\t// Construct all of the vertices for this subdivision.\r\n\r\n\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\r\n\r\n\t\t\tv[ i ] = [];\r\n\r\n\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\r\n\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\r\n\t\t\tvar rows = cols - i;\r\n\r\n\t\t\tfor ( var j = 0; j <= rows; j ++) {\r\n\r\n\t\t\t\tif ( j == 0 && i == cols ) {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Construct all of the faces.\r\n\r\n\t\tfor ( var i = 0; i < cols ; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2 * (cols - i) - 1; j ++ ) {\r\n\r\n\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\tif ( j % 2 == 0 ) {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tv[ i ][ k ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1][ k + 1],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\tfunction azimuth( vector ) {\r\n\r\n\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t}\r\n\r\n\r\n\t// Angle above the XZ plane.\r\n\r\n\tfunction inclination( vector ) {\r\n\r\n\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t}\r\n\r\n\r\n\t// Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n\tfunction correctUV( uv, vector, azimuth ) {\r\n\r\n\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\r\n\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\r\n\t\treturn uv.clone();\r\n\r\n\t}\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function ( radius, detail ) {\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\tvar r = 1 / t;\r\n\r\n\tvar vertices = [\r\n\r\n\t\t// (±1, ±1, ±1)\r\n\t\t-1, -1, -1,    -1, -1,  1,\r\n\t\t-1,  1, -1,    -1,  1,  1,\r\n\t\t 1, -1, -1,     1, -1,  1,\r\n\t\t 1,  1, -1,     1,  1,  1,\r\n\r\n\t\t// (0, ±1/φ, ±φ)\r\n\t\t 0, -r, -t,     0, -r,  t,\r\n\t\t 0,  r, -t,     0,  r,  t,\r\n\r\n\t\t// (±1/φ, ±φ, 0)\r\n\t\t-r, -t,  0,    -r,  t,  0,\r\n\t\t r, -t,  0,     r,  t,  0,\r\n\r\n\t\t// (±φ, 0, ±1/φ)\r\n\t\t-t,  0, -r,     t,  0, -r,\r\n\t\t-t,  0,  r,     t,  0,  r\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\r\n\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\r\n\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\r\n\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\r\n\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\r\n\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\r\n\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\r\n\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\r\n\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\r\n\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\r\n\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\r\n\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\tvar vertices = [\r\n\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\r\n\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\r\n\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\r\n\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\r\n\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\r\n\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'IcosahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function ( radius, detail ) {\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tvar vertices = [\r\n\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0,- 1, 0,    0, 0, 1,    0, 0,- 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'OctahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'TetrahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function ( func, slices, stacks ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ParametricGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tfunc: func,\r\n\t\tslices: slices,\r\n\t\tstacks: stacks\r\n\t};\r\n\r\n\tvar verts = this.vertices;\r\n\tvar faces = this.faces;\r\n\tvar uvs = this.faceVertexUvs[ 0 ];\r\n\r\n\tvar i, j, p;\r\n\tvar u, v;\r\n\r\n\tvar sliceCount = slices + 1;\r\n\r\n\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\tv = i / stacks;\r\n\r\n\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\tu = j / slices;\r\n\r\n\t\t\tp = func( u, v );\r\n\t\t\tverts.push( p );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tvar a, b, c, d;\r\n\tvar uva, uvb, uvc, uvd;\r\n\r\n\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\ta = i * sliceCount + j;\r\n\t\t\tb = i * sliceCount + j + 1;\r\n\t\t\tc = (i + 1) * sliceCount + j + 1;\r\n\t\t\td = (i + 1) * sliceCount + j;\r\n\r\n\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\r\n\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\r\n\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\r\n\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tuvs.push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// console.log(this);\r\n\r\n\t// magic bullet\r\n\t// var diff = this.mergeVertices();\r\n\t// console.log('removed ', diff, ' vertices by merging');\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function ( size ) {\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar vertices = new Float32Array( [\r\n\t\t0, 0, 0,  size, 0, 0,\r\n\t\t0, 0, 0,  0, size, 0,\r\n\t\t0, 0, 0,  0, 0, size\r\n\t] );\r\n\r\n\tvar colors = new Float32Array( [\r\n\t\t1, 0, 0,  1, 0.6, 0,\r\n\t\t0, 1, 0,  0.6, 1, 0,\r\n\t\t0, 0, 1,  0, 0.6, 1\r\n\t] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tTHREE.Line.call( this, geometry, material, THREE.LinePieces );\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = ( function () {\r\n\r\n\tvar lineGeometry = new THREE.Geometry();\r\n\tlineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\r\n\r\n\tvar coneGeometry = new THREE.CylinderGeometry( 0, 0.5, 1, 5, 1 );\r\n\tconeGeometry.applyMatrix( new THREE.Matrix4().makeTranslation( 0, - 0.5, 0 ) );\r\n\r\n\treturn function ( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\tif ( length === undefined ) length = 1;\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tthis.position.copy( origin );\r\n\r\n\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\tthis.line.matrixAutoUpdate = false;\r\n\t\tthis.add( this.line );\r\n\r\n\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t}\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = ( function () {\r\n\r\n\tvar axis = new THREE.Vector3();\r\n\tvar radians;\r\n\r\n\treturn function ( dir ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\tradians = Math.acos( dir.y );\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\tthis.line.scale.set( 1, length - headLength, 1 );\r\n\tthis.line.updateMatrix();\r\n\r\n\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\tthis.cone.position.y = length;\r\n\tthis.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\tthis.line.material.color.set( color );\r\n\tthis.cone.material.color.set( color );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function ( object ) {\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( 72 ), 3 ) );\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ), THREE.LinePieces );\r\n\r\n\tif ( object !== undefined ) {\r\n\r\n\t\tthis.update( object );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = function ( object ) {\r\n\r\n\tvar geometry = object.geometry;\r\n\r\n\tif ( geometry.boundingBox === null ) {\r\n\r\n\t\tgeometry.computeBoundingBox();\r\n\r\n\t}\r\n\r\n\tvar min = geometry.boundingBox.min;\r\n\tvar max = geometry.boundingBox.max;\r\n\r\n\t/*\r\n\t  5____4\r\n\t1/___0/|\r\n\t| 6__|_7\r\n\t2/___3/\r\n\r\n\t0: max.x, max.y, max.z\r\n\t1: min.x, max.y, max.z\r\n\t2: min.x, min.y, max.z\r\n\t3: max.x, min.y, max.z\r\n\t4: max.x, max.y, min.z\r\n\t5: min.x, max.y, min.z\r\n\t6: min.x, min.y, min.z\r\n\t7: max.x, min.y, min.z\r\n\t*/\r\n\r\n\tvar vertices = this.geometry.attributes.position.array;\r\n\r\n\tvertices[  0 ] = max.x; vertices[  1 ] = max.y; vertices[  2 ] = max.z;\r\n\tvertices[  3 ] = min.x; vertices[  4 ] = max.y; vertices[  5 ] = max.z;\r\n\r\n\tvertices[  6 ] = min.x; vertices[  7 ] = max.y; vertices[  8 ] = max.z;\r\n\tvertices[  9 ] = min.x; vertices[ 10 ] = min.y; vertices[ 11 ] = max.z;\r\n\r\n\tvertices[ 12 ] = min.x; vertices[ 13 ] = min.y; vertices[ 14 ] = max.z;\r\n\tvertices[ 15 ] = max.x; vertices[ 16 ] = min.y; vertices[ 17 ] = max.z;\r\n\r\n\tvertices[ 18 ] = max.x; vertices[ 19 ] = min.y; vertices[ 20 ] = max.z;\r\n\tvertices[ 21 ] = max.x; vertices[ 22 ] = max.y; vertices[ 23 ] = max.z;\r\n\r\n\t//\r\n\r\n\tvertices[ 24 ] = max.x; vertices[ 25 ] = max.y; vertices[ 26 ] = min.z;\r\n\tvertices[ 27 ] = min.x; vertices[ 28 ] = max.y; vertices[ 29 ] = min.z;\r\n\r\n\tvertices[ 30 ] = min.x; vertices[ 31 ] = max.y; vertices[ 32 ] = min.z;\r\n\tvertices[ 33 ] = min.x; vertices[ 34 ] = min.y; vertices[ 35 ] = min.z;\r\n\r\n\tvertices[ 36 ] = min.x; vertices[ 37 ] = min.y; vertices[ 38 ] = min.z;\r\n\tvertices[ 39 ] = max.x; vertices[ 40 ] = min.y; vertices[ 41 ] = min.z;\r\n\r\n\tvertices[ 42 ] = max.x; vertices[ 43 ] = min.y; vertices[ 44 ] = min.z;\r\n\tvertices[ 45 ] = max.x; vertices[ 46 ] = max.y; vertices[ 47 ] = min.z;\r\n\r\n\t//\r\n\r\n\tvertices[ 48 ] = max.x; vertices[ 49 ] = max.y; vertices[ 50 ] = max.z;\r\n\tvertices[ 51 ] = max.x; vertices[ 52 ] = max.y; vertices[ 53 ] = min.z;\r\n\r\n\tvertices[ 54 ] = min.x; vertices[ 55 ] = max.y; vertices[ 56 ] = max.z;\r\n\tvertices[ 57 ] = min.x; vertices[ 58 ] = max.y; vertices[ 59 ] = min.z;\r\n\r\n\tvertices[ 60 ] = min.x; vertices[ 61 ] = min.y; vertices[ 62 ] = max.z;\r\n\tvertices[ 63 ] = min.x; vertices[ 64 ] = min.y; vertices[ 65 ] = min.z;\r\n\r\n\tvertices[ 66 ] = max.x; vertices[ 67 ] = min.y; vertices[ 68 ] = max.z;\r\n\tvertices[ 69 ] = max.x; vertices[ 70 ] = min.y; vertices[ 71 ] = min.z;\r\n\r\n\tthis.geometry.attributes.position.needsUpdate = true;\r\n\r\n\tthis.geometry.computeBoundingSphere();\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0x888888;\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.box = new THREE.Box3();\r\n\r\n\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function () {\r\n\r\n\tthis.box.setFromObject( this.object );\r\n\r\n\tthis.box.size( this.scale );\r\n\r\n\tthis.box.center( this.position );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function ( camera ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\r\n\r\n\tvar pointMap = {};\r\n\r\n\t// colors\r\n\r\n\tvar hexFrustum = 0xffaa00;\r\n\tvar hexCone = 0xff0000;\r\n\tvar hexUp = 0x00aaff;\r\n\tvar hexTarget = 0xffffff;\r\n\tvar hexCross = 0x333333;\r\n\r\n\t// near\r\n\r\n\taddLine( \"n1\", \"n2\", hexFrustum );\r\n\taddLine( \"n2\", \"n4\", hexFrustum );\r\n\taddLine( \"n4\", \"n3\", hexFrustum );\r\n\taddLine( \"n3\", \"n1\", hexFrustum );\r\n\r\n\t// far\r\n\r\n\taddLine( \"f1\", \"f2\", hexFrustum );\r\n\taddLine( \"f2\", \"f4\", hexFrustum );\r\n\taddLine( \"f4\", \"f3\", hexFrustum );\r\n\taddLine( \"f3\", \"f1\", hexFrustum );\r\n\r\n\t// sides\r\n\r\n\taddLine( \"n1\", \"f1\", hexFrustum );\r\n\taddLine( \"n2\", \"f2\", hexFrustum );\r\n\taddLine( \"n3\", \"f3\", hexFrustum );\r\n\taddLine( \"n4\", \"f4\", hexFrustum );\r\n\r\n\t// cone\r\n\r\n\taddLine( \"p\", \"n1\", hexCone );\r\n\taddLine( \"p\", \"n2\", hexCone );\r\n\taddLine( \"p\", \"n3\", hexCone );\r\n\taddLine( \"p\", \"n4\", hexCone );\r\n\r\n\t// up\r\n\r\n\taddLine( \"u1\", \"u2\", hexUp );\r\n\taddLine( \"u2\", \"u3\", hexUp );\r\n\taddLine( \"u3\", \"u1\", hexUp );\r\n\r\n\t// target\r\n\r\n\taddLine( \"c\", \"t\", hexTarget );\r\n\taddLine( \"p\", \"c\", hexCross );\r\n\r\n\t// cross\r\n\r\n\taddLine( \"cn1\", \"cn2\", hexCross );\r\n\taddLine( \"cn3\", \"cn4\", hexCross );\r\n\r\n\taddLine( \"cf1\", \"cf2\", hexCross );\r\n\taddLine( \"cf3\", \"cf4\", hexCross );\r\n\r\n\tfunction addLine( a, b, hex ) {\r\n\r\n\t\taddPoint( a, hex );\r\n\t\taddPoint( b, hex );\r\n\r\n\t}\r\n\r\n\tfunction addPoint( id, hex ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\tgeometry.colors.push( new THREE.Color( hex ) );\r\n\r\n\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, material, THREE.LinePieces );\r\n\r\n\tthis.camera = camera;\r\n\tthis.matrix = camera.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.pointMap = pointMap;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function () {\r\n\r\n\tvar geometry, pointMap;\r\n\t\r\n\tvar vector = new THREE.Vector3();\r\n\tvar camera = new THREE.Camera();\r\n\r\n\tvar setPoint = function ( point, x, y, z ) {\r\n\r\n\t\tvector.set( x, y, z ).unproject( camera );\r\n\r\n\t\tvar points = pointMap[ point ];\r\n\r\n\t\tif ( points !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn function () {\r\n\r\n\t\tgeometry = this.geometry;\r\n\t\tpointMap = this.pointMap;\r\n\r\n\t\tvar w = 1, h = 1;\r\n\r\n\t\t// we need just camera projection matrix\r\n\t\t// world matrix must be identity\r\n\r\n\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\r\n\t\t// center / target\r\n\r\n\t\tsetPoint( \"c\", 0, 0, - 1 );\r\n\t\tsetPoint( \"t\", 0, 0,  1 );\r\n\r\n\t\t// near\r\n\r\n\t\tsetPoint( \"n1\", - w, - h, - 1 );\r\n\t\tsetPoint( \"n2\",   w, - h, - 1 );\r\n\t\tsetPoint( \"n3\", - w,   h, - 1 );\r\n\t\tsetPoint( \"n4\",   w,   h, - 1 );\r\n\r\n\t\t// far\r\n\r\n\t\tsetPoint( \"f1\", - w, - h, 1 );\r\n\t\tsetPoint( \"f2\",   w, - h, 1 );\r\n\t\tsetPoint( \"f3\", - w,   h, 1 );\r\n\t\tsetPoint( \"f4\",   w,   h, 1 );\r\n\r\n\t\t// up\r\n\r\n\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\r\n\r\n\t\t// cross\r\n\r\n\t\tsetPoint( \"cf1\", - w,   0, 1 );\r\n\t\tsetPoint( \"cf2\",   w,   0, 1 );\r\n\t\tsetPoint( \"cf3\",   0, - h, 1 );\r\n\t\tsetPoint( \"cf4\",   0,   h, 1 );\r\n\r\n\t\tsetPoint( \"cn1\", - w,   0, - 1 );\r\n\t\tsetPoint( \"cn2\",   w,   0, - 1 );\r\n\t\tsetPoint( \"cn3\",   0, - h, - 1 );\r\n\t\tsetPoint( \"cn4\",   0,   h, - 1 );\r\n\r\n\t\tgeometry.verticesNeedUpdate = true;\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function ( light, size ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3( - size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size,   size, 0 )\r\n\t);\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.lightPlane = new THREE.Line( geometry, material );\r\n\tthis.add( this.lightPlane );\r\n\r\n\tgeometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3(),\r\n\t\tnew THREE.Vector3()\r\n\t);\r\n\r\n\tmaterial = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.targetLine = new THREE.Line( geometry, material );\r\n\tthis.add( this.targetLine );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightPlane.geometry.dispose();\r\n\tthis.lightPlane.material.dispose();\r\n\tthis.targetLine.geometry.dispose();\r\n\tthis.targetLine.material.dispose();\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar v3 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\tv3.subVectors( v2, v1 );\r\n\r\n\t\tthis.lightPlane.lookAt( v3 );\r\n\t\tthis.lightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.targetLine.geometry.vertices[ 1 ].copy( v3 );\r\n\t\tthis.targetLine.geometry.verticesNeedUpdate = true;\r\n\t\tthis.targetLine.material.color.copy( this.lightPlane.material.color );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimim angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\tvar thresholdDot = Math.cos( THREE.Math.degToRad( thresholdAngle ) );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\tvar sortFunction = function ( a, b ) { return a - b };\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar geometry2;\r\n\r\n\tif ( object.geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tgeometry2 = new THREE.Geometry();\r\n\t\tgeometry2.fromBufferGeometry( object.geometry );\r\n\r\n\t} else {\r\n\r\n\t\tgeometry2 = object.geometry.clone();\r\n\r\n\t}\r\n\r\n\tgeometry2.mergeVertices();\r\n\tgeometry2.computeFaceNormals();\r\n\r\n\tvar vertices = geometry2.vertices;\r\n\tvar faces = geometry2.faces;\r\n\tvar numEdges = 0;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\tvar key = edge.toString();\r\n\r\n\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\r\n\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thash[ key ].face2 = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\tvar index = 0;\r\n\r\n\tfor ( var key in hash ) {\r\n\r\n\t\tvar h = hash[ key ];\r\n\r\n\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\tvar vertex = vertices[ h.vert1 ];\r\n\t\t\tcoords[ index ++ ] = vertex.x;\r\n\t\t\tcoords[ index ++ ] = vertex.y;\r\n\t\t\tcoords[ index ++ ] = vertex.z;\r\n\r\n\t\t\tvertex = vertices[ h.vert2 ];\r\n\t\t\tcoords[ index ++ ] = vertex.x;\r\n\t\t\tcoords[ index ++ ] = vertex.y;\r\n\t\t\tcoords[ index ++ ] = vertex.z;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: color } ), THREE.LinePieces );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tvar faces = this.object.geometry.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3(), new THREE.Vector3() );\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ), THREE.LinePieces );\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.normalMatrix = new THREE.Matrix3();\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = function () {\r\n\r\n\tvar vertices = this.geometry.vertices;\r\n\r\n\tvar object = this.object;\r\n\tvar objectVertices = object.geometry.vertices;\r\n\tvar objectFaces = object.geometry.faces;\r\n\tvar objectWorldMatrix = object.matrixWorld;\r\n\r\n\tobject.updateMatrixWorld( true );\r\n\r\n\tthis.normalMatrix.getNormalMatrix( objectWorldMatrix );\r\n\r\n\tfor ( var i = 0, i2 = 0, l = objectFaces.length; i < l; i ++, i2 += 2 ) {\r\n\r\n\t\tvar face = objectFaces[ i ];\r\n\r\n\t\tvertices[ i2 ].copy( objectVertices[ face.a ] )\r\n\t\t\t.add( objectVertices[ face.b ] )\r\n\t\t\t.add( objectVertices[ face.c ] )\r\n\t\t\t.divideScalar( 3 )\r\n\t\t\t.applyMatrix4( objectWorldMatrix );\r\n\r\n\t\tvertices[ i2 + 1 ].copy( face.normal )\r\n\t\t\t.applyMatrix3( this.normalMatrix )\r\n\t\t\t.normalize()\r\n\t\t\t.multiplyScalar( this.size )\r\n\t\t\t.add( vertices[ i2 ] );\r\n\r\n\t}\r\n\r\n\tthis.geometry.verticesNeedUpdate = true;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function ( size, step ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tthis.color1 = new THREE.Color( 0x444444 );\r\n\tthis.color2 = new THREE.Color( 0x888888 );\r\n\r\n\tfor ( var i = - size; i <= size; i += step ) {\r\n\r\n\t\tgeometry.vertices.push(\r\n\t\t\tnew THREE.Vector3( - size, 0, i ), new THREE.Vector3( size, 0, i ),\r\n\t\t\tnew THREE.Vector3( i, 0, - size ), new THREE.Vector3( i, 0, size )\r\n\t\t);\r\n\r\n\t\tvar color = i === 0 ? this.color1 : this.color2;\r\n\r\n\t\tgeometry.colors.push( color, color, color, color );\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, material, THREE.LinePieces );\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function( colorCenterLine, colorGrid ) {\r\n\r\n\tthis.color1.set( colorCenterLine );\r\n\tthis.color2.set( colorGrid );\r\n\r\n\tthis.geometry.colorsNeedUpdate = true;\r\n\r\n}\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tgeometry.applyMatrix( new THREE.Matrix4().makeRotationX( - Math.PI / 2 ) );\r\n\r\n\tfor ( var i = 0, il = 8; i < il; i ++ ) {\r\n\r\n\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\r\n\r\n\t}\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.lightSphere );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function () {\r\n\tthis.lightSphere.geometry.dispose();\r\n\tthis.lightSphere.material.dispose();\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n\t}\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function ( light, sphereSize ) {\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.matrix = this.light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\t/*\r\n\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\tvar d = light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\r\n\tthis.add( this.lightDistance );\r\n\t*/\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.geometry.dispose();\r\n\tthis.material.dispose();\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function () {\r\n\r\n\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t/*\r\n\tvar d = this.light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.visible = true;\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\t*/\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function ( object ) {\r\n\r\n\tthis.bones = this.getBoneList( object );\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\r\n\tTHREE.Line.call( this, geometry, material, THREE.LinePieces );\r\n\r\n\tthis.root = object;\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\r\n\r\n\tvar boneList = [];\r\n\r\n\tif ( object instanceof THREE.Bone ) {\r\n\r\n\t\tboneList.push( object );\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\r\n\r\n\t}\r\n\r\n\treturn boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function () {\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\r\n\r\n\tvar boneMatrix = new THREE.Matrix4();\r\n\r\n\tvar j = 0;\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tj += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.verticesNeedUpdate = true;\r\n\r\n\tgeometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.SpotLightHelper = function ( light ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tvar geometry = new THREE.CylinderGeometry( 0, 1, 1, 8, 1, true );\r\n\r\n\tgeometry.applyMatrix( new THREE.Matrix4().makeTranslation( 0, - 0.5, 0 ) );\r\n\tgeometry.applyMatrix( new THREE.Matrix4().makeRotationX( - Math.PI / 2 ) );\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\r\n\tthis.cone = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.cone );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function () {\r\n\tthis.cone.geometry.dispose();\r\n\tthis.cone.material.dispose();\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar vector2 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tvar coneLength = this.light.distance ? this.light.distance : 10000;\r\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\r\n\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tvar faces = object.geometry.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3(), new THREE.Vector3() );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ), THREE.LinePieces );\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.normalMatrix = new THREE.Matrix3();\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = ( function ( object ) {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function( object ) {\r\n\r\n\t\tvar keys = [ 'a', 'b', 'c', 'd' ];\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tthis.normalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar vertices = this.geometry.vertices;\r\n\r\n\t\tvar verts = this.object.geometry.vertices;\r\n\r\n\t\tvar faces = this.object.geometry.faces;\r\n\r\n\t\tvar worldMatrix = this.object.matrixWorld;\r\n\r\n\t\tvar idx = 0;\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar vertexId = face[ keys[ j ] ];\r\n\t\t\t\tvar vertex = verts[ vertexId ];\r\n\r\n\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\r\n\t\t\t\tvertices[ idx ].copy( vertex ).applyMatrix4( worldMatrix );\r\n\r\n\t\t\t\tv1.copy( normal ).applyMatrix3( this.normalMatrix ).normalize().multiplyScalar( this.size );\r\n\r\n\t\t\t\tv1.add( vertices[ idx ] );\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tvertices[ idx ].copy( v1 );\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometry.verticesNeedUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/VertexTangentsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.VertexTangentsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0x0000ff;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tvar faces = object.geometry.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0, jl = face.vertexTangents.length; j < jl; j ++ ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ), THREE.LinePieces );\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.VertexTangentsHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.VertexTangentsHelper.prototype.constructor = THREE.VertexTangentsHelper;\r\n\r\nTHREE.VertexTangentsHelper.prototype.update = ( function ( object ) {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function( object ) {\r\n\r\n\t\tvar keys = [ 'a', 'b', 'c', 'd' ];\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tvar vertices = this.geometry.vertices;\r\n\r\n\t\tvar verts = this.object.geometry.vertices;\r\n\r\n\t\tvar faces = this.object.geometry.faces;\r\n\r\n\t\tvar worldMatrix = this.object.matrixWorld;\r\n\r\n\t\tvar idx = 0;\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexTangents.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar vertexId = face[ keys[ j ] ];\r\n\t\t\t\tvar vertex = verts[ vertexId ];\r\n\r\n\t\t\t\tvar tangent = face.vertexTangents[ j ];\r\n\r\n\t\t\t\tvertices[ idx ].copy( vertex ).applyMatrix4( worldMatrix );\r\n\r\n\t\t\t\tv1.copy( tangent ).transformDirection( worldMatrix ).multiplyScalar( this.size );\r\n\r\n\t\t\t\tv1.add( vertices[ idx ] );\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tvertices[ idx ].copy( v1 );\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometry.verticesNeedUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\tvar sortFunction = function ( a, b ) { return a - b };\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tif ( object.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tvar vertices = object.geometry.vertices;\r\n\t\tvar faces = object.geometry.faces;\r\n\t\tvar numEdges = 0;\r\n\r\n\t\t// allocate maximal size\r\n\t\tvar edges = new Uint32Array( 6 * faces.length );\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j] ];\r\n\r\n\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\tcoords[ index + 0 ] = vertex.x;\r\n\t\t\t\tcoords[ index + 1 ] = vertex.y;\r\n\t\t\t\tcoords[ index + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t} else if ( object.geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tif ( object.geometry.attributes.index !== undefined ) { // Indexed BufferGeometry\r\n\r\n\t\t\tvar vertices = object.geometry.attributes.position.array;\r\n\t\t\tvar indices = object.geometry.attributes.index.array;\r\n\t\t\tvar drawcalls = object.geometry.drawcalls;\r\n\t\t\tvar numEdges = 0;\r\n\r\n\t\t\tif ( drawcalls.length === 0 ) {\r\n\r\n\t\t\t\tdrawcalls = [ { count : indices.length, index : 0, start : 0 } ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// allocate maximal size\r\n\t\t\tvar edges = new Uint32Array( 2 * indices.length );\r\n\r\n\t\t\tfor ( var o = 0, ol = drawcalls.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\tvar start = drawcalls[ o ].start;\r\n\t\t\t\tvar count = drawcalls[ o ].count;\r\n\t\t\t\tvar index = drawcalls[ o ].index;\r\n\r\n\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\tedge[ 0 ] = index + indices[ i + j ];\r\n\t\t\t\t\t\tedge[ 1 ] = index + indices[ i + ( j + 1 ) % 3 ];\r\n\t\t\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\tvar index2 = 3 * edges[ 2 * i + j];\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index2 ];\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index2 + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t} else { // non-indexed BufferGeometry\r\n\r\n\t\t\tvar vertices = object.geometry.attributes.position.array;\r\n\t\t\tvar numEdges = vertices.length / 3;\r\n\t\t\tvar numTris = numEdges / 3;\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 18 * i + 6 * j;\r\n\r\n\t\t\t\t\tvar index1 = 9 * i + 3 * j;\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\r\n\r\n\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\r\n\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\r\n\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTHREE.Line.call( this, geometry, new THREE.LineBasicMaterial( { color: color } ), THREE.LinePieces );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.render = function ( renderCallback ) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function( geometry, material ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.animationsMap = {};\r\n\tthis.animationsList = [];\r\n\r\n\t// prepare default animation\r\n\t// (all frames played together in 1 second)\r\n\r\n\tvar numFrames = this.geometry.morphTargets.length;\r\n\r\n\tvar name = \"__default\";\r\n\r\n\tvar startFrame = 0;\r\n\tvar endFrame = numFrames - 1;\r\n\r\n\tvar fps = numFrames / 1;\r\n\r\n\tthis.createAnimation( name, startFrame, endFrame, fps );\r\n\tthis.setAnimationWeight( name, 1 );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\r\n\r\n\tvar animation = {\r\n\r\n\t\tstartFrame: start,\r\n\t\tendFrame: end,\r\n\r\n\t\tlength: end - start + 1,\r\n\r\n\t\tfps: fps,\r\n\t\tduration: ( end - start ) / fps,\r\n\r\n\t\tlastFrame: 0,\r\n\t\tcurrentFrame: 0,\r\n\r\n\t\tactive: false,\r\n\r\n\t\ttime: 0,\r\n\t\tdirection: 1,\r\n\t\tweight: 1,\r\n\r\n\t\tdirectionBackwards: false,\r\n\t\tmirroredLoop: false\r\n\r\n\t};\r\n\r\n\tthis.animationsMap[ name ] = animation;\r\n\tthis.animationsList.push( animation );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\r\n\r\n\tvar pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n\tvar firstAnimation, frameRanges = {};\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\tvar chunks = morph.name.match( pattern );\r\n\r\n\t\tif ( chunks && chunks.length > 1 ) {\r\n\r\n\t\t\tvar name = chunks[ 1 ];\r\n\r\n\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\r\n\r\n\t\t\tvar range = frameRanges[ name ];\r\n\r\n\t\t\tif ( i < range.start ) range.start = i;\r\n\t\t\tif ( i > range.end ) range.end = i;\r\n\r\n\t\t\tif ( ! firstAnimation ) firstAnimation = name;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var name in frameRanges ) {\r\n\r\n\t\tvar range = frameRanges[ name ];\r\n\t\tthis.createAnimation( name, range.start, range.end, fps );\r\n\r\n\t}\r\n\r\n\tthis.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = 1;\r\n\t\tanimation.directionBackwards = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = - 1;\r\n\t\tanimation.directionBackwards = true;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.fps = fps;\r\n\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.duration = duration;\r\n\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.weight = weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = time;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\r\n\r\n\tvar time = 0;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\ttime = animation.time;\r\n\r\n\t}\r\n\r\n\treturn time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\r\n\r\n\tvar duration = - 1;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tduration = animation.duration;\r\n\r\n\t}\r\n\r\n\treturn duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = 0;\r\n\t\tanimation.active = true;\r\n\r\n\t} else {\r\n\r\n\t\tTHREE.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.active = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\r\n\r\n\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\r\n\r\n\t\tvar animation = this.animationsList[ i ];\r\n\r\n\t\tif ( ! animation.active ) continue;\r\n\r\n\t\tvar frameTime = animation.duration / animation.length;\r\n\r\n\t\tanimation.time += animation.direction * delta;\r\n\r\n\t\tif ( animation.mirroredLoop ) {\r\n\r\n\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\r\n\r\n\t\t\t\tanimation.direction *= - 1;\r\n\r\n\t\t\t\tif ( animation.time > animation.duration ) {\r\n\r\n\t\t\t\t\tanimation.time = animation.duration;\r\n\t\t\t\t\tanimation.directionBackwards = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( animation.time < 0 ) {\r\n\r\n\t\t\t\t\tanimation.time = 0;\r\n\t\t\t\t\tanimation.directionBackwards = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tanimation.time = animation.time % animation.duration;\r\n\r\n\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\r\n\r\n\t\t}\r\n\r\n\t\tvar keyframe = animation.startFrame + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\r\n\t\tvar weight = animation.weight;\r\n\r\n\t\tif ( keyframe !== animation.currentFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\r\n\r\n\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\r\n\t\t\tanimation.lastFrame = animation.currentFrame;\r\n\t\t\tanimation.currentFrame = keyframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar mix = ( animation.time % frameTime ) / frameTime;\r\n\r\n\t\tif ( animation.directionBackwards ) mix = 1 - mix;\r\n\r\n\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\r\n\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n} else {\r\n  this['THREE'] = THREE;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/THREE/three.js","import Stats from 'stats.js'\n\nexport function init_stats( targetID ){\n\t/*\n\t * Wire in the stats library\n\t */\n\tvar stats = new Stats();\n\tstats.domElement.style.display = 'inline-block'\n\tstats.domElement.style.position = 'inherit'\n\n\tdocument.getElementById( targetID || \"stats-container\" ).appendChild( stats.domElement );\n\treturn stats;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/stats.js","import THREE from 'THREE'\n\nvar print = true;\n\nexport function collidable_aspect( sys, object, boundingBox ){\n\tvar max = new THREE.Vector3( boundingBox.x / 2, boundingBox.y / 2, boundingBox.z / 2 );\n\tvar min = new THREE.Vector3();\n\tmin.copy( max ).negate();\n\n\tvar visual;\n\tvar collidable = {\n\t\tobject: object,\n\t\tbounds: boundingBox,\n\t\tcalc: function(){\n\t\t\tvar box = new THREE.Box3( min.clone(), max.clone() );\n\t\t\tvar point = new THREE.Vector3( this.object.position.x, this.object.position.y, this.object.position.z );\n\t\t\treturn box.translate( point );\n\t\t},\n\t\tanimate_tick: function( scene ){\n\t\t\tif( !visual ){\n\t\t\t\tvar geometry = new THREE.BoxGeometry( boundingBox.x, boundingBox.y, boundingBox.z );\n\t\t\t\tvar material = new THREE.MeshBasicMaterial( { color: 0xff0000 } );\n\t\t\t\tvar mesh = new THREE.Mesh( geometry, material );\n\n\t\t\t\tvisual = new THREE.WireframeHelper( mesh, 0xff0000 );\n\t\t\t\tvisual.matrixAutoUpdate = true; //GAH!  :-(\n\n\t\t\t\tscene.add( visual );\n\t\t\t}\n\t\t\tfunction sync_position( target, source ){\n\t\t\t\ttarget.position.x = source.position.x;\n\t\t\t\ttarget.position.y = source.position.y;\n\t\t\t\ttarget.position.z = source.position.z;\n\t\t\t}\n\t\t\tsync_position( visual, this.object );\n\t\t},\n\n\t\tcollision_tick: function( others ){\n\t\t\tvar count = 0;\n\t\t\tvar self = this;\n\t\t\tvar realArea = this.calc();\n\t\t\tvar hit = others.filter( function( other ){\n\t\t\t\tif( other == self ) return false;\n\t\t\t\tvar check = other.calc();\n\t\t\t\tif( count % 997 == 0 ){\n\t\t\t\t\t//console.log( check.min, check.max, realArea.min, realArea.max );\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tvar hit = realArea.isIntersectionBox( check );\n\t\t\t\tif( hit ){\n\t\t\t\t\tif( print ){ console.log( check, realArea ); }\n\t\t\t\t}\n\t\t\t\treturn hit;\n\t\t\t});\n\t\t\tif( hit.length > 0 ){\n\t\t\t\tif( print ){\n\t\t\t\t\tprint= false;\n\t\t\t\t\tconsole.log( hit );\n\t\t\t\t}\n\t\t\t\tthis.collided( hit );\n\t\t\t}\n\t\t},\n\n\t\tcollided: function(){}\n\t};\n\tsys.visuals.animatable.push( collidable );\n\tsys.sim.collidables.push( collidable );\n\treturn collidable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/collidable.js","import { init_system } from './system'\nimport { init_player } from './player'\nimport { init_player_controls } from './player-controls'\nimport { init_dock } from './dock'\nimport THREE from 'THREE'\nimport ColladaLoader from 'three-loaders-collada'\nColladaLoader( THREE )\n\n//http://threejs.org/docs/index.html#Manual/Introduction/Creating_a_scene\nexport function init(){\n\tvar system = init_system();\n\tsystem.init();\n\tvar sys = system;\n\n//\t\t\tinit_skybox( sys );\n\n\tvar player = init_player( sys );\n\tinit_player_controls( sys, player.actions );\n\n\tvar dock = init_dock( sys );\n\n\t//Level\n\tvar done = false;\n\tplayer.collidedWith = function( other ){\n\t\tif( !done ){\n\t\t\tif( other.object == dock ){\n\t\t\t\tdone = true;\n\t\t\t\tconsole.log( \"Docking complete. Hmm...we need more objectives.\" );\n\t\t\t}\n\t\t}\n\t}\n\n\t//\n\ttest_model( system );\n\tvar add = true;\n\tsys.attach( {\n\t\tanimate_tick: function( scene ){\n\t\t\tif( add ){\n\t\t\t\tadd = !add;\n\t\t\t\tscene.add( new THREE.AmbientLight( 0x404040 ) );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction test_model( sys ){\n\tvar loader = new THREE.ColladaLoader();\n\tloader.options.convertUpAxis = true;\n\tloader.load( '/assets/box-ship.dae', function ( collada ) {\n\t\tvar object = collada.scene;\n\t\tconsole.log( collada );\n\t\tvar needsAdding = true;\n\t\tvar controller = {\n\t\t\tanimate_tick: function( scene ){\n\t\t\t\tif( needsAdding ){\n\t\t\t\t\tneedsAdding != needsAdding;\n\t\t\t\t\tscene.add( object );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tsys.attach( controller );\n\t});\n}\n\nfunction goal_text(){\n\tvar textGeom;\n\tvar text = {\n\t\tanimate_tick: function( scene ){\n\t\t\tif( !textGeom ){\n\t\t\t\ttextGeom = new THREE.TextGeometry( \"Hello, intersect with the cube.\", { height: .01 });\n\t\t\t\tvar wrapper = new THREE.MeshNormalMaterial({color: 0x00ff00});\n\t\t\t\tvar words = new THREE.Mesh( textGeom, wrapper);\n\t\t\t\twords.scale.x = .001;\n\t\t\t\twords.scale.y = .001;\n\t\t\t\twords.scale.z = .001;\n\t\t\t\twords.matrixWorldNeedsUpdate = true;\n\t\t\t\tscene.add(words);\n\t\t\t}\n\t\t}\n\t}\n\tsystem.attach( text );\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/rendering.js","import { init_gl } from './renderer'\nimport { init_simulation } from './simulation'\n\nexport function init_system(){\n\tfunction System(){ }\n\tSystem.prototype.init = function(){\n\t\tthis.visuals = init_gl();\n\t\tthis.sim = init_simulation();\n\t}\n\tSystem.prototype.attach = function( what ){\n\t\tif( what.simulation_tick ){ this.sim.tickables.push( what ); }\n\t\tif( what.collision_tick ){ this.sim.collidables.push( what ); }\n\t\tif( what.animate_tick ){ this.visuals.animatable.push( what ); }\n\t}\n\n\tvar sys = new System();\n\treturn sys;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/system.js","import { init_stats } from './stats'\nimport THREE from 'THREE'\n\nexport function init_gl(){\n\tvar scene = new THREE.Scene();\n\tvar camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );\n\n\tvar renderer = new THREE.WebGLRenderer();\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\tdocument.body.appendChild( renderer.domElement );\n\n\tcamera.position.z = 5;\n\n\tvar renderingStats = init_stats( \"stats-renderer\" );\n\tvar animatables = [];\n\tvar render = function () {\n\t\trequestAnimationFrame( render );\n\n\t\trenderingStats.begin();\n\n\t\tanimatables.forEach( function( visual ){\n\t\t\tvisual.animate_tick( scene );\n\t\t});\n\n\t\trenderingStats.end();\n\n\t\trenderer.render(scene, camera);\n\t};\n\trequestAnimationFrame( render );\n\n\treturn {\n\t\tcamera: camera,\n\t\tanimatable: animatables\n\t};\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/renderer.js","// stats.js - http://github.com/mrdoob/stats.js\n(function(f,e){\"object\"===typeof exports&&\"undefined\"!==typeof module?module.exports=e():\"function\"===typeof define&&define.amd?define(e):f.Stats=e()})(this,function(){var f=function(){function e(a){c.appendChild(a.dom);return a}function u(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?\"block\":\"none\";l=a}var l=0,c=document.createElement(\"div\");c.style.cssText=\"position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000\";c.addEventListener(\"click\",function(a){a.preventDefault();\nu(++l%c.children.length)},!1);var k=(performance||Date).now(),g=k,a=0,r=e(new f.Panel(\"FPS\",\"#0ff\",\"#002\")),h=e(new f.Panel(\"MS\",\"#0f0\",\"#020\"));if(self.performance&&self.performance.memory)var t=e(new f.Panel(\"MB\",\"#f08\",\"#201\"));u(0);return{REVISION:16,dom:c,addPanel:e,showPanel:u,begin:function(){k=(performance||Date).now()},end:function(){a++;var c=(performance||Date).now();h.update(c-k,200);if(c>g+1E3&&(r.update(1E3*a/(c-g),100),g=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/\n1048576,d.jsHeapSizeLimit/1048576)}return c},update:function(){k=this.end()},domElement:c,setMode:u}};f.Panel=function(e,f,l){var c=Infinity,k=0,g=Math.round,a=g(window.devicePixelRatio||1),r=80*a,h=48*a,t=3*a,v=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement(\"canvas\");q.width=r;q.height=h;q.style.cssText=\"width:80px;height:48px\";var b=q.getContext(\"2d\");b.font=\"bold \"+9*a+\"px Helvetica,Arial,sans-serif\";b.textBaseline=\"top\";b.fillStyle=l;b.fillRect(0,0,r,h);b.fillStyle=f;b.fillText(e,t,v);\nb.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return{dom:q,update:function(h,w){c=Math.min(c,h);k=Math.max(k,h);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=f;b.fillText(g(h)+\" \"+e+\" (\"+g(c)+\"-\"+g(k)+\")\",t,v);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,g((1-h/w)*p))}}};return f});\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/stats.js/build/stats.min.js","module.exports = function(module) {\n\tif(!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif(!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/module.js","import { init_stats } from './stats'\n\nexport function init_simulation( visuals /* don't really belong here */ ){\n\tvar tickables = [];\n\tvar collidables = [];\n\n\tvar simStats = init_stats( \"stats-sim\" );\n\tvar collisionStats = init_stats( \"stats-collision\" );\n\n\tfunction game_tick(){\n\t\tvar done = false;\n\t\ttry {\n\t\t\tsimStats.begin();\n\t\t\ttickables.forEach( function( t ) { t.simulation_tick(); } );\n\t\t\tsimStats.end();\n\n\t\t\tcollisionStats.begin();\n\t\t\tcollidables.forEach( function( t ) { t.collision_tick( collidables ); } );\n\t\t\tcollisionStats.end();\n\n\t\t\tdone=true;\n\t\t}finally{\n\t\t\tif( !done ){\n\t\t\t\tclearInterval( sim_clock );\n\t\t\t}\n\t\t}\n\t}\n\n\tvar sim_clock = setInterval( game_tick, 1000 / 60 );\n\treturn { simulate: tickables, collidables: collidables };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/simulation.js","import { thrust_aspect, rotational_thrust_aspect } from './thrusters'\nimport { collidable_aspect } from './collidable'\n\nexport function init_player( sys ){\n\tvar visuals = sys.visuals;\n\tvar sim = sys.sim;\n\n\tvar player = {\n\t\tname: \"player\",\n\t\tmomentum: { x: 0, y: 0, z: 0 },\n\t\trotation: { x: 0, y: 0, z: 0 },\n\t\tposition: { x: 0, y: 0, z: 5 },\n\t\tanimate_tick: function(){\n\t\t\tvar camera = visuals.camera;\n\t\t\tcamera.position.x = this.position.x;\n\t\t\tcamera.position.y = this.position.y;\n\t\t\tcamera.position.z = this.position.z;\n\n\t\t\tcamera.rotation.x = this.rotation.x;\n\t\t\tcamera.rotation.y = this.rotation.y;\n\t\t\tcamera.rotation.z = this.rotation.z;\n\t\t},\n\t\tsimulation_tick: function(){\n\t\t\tthis.position.x += this.momentum.x;\n\t\t\tthis.position.y += this.momentum.y;\n\t\t\tthis.position.z += this.momentum.z;\n\t\t},\n\t\tcollidedWith: function( hit ){}\n\t};\n\tvisuals.animatable.push( player );\n\tsys.sim.simulate.push(  player );\n\tvar primary_thruster = thrust_aspect( sys, player, { x: 0, y: 0, z: -1 } );\n\tvar top_nav_thruster = thrust_aspect( sys, player, { x: 0, y: 1, z: 0 } );\n\tvar bottom_nav_thruster = thrust_aspect( sys, player, { x: 0, y: -1, z: 0 } );\n\tvar starboard_nav_thruster = thrust_aspect( sys, player, { x: 1, y: 0, z: 0 } );\n\tvar port_nav_thruster = thrust_aspect( sys, player, { x: -1, y: 0, z: 0 } );\n\n\tvar hitbox = collidable_aspect( sys, player, {x: 1, y: 1, z: 1} );\n\thitbox.collided = function( hitOthers ){\n\t\tprimary_thruster.stop();\n\t\tplayer.momentum.z = 0;\n\t\thitOthers.forEach( function( other ){\n\t\t\tplayer.collidedWith( other );\n\t\t});\n\t}\n\n\tvar pitchThrust = rotational_thrust_aspect( sys, player, { x: 1, y:0, z:0 } );\n\tfunction pitch_forward(){\n\t\tpitchThrust.increase();\n\t}\n\tfunction pitch_back(){\n\t\tpitchThrust.decrease();\n\t}\n\n\tvar yawThrust = rotational_thrust_aspect( sys, player, { x: 0, y:1, z:0 } );\n\tfunction yaw_port(){\n\t\tyawThrust.increase();\n\t}\n\tfunction yaw_starboard(){\n\t\tyawThrust.decrease();\n\t}\n\n\tvar rollThrust = rotational_thrust_aspect( sys, player, { x: 0, y:0, z:1 } );\n\tfunction roll_port(){\n\t\trollThrust.increase();\n\t}\n\tfunction roll_starboard(){\n\t\trollThrust.decrease();\n\t}\n\n\tplayer.actions = {\n\t\ttranslate_up: { perform: function(){\n\t\t\ttop_nav_thruster.increase();\n\t\t\tbottom_nav_thruster.stop();\n\t\t}, description: \"Use upward thruster\" },\n\n\t\ttranslate_down: { perform: function(){\n\t\t\tbottom_nav_thruster.increase();\n\t\t\ttop_nav_thruster.stop();\n\t\t}, description: \"Use downward thruster\" },\n\n\t\ttranslate_port: { perform: function(){\n\t\t\tport_nav_thruster.increase();\n\t\t\tstarboard_nav_thruster.stop();\n\t\t\tplayer.momentum.x = 0;\n\t\t}, description: \"Use port thruster\" },\n\n\t\ttranslate_starboard: { perform: function(){\n\t\t\tstarboard_nav_thruster.increase();\n\t\t\tport_nav_thruster.stop();\n\t\t\tplayer.momentum.x = 0;\n\t\t}, description: \"Use starboard thruster\" },\n\n\t\ttranslate_fore: { perform: function(){\n\t\t\tprimary_thruster.increase();\n\t\t}, description: \"Use primary thruster\" },\n\n\t\ttranslate_aft: { perform: function(){\n\t\t\tprimary_thruster.decrease();\n\t\t}, description: \"Use braking thruster\" },\n\n\t\tfull_stop: { perform: function(){\n\t\t\tprimary_thruster.stop();\n\t\t\tstarboard_nav_thruster.stop();\n\t\t\tport_nav_thruster.stop();\n\t\t\tbottom_nav_thruster.stop();\n\t\t\ttop_nav_thruster.stop();\n\t\t\tplayer.momentum.x = 0;\n\t\t\tplayer.momentum.y = 0;\n\t\t\tplayer.momentum.z = 0;\n\t\t}, description: \"Disable all thrusters\" },\n\n\t\tpitch_forward: { perform: function(){\n\t\t\tpitch_forward();\n\t\t}, description: \"pitch forward\" },\n\t\tpitch_back: { perform: function(){\n\t\t\tpitch_back();\n\t\t}, description: \"pitch back\" },\n\n\t\tyaw_port: { perform: function(){\n\t\t\tyaw_port();\n\t\t}, description: \"yaw port\" },\n\t\tyaw_starboard: { perform: function(){\n\t\t\t yaw_starboard();\n\t\t}, description: \"yaw starboard\" },\n\n\t\troll_port: { perform: function(){\n\t\t\troll_port();\n\t\t}, description: \"roll port\" },\n\t\troll_starboard: { perform: function(){\n\t\t\troll_starboard();\n\t\t}, description: \"roll starboard\" },\n\t};\n\treturn player;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/player.js","\nexport function rotational_thrust_aspect( sys, object, vector ){\n\tvar thruster = {\n\t\tstep: 0.10 / 60.0,\n\t\tmaximum: 1.00 / 60.0,\n\t\tminimum: -1.00 / 60.0,\n\t\tthrust: 0,\n\t\tvector: vector,\n\t\tsimulation_tick: function(){\n\t\t\t//TODO model real thrust curve (bell?); physics of exhaust?\n\t\t\tobject.rotation.x += this.vector.x * this.thrust;\n\t\t\tobject.rotation.y += this.vector.y * this.thrust;\n\t\t\tobject.rotation.z += this.vector.z * this.thrust;\n\t\t},\n\t\tincrease: function(){\n\t\t\tvar more = this.thrust + this.step;\n\t\t\tif( more <= this.maximum ){\n\t\t\t\tthis.thrust = more;\n\t\t\t}\n\t\t},\n\t\tdecrease: function(){\n\t\t\tvar less = this.thrust - this.step;\n\t\t\tif( less >= this.minimum ){\n\t\t\t\tthis.thrust = less;\n\t\t\t}\n\t\t},\n\t\tstop: function(){\n\t\t\tthis.thrust = 0;\n\t\t}\n\t};\n\tsys.sim.simulate.push( thruster );\n\treturn thruster;\n}\n\nexport function thrust_aspect( sys, object, vector ){\n\tvar thruster = {\n\t\tstep: 0.10 / 60.0,\n\t\tmaximum: 1.00 / 60.0,\n\t\tminimum: -1.00 / 60.0,\n\t\tthrust: 0,\n\t\tvector: vector,\n\t\tsimulation_tick: function(){\n\t\t\t//TODO model real thrust curve (bell?); physics of exhaust?\n\t\t\tobject.momentum.x += this.vector.x * this.thrust;\n\t\t\tobject.momentum.y += this.vector.y * this.thrust;\n\t\t\tobject.momentum.z += this.vector.z * this.thrust;\n\t\t},\n\t\tincrease: function(){\n\t\t\tvar more = this.thrust + this.step;\n\t\t\tif( more <= this.maximum ){\n\t\t\t\tthis.thrust = more;\n\t\t\t}\n\t\t},\n\t\tdecrease: function(){\n\t\t\tvar less = this.thrust - this.step;\n\t\t\tif( less >= this.minimum ){\n\t\t\t\tthis.thrust = less;\n\t\t\t}\n\t\t},\n\t\tstop: function(){\n\t\t\tthis.thrust = 0;\n\t\t}\n\t};\n\tsys.sim.simulate.push( thruster );\n\treturn thruster;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/thrusters.js","export function init_player_controls( sys, actions ){\n\tvar keyActionMap = {\n\t\tR: actions.translate_up,\n\t\tZ: actions.translate_down,\n\n\t\tW: actions.translate_fore,\n\t\tS: actions.translate_aft,\n\n\t\tA: actions.translate_port,\n\t\tD: actions.translate_starboard,\n\n\t\tI: actions.pitch_forward,\n\t\tK: actions.pitch_back,\n\n\t\tJ: actions.yaw_port,\n\t\tL: actions.yaw_starboard,\n\n\t\tQ: actions.roll_port,\n\t\tE: actions.roll_starboard,\n\n\t\tP: actions.full_stop\n\t};\n\n\twindow.addEventListener( \"keydown\", function( k ){\n\t\tvar c = String.fromCharCode( k.keyCode );\n\t\tvar action = keyActionMap[c];\n\t\tif( action ){\n\t\t\tconsole.log( action.description );\n\t\t\taction.perform();\n\t\t}else{\n\t\t\tconsole.log( \"No binding for \", c );\n\t\t\tconsole.log( keyActionMap );\n\t\t}\n\t});\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/player-controls.js","import { collidable_aspect } from './collidable'\nimport THREE from 'THREE'\n\nexport function init_dock( sys ){\n\t// Interesting object to fly through\n\tvar stationMesh;\n\tvar simulatedStation = {\n\t\tposition: { x: 0, y: 0, z: -5 },\n\t\tanimate_tick: function( scene ){\n\t\t\tif( !stationMesh ){\n\t\t\t\tvar geometry = new THREE.TorusGeometry( .7, .1, 64, 32);\n\t\t\t\tvar material = new THREE.MeshBasicMaterial( { color: 0x0000FF } );\n\t\t\t\tstationMesh= new THREE.Mesh( geometry, material );\n\t\t\t\tscene.add( stationMesh );\n\t\t\t}\n\n\t\t\tstationMesh.matrixWorldNeedsUpdate = true;\n\t\t\tstationMesh.position.x = this.position.x;\n\t\t\tstationMesh.position.y = this.position.y;\n\t\t\tstationMesh.position.z = this.position.z;\n\t\t}\n\t};\n\tsys.visuals.animatable.push( simulatedStation );\n\n\t// Objective area\n\tvar waypointMesh;\n\tvar dock = {\n\t\tname: \"dock\",\n\t\tmomentum: { x: 0, y: 0, z: 0 },\n\t\tposition: { x: 0, y: 0, z: -5 },\n\t\tanimate_tick: function( scene ){\n\t\t\tif( !waypointMesh ){\n\t\t\t\tvar geometry = new THREE.BoxGeometry( 1, 1, .1 );\n\t\t\t\tvar material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\n\t\t\t\tmaterial.transparent= true;\n\t\t\t\tmaterial.opacity = .4;\n\t\t\t\twaypointMesh= new THREE.Mesh( geometry, material );\n\t\t\t\tscene.add( waypointMesh );\n\t\t\t}\n\n\t\t\twaypointMesh.position.x = this.position.x;\n\t\t\twaypointMesh.position.y = this.position.y;\n\t\t\twaypointMesh.position.z = this.position.z;\n\n\t\t},\n\t\tsimulation_tick: function(){\n\t\t\tthis.position.x += this.momentum.x;\n\t\t\tthis.position.y += this.momentum.y;\n\t\t\tthis.position.z += this.momentum.z;\n\t\t}\n\t};\n\tsys.visuals.animatable.push( dock );\n\tvar hitbox = collidable_aspect( sys, dock, {x:1,y: 1,z: .1} );\n\treturn dock;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/dock.js","/**\n* @author Tim Knip / http://www.floorplanner.com/ / tim at floorplanner.com\n* @author Tony Parisi / http://www.tonyparisi.com/\n*/\n\nmodule.exports = function(THREE){\n\n    THREE.ColladaLoader = function () {\n\n        var COLLADA = null;\n        var scene = null;\n        var visualScene;\n        var kinematicsModel;\n\n        var readyCallbackFunc = null;\n\n        var sources = {};\n        var images = {};\n        var animations = {};\n        var controllers = {};\n        var geometries = {};\n        var materials = {};\n        var effects = {};\n        var cameras = {};\n        var lights = {};\n\n        var animData;\n        var kinematics;\n        var visualScenes;\n        var kinematicsModels;\n        var baseUrl;\n        var morphs;\n        var skins;\n\n        var flip_uv = true;\n        var preferredShading = THREE.SmoothShading;\n\n        var options = {\n            // Force Geometry to always be centered at the local origin of the\n            // containing Mesh.\n            centerGeometry: false,\n\n            // Axis conversion is done for geometries, animations, and controllers.\n            // If we ever pull cameras or lights out of the COLLADA file, they'll\n            // need extra work.\n            convertUpAxis: false,\n\n            subdivideFaces: true,\n\n            upAxis: 'Y',\n\n            // For reflective or refractive materials we'll use this cubemap\n            defaultEnvMap: null\n\n        };\n\n        var colladaUnit = 1.0;\n        var colladaUp = 'Y';\n        var upConversion = null;\n\n        function load ( url, readyCallback, progressCallback, failCallback ) {\n\n            var length = 0;\n\n            if ( document.implementation && document.implementation.createDocument ) {\n\n                var request = new XMLHttpRequest();\n\n                request.onreadystatechange = function() {\n\n                    if ( request.readyState === 4 ) {\n\n                        if ( request.status === 0 || request.status === 200 ) {\n\n\n                            if ( request.responseXML ) {\n\n                                readyCallbackFunc = readyCallback;\n                                parse( request.responseXML, undefined, url );\n\n                            } else if ( request.responseText ) {\n\n                                readyCallbackFunc = readyCallback;\n                                var xmlParser = new DOMParser();\n                                var responseXML = xmlParser.parseFromString( request.responseText, \"application/xml\" );\n                                parse( responseXML, undefined, url );\n\n                            } else {\n\n                                if ( faillCallback ) {\n\n                                    failCallback();\n\n                                } else {\n\n                                    console.error( \"ColladaLoader: Empty or non-existing file (\" + url + \")\" );\n\n                                }\n\n                            }\n\n                        }\n\n                    } else if ( request.readyState === 3 ) {\n\n                        if ( progressCallback ) {\n\n                            if ( length === 0 ) {\n\n                                length = request.getResponseHeader( \"Content-Length\" );\n\n                            }\n\n                            progressCallback( { total: length, loaded: request.responseText.length } );\n\n                        }\n\n                    }\n\n                }\n\n                request.open( \"GET\", url, true );\n                request.send( null );\n\n            } else {\n\n                alert( \"Don't know how to parse XML!\" );\n\n            }\n\n        }\n\n        function parse( doc, callBack, url ) {\n\n            COLLADA = doc;\n            callBack = callBack || readyCallbackFunc;\n\n            if ( url !== undefined ) {\n\n                var parts = url.split( '/' );\n                parts.pop();\n                baseUrl = ( parts.length < 1 ? '.' : parts.join( '/' ) ) + '/';\n\n            }\n\n            parseAsset();\n            setUpConversion();\n            images = parseLib( \"library_images image\", _Image, \"image\" );\n            materials = parseLib( \"library_materials material\", Material, \"material\" );\n            effects = parseLib( \"library_effects effect\", Effect, \"effect\" );\n            geometries = parseLib( \"library_geometries geometry\", Geometry, \"geometry\" );\n            cameras = parseLib( \"library_cameras camera\", Camera, \"camera\" );\n            lights = parseLib( \"library_lights light\", Light, \"light\" );\n            controllers = parseLib( \"library_controllers controller\", Controller, \"controller\" );\n            animations = parseLib( \"library_animations animation\", Animation, \"animation\" );\n            visualScenes = parseLib( \"library_visual_scenes visual_scene\", VisualScene, \"visual_scene\" );\n            kinematicsModels = parseLib( \"library_kinematics_models kinematics_model\", KinematicsModel, \"kinematics_model\" );\n\n            morphs = [];\n            skins = [];\n\n            visualScene = parseScene();\n            scene = new THREE.Group();\n\n            for ( var i = 0; i < visualScene.nodes.length; i ++ ) {\n\n                scene.add( createSceneGraph( visualScene.nodes[ i ] ) );\n\n            }\n\n            // unit conversion\n            scene.scale.multiplyScalar( colladaUnit );\n\n            createAnimations();\n\n            kinematicsModel = parseKinematicsModel();\n            createKinematics();\n\n            var result = {\n\n                scene: scene,\n                morphs: morphs,\n                skins: skins,\n                animations: animData,\n                kinematics: kinematics,\n                dae: {\n                    images: images,\n                    materials: materials,\n                    cameras: cameras,\n                    lights: lights,\n                    effects: effects,\n                    geometries: geometries,\n                    controllers: controllers,\n                    animations: animations,\n                    visualScenes: visualScenes,\n                    visualScene: visualScene,\n                    scene: visualScene,\n                    kinematicsModels: kinematicsModels,\n                    kinematicsModel: kinematicsModel\n                }\n\n            };\n\n            if ( callBack ) {\n\n                callBack( result );\n\n            }\n\n            return result;\n\n        }\n\n        function setPreferredShading ( shading ) {\n\n            preferredShading = shading;\n\n        }\n\n        function parseAsset () {\n\n            var elements = COLLADA.querySelectorAll('asset');\n\n            var element = elements[0];\n\n            if ( element && element.childNodes ) {\n\n                for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                    var child = element.childNodes[ i ];\n\n                    switch ( child.nodeName ) {\n\n                        case 'unit':\n\n                            var meter = child.getAttribute( 'meter' );\n\n                            if ( meter ) {\n\n                                colladaUnit = parseFloat( meter );\n\n                            }\n\n                            break;\n\n                        case 'up_axis':\n\n                            colladaUp = child.textContent.charAt(0);\n                            break;\n\n                    }\n\n                }\n\n            }\n\n        }\n\n        function parseLib ( q, classSpec, prefix ) {\n\n            var elements = COLLADA.querySelectorAll(q);\n\n            var lib = {};\n\n            var i = 0;\n\n            var elementsLength = elements.length;\n\n            for ( var j = 0; j < elementsLength; j ++ ) {\n\n                var element = elements[j];\n                var daeElement = ( new classSpec() ).parse( element );\n\n                if ( !daeElement.id || daeElement.id.length === 0 ) daeElement.id = prefix + ( i ++ );\n                lib[ daeElement.id ] = daeElement;\n\n            }\n\n            return lib;\n\n        }\n\n        function parseScene() {\n\n            var sceneElement = COLLADA.querySelectorAll('scene instance_visual_scene')[0];\n\n            if ( sceneElement ) {\n\n                var url = sceneElement.getAttribute( 'url' ).replace( /^#/, '' );\n                return visualScenes[ url.length > 0 ? url : 'visual_scene0' ];\n\n            } else {\n\n                return null;\n\n            }\n\n        }\n\n        function parseKinematicsModel() {\n\n            var kinematicsModelElement = COLLADA.querySelectorAll('instance_kinematics_model')[0];\n\n            if ( kinematicsModelElement ) {\n\n                var url = kinematicsModelElement.getAttribute( 'url' ).replace(/^#/, '');\n                return kinematicsModels[ url.length > 0 ? url : 'kinematics_model0' ];\n\n            } else {\n\n                return null;\n\n            }\n\n        }\n\n        function createAnimations() {\n\n            animData = [];\n\n            // fill in the keys\n            recurseHierarchy( scene );\n\n        }\n\n        function recurseHierarchy( node ) {\n\n            var n = visualScene.getChildById( node.colladaId, true ),\n                newData = null;\n\n            if ( n && n.keys ) {\n\n                newData = {\n                    fps: 60,\n                    hierarchy: [ {\n                        node: n,\n                        keys: n.keys,\n                        sids: n.sids\n                    } ],\n                    node: node,\n                    name: 'animation_' + node.name,\n                    length: 0\n                };\n\n                animData.push(newData);\n\n                for ( var i = 0, il = n.keys.length; i < il; i ++ ) {\n\n                    newData.length = Math.max( newData.length, n.keys[i].time );\n\n                }\n\n            } else {\n\n                newData = {\n                    hierarchy: [ {\n                        keys: [],\n                        sids: []\n                    } ]\n                }\n\n            }\n\n            for ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n                var d = recurseHierarchy( node.children[i] );\n\n                for ( var j = 0, jl = d.hierarchy.length; j < jl; j ++ ) {\n\n                    newData.hierarchy.push( {\n                        keys: [],\n                        sids: []\n                    } );\n\n                }\n\n            }\n\n            return newData;\n\n        }\n\n        function calcAnimationBounds () {\n\n            var start = 1000000;\n            var end = -start;\n            var frames = 0;\n            var ID;\n            for ( var id in animations ) {\n\n                var animation = animations[ id ];\n                ID = ID || animation.id;\n                for ( var i = 0; i < animation.sampler.length; i ++ ) {\n\n                    var sampler = animation.sampler[ i ];\n\n                    sampler.create();\n\n                    start = Math.min( start, sampler.startTime );\n                    end = Math.max( end, sampler.endTime );\n                    frames = Math.max( frames, sampler.input.length );\n\n                }\n\n            }\n\n            return { start:start, end:end, frames:frames,ID:ID };\n\n        }\n\n        function createMorph ( geometry, ctrl ) {\n\n            var morphCtrl = ctrl instanceof InstanceController ? controllers[ ctrl.url ] : ctrl;\n\n            if ( !morphCtrl || !morphCtrl.morph ) {\n\n                console.log(\"could not find morph controller!\");\n                return;\n\n            }\n\n            var morph = morphCtrl.morph;\n\n            for ( var i = 0; i < morph.targets.length; i ++ ) {\n\n                var target_id = morph.targets[ i ];\n                var daeGeometry = geometries[ target_id ];\n\n                if ( !daeGeometry.mesh ||\n                     !daeGeometry.mesh.primitives ||\n                     !daeGeometry.mesh.primitives.length ) {\n                     continue;\n                }\n\n                var target = daeGeometry.mesh.primitives[ 0 ].geometry;\n\n                if ( target.vertices.length === geometry.vertices.length ) {\n\n                    geometry.morphTargets.push( { name: \"target_1\", vertices: target.vertices } );\n\n                }\n\n            }\n\n            geometry.morphTargets.push( { name: \"target_Z\", vertices: geometry.vertices } );\n\n        };\n\n        function createSkin ( geometry, ctrl, applyBindShape ) {\n\n            var skinCtrl = controllers[ ctrl.url ];\n\n            if ( !skinCtrl || !skinCtrl.skin ) {\n\n                console.log( \"could not find skin controller!\" );\n                return;\n\n            }\n\n            if ( !ctrl.skeleton || !ctrl.skeleton.length ) {\n\n                console.log( \"could not find the skeleton for the skin!\" );\n                return;\n\n            }\n\n            var skin = skinCtrl.skin;\n            var skeleton = visualScene.getChildById( ctrl.skeleton[ 0 ] );\n            var hierarchy = [];\n\n            applyBindShape = applyBindShape !== undefined ? applyBindShape : true;\n\n            var bones = [];\n            geometry.skinWeights = [];\n            geometry.skinIndices = [];\n\n            //createBones( geometry.bones, skin, hierarchy, skeleton, null, -1 );\n            //createWeights( skin, geometry.bones, geometry.skinIndices, geometry.skinWeights );\n\n            /*\n            geometry.animation = {\n                name: 'take_001',\n                fps: 30,\n                length: 2,\n                JIT: true,\n                hierarchy: hierarchy\n            };\n            */\n\n            if ( applyBindShape ) {\n\n                for ( var i = 0; i < geometry.vertices.length; i ++ ) {\n\n                    geometry.vertices[ i ].applyMatrix4( skin.bindShapeMatrix );\n\n                }\n\n            }\n\n        }\n\n        function setupSkeleton ( node, bones, frame, parent ) {\n\n            node.world = node.world || new THREE.Matrix4();\n            node.localworld = node.localworld || new THREE.Matrix4();\n            node.world.copy( node.matrix );\n            node.localworld.copy( node.matrix );\n\n            if ( node.channels && node.channels.length ) {\n\n                var channel = node.channels[ 0 ];\n                var m = channel.sampler.output[ frame ];\n\n                if ( m instanceof THREE.Matrix4 ) {\n\n                    node.world.copy( m );\n                    node.localworld.copy(m);\n                    if (frame === 0)\n                        node.matrix.copy(m);\n                }\n\n            }\n\n            if ( parent ) {\n\n                node.world.multiplyMatrices( parent, node.world );\n\n            }\n\n            bones.push( node );\n\n            for ( var i = 0; i < node.nodes.length; i ++ ) {\n\n                setupSkeleton( node.nodes[ i ], bones, frame, node.world );\n\n            }\n\n        }\n\n        function setupSkinningMatrices ( bones, skin ) {\n\n            // FIXME: this is dumb...\n\n            for ( var i = 0; i < bones.length; i ++ ) {\n\n                var bone = bones[ i ];\n                var found = -1;\n\n                if ( bone.type != 'JOINT' ) continue;\n\n                for ( var j = 0; j < skin.joints.length; j ++ ) {\n\n                    if ( bone.sid === skin.joints[ j ] ) {\n\n                        found = j;\n                        break;\n\n                    }\n\n                }\n\n                if ( found >= 0 ) {\n\n                    var inv = skin.invBindMatrices[ found ];\n\n                    bone.invBindMatrix = inv;\n                    bone.skinningMatrix = new THREE.Matrix4();\n                    bone.skinningMatrix.multiplyMatrices(bone.world, inv); // (IBMi * JMi)\n                    bone.animatrix = new THREE.Matrix4();\n\n                    bone.animatrix.copy(bone.localworld);\n                    bone.weights = [];\n\n                    for ( var j = 0; j < skin.weights.length; j ++ ) {\n\n                        for (var k = 0; k < skin.weights[ j ].length; k ++ ) {\n\n                            var w = skin.weights[ j ][ k ];\n\n                            if ( w.joint === found ) {\n\n                                bone.weights.push( w );\n\n                            }\n\n                        }\n\n                    }\n\n                } else {\n\n                    console.warn( \"ColladaLoader: Could not find joint '\" + bone.sid + \"'.\" );\n\n                    bone.skinningMatrix = new THREE.Matrix4();\n                    bone.weights = [];\n\n                }\n            }\n\n        }\n\n        //Walk the Collada tree and flatten the bones into a list, extract the position, quat and scale from the matrix\n        function flattenSkeleton(skeleton) {\n\n            var list = [];\n            var walk = function(parentid, node, list) {\n\n                var bone = {};\n                bone.name = node.sid;\n                bone.parent = parentid;\n                bone.matrix = node.matrix;\n                var data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\n                bone.matrix.decompose(data[0], data[1], data[2]);\n\n                bone.pos = [ data[0].x,data[0].y,data[0].z ];\n\n                bone.scl = [ data[2].x,data[2].y,data[2].z ];\n                bone.rotq = [ data[1].x,data[1].y,data[1].z,data[1].w ];\n                list.push(bone);\n\n                for (var i in node.nodes) {\n\n                    walk(node.sid, node.nodes[i], list);\n\n                }\n\n            };\n\n            walk(-1, skeleton, list);\n            return list;\n\n        }\n\n        //Move the vertices into the pose that is proper for the start of the animation\n        function skinToBindPose(geometry,skeleton,skinController) {\n\n            var bones = [];\n            setupSkeleton( skeleton, bones, -1 );\n            setupSkinningMatrices( bones, skinController.skin );\n            v = new THREE.Vector3();\n            var skinned = [];\n\n            for (var i = 0; i < geometry.vertices.length; i ++) {\n\n                skinned.push(new THREE.Vector3());\n\n            }\n\n            for ( i = 0; i < bones.length; i ++ ) {\n\n                if ( bones[ i ].type != 'JOINT' ) continue;\n\n                for ( j = 0; j < bones[ i ].weights.length; j ++ ) {\n\n                    w = bones[ i ].weights[ j ];\n                    vidx = w.index;\n                    weight = w.weight;\n\n                    o = geometry.vertices[vidx];\n                    s = skinned[vidx];\n\n                    v.x = o.x;\n                    v.y = o.y;\n                    v.z = o.z;\n\n                    v.applyMatrix4( bones[i].skinningMatrix );\n\n                    s.x += (v.x * weight);\n                    s.y += (v.y * weight);\n                    s.z += (v.z * weight);\n                }\n\n            }\n\n            for (var i = 0; i < geometry.vertices.length; i ++) {\n\n                geometry.vertices[i] = skinned[i];\n\n            }\n\n        }\n\n        function applySkin ( geometry, instanceCtrl, frame ) {\n\n            var skinController = controllers[ instanceCtrl.url ];\n\n            frame = frame !== undefined ? frame : 40;\n\n            if ( !skinController || !skinController.skin ) {\n\n                console.log( 'ColladaLoader: Could not find skin controller.' );\n                return;\n\n            }\n\n            if ( !instanceCtrl.skeleton || !instanceCtrl.skeleton.length ) {\n\n                console.log( 'ColladaLoader: Could not find the skeleton for the skin. ' );\n                return;\n\n            }\n\n            var animationBounds = calcAnimationBounds();\n            var skeleton = visualScene.getChildById( instanceCtrl.skeleton[0], true ) || visualScene.getChildBySid( instanceCtrl.skeleton[0], true );\n\n            //flatten the skeleton into a list of bones\n            var bonelist = flattenSkeleton(skeleton);\n            var joints = skinController.skin.joints;\n\n            //sort that list so that the order reflects the order in the joint list\n            var sortedbones = [];\n            for (var i = 0; i < joints.length; i ++) {\n\n                for (var j = 0; j < bonelist.length; j ++) {\n\n                    if (bonelist[j].name === joints[i]) {\n\n                        sortedbones[i] = bonelist[j];\n\n                    }\n\n                }\n\n            }\n\n            //hook up the parents by index instead of name\n            for (var i = 0; i < sortedbones.length; i ++) {\n\n                for (var j = 0; j < sortedbones.length; j ++) {\n\n                    if (sortedbones[i].parent === sortedbones[j].name) {\n\n                        sortedbones[i].parent = j;\n\n                    }\n\n                }\n\n            }\n\n\n            var i, j, w, vidx, weight;\n            var v = new THREE.Vector3(), o, s;\n\n            // move vertices to bind shape\n            for ( i = 0; i < geometry.vertices.length; i ++ ) {\n                geometry.vertices[i].applyMatrix4( skinController.skin.bindShapeMatrix );\n            }\n\n            var skinIndices = [];\n            var skinWeights = [];\n            var weights = skinController.skin.weights;\n\n            // hook up the skin weights\n            // TODO - this might be a good place to choose greatest 4 weights\n            for ( var i =0; i < weights.length; i ++ ) {\n\n                var indicies = new THREE.Vector4(weights[i][0] ? weights[i][0].joint : 0,weights[i][1] ? weights[i][1].joint : 0,weights[i][2] ? weights[i][2].joint : 0,weights[i][3] ? weights[i][3].joint : 0);\n                var weight = new THREE.Vector4(weights[i][0] ? weights[i][0].weight : 0,weights[i][1] ? weights[i][1].weight : 0,weights[i][2] ? weights[i][2].weight : 0,weights[i][3] ? weights[i][3].weight : 0);\n\n                skinIndices.push(indicies);\n                skinWeights.push(weight);\n\n            }\n\n            geometry.skinIndices = skinIndices;\n            geometry.skinWeights = skinWeights;\n            geometry.bones = sortedbones;\n            // process animation, or simply pose the rig if no animation\n\n            //create an animation for the animated bones\n            //NOTE: this has no effect when using morphtargets\n            var animationdata = { \"name\":animationBounds.ID,\"fps\":30,\"length\":animationBounds.frames / 30,\"hierarchy\":[] };\n\n            for (var j = 0; j < sortedbones.length; j ++) {\n\n                animationdata.hierarchy.push({ parent:sortedbones[j].parent, name:sortedbones[j].name, keys:[] });\n\n            }\n\n            console.log( 'ColladaLoader:', animationBounds.ID + ' has ' + sortedbones.length + ' bones.' );\n\n\n\n            skinToBindPose(geometry, skeleton, skinController);\n\n\n            for ( frame = 0; frame < animationBounds.frames; frame ++ ) {\n\n                var bones = [];\n                var skinned = [];\n                // process the frame and setup the rig with a fresh\n                // transform, possibly from the bone's animation channel(s)\n\n                setupSkeleton( skeleton, bones, frame );\n                setupSkinningMatrices( bones, skinController.skin );\n\n                for (var i = 0; i < bones.length; i ++) {\n\n                    for (var j = 0; j < animationdata.hierarchy.length; j ++) {\n\n                        if (animationdata.hierarchy[j].name === bones[i].sid) {\n\n                            var key = {};\n                            key.time = (frame / 30);\n                            key.matrix = bones[i].animatrix;\n\n                            if (frame === 0)\n                                bones[i].matrix = key.matrix;\n\n                            var data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\n                            key.matrix.decompose(data[0], data[1], data[2]);\n\n                            key.pos = [ data[0].x,data[0].y,data[0].z ];\n\n                            key.scl = [ data[2].x,data[2].y,data[2].z ];\n                            key.rot = data[1];\n\n                            animationdata.hierarchy[j].keys.push(key);\n\n                        }\n\n                    }\n\n                }\n\n                geometry.animation = animationdata;\n\n            }\n\n        };\n\n        function createKinematics() {\n\n            if ( kinematicsModel && kinematicsModel.joints.length === 0 ) {\n                kinematics = undefined;\n                return;\n            }\n\n            var jointMap = {};\n\n            var _addToMap = function( jointIndex, parentVisualElement ) {\n\n                var parentVisualElementId = parentVisualElement.getAttribute( 'id' );\n                var colladaNode = visualScene.getChildById( parentVisualElementId, true );\n                var joint = kinematicsModel.joints[ jointIndex ];\n\n                scene.traverse(function( node ) {\n\n                    if ( node.colladaId == parentVisualElementId ) {\n\n                        jointMap[ jointIndex ] = {\n                            node: node,\n                            transforms: colladaNode.transforms,\n                            joint: joint,\n                            position: joint.zeroPosition\n                        };\n\n                    }\n\n                });\n\n            };\n\n            kinematics = {\n\n                joints: kinematicsModel && kinematicsModel.joints,\n\n                getJointValue: function( jointIndex ) {\n\n                    var jointData = jointMap[ jointIndex ];\n\n                    if ( jointData ) {\n\n                        return jointData.position;\n\n                    } else {\n\n                        console.log( 'getJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\n\n                    }\n\n                },\n\n                setJointValue: function( jointIndex, value ) {\n\n                    var jointData = jointMap[ jointIndex ];\n\n                    if ( jointData ) {\n\n                        var joint = jointData.joint;\n\n                        if ( value > joint.limits.max || value < joint.limits.min ) {\n\n                            console.log( 'setJointValue: joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ')' );\n\n                        } else if ( joint.static ) {\n\n                            console.log( 'setJointValue: joint ' + jointIndex + ' is static' );\n\n                        } else {\n\n                            var threejsNode = jointData.node;\n                            var axis = joint.axis;\n                            var transforms = jointData.transforms;\n\n                            var matrix = new THREE.Matrix4();\n\n                            for (i = 0; i < transforms.length; i ++ ) {\n\n                                var transform = transforms[ i ];\n\n                                // kinda ghetto joint detection\n                                if ( transform.sid && transform.sid.indexOf( 'joint' + jointIndex ) !== -1 ) {\n\n                                    // apply actual joint value here\n                                    switch ( joint.type ) {\n\n                                        case 'revolute':\n\n                                            matrix.multiply( m1.makeRotationAxis( axis, THREE.Math.degToRad(value) ) );\n                                            break;\n\n                                        case 'prismatic':\n\n                                            matrix.multiply( m1.makeTranslation(axis.x * value, axis.y * value, axis.z * value ) );\n                                            break;\n\n                                        default:\n\n                                            console.warn( 'setJointValue: unknown joint type: ' + joint.type );\n                                            break;\n\n                                    }\n\n                                } else {\n\n                                    var m1 = new THREE.Matrix4();\n\n                                    switch ( transform.type ) {\n\n                                        case 'matrix':\n\n                                            matrix.multiply( transform.obj );\n\n                                            break;\n\n                                        case 'translate':\n\n                                            matrix.multiply( m1.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\n\n                                            break;\n\n                                        case 'rotate':\n\n                                            matrix.multiply( m1.makeRotationAxis( transform.obj, transform.angle ) );\n\n                                            break;\n\n                                    }\n                                }\n                            }\n\n                            // apply the matrix to the threejs node\n                            var elementsFloat32Arr = matrix.elements;\n                            var elements = Array.prototype.slice.call( elementsFloat32Arr );\n\n                            var elementsRowMajor = [\n                                elements[ 0 ],\n                                elements[ 4 ],\n                                elements[ 8 ],\n                                elements[ 12 ],\n                                elements[ 1 ],\n                                elements[ 5 ],\n                                elements[ 9 ],\n                                elements[ 13 ],\n                                elements[ 2 ],\n                                elements[ 6 ],\n                                elements[ 10 ],\n                                elements[ 14 ],\n                                elements[ 3 ],\n                                elements[ 7 ],\n                                elements[ 11 ],\n                                elements[ 15 ]\n                            ];\n\n                            threejsNode.matrix.set.apply( threejsNode.matrix, elementsRowMajor );\n                            threejsNode.matrix.decompose( threejsNode.position, threejsNode.quaternion, threejsNode.scale );\n                        }\n\n                    } else {\n\n                        console.log( 'setJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\n\n                    }\n\n                }\n\n            };\n\n            var element = COLLADA.querySelector('scene instance_kinematics_scene');\n\n            if ( element ) {\n\n                for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                    var child = element.childNodes[ i ];\n\n                    if ( child.nodeType != 1 ) continue;\n\n                    switch ( child.nodeName ) {\n\n                        case 'bind_joint_axis':\n\n                            var visualTarget = child.getAttribute( 'target' ).split( '/' ).pop();\n                            var axis = child.querySelector('axis param').textContent;\n                            var jointIndex = parseInt( axis.split( 'joint' ).pop().split( '.' )[0] );\n                            var visualTargetElement = COLLADA.querySelector( '[sid=\"' + visualTarget + '\"]' );\n\n                            if ( visualTargetElement ) {\n                                var parentVisualElement = visualTargetElement.parentElement;\n                                _addToMap(jointIndex, parentVisualElement);\n                            }\n\n                            break;\n\n                        default:\n\n                            break;\n\n                    }\n\n                }\n            }\n\n        };\n\n        function createSceneGraph ( node, parent ) {\n\n            var obj = new THREE.Object3D();\n            var skinned = false;\n            var skinController;\n            var morphController;\n            var i, j;\n\n            // FIXME: controllers\n\n            for ( i = 0; i < node.controllers.length; i ++ ) {\n\n                var controller = controllers[ node.controllers[ i ].url ];\n\n                switch ( controller.type ) {\n\n                    case 'skin':\n\n                        if ( geometries[ controller.skin.source ] ) {\n\n                            var inst_geom = new InstanceGeometry();\n\n                            inst_geom.url = controller.skin.source;\n                            inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                            node.geometries.push( inst_geom );\n                            skinned = true;\n                            skinController = node.controllers[ i ];\n\n                        } else if ( controllers[ controller.skin.source ] ) {\n\n                            // urgh: controller can be chained\n                            // handle the most basic case...\n\n                            var second = controllers[ controller.skin.source ];\n                            morphController = second;\n                        //  skinController = node.controllers[i];\n\n                            if ( second.morph && geometries[ second.morph.source ] ) {\n\n                                var inst_geom = new InstanceGeometry();\n\n                                inst_geom.url = second.morph.source;\n                                inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                                node.geometries.push( inst_geom );\n\n                            }\n\n                        }\n\n                        break;\n\n                    case 'morph':\n\n                        if ( geometries[ controller.morph.source ] ) {\n\n                            var inst_geom = new InstanceGeometry();\n\n                            inst_geom.url = controller.morph.source;\n                            inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                            node.geometries.push( inst_geom );\n                            morphController = node.controllers[ i ];\n\n                        }\n\n                        console.log( 'ColladaLoader: Morph-controller partially supported.' );\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            // geometries\n\n            var double_sided_materials = {};\n\n            for ( i = 0; i < node.geometries.length; i ++ ) {\n\n                var instance_geometry = node.geometries[i];\n                var instance_materials = instance_geometry.instance_material;\n                var geometry = geometries[ instance_geometry.url ];\n                var used_materials = {};\n                var used_materials_array = [];\n                var num_materials = 0;\n                var first_material;\n\n                if ( geometry ) {\n\n                    if ( !geometry.mesh || !geometry.mesh.primitives )\n                        continue;\n\n                    if ( obj.name.length === 0 ) {\n\n                        obj.name = geometry.id;\n\n                    }\n\n                    // collect used fx for this geometry-instance\n\n                    if ( instance_materials ) {\n\n                        for ( j = 0; j < instance_materials.length; j ++ ) {\n\n                            var instance_material = instance_materials[ j ];\n                            var mat = materials[ instance_material.target ];\n                            var effect_id = mat.instance_effect.url;\n                            var shader = effects[ effect_id ].shader;\n                            var material3js = shader.material;\n\n                            if ( geometry.doubleSided ) {\n\n                                if ( !( instance_material.symbol in double_sided_materials ) ) {\n\n                                    var _copied_material = material3js.clone();\n                                    _copied_material.side = THREE.DoubleSide;\n                                    double_sided_materials[ instance_material.symbol ] = _copied_material;\n\n                                }\n\n                                material3js = double_sided_materials[ instance_material.symbol ];\n\n                            }\n\n                            material3js.opacity = !material3js.opacity ? 1 : material3js.opacity;\n                            used_materials[ instance_material.symbol ] = num_materials;\n                            used_materials_array.push( material3js );\n                            first_material = material3js;\n                            first_material.name = mat.name === null || mat.name === '' ? mat.id : mat.name;\n                            num_materials ++;\n\n                        }\n\n                    }\n\n                    var mesh;\n                    var material = first_material || new THREE.MeshLambertMaterial( { color: 0xdddddd, side: geometry.doubleSided ? THREE.DoubleSide : THREE.FrontSide } );\n                    var geom = geometry.mesh.geometry3js;\n\n                    if ( num_materials > 1 ) {\n\n                        material = new THREE.MeshFaceMaterial( used_materials_array );\n\n                        for ( j = 0; j < geom.faces.length; j ++ ) {\n\n                            var face = geom.faces[ j ];\n                            face.materialIndex = used_materials[ face.daeMaterial ]\n\n                        }\n\n                    }\n\n                    if ( skinController !== undefined ) {\n\n\n                        applySkin( geom, skinController );\n\n                        if ( geom.morphTargets.length > 0 ) {\n\n                            material.morphTargets = true;\n                            material.skinning = false;\n\n                        } else {\n\n                            material.morphTargets = false;\n                            material.skinning = true;\n\n                        }\n\n\n                        mesh = new THREE.SkinnedMesh( geom, material, false );\n\n\n                        //mesh.skeleton = skinController.skeleton;\n                        //mesh.skinController = controllers[ skinController.url ];\n                        //mesh.skinInstanceController = skinController;\n                        mesh.name = 'skin_' + skins.length;\n\n\n\n                        //mesh.animationHandle.setKey(0);\n                        skins.push( mesh );\n\n                    } else if ( morphController !== undefined ) {\n\n                        createMorph( geom, morphController );\n\n                        material.morphTargets = true;\n\n                        mesh = new THREE.Mesh( geom, material );\n                        mesh.name = 'morph_' + morphs.length;\n\n                        morphs.push( mesh );\n\n                    } else {\n\n                        if ( geom.isLineStrip === true ) {\n\n                            mesh = new THREE.Line( geom );\n\n                        } else {\n\n                            mesh = new THREE.Mesh( geom, material );\n\n                        }\n\n                    }\n\n                    obj.add(mesh);\n\n                }\n\n            }\n\n            for ( i = 0; i < node.cameras.length; i ++ ) {\n\n                var instance_camera = node.cameras[i];\n                var cparams = cameras[instance_camera.url];\n\n                var cam = new THREE.PerspectiveCamera(cparams.yfov, parseFloat(cparams.aspect_ratio),\n                        parseFloat(cparams.znear), parseFloat(cparams.zfar));\n\n                obj.add(cam);\n            }\n\n            for ( i = 0; i < node.lights.length; i ++ ) {\n\n                var light = null;\n                var instance_light = node.lights[i];\n                var lparams = lights[instance_light.url];\n\n                if ( lparams && lparams.technique ) {\n\n                    var color = lparams.color.getHex();\n                    var intensity = lparams.intensity;\n                    var distance = lparams.distance;\n                    var angle = lparams.falloff_angle;\n                    var exponent; // Intentionally undefined, don't know what this is yet\n\n                    switch ( lparams.technique ) {\n\n                        case 'directional':\n\n                            light = new THREE.DirectionalLight( color, intensity, distance );\n                            light.position.set(0, 0, 1);\n                            break;\n\n                        case 'point':\n\n                            light = new THREE.PointLight( color, intensity, distance );\n                            break;\n\n                        case 'spot':\n\n                            light = new THREE.SpotLight( color, intensity, distance, angle, exponent );\n                            light.position.set(0, 0, 1);\n                            break;\n\n                        case 'ambient':\n\n                            light = new THREE.AmbientLight( color );\n                            break;\n\n                    }\n\n                }\n\n                if (light) {\n                    obj.add(light);\n                }\n            }\n\n            obj.name = node.name || node.id || \"\";\n            obj.colladaId = node.id || \"\";\n            obj.layer = node.layer || \"\";\n            obj.matrix = node.matrix;\n            obj.matrix.decompose( obj.position, obj.quaternion, obj.scale );\n\n            if ( options.centerGeometry && obj.geometry ) {\n\n                var delta = obj.geometry.center();\n                delta.multiply( obj.scale );\n                delta.applyQuaternion( obj.quaternion );\n\n                obj.position.sub( delta );\n\n            }\n\n            for ( i = 0; i < node.nodes.length; i ++ ) {\n\n                obj.add( createSceneGraph( node.nodes[i], node ) );\n\n            }\n\n            return obj;\n\n        };\n\n        function getJointId( skin, id ) {\n\n            for ( var i = 0; i < skin.joints.length; i ++ ) {\n\n                if ( skin.joints[ i ] === id ) {\n\n                    return i;\n\n                }\n\n            }\n\n        };\n\n        function getLibraryNode( id ) {\n\n            var nodes = COLLADA.querySelectorAll('library_nodes node');\n\n            for ( var i = 0; i < nodes.length; i++ ) {\n\n                var attObj = nodes[i].attributes.getNamedItem('id');\n\n                if ( attObj && attObj.value === id ) {\n\n                    return nodes[i];\n\n                }\n\n            }\n\n            return undefined;\n\n        };\n\n        function getChannelsForNode ( node ) {\n\n            var channels = [];\n            var startTime = 1000000;\n            var endTime = -1000000;\n\n            for ( var id in animations ) {\n\n                var animation = animations[id];\n\n                for ( var i = 0; i < animation.channel.length; i ++ ) {\n\n                    var channel = animation.channel[i];\n                    var sampler = animation.sampler[i];\n                    var id = channel.target.split('/')[0];\n\n                    if ( id == node.id ) {\n\n                        sampler.create();\n                        channel.sampler = sampler;\n                        startTime = Math.min(startTime, sampler.startTime);\n                        endTime = Math.max(endTime, sampler.endTime);\n                        channels.push(channel);\n\n                    }\n\n                }\n\n            }\n\n            if ( channels.length ) {\n\n                node.startTime = startTime;\n                node.endTime = endTime;\n\n            }\n\n            return channels;\n\n        };\n\n        function calcFrameDuration( node ) {\n\n            var minT = 10000000;\n\n            for ( var i = 0; i < node.channels.length; i ++ ) {\n\n                var sampler = node.channels[i].sampler;\n\n                for ( var j = 0; j < sampler.input.length - 1; j ++ ) {\n\n                    var t0 = sampler.input[ j ];\n                    var t1 = sampler.input[ j + 1 ];\n                    minT = Math.min( minT, t1 - t0 );\n\n                }\n            }\n\n            return minT;\n\n        };\n\n        function calcMatrixAt( node, t ) {\n\n            var animated = {};\n\n            var i, j;\n\n            for ( i = 0; i < node.channels.length; i ++ ) {\n\n                var channel = node.channels[ i ];\n                animated[ channel.sid ] = channel;\n\n            }\n\n            var matrix = new THREE.Matrix4();\n\n            for ( i = 0; i < node.transforms.length; i ++ ) {\n\n                var transform = node.transforms[ i ];\n                var channel = animated[ transform.sid ];\n\n                if ( channel !== undefined ) {\n\n                    var sampler = channel.sampler;\n                    var value;\n\n                    for ( j = 0; j < sampler.input.length - 1; j ++ ) {\n\n                        if ( sampler.input[ j + 1 ] > t ) {\n\n                            value = sampler.output[ j ];\n                            //console.log(value.flatten)\n                            break;\n\n                        }\n\n                    }\n\n                    if ( value !== undefined ) {\n\n                        if ( value instanceof THREE.Matrix4 ) {\n\n                            matrix.multiplyMatrices( matrix, value );\n\n                        } else {\n\n                            // FIXME: handle other types\n\n                            matrix.multiplyMatrices( matrix, transform.matrix );\n\n                        }\n\n                    } else {\n\n                        matrix.multiplyMatrices( matrix, transform.matrix );\n\n                    }\n\n                } else {\n\n                    matrix.multiplyMatrices( matrix, transform.matrix );\n\n                }\n\n            }\n\n            return matrix;\n\n        };\n\n        function bakeAnimations ( node ) {\n\n            if ( node.channels && node.channels.length ) {\n\n                var keys = [],\n                    sids = [];\n\n                for ( var i = 0, il = node.channels.length; i < il; i ++ ) {\n\n                    var channel = node.channels[i],\n                        fullSid = channel.fullSid,\n                        sampler = channel.sampler,\n                        input = sampler.input,\n                        transform = node.getTransformBySid( channel.sid ),\n                        member;\n\n                    if ( channel.arrIndices ) {\n\n                        member = [];\n\n                        for ( var j = 0, jl = channel.arrIndices.length; j < jl; j ++ ) {\n\n                            member[ j ] = getConvertedIndex( channel.arrIndices[ j ] );\n\n                        }\n\n                    } else {\n\n                        member = getConvertedMember( channel.member );\n\n                    }\n\n                    if ( transform ) {\n\n                        if ( sids.indexOf( fullSid ) === -1 ) {\n\n                            sids.push( fullSid );\n\n                        }\n\n                        for ( var j = 0, jl = input.length; j < jl; j ++ ) {\n\n                            var time = input[j],\n                                data = sampler.getData( transform.type, j, member ),\n                                key = findKey( keys, time );\n\n                            if ( !key ) {\n\n                                key = new Key( time );\n                                var timeNdx = findTimeNdx( keys, time );\n                                keys.splice( timeNdx === -1 ? keys.length : timeNdx, 0, key );\n\n                            }\n\n                            key.addTarget( fullSid, transform, member, data );\n\n                        }\n\n                    } else {\n\n                        console.log( 'Could not find transform \"' + channel.sid + '\" in node ' + node.id );\n\n                    }\n\n                }\n\n                // post process\n                for ( var i = 0; i < sids.length; i ++ ) {\n\n                    var sid = sids[ i ];\n\n                    for ( var j = 0; j < keys.length; j ++ ) {\n\n                        var key = keys[ j ];\n\n                        if ( !key.hasTarget( sid ) ) {\n\n                            interpolateKeys( keys, key, j, sid );\n\n                        }\n\n                    }\n\n                }\n\n                node.keys = keys;\n                node.sids = sids;\n\n            }\n\n        };\n\n        function findKey ( keys, time) {\n\n            var retVal = null;\n\n            for ( var i = 0, il = keys.length; i < il && retVal === null; i ++ ) {\n\n                var key = keys[i];\n\n                if ( key.time === time ) {\n\n                    retVal = key;\n\n                } else if ( key.time > time ) {\n\n                    break;\n\n                }\n\n            }\n\n            return retVal;\n\n        };\n\n        function findTimeNdx ( keys, time) {\n\n            var ndx = -1;\n\n            for ( var i = 0, il = keys.length; i < il && ndx === -1; i ++ ) {\n\n                var key = keys[i];\n\n                if ( key.time >= time ) {\n\n                    ndx = i;\n\n                }\n\n            }\n\n            return ndx;\n\n        };\n\n        function interpolateKeys ( keys, key, ndx, fullSid ) {\n\n            var prevKey = getPrevKeyWith( keys, fullSid, ndx ? ndx - 1 : 0 ),\n                nextKey = getNextKeyWith( keys, fullSid, ndx + 1 );\n\n            if ( prevKey && nextKey ) {\n\n                var scale = (key.time - prevKey.time) / (nextKey.time - prevKey.time),\n                    prevTarget = prevKey.getTarget( fullSid ),\n                    nextData = nextKey.getTarget( fullSid ).data,\n                    prevData = prevTarget.data,\n                    data;\n\n                if ( prevTarget.type === 'matrix' ) {\n\n                    data = prevData;\n\n                } else if ( prevData.length ) {\n\n                    data = [];\n\n                    for ( var i = 0; i < prevData.length; ++ i ) {\n\n                        data[ i ] = prevData[ i ] + ( nextData[ i ] - prevData[ i ] ) * scale;\n\n                    }\n\n                } else {\n\n                    data = prevData + ( nextData - prevData ) * scale;\n\n                }\n\n                key.addTarget( fullSid, prevTarget.transform, prevTarget.member, data );\n\n            }\n\n        };\n\n        // Get next key with given sid\n\n        function getNextKeyWith( keys, fullSid, ndx ) {\n\n            for ( ; ndx < keys.length; ndx ++ ) {\n\n                var key = keys[ ndx ];\n\n                if ( key.hasTarget( fullSid ) ) {\n\n                    return key;\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        // Get previous key with given sid\n\n        function getPrevKeyWith( keys, fullSid, ndx ) {\n\n            ndx = ndx >= 0 ? ndx : ndx + keys.length;\n\n            for ( ; ndx >= 0; ndx -- ) {\n\n                var key = keys[ ndx ];\n\n                if ( key.hasTarget( fullSid ) ) {\n\n                    return key;\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        function _Image() {\n\n            this.id = \"\";\n            this.init_from = \"\";\n\n        };\n\n        _Image.prototype.parse = function(element) {\n\n            this.id = element.getAttribute('id');\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                if ( child.nodeName === 'init_from' ) {\n\n                    this.init_from = child.textContent;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Controller() {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.type = \"\";\n            this.skin = null;\n            this.morph = null;\n\n        };\n\n        Controller.prototype.parse = function( element ) {\n\n            this.id = element.getAttribute('id');\n            this.name = element.getAttribute('name');\n            this.type = \"none\";\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'skin':\n\n                        this.skin = (new Skin()).parse(child);\n                        this.type = child.nodeName;\n                        break;\n\n                    case 'morph':\n\n                        this.morph = (new Morph()).parse(child);\n                        this.type = child.nodeName;\n                        break;\n\n                    default:\n                        break;\n\n                }\n            }\n\n            return this;\n\n        };\n\n        function Morph() {\n\n            this.method = null;\n            this.source = null;\n            this.targets = null;\n            this.weights = null;\n\n        };\n\n        Morph.prototype.parse = function( element ) {\n\n            var sources = {};\n            var inputs = [];\n            var i;\n\n            this.method = element.getAttribute( 'method' );\n            this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n\n            for ( i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'source':\n\n                        var source = ( new Source() ).parse( child );\n                        sources[ source.id ] = source;\n                        break;\n\n                    case 'targets':\n\n                        inputs = this.parseInputs( child );\n                        break;\n\n                    default:\n\n                        console.log( child.nodeName );\n                        break;\n\n                }\n\n            }\n\n            for ( i = 0; i < inputs.length; i ++ ) {\n\n                var input = inputs[ i ];\n                var source = sources[ input.source ];\n\n                switch ( input.semantic ) {\n\n                    case 'MORPH_TARGET':\n\n                        this.targets = source.read();\n                        break;\n\n                    case 'MORPH_WEIGHT':\n\n                        this.weights = source.read();\n                        break;\n\n                    default:\n                        break;\n\n                }\n            }\n\n            return this;\n\n        };\n\n        Morph.prototype.parseInputs = function(element) {\n\n            var inputs = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'input':\n\n                        inputs.push( (new Input()).parse(child) );\n                        break;\n\n                    default:\n                        break;\n                }\n            }\n\n            return inputs;\n\n        };\n\n        function Skin() {\n\n            this.source = \"\";\n            this.bindShapeMatrix = null;\n            this.invBindMatrices = [];\n            this.joints = [];\n            this.weights = [];\n\n        };\n\n        Skin.prototype.parse = function( element ) {\n\n            var sources = {};\n            var joints, weights;\n\n            this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n            this.invBindMatrices = [];\n            this.joints = [];\n            this.weights = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'bind_shape_matrix':\n\n                        var f = _floats(child.textContent);\n                        this.bindShapeMatrix = getConvertedMat4( f );\n                        break;\n\n                    case 'source':\n\n                        var src = new Source().parse(child);\n                        sources[ src.id ] = src;\n                        break;\n\n                    case 'joints':\n\n                        joints = child;\n                        break;\n\n                    case 'vertex_weights':\n\n                        weights = child;\n                        break;\n\n                    default:\n\n                        console.log( child.nodeName );\n                        break;\n\n                }\n            }\n\n            this.parseJoints( joints, sources );\n            this.parseWeights( weights, sources );\n\n            return this;\n\n        };\n\n        Skin.prototype.parseJoints = function ( element, sources ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'input':\n\n                        var input = ( new Input() ).parse( child );\n                        var source = sources[ input.source ];\n\n                        if ( input.semantic === 'JOINT' ) {\n\n                            this.joints = source.read();\n\n                        } else if ( input.semantic === 'INV_BIND_MATRIX' ) {\n\n                            this.invBindMatrices = source.read();\n\n                        }\n\n                        break;\n\n                    default:\n                        break;\n                }\n\n            }\n\n        };\n\n        Skin.prototype.parseWeights = function ( element, sources ) {\n\n            var v, vcount, inputs = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'input':\n\n                        inputs.push( ( new Input() ).parse( child ) );\n                        break;\n\n                    case 'v':\n\n                        v = _ints( child.textContent );\n                        break;\n\n                    case 'vcount':\n\n                        vcount = _ints( child.textContent );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            var index = 0;\n\n            for ( var i = 0; i < vcount.length; i ++ ) {\n\n                var numBones = vcount[i];\n                var vertex_weights = [];\n\n                for ( var j = 0; j < numBones; j ++ ) {\n\n                    var influence = {};\n\n                    for ( var k = 0; k < inputs.length; k ++ ) {\n\n                        var input = inputs[ k ];\n                        var value = v[ index + input.offset ];\n\n                        switch ( input.semantic ) {\n\n                            case 'JOINT':\n\n                                influence.joint = value;//this.joints[value];\n                                break;\n\n                            case 'WEIGHT':\n\n                                influence.weight = sources[ input.source ].data[ value ];\n                                break;\n\n                            default:\n                                break;\n\n                        }\n\n                    }\n\n                    vertex_weights.push( influence );\n                    index += inputs.length;\n                }\n\n                for ( var j = 0; j < vertex_weights.length; j ++ ) {\n\n                    vertex_weights[ j ].index = i;\n\n                }\n\n                this.weights.push( vertex_weights );\n\n            }\n\n        };\n\n        function VisualScene () {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.nodes = [];\n            this.scene = new THREE.Group();\n\n        };\n\n        VisualScene.prototype.getChildById = function( id, recursive ) {\n\n            for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                var node = this.nodes[ i ].getChildById( id, recursive );\n\n                if ( node ) {\n\n                    return node;\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        VisualScene.prototype.getChildBySid = function( sid, recursive ) {\n\n            for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                var node = this.nodes[ i ].getChildBySid( sid, recursive );\n\n                if ( node ) {\n\n                    return node;\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        VisualScene.prototype.parse = function( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n            this.nodes = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'node':\n\n                        this.nodes.push( ( new Node() ).parse( child ) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Node() {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.sid = \"\";\n            this.nodes = [];\n            this.controllers = [];\n            this.transforms = [];\n            this.geometries = [];\n            this.channels = [];\n            this.matrix = new THREE.Matrix4();\n\n        };\n\n        Node.prototype.getChannelForTransform = function( transformSid ) {\n\n            for ( var i = 0; i < this.channels.length; i ++ ) {\n\n                var channel = this.channels[i];\n                var parts = channel.target.split('/');\n                var id = parts.shift();\n                var sid = parts.shift();\n                var dotSyntax = (sid.indexOf(\".\") >= 0);\n                var arrSyntax = (sid.indexOf(\"(\") >= 0);\n                var arrIndices;\n                var member;\n\n                if ( dotSyntax ) {\n\n                    parts = sid.split(\".\");\n                    sid = parts.shift();\n                    member = parts.shift();\n\n                } else if ( arrSyntax ) {\n\n                    arrIndices = sid.split(\"(\");\n                    sid = arrIndices.shift();\n\n                    for ( var j = 0; j < arrIndices.length; j ++ ) {\n\n                        arrIndices[ j ] = parseInt( arrIndices[ j ].replace( /\\)/, '' ) );\n\n                    }\n\n                }\n\n                if ( sid === transformSid ) {\n\n                    channel.info = { sid: sid, dotSyntax: dotSyntax, arrSyntax: arrSyntax, arrIndices: arrIndices };\n                    return channel;\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        Node.prototype.getChildById = function ( id, recursive ) {\n\n            if ( this.id === id ) {\n\n                return this;\n\n            }\n\n            if ( recursive ) {\n\n                for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                    var n = this.nodes[ i ].getChildById( id, recursive );\n\n                    if ( n ) {\n\n                        return n;\n\n                    }\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        Node.prototype.getChildBySid = function ( sid, recursive ) {\n\n            if ( this.sid === sid ) {\n\n                return this;\n\n            }\n\n            if ( recursive ) {\n\n                for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                    var n = this.nodes[ i ].getChildBySid( sid, recursive );\n\n                    if ( n ) {\n\n                        return n;\n\n                    }\n\n                }\n            }\n\n            return null;\n\n        };\n\n        Node.prototype.getTransformBySid = function ( sid ) {\n\n            for ( var i = 0; i < this.transforms.length; i ++ ) {\n\n                if ( this.transforms[ i ].sid === sid ) return this.transforms[ i ];\n\n            }\n\n            return null;\n\n        };\n\n        Node.prototype.parse = function( element ) {\n\n            var url;\n\n            this.id = element.getAttribute('id');\n            this.sid = element.getAttribute('sid');\n            this.name = element.getAttribute('name');\n            this.type = element.getAttribute('type');\n            this.layer = element.getAttribute('layer');\n\n            this.type = this.type === 'JOINT' ? this.type : 'NODE';\n\n            this.nodes = [];\n            this.transforms = [];\n            this.geometries = [];\n            this.cameras = [];\n            this.lights = [];\n            this.controllers = [];\n            this.matrix = new THREE.Matrix4();\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'node':\n\n                        this.nodes.push( ( new Node() ).parse( child ) );\n                        break;\n\n                    case 'instance_camera':\n\n                        this.cameras.push( ( new InstanceCamera() ).parse( child ) );\n                        break;\n\n                    case 'instance_controller':\n\n                        this.controllers.push( ( new InstanceController() ).parse( child ) );\n                        break;\n\n                    case 'instance_geometry':\n\n                        this.geometries.push( ( new InstanceGeometry() ).parse( child ) );\n                        break;\n\n                    case 'instance_light':\n\n                        this.lights.push( ( new InstanceLight() ).parse( child ) );\n                        break;\n\n                    case 'instance_node':\n\n                        url = child.getAttribute( 'url' ).replace( /^#/, '' );\n                        var iNode = getLibraryNode( url );\n\n                        if ( iNode ) {\n\n                            this.nodes.push( ( new Node() ).parse( iNode )) ;\n\n                        }\n\n                        break;\n\n                    case 'rotate':\n                    case 'translate':\n                    case 'scale':\n                    case 'matrix':\n                    case 'lookat':\n                    case 'skew':\n\n                        this.transforms.push( ( new Transform() ).parse( child ) );\n                        break;\n\n                    case 'extra':\n                        break;\n\n                    default:\n\n                        console.log( child.nodeName );\n                        break;\n\n                }\n\n            }\n\n            this.channels = getChannelsForNode( this );\n            bakeAnimations( this );\n\n            this.updateMatrix();\n\n            return this;\n\n        };\n\n        Node.prototype.updateMatrix = function () {\n\n            this.matrix.identity();\n\n            for ( var i = 0; i < this.transforms.length; i ++ ) {\n\n                this.transforms[ i ].apply( this.matrix );\n\n            }\n\n        };\n\n        function Transform () {\n\n            this.sid = \"\";\n            this.type = \"\";\n            this.data = [];\n            this.obj = null;\n\n        };\n\n        Transform.prototype.parse = function ( element ) {\n\n            this.sid = element.getAttribute( 'sid' );\n            this.type = element.nodeName;\n            this.data = _floats( element.textContent );\n            this.convert();\n\n            return this;\n\n        };\n\n        Transform.prototype.convert = function () {\n\n            switch ( this.type ) {\n\n                case 'matrix':\n\n                    this.obj = getConvertedMat4( this.data );\n                    break;\n\n                case 'rotate':\n\n                    this.angle = THREE.Math.degToRad( this.data[3] );\n\n                case 'translate':\n\n                    fixCoords( this.data, -1 );\n                    this.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\n                    break;\n\n                case 'scale':\n\n                    fixCoords( this.data, 1 );\n                    this.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\n                    break;\n\n                default:\n                    console.log( 'Can not convert Transform of type ' + this.type );\n                    break;\n\n            }\n\n        };\n\n        Transform.prototype.apply = function () {\n\n            var m1 = new THREE.Matrix4();\n\n            return function ( matrix ) {\n\n                switch ( this.type ) {\n\n                    case 'matrix':\n\n                        matrix.multiply( this.obj );\n\n                        break;\n\n                    case 'translate':\n\n                        matrix.multiply( m1.makeTranslation( this.obj.x, this.obj.y, this.obj.z ) );\n\n                        break;\n\n                    case 'rotate':\n\n                        matrix.multiply( m1.makeRotationAxis( this.obj, this.angle ) );\n\n                        break;\n\n                    case 'scale':\n\n                        matrix.scale( this.obj );\n\n                        break;\n\n                }\n\n            };\n\n        }();\n\n        Transform.prototype.update = function ( data, member ) {\n\n            var members = [ 'X', 'Y', 'Z', 'ANGLE' ];\n\n            switch ( this.type ) {\n\n                case 'matrix':\n\n                    if ( ! member ) {\n\n                        this.obj.copy( data );\n\n                    } else if ( member.length === 1 ) {\n\n                        switch ( member[ 0 ] ) {\n\n                            case 0:\n\n                                this.obj.n11 = data[ 0 ];\n                                this.obj.n21 = data[ 1 ];\n                                this.obj.n31 = data[ 2 ];\n                                this.obj.n41 = data[ 3 ];\n\n                                break;\n\n                            case 1:\n\n                                this.obj.n12 = data[ 0 ];\n                                this.obj.n22 = data[ 1 ];\n                                this.obj.n32 = data[ 2 ];\n                                this.obj.n42 = data[ 3 ];\n\n                                break;\n\n                            case 2:\n\n                                this.obj.n13 = data[ 0 ];\n                                this.obj.n23 = data[ 1 ];\n                                this.obj.n33 = data[ 2 ];\n                                this.obj.n43 = data[ 3 ];\n\n                                break;\n\n                            case 3:\n\n                                this.obj.n14 = data[ 0 ];\n                                this.obj.n24 = data[ 1 ];\n                                this.obj.n34 = data[ 2 ];\n                                this.obj.n44 = data[ 3 ];\n\n                                break;\n\n                        }\n\n                    } else if ( member.length === 2 ) {\n\n                        var propName = 'n' + ( member[ 0 ] + 1 ) + ( member[ 1 ] + 1 );\n                        this.obj[ propName ] = data;\n\n                    } else {\n\n                        console.log('Incorrect addressing of matrix in transform.');\n\n                    }\n\n                    break;\n\n                case 'translate':\n                case 'scale':\n\n                    if ( Object.prototype.toString.call( member ) === '[object Array]' ) {\n\n                        member = members[ member[ 0 ] ];\n\n                    }\n\n                    switch ( member ) {\n\n                        case 'X':\n\n                            this.obj.x = data;\n                            break;\n\n                        case 'Y':\n\n                            this.obj.y = data;\n                            break;\n\n                        case 'Z':\n\n                            this.obj.z = data;\n                            break;\n\n                        default:\n\n                            this.obj.x = data[ 0 ];\n                            this.obj.y = data[ 1 ];\n                            this.obj.z = data[ 2 ];\n                            break;\n\n                    }\n\n                    break;\n\n                case 'rotate':\n\n                    if ( Object.prototype.toString.call( member ) === '[object Array]' ) {\n\n                        member = members[ member[ 0 ] ];\n\n                    }\n\n                    switch ( member ) {\n\n                        case 'X':\n\n                            this.obj.x = data;\n                            break;\n\n                        case 'Y':\n\n                            this.obj.y = data;\n                            break;\n\n                        case 'Z':\n\n                            this.obj.z = data;\n                            break;\n\n                        case 'ANGLE':\n\n                            this.angle = THREE.Math.degToRad( data );\n                            break;\n\n                        default:\n\n                            this.obj.x = data[ 0 ];\n                            this.obj.y = data[ 1 ];\n                            this.obj.z = data[ 2 ];\n                            this.angle = THREE.Math.degToRad( data[ 3 ] );\n                            break;\n\n                    }\n                    break;\n\n            }\n\n        };\n\n        function InstanceController() {\n\n            this.url = \"\";\n            this.skeleton = [];\n            this.instance_material = [];\n\n        };\n\n        InstanceController.prototype.parse = function ( element ) {\n\n            this.url = element.getAttribute('url').replace(/^#/, '');\n            this.skeleton = [];\n            this.instance_material = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType !== 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'skeleton':\n\n                        this.skeleton.push( child.textContent.replace(/^#/, '') );\n                        break;\n\n                    case 'bind_material':\n\n                        var instances = child.querySelectorAll('instance_material');\n\n                        for ( var j = 0; j < instances.length; j ++ ) {\n\n                            var instance = instances[j];\n                            this.instance_material.push( (new InstanceMaterial()).parse(instance) );\n\n                        }\n\n\n                        break;\n\n                    case 'extra':\n                        break;\n\n                    default:\n                        break;\n\n                }\n            }\n\n            return this;\n\n        };\n\n        function InstanceMaterial () {\n\n            this.symbol = \"\";\n            this.target = \"\";\n\n        };\n\n        InstanceMaterial.prototype.parse = function ( element ) {\n\n            this.symbol = element.getAttribute('symbol');\n            this.target = element.getAttribute('target').replace(/^#/, '');\n            return this;\n\n        };\n\n        function InstanceGeometry() {\n\n            this.url = \"\";\n            this.instance_material = [];\n\n        };\n\n        InstanceGeometry.prototype.parse = function ( element ) {\n\n            this.url = element.getAttribute('url').replace(/^#/, '');\n            this.instance_material = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1 ) continue;\n\n                if ( child.nodeName === 'bind_material' ) {\n\n                    var instances = child.querySelectorAll('instance_material');\n\n                    for ( var j = 0; j < instances.length; j ++ ) {\n\n                        var instance = instances[j];\n                        this.instance_material.push( (new InstanceMaterial()).parse(instance) );\n\n                    }\n\n                    break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Geometry() {\n\n            this.id = \"\";\n            this.mesh = null;\n\n        };\n\n        Geometry.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute('id');\n\n            extractDoubleSided( this, element );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n\n                switch ( child.nodeName ) {\n\n                    case 'mesh':\n\n                        this.mesh = (new Mesh(this)).parse(child);\n                        break;\n\n                    case 'extra':\n\n                        // console.log( child );\n                        break;\n\n                    default:\n                        break;\n                }\n            }\n\n            return this;\n\n        };\n\n        function Mesh( geometry ) {\n\n            this.geometry = geometry.id;\n            this.primitives = [];\n            this.vertices = null;\n            this.geometry3js = null;\n\n        };\n\n        Mesh.prototype.parse = function ( element ) {\n\n            this.primitives = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'source':\n\n                        _source( child );\n                        break;\n\n                    case 'vertices':\n\n                        this.vertices = ( new Vertices() ).parse( child );\n                        break;\n\n                    case 'linestrips':\n\n                        this.primitives.push( ( new LineStrips().parse( child ) ) );\n                        break;\n\n                    case 'triangles':\n\n                        this.primitives.push( ( new Triangles().parse( child ) ) );\n                        break;\n\n                    case 'polygons':\n\n                        this.primitives.push( ( new Polygons().parse( child ) ) );\n                        break;\n\n                    case 'polylist':\n\n                        this.primitives.push( ( new Polylist().parse( child ) ) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            this.geometry3js = new THREE.Geometry();\n\n            if ( this.vertices === null ) {\n\n                // TODO (mrdoob): Study case when this is null (carrier.dae)\n\n                return this;\n\n            }\n\n            var vertexData = sources[ this.vertices.input['POSITION'].source ].data;\n\n            for ( var i = 0; i < vertexData.length; i += 3 ) {\n\n                this.geometry3js.vertices.push( getConvertedVec3( vertexData, i ).clone() );\n\n            }\n\n            for ( var i = 0; i < this.primitives.length; i ++ ) {\n\n                var primitive = this.primitives[ i ];\n                primitive.setVertices( this.vertices );\n                this.handlePrimitive( primitive, this.geometry3js );\n\n            }\n\n            if ( this.geometry3js.calcNormals ) {\n\n                this.geometry3js.computeVertexNormals();\n                delete this.geometry3js.calcNormals;\n\n            }\n\n            return this;\n\n        };\n\n        Mesh.prototype.handlePrimitive = function ( primitive, geom ) {\n\n            if ( primitive instanceof LineStrips ) {\n\n                // TODO: Handle indices. Maybe easier with BufferGeometry?\n\n                geom.isLineStrip = true;\n                return;\n\n            }\n\n            var j, k, pList = primitive.p, inputs = primitive.inputs;\n            var input, index, idx32;\n            var source, numParams;\n            var vcIndex = 0, vcount = 3, maxOffset = 0;\n            var texture_sets = [];\n\n            for ( j = 0; j < inputs.length; j ++ ) {\n\n                input = inputs[ j ];\n\n                var offset = input.offset + 1;\n                maxOffset = (maxOffset < offset) ? offset : maxOffset;\n\n                switch ( input.semantic ) {\n\n                    case 'TEXCOORD':\n                        texture_sets.push( input.set );\n                        break;\n\n                }\n\n            }\n\n            for ( var pCount = 0; pCount < pList.length; ++ pCount ) {\n\n                var p = pList[ pCount ], i = 0;\n\n                while ( i < p.length ) {\n\n                    var vs = [];\n                    var ns = [];\n                    var ts = null;\n                    var cs = [];\n\n                    if ( primitive.vcount ) {\n\n                        vcount = primitive.vcount.length ? primitive.vcount[ vcIndex ++ ] : primitive.vcount;\n\n                    } else {\n\n                        vcount = p.length / maxOffset;\n\n                    }\n\n\n                    for ( j = 0; j < vcount; j ++ ) {\n\n                        for ( k = 0; k < inputs.length; k ++ ) {\n\n                            input = inputs[ k ];\n                            source = sources[ input.source ];\n\n                            index = p[ i + ( j * maxOffset ) + input.offset ];\n                            numParams = source.accessor.params.length;\n                            idx32 = index * numParams;\n\n                            switch ( input.semantic ) {\n\n                                case 'VERTEX':\n\n                                    vs.push( index );\n\n                                    break;\n\n                                case 'NORMAL':\n\n                                    ns.push( getConvertedVec3( source.data, idx32 ) );\n\n                                    break;\n\n                                case 'TEXCOORD':\n\n                                    ts = ts || { };\n                                    if ( ts[ input.set ] === undefined ) ts[ input.set ] = [];\n                                    // invert the V\n                                    ts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], source.data[ idx32 + 1 ] ) );\n\n                                    break;\n\n                                case 'COLOR':\n\n                                    cs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\n\n                                    break;\n\n                                default:\n\n                                    break;\n\n                            }\n\n                        }\n\n                    }\n\n                    if ( ns.length === 0 ) {\n\n                        // check the vertices inputs\n                        input = this.vertices.input.NORMAL;\n\n                        if ( input ) {\n\n                            source = sources[ input.source ];\n                            numParams = source.accessor.params.length;\n\n                            for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                                ns.push( getConvertedVec3( source.data, vs[ ndx ] * numParams ) );\n\n                            }\n\n                        } else {\n\n                            geom.calcNormals = true;\n\n                        }\n\n                    }\n\n                    if ( !ts ) {\n\n                        ts = { };\n                        // check the vertices inputs\n                        input = this.vertices.input.TEXCOORD;\n\n                        if ( input ) {\n\n                            texture_sets.push( input.set );\n                            source = sources[ input.source ];\n                            numParams = source.accessor.params.length;\n\n                            for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                                idx32 = vs[ ndx ] * numParams;\n                                if ( ts[ input.set ] === undefined ) ts[ input.set ] = [ ];\n                                // invert the V\n                                ts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], 1.0 - source.data[ idx32 + 1 ] ) );\n\n                            }\n\n                        }\n\n                    }\n\n                    if ( cs.length === 0 ) {\n\n                        // check the vertices inputs\n                        input = this.vertices.input.COLOR;\n\n                        if ( input ) {\n\n                            source = sources[ input.source ];\n                            numParams = source.accessor.params.length;\n\n                            for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                                idx32 = vs[ ndx ] * numParams;\n                                cs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\n\n                            }\n\n                        }\n\n                    }\n\n                    var face = null, faces = [], uv, uvArr;\n\n                    if ( vcount === 3 ) {\n\n                        faces.push( new THREE.Face3( vs[0], vs[1], vs[2], ns, cs.length ? cs : new THREE.Color() ) );\n\n                    } else if ( vcount === 4 ) {\n\n                        faces.push( new THREE.Face3( vs[0], vs[1], vs[3], [ ns[0].clone(), ns[1].clone(), ns[3].clone() ], cs.length ? [ cs[0], cs[1], cs[3] ] : new THREE.Color() ) );\n\n                        faces.push( new THREE.Face3( vs[1], vs[2], vs[3], [ ns[1].clone(), ns[2].clone(), ns[3].clone() ], cs.length ? [ cs[1], cs[2], cs[3] ] : new THREE.Color() ) );\n\n                    } else if ( vcount > 4 && options.subdivideFaces ) {\n\n                        var clr = cs.length ? cs : new THREE.Color(),\n                            vec1, vec2, vec3, v1, v2, norm;\n\n                        // subdivide into multiple Face3s\n\n                        for ( k = 1; k < vcount - 1; ) {\n\n                            faces.push( new THREE.Face3( vs[0], vs[k], vs[k + 1], [ ns[0].clone(), ns[k ++].clone(), ns[k].clone() ], clr ) );\n\n                        }\n\n                    }\n\n                    if ( faces.length ) {\n\n                        for ( var ndx = 0, len = faces.length; ndx < len; ndx ++ ) {\n\n                            face = faces[ndx];\n                            face.daeMaterial = primitive.material;\n                            geom.faces.push( face );\n\n                            for ( k = 0; k < texture_sets.length; k ++ ) {\n\n                                uv = ts[ texture_sets[k] ];\n\n                                if ( vcount > 4 ) {\n\n                                    // Grab the right UVs for the vertices in this face\n                                    uvArr = [ uv[0], uv[ndx + 1], uv[ndx + 2] ];\n\n                                } else if ( vcount === 4 ) {\n\n                                    if ( ndx === 0 ) {\n\n                                        uvArr = [ uv[0], uv[1], uv[3] ];\n\n                                    } else {\n\n                                        uvArr = [ uv[1].clone(), uv[2], uv[3].clone() ];\n\n                                    }\n\n                                } else {\n\n                                    uvArr = [ uv[0], uv[1], uv[2] ];\n\n                                }\n\n                                if ( geom.faceVertexUvs[k] === undefined ) {\n\n                                    geom.faceVertexUvs[k] = [];\n\n                                }\n\n                                geom.faceVertexUvs[k].push( uvArr );\n\n                            }\n\n                        }\n\n                    } else {\n\n                        console.log( 'dropped face with vcount ' + vcount + ' for geometry with id: ' + geom.id );\n\n                    }\n\n                    i += maxOffset * vcount;\n\n                }\n\n            }\n\n        };\n\n        function Polygons () {\n\n            this.material = \"\";\n            this.count = 0;\n            this.inputs = [];\n            this.vcount = null;\n            this.p = [];\n            this.geometry = new THREE.Geometry();\n\n        };\n\n        Polygons.prototype.setVertices = function ( vertices ) {\n\n            for ( var i = 0; i < this.inputs.length; i ++ ) {\n\n                if ( this.inputs[ i ].source === vertices.id ) {\n\n                    this.inputs[ i ].source = vertices.input[ 'POSITION' ].source;\n\n                }\n\n            }\n\n        };\n\n        Polygons.prototype.parse = function ( element ) {\n\n            this.material = element.getAttribute( 'material' );\n            this.count = _attr_as_int( element, 'count', 0 );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'input':\n\n                        this.inputs.push( ( new Input() ).parse( element.childNodes[ i ] ) );\n                        break;\n\n                    case 'vcount':\n\n                        this.vcount = _ints( child.textContent );\n                        break;\n\n                    case 'p':\n\n                        this.p.push( _ints( child.textContent ) );\n                        break;\n\n                    case 'ph':\n\n                        console.warn( 'polygon holes not yet supported!' );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Polylist () {\n\n            Polygons.call( this );\n\n            this.vcount = [];\n\n        };\n\n        Polylist.prototype = Object.create( Polygons.prototype );\n        Polylist.prototype.constructor = Polylist;\n\n        function LineStrips() {\n\n            Polygons.call( this );\n\n            this.vcount = 1;\n\n        };\n\n        LineStrips.prototype = Object.create( Polygons.prototype );\n        LineStrips.prototype.constructor = LineStrips;\n\n        function Triangles () {\n\n            Polygons.call( this );\n\n            this.vcount = 3;\n\n        };\n\n        Triangles.prototype = Object.create( Polygons.prototype );\n        Triangles.prototype.constructor = Triangles;\n\n        function Accessor() {\n\n            this.source = \"\";\n            this.count = 0;\n            this.stride = 0;\n            this.params = [];\n\n        };\n\n        Accessor.prototype.parse = function ( element ) {\n\n            this.params = [];\n            this.source = element.getAttribute( 'source' );\n            this.count = _attr_as_int( element, 'count', 0 );\n            this.stride = _attr_as_int( element, 'stride', 0 );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                if ( child.nodeName === 'param' ) {\n\n                    var param = {};\n                    param[ 'name' ] = child.getAttribute( 'name' );\n                    param[ 'type' ] = child.getAttribute( 'type' );\n                    this.params.push( param );\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Vertices() {\n\n            this.input = {};\n\n        };\n\n        Vertices.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute('id');\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                if ( element.childNodes[i].nodeName === 'input' ) {\n\n                    var input = ( new Input() ).parse( element.childNodes[ i ] );\n                    this.input[ input.semantic ] = input;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Input () {\n\n            this.semantic = \"\";\n            this.offset = 0;\n            this.source = \"\";\n            this.set = 0;\n\n        };\n\n        Input.prototype.parse = function ( element ) {\n\n            this.semantic = element.getAttribute('semantic');\n            this.source = element.getAttribute('source').replace(/^#/, '');\n            this.set = _attr_as_int(element, 'set', -1);\n            this.offset = _attr_as_int(element, 'offset', 0);\n\n            if ( this.semantic === 'TEXCOORD' && this.set < 0 ) {\n\n                this.set = 0;\n\n            }\n\n            return this;\n\n        };\n\n        function Source ( id ) {\n\n            this.id = id;\n            this.type = null;\n\n        };\n\n        Source.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n\n                switch ( child.nodeName ) {\n\n                    case 'bool_array':\n\n                        this.data = _bools( child.textContent );\n                        this.type = child.nodeName;\n                        break;\n\n                    case 'float_array':\n\n                        this.data = _floats( child.textContent );\n                        this.type = child.nodeName;\n                        break;\n\n                    case 'int_array':\n\n                        this.data = _ints( child.textContent );\n                        this.type = child.nodeName;\n                        break;\n\n                    case 'IDREF_array':\n                    case 'Name_array':\n\n                        this.data = _strings( child.textContent );\n                        this.type = child.nodeName;\n                        break;\n\n                    case 'technique_common':\n\n                        for ( var j = 0; j < child.childNodes.length; j ++ ) {\n\n                            if ( child.childNodes[ j ].nodeName === 'accessor' ) {\n\n                                this.accessor = ( new Accessor() ).parse( child.childNodes[ j ] );\n                                break;\n\n                            }\n                        }\n                        break;\n\n                    default:\n                        // console.log(child.nodeName);\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Source.prototype.read = function () {\n\n            var result = [];\n\n            //for (var i = 0; i < this.accessor.params.length; i++) {\n\n            var param = this.accessor.params[ 0 ];\n\n                //console.log(param.name + \" \" + param.type);\n\n            switch ( param.type ) {\n\n                case 'IDREF':\n                case 'Name': case 'name':\n                case 'float':\n\n                    return this.data;\n\n                case 'float4x4':\n\n                    for ( var j = 0; j < this.data.length; j += 16 ) {\n\n                        var s = this.data.slice( j, j + 16 );\n                        var m = getConvertedMat4( s );\n                        result.push( m );\n                    }\n\n                    break;\n\n                default:\n\n                    console.log( 'ColladaLoader: Source: Read dont know how to read ' + param.type + '.' );\n                    break;\n\n            }\n\n            //}\n\n            return result;\n\n        };\n\n        function Material () {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.instance_effect = null;\n\n        };\n\n        Material.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                if ( element.childNodes[ i ].nodeName === 'instance_effect' ) {\n\n                    this.instance_effect = ( new InstanceEffect() ).parse( element.childNodes[ i ] );\n                    break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function ColorOrTexture () {\n\n            this.color = new THREE.Color();\n            this.color.setRGB( Math.random(), Math.random(), Math.random() );\n            this.color.a = 1.0;\n\n            this.texture = null;\n            this.texcoord = null;\n            this.texOpts = null;\n\n        };\n\n        ColorOrTexture.prototype.isColor = function () {\n\n            return ( this.texture === null );\n\n        };\n\n        ColorOrTexture.prototype.isTexture = function () {\n\n            return ( this.texture != null );\n\n        };\n\n        ColorOrTexture.prototype.parse = function ( element ) {\n\n            if (element.nodeName === 'transparent') {\n\n                this.opaque = element.getAttribute('opaque');\n\n            }\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'color':\n\n                        var rgba = _floats( child.textContent );\n                        this.color = new THREE.Color();\n                        this.color.setRGB( rgba[0], rgba[1], rgba[2] );\n                        this.color.a = rgba[3];\n                        break;\n\n                    case 'texture':\n\n                        this.texture = child.getAttribute('texture');\n                        this.texcoord = child.getAttribute('texcoord');\n                        // Defaults from:\n                        // https://collada.org/mediawiki/index.php/Maya_texture_placement_MAYA_extension\n                        this.texOpts = {\n                            offsetU: 0,\n                            offsetV: 0,\n                            repeatU: 1,\n                            repeatV: 1,\n                            wrapU: 1,\n                            wrapV: 1\n                        };\n                        this.parseTexture( child );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        ColorOrTexture.prototype.parseTexture = function ( element ) {\n\n            if ( ! element.childNodes ) return this;\n\n            // This should be supported by Maya, 3dsMax, and MotionBuilder\n\n            if ( element.childNodes[1] && element.childNodes[1].nodeName === 'extra' ) {\n\n                element = element.childNodes[1];\n\n                if ( element.childNodes[1] && element.childNodes[1].nodeName === 'technique' ) {\n\n                    element = element.childNodes[1];\n\n                }\n\n            }\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'offsetU':\n                    case 'offsetV':\n                    case 'repeatU':\n                    case 'repeatV':\n\n                        this.texOpts[ child.nodeName ] = parseFloat( child.textContent );\n\n                        break;\n\n                    case 'wrapU':\n                    case 'wrapV':\n\n                        // some dae have a value of true which becomes NaN via parseInt\n\n                        if ( child.textContent.toUpperCase() === 'TRUE' ) {\n\n                            this.texOpts[ child.nodeName ] = 1;\n\n                        } else {\n\n                            this.texOpts[ child.nodeName ] = parseInt( child.textContent );\n\n                        }\n                        break;\n\n                    default:\n\n                        this.texOpts[ child.nodeName ] = child.textContent;\n\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Shader ( type, effect ) {\n\n            this.type = type;\n            this.effect = effect;\n            this.material = null;\n\n        };\n\n        Shader.prototype.parse = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'emission':\n                    case 'diffuse':\n                    case 'specular':\n                    case 'transparent':\n\n                        this[ child.nodeName ] = ( new ColorOrTexture() ).parse( child );\n                        break;\n\n                    case 'bump':\n\n                        // If 'bumptype' is 'heightfield', create a 'bump' property\n                        // Else if 'bumptype' is 'normalmap', create a 'normal' property\n                        // (Default to 'bump')\n                        var bumpType = child.getAttribute( 'bumptype' );\n                        if ( bumpType ) {\n                            if ( bumpType.toLowerCase() === \"heightfield\" ) {\n                                this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                            } else if ( bumpType.toLowerCase() === \"normalmap\" ) {\n                                this[ 'normal' ] = ( new ColorOrTexture() ).parse( child );\n                            } else {\n                                console.error( \"Shader.prototype.parse: Invalid value for attribute 'bumptype' (\" + bumpType + \") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'\" );\n                                this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                            }\n                        } else {\n                            console.warn( \"Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'\" );\n                            this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                        }\n\n                        break;\n\n                    case 'shininess':\n                    case 'reflectivity':\n                    case 'index_of_refraction':\n                    case 'transparency':\n\n                        var f = child.querySelectorAll('float');\n\n                        if ( f.length > 0 )\n                            this[ child.nodeName ] = parseFloat( f[ 0 ].textContent );\n\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            this.create();\n            return this;\n\n        };\n\n        Shader.prototype.create = function() {\n\n            var props = {};\n\n            var transparent = false;\n\n            if (this['transparency'] !== undefined && this['transparent'] !== undefined) {\n                // convert transparent color RBG to average value\n                var transparentColor = this['transparent'];\n                var transparencyLevel = (this.transparent.color.r + this.transparent.color.g + this.transparent.color.b) / 3 * this.transparency;\n\n                if (transparencyLevel > 0) {\n                    transparent = true;\n                    props[ 'transparent' ] = true;\n                    props[ 'opacity' ] = 1 - transparencyLevel;\n\n                }\n\n            }\n\n            var keys = {\n                'diffuse':'map',\n                'ambient':'lightMap',\n                'specular':'specularMap',\n                'emission':'emissionMap',\n                'bump':'bumpMap',\n                'normal':'normalMap'\n                };\n\n            for ( var prop in this ) {\n\n                switch ( prop ) {\n\n                    case 'ambient':\n                    case 'emission':\n                    case 'diffuse':\n                    case 'specular':\n                    case 'bump':\n                    case 'normal':\n\n                        var cot = this[ prop ];\n\n                        if ( cot instanceof ColorOrTexture ) {\n\n                            if ( cot.isTexture() ) {\n\n                                var samplerId = cot.texture;\n                                var surfaceId = this.effect.sampler[samplerId];\n\n                                if ( surfaceId !== undefined && surfaceId.source !== undefined ) {\n\n                                    var surface = this.effect.surface[surfaceId.source];\n\n                                    if ( surface !== undefined ) {\n\n                                        var image = images[ surface.init_from ];\n\n                                        if ( image ) {\n\n                                            var url = baseUrl + image.init_from;\n\n                                            var texture;\n                                            var loader = THREE.Loader.Handlers.get( url );\n\n                                            if ( loader !== null ) {\n\n                                                texture = loader.load( url );\n\n                                            } else {\n\n                                                texture = new THREE.Texture();\n\n                                                loadTextureImage( texture, url );\n\n                                            }\n\n                                            texture.wrapS = cot.texOpts.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n                                            texture.wrapT = cot.texOpts.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n                                            texture.offset.x = cot.texOpts.offsetU;\n                                            texture.offset.y = cot.texOpts.offsetV;\n                                            texture.repeat.x = cot.texOpts.repeatU;\n                                            texture.repeat.y = cot.texOpts.repeatV;\n                                            props[keys[prop]] = texture;\n\n                                            // Texture with baked lighting?\n                                            if (prop === 'emission') props['emissive'] = 0xffffff;\n\n                                        }\n\n                                    }\n\n                                }\n\n                            } else if ( prop === 'diffuse' || !transparent ) {\n\n                                if ( prop === 'emission' ) {\n\n                                    props[ 'emissive' ] = cot.color.getHex();\n\n                                } else {\n\n                                    props[ prop ] = cot.color.getHex();\n\n                                }\n\n                            }\n\n                        }\n\n                        break;\n\n                    case 'shininess':\n\n                        props[ prop ] = this[ prop ];\n                        break;\n\n                    case 'reflectivity':\n\n                        props[ prop ] = this[ prop ];\n                        if ( props[ prop ] > 0.0 ) props['envMap'] = options.defaultEnvMap;\n                        props['combine'] = THREE.MixOperation;  //mix regular shading with reflective component\n                        break;\n\n                    case 'index_of_refraction':\n\n                        props[ 'refractionRatio' ] = this[ prop ]; //TODO: \"index_of_refraction\" becomes \"refractionRatio\" in shader, but I'm not sure if the two are actually comparable\n                        if ( this[ prop ] !== 1.0 ) props['envMap'] = options.defaultEnvMap;\n                        break;\n\n                    case 'transparency':\n                        // gets figured out up top\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            props[ 'shading' ] = preferredShading;\n            props[ 'side' ] = this.effect.doubleSided ? THREE.DoubleSide : THREE.FrontSide;\n\n            switch ( this.type ) {\n\n                case 'constant':\n\n                    if (props.emissive != undefined) props.color = props.emissive;\n                    this.material = new THREE.MeshBasicMaterial( props );\n                    break;\n\n                case 'phong':\n                case 'blinn':\n\n                    if (props.diffuse != undefined) props.color = props.diffuse;\n                    this.material = new THREE.MeshPhongMaterial( props );\n                    break;\n\n                case 'lambert':\n                default:\n\n                    if (props.diffuse != undefined) props.color = props.diffuse;\n                    this.material = new THREE.MeshLambertMaterial( props );\n                    break;\n\n            }\n\n            return this.material;\n\n        };\n\n        function Surface ( effect ) {\n\n            this.effect = effect;\n            this.init_from = null;\n            this.format = null;\n\n        };\n\n        Surface.prototype.parse = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'init_from':\n\n                        this.init_from = child.textContent;\n                        break;\n\n                    case 'format':\n\n                        this.format = child.textContent;\n                        break;\n\n                    default:\n\n                        console.log( \"unhandled Surface prop: \" + child.nodeName );\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Sampler2D ( effect ) {\n\n            this.effect = effect;\n            this.source = null;\n            this.wrap_s = null;\n            this.wrap_t = null;\n            this.minfilter = null;\n            this.magfilter = null;\n            this.mipfilter = null;\n\n        };\n\n        Sampler2D.prototype.parse = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'source':\n\n                        this.source = child.textContent;\n                        break;\n\n                    case 'minfilter':\n\n                        this.minfilter = child.textContent;\n                        break;\n\n                    case 'magfilter':\n\n                        this.magfilter = child.textContent;\n                        break;\n\n                    case 'mipfilter':\n\n                        this.mipfilter = child.textContent;\n                        break;\n\n                    case 'wrap_s':\n\n                        this.wrap_s = child.textContent;\n                        break;\n\n                    case 'wrap_t':\n\n                        this.wrap_t = child.textContent;\n                        break;\n\n                    default:\n\n                        console.log( \"unhandled Sampler2D prop: \" + child.nodeName );\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Effect () {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.shader = null;\n            this.surface = {};\n            this.sampler = {};\n\n        };\n\n        Effect.prototype.create = function () {\n\n            if ( this.shader === null ) {\n\n                return null;\n\n            }\n\n        };\n\n        Effect.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n\n            extractDoubleSided( this, element );\n\n            this.shader = null;\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'profile_COMMON':\n\n                        this.parseTechnique( this.parseProfileCOMMON( child ) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Effect.prototype.parseNewparam = function ( element ) {\n\n            var sid = element.getAttribute( 'sid' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'surface':\n\n                        this.surface[sid] = ( new Surface( this ) ).parse( child );\n                        break;\n\n                    case 'sampler2D':\n\n                        this.sampler[sid] = ( new Sampler2D( this ) ).parse( child );\n                        break;\n\n                    case 'extra':\n\n                        break;\n\n                    default:\n\n                        console.log( child.nodeName );\n                        break;\n\n                }\n\n            }\n\n        };\n\n        Effect.prototype.parseProfileCOMMON = function ( element ) {\n\n            var technique;\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'profile_COMMON':\n\n                        this.parseProfileCOMMON( child );\n                        break;\n\n                    case 'technique':\n\n                        technique = child;\n                        break;\n\n                    case 'newparam':\n\n                        this.parseNewparam( child );\n                        break;\n\n                    case 'image':\n\n                        var _image = ( new _Image() ).parse( child );\n                        images[ _image.id ] = _image;\n                        break;\n\n                    case 'extra':\n                        break;\n\n                    default:\n\n                        console.log( child.nodeName );\n                        break;\n\n                }\n\n            }\n\n            return technique;\n\n        };\n\n        Effect.prototype.parseTechnique = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'constant':\n                    case 'lambert':\n                    case 'blinn':\n                    case 'phong':\n\n                        this.shader = ( new Shader( child.nodeName, this ) ).parse( child );\n                        break;\n                    case 'extra':\n                        this.parseExtra(child);\n                        break;\n                    default:\n                        break;\n\n                }\n\n            }\n\n        };\n\n        Effect.prototype.parseExtra = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'technique':\n                        this.parseExtraTechnique( child );\n                        break;\n                    default:\n                        break;\n\n                }\n\n            }\n\n        };\n\n        Effect.prototype.parseExtraTechnique = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[i];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'bump':\n                        this.shader.parse( element );\n                        break;\n                    default:\n                        break;\n\n                }\n\n            }\n\n        };\n\n        function InstanceEffect () {\n\n            this.url = \"\";\n\n        };\n\n        InstanceEffect.prototype.parse = function ( element ) {\n\n            this.url = element.getAttribute( 'url' ).replace( /^#/, '' );\n            return this;\n\n        };\n\n        function Animation() {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.source = {};\n            this.sampler = [];\n            this.channel = [];\n\n        };\n\n        Animation.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n            this.source = {};\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'animation':\n\n                        var anim = ( new Animation() ).parse( child );\n\n                        for ( var src in anim.source ) {\n\n                            this.source[ src ] = anim.source[ src ];\n\n                        }\n\n                        for ( var j = 0; j < anim.channel.length; j ++ ) {\n\n                            this.channel.push( anim.channel[ j ] );\n                            this.sampler.push( anim.sampler[ j ] );\n\n                        }\n\n                        break;\n\n                    case 'source':\n\n                        var src = ( new Source() ).parse( child );\n                        this.source[ src.id ] = src;\n                        break;\n\n                    case 'sampler':\n\n                        this.sampler.push( ( new Sampler( this ) ).parse( child ) );\n                        break;\n\n                    case 'channel':\n\n                        this.channel.push( ( new Channel( this ) ).parse( child ) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Channel( animation ) {\n\n            this.animation = animation;\n            this.source = \"\";\n            this.target = \"\";\n            this.fullSid = null;\n            this.sid = null;\n            this.dotSyntax = null;\n            this.arrSyntax = null;\n            this.arrIndices = null;\n            this.member = null;\n\n        };\n\n        Channel.prototype.parse = function ( element ) {\n\n            this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n            this.target = element.getAttribute( 'target' );\n\n            var parts = this.target.split( '/' );\n\n            var id = parts.shift();\n            var sid = parts.shift();\n\n            var dotSyntax = ( sid.indexOf(\".\") >= 0 );\n            var arrSyntax = ( sid.indexOf(\"(\") >= 0 );\n\n            if ( dotSyntax ) {\n\n                parts = sid.split(\".\");\n                this.sid = parts.shift();\n                this.member = parts.shift();\n\n            } else if ( arrSyntax ) {\n\n                var arrIndices = sid.split(\"(\");\n                this.sid = arrIndices.shift();\n\n                for (var j = 0; j < arrIndices.length; j ++ ) {\n\n                    arrIndices[j] = parseInt( arrIndices[j].replace(/\\)/, '') );\n\n                }\n\n                this.arrIndices = arrIndices;\n\n            } else {\n\n                this.sid = sid;\n\n            }\n\n            this.fullSid = sid;\n            this.dotSyntax = dotSyntax;\n            this.arrSyntax = arrSyntax;\n\n            return this;\n\n        };\n\n        function Sampler ( animation ) {\n\n            this.id = \"\";\n            this.animation = animation;\n            this.inputs = [];\n            this.input = null;\n            this.output = null;\n            this.strideOut = null;\n            this.interpolation = null;\n            this.startTime = null;\n            this.endTime = null;\n            this.duration = 0;\n\n        };\n\n        Sampler.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.inputs = [];\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'input':\n\n                        this.inputs.push( (new Input()).parse( child ) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Sampler.prototype.create = function () {\n\n            for ( var i = 0; i < this.inputs.length; i ++ ) {\n\n                var input = this.inputs[ i ];\n                var source = this.animation.source[ input.source ];\n\n                switch ( input.semantic ) {\n\n                    case 'INPUT':\n\n                        this.input = source.read();\n                        break;\n\n                    case 'OUTPUT':\n\n                        this.output = source.read();\n                        this.strideOut = source.accessor.stride;\n                        break;\n\n                    case 'INTERPOLATION':\n\n                        this.interpolation = source.read();\n                        break;\n\n                    case 'IN_TANGENT':\n\n                        break;\n\n                    case 'OUT_TANGENT':\n\n                        break;\n\n                    default:\n\n                        console.log(input.semantic);\n                        break;\n\n                }\n\n            }\n\n            this.startTime = 0;\n            this.endTime = 0;\n            this.duration = 0;\n\n            if ( this.input.length ) {\n\n                this.startTime = 100000000;\n                this.endTime = -100000000;\n\n                for ( var i = 0; i < this.input.length; i ++ ) {\n\n                    this.startTime = Math.min( this.startTime, this.input[ i ] );\n                    this.endTime = Math.max( this.endTime, this.input[ i ] );\n\n                }\n\n                this.duration = this.endTime - this.startTime;\n\n            }\n\n        };\n\n        Sampler.prototype.getData = function ( type, ndx, member ) {\n\n            var data;\n\n            if ( type === 'matrix' && this.strideOut === 16 ) {\n\n                data = this.output[ ndx ];\n\n            } else if ( this.strideOut > 1 ) {\n\n                data = [];\n                ndx *= this.strideOut;\n\n                for ( var i = 0; i < this.strideOut; ++ i ) {\n\n                    data[ i ] = this.output[ ndx + i ];\n\n                }\n\n                if ( this.strideOut === 3 ) {\n\n                    switch ( type ) {\n\n                        case 'rotate':\n                        case 'translate':\n\n                            fixCoords( data, -1 );\n                            break;\n\n                        case 'scale':\n\n                            fixCoords( data, 1 );\n                            break;\n\n                    }\n\n                } else if ( this.strideOut === 4 && type === 'matrix' ) {\n\n                    fixCoords( data, -1 );\n\n                }\n\n            } else {\n\n                data = this.output[ ndx ];\n\n                if ( member && type === 'translate' ) {\n                    data = getConvertedTranslation( member, data );\n                }\n\n            }\n\n            return data;\n\n        };\n\n        function Key ( time ) {\n\n            this.targets = [];\n            this.time = time;\n\n        };\n\n        Key.prototype.addTarget = function ( fullSid, transform, member, data ) {\n\n            this.targets.push( {\n                sid: fullSid,\n                member: member,\n                transform: transform,\n                data: data\n            } );\n\n        };\n\n        Key.prototype.apply = function ( opt_sid ) {\n\n            for ( var i = 0; i < this.targets.length; ++ i ) {\n\n                var target = this.targets[ i ];\n\n                if ( !opt_sid || target.sid === opt_sid ) {\n\n                    target.transform.update( target.data, target.member );\n\n                }\n\n            }\n\n        };\n\n        Key.prototype.getTarget = function ( fullSid ) {\n\n            for ( var i = 0; i < this.targets.length; ++ i ) {\n\n                if ( this.targets[ i ].sid === fullSid ) {\n\n                    return this.targets[ i ];\n\n                }\n\n            }\n\n            return null;\n\n        };\n\n        Key.prototype.hasTarget = function ( fullSid ) {\n\n            for ( var i = 0; i < this.targets.length; ++ i ) {\n\n                if ( this.targets[ i ].sid === fullSid ) {\n\n                    return true;\n\n                }\n\n            }\n\n            return false;\n\n        };\n\n        // TODO: Currently only doing linear interpolation. Should support full COLLADA spec.\n        Key.prototype.interpolate = function ( nextKey, time ) {\n\n            for ( var i = 0, l = this.targets.length; i < l; i ++ ) {\n\n                var target = this.targets[ i ],\n                    nextTarget = nextKey.getTarget( target.sid ),\n                    data;\n\n                if ( target.transform.type !== 'matrix' && nextTarget ) {\n\n                    var scale = ( time - this.time ) / ( nextKey.time - this.time ),\n                        nextData = nextTarget.data,\n                        prevData = target.data;\n\n                    if ( scale < 0 ) scale = 0;\n                    if ( scale > 1 ) scale = 1;\n\n                    if ( prevData.length ) {\n\n                        data = [];\n\n                        for ( var j = 0; j < prevData.length; ++ j ) {\n\n                            data[ j ] = prevData[ j ] + ( nextData[ j ] - prevData[ j ] ) * scale;\n\n                        }\n\n                    } else {\n\n                        data = prevData + ( nextData - prevData ) * scale;\n\n                    }\n\n                } else {\n\n                    data = target.data;\n\n                }\n\n                target.transform.update( data, target.member );\n\n            }\n\n        };\n\n        // Camera\n        function Camera() {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.technique = \"\";\n\n        };\n\n        Camera.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'optics':\n\n                        this.parseOptics( child );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Camera.prototype.parseOptics = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                if ( element.childNodes[ i ].nodeName === 'technique_common' ) {\n\n                    var technique = element.childNodes[ i ];\n\n                    for ( var j = 0; j < technique.childNodes.length; j ++ ) {\n\n                        this.technique = technique.childNodes[ j ].nodeName;\n\n                        if ( this.technique === 'perspective' ) {\n\n                            var perspective = technique.childNodes[ j ];\n\n                            for ( var k = 0; k < perspective.childNodes.length; k ++ ) {\n\n                                var param = perspective.childNodes[ k ];\n\n                                switch ( param.nodeName ) {\n\n                                    case 'yfov':\n                                        this.yfov = param.textContent;\n                                        break;\n                                    case 'xfov':\n                                        this.xfov = param.textContent;\n                                        break;\n                                    case 'znear':\n                                        this.znear = param.textContent;\n                                        break;\n                                    case 'zfar':\n                                        this.zfar = param.textContent;\n                                        break;\n                                    case 'aspect_ratio':\n                                        this.aspect_ratio = param.textContent;\n                                        break;\n\n                                }\n\n                            }\n\n                        } else if ( this.technique === 'orthographic' ) {\n\n                            var orthographic = technique.childNodes[ j ];\n\n                            for ( var k = 0; k < orthographic.childNodes.length; k ++ ) {\n\n                                var param = orthographic.childNodes[ k ];\n\n                                switch ( param.nodeName ) {\n\n                                    case 'xmag':\n                                        this.xmag = param.textContent;\n                                        break;\n                                    case 'ymag':\n                                        this.ymag = param.textContent;\n                                        break;\n                                    case 'znear':\n                                        this.znear = param.textContent;\n                                        break;\n                                    case 'zfar':\n                                        this.zfar = param.textContent;\n                                        break;\n                                    case 'aspect_ratio':\n                                        this.aspect_ratio = param.textContent;\n                                        break;\n\n                                }\n\n                            }\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function InstanceCamera() {\n\n            this.url = \"\";\n\n        };\n\n        InstanceCamera.prototype.parse = function ( element ) {\n\n            this.url = element.getAttribute('url').replace(/^#/, '');\n\n            return this;\n\n        };\n\n        // Light\n\n        function Light() {\n\n            this.id = \"\";\n            this.name = \"\";\n            this.technique = \"\";\n\n        };\n\n        Light.prototype.parse = function ( element ) {\n\n            this.id = element.getAttribute( 'id' );\n            this.name = element.getAttribute( 'name' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'technique_common':\n\n                        this.parseCommon( child );\n                        break;\n\n                    case 'technique':\n\n                        this.parseTechnique( child );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Light.prototype.parseCommon = function ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                switch ( element.childNodes[ i ].nodeName ) {\n\n                    case 'directional':\n                    case 'point':\n                    case 'spot':\n                    case 'ambient':\n\n                        this.technique = element.childNodes[ i ].nodeName;\n\n                        var light = element.childNodes[ i ];\n\n                        for ( var j = 0; j < light.childNodes.length; j ++ ) {\n\n                            var child = light.childNodes[j];\n\n                            switch ( child.nodeName ) {\n\n                                case 'color':\n\n                                    var rgba = _floats( child.textContent );\n                                    this.color = new THREE.Color(0);\n                                    this.color.setRGB( rgba[0], rgba[1], rgba[2] );\n                                    this.color.a = rgba[3];\n                                    break;\n\n                                case 'falloff_angle':\n\n                                    this.falloff_angle = parseFloat( child.textContent );\n                                    break;\n\n                                case 'quadratic_attenuation':\n                                    var f = parseFloat( child.textContent );\n                                    this.distance = f ? Math.sqrt( 1 / f ) : 0;\n                            }\n\n                        }\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        Light.prototype.parseTechnique = function ( element ) {\n\n            this.profile = element.getAttribute( 'profile' );\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'intensity':\n\n                        this.intensity = parseFloat(child.textContent);\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function InstanceLight() {\n\n            this.url = \"\";\n\n        };\n\n        InstanceLight.prototype.parse = function ( element ) {\n\n            this.url = element.getAttribute('url').replace(/^#/, '');\n\n            return this;\n\n        };\n\n        function KinematicsModel( ) {\n\n            this.id = '';\n            this.name = '';\n            this.joints = [];\n            this.links = [];\n\n        }\n\n        KinematicsModel.prototype.parse = function( element ) {\n\n            this.id = element.getAttribute('id');\n            this.name = element.getAttribute('name');\n            this.joints = [];\n            this.links = [];\n\n            for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'technique_common':\n\n                        this.parseCommon(child);\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        KinematicsModel.prototype.parseCommon = function( element ) {\n\n            for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( element.childNodes[ i ].nodeName ) {\n\n                    case 'joint':\n                        this.joints.push( (new Joint()).parse(child) );\n                        break;\n\n                    case 'link':\n                        this.links.push( (new Link()).parse(child) );\n                        break;\n\n                    default:\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Joint( ) {\n\n            this.sid = '';\n            this.name = '';\n            this.axis = new THREE.Vector3();\n            this.limits = {\n                min: 0,\n                max: 0\n            };\n            this.type = '';\n            this.static = false;\n            this.zeroPosition = 0.0;\n            this.middlePosition = 0.0;\n\n        }\n\n        Joint.prototype.parse = function( element ) {\n\n            this.sid = element.getAttribute('sid');\n            this.name = element.getAttribute('name');\n            this.axis = new THREE.Vector3();\n            this.limits = {\n                min: 0,\n                max: 0\n            };\n            this.type = '';\n            this.static = false;\n            this.zeroPosition = 0.0;\n            this.middlePosition = 0.0;\n\n            var axisElement = element.querySelector('axis');\n            var _axis = _floats(axisElement.textContent);\n            this.axis = getConvertedVec3(_axis, 0);\n\n            var min = element.querySelector('limits min') ? parseFloat(element.querySelector('limits min').textContent) : -360;\n            var max = element.querySelector('limits max') ? parseFloat(element.querySelector('limits max').textContent) : 360;\n\n            this.limits = {\n                min: min,\n                max: max\n            };\n\n            var jointTypes = [ 'prismatic', 'revolute' ];\n            for (var i = 0; i < jointTypes.length; i ++ ) {\n\n                var type = jointTypes[ i ];\n\n                var jointElement = element.querySelector(type);\n\n                if ( jointElement ) {\n\n                    this.type = type;\n\n                }\n\n            }\n\n            // if the min is equal to or somehow greater than the max, consider the joint static\n            if ( this.limits.min >= this.limits.max ) {\n\n                this.static = true;\n\n            }\n\n            this.middlePosition = (this.limits.min + this.limits.max) / 2.0;\n            return this;\n\n        };\n\n        function Link( ) {\n\n            this.sid = '';\n            this.name = '';\n            this.transforms = [];\n            this.attachments = [];\n\n        }\n\n        Link.prototype.parse = function( element ) {\n\n            this.sid = element.getAttribute('sid');\n            this.name = element.getAttribute('name');\n            this.transforms = [];\n            this.attachments = [];\n\n            for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'attachment_full':\n                        this.attachments.push( (new Attachment()).parse(child) );\n                        break;\n\n                    case 'rotate':\n                    case 'translate':\n                    case 'matrix':\n\n                        this.transforms.push( (new Transform()).parse(child) );\n                        break;\n\n                    default:\n\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function Attachment( ) {\n\n            this.joint = '';\n            this.transforms = [];\n            this.links = [];\n\n        }\n\n        Attachment.prototype.parse = function( element ) {\n\n            this.joint = element.getAttribute('joint').split('/').pop();\n            this.links = [];\n\n            for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'link':\n                        this.links.push( (new Link()).parse(child) );\n                        break;\n\n                    case 'rotate':\n                    case 'translate':\n                    case 'matrix':\n\n                        this.transforms.push( (new Transform()).parse(child) );\n                        break;\n\n                    default:\n\n                        break;\n\n                }\n\n            }\n\n            return this;\n\n        };\n\n        function _source( element ) {\n\n            var id = element.getAttribute( 'id' );\n\n            if ( sources[ id ] != undefined ) {\n\n                return sources[ id ];\n\n            }\n\n            sources[ id ] = ( new Source(id )).parse( element );\n            return sources[ id ];\n\n        };\n\n        function _nsResolver( nsPrefix ) {\n\n            if ( nsPrefix === \"dae\" ) {\n\n                return \"http://www.collada.org/2005/11/COLLADASchema\";\n\n            }\n\n            return null;\n\n        };\n\n        function _bools( str ) {\n\n            var raw = _strings( str );\n            var data = [];\n\n            for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n                data.push( (raw[i] === 'true' || raw[i] === '1') ? true : false );\n\n            }\n\n            return data;\n\n        };\n\n        function _floats( str ) {\n\n            var raw = _strings(str);\n            var data = [];\n\n            for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n                data.push( parseFloat( raw[ i ] ) );\n\n            }\n\n            return data;\n\n        };\n\n        function _ints( str ) {\n\n            var raw = _strings( str );\n            var data = [];\n\n            for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n                data.push( parseInt( raw[ i ], 10 ) );\n\n            }\n\n            return data;\n\n        };\n\n        function _strings( str ) {\n\n            return ( str.length > 0 ) ? _trimString( str ).split( /\\s+/ ) : [];\n\n        };\n\n        function _trimString( str ) {\n\n            return str.replace( /^\\s+/, \"\" ).replace( /\\s+$/, \"\" );\n\n        };\n\n        function _attr_as_float( element, name, defaultValue ) {\n\n            if ( element.hasAttribute( name ) ) {\n\n                return parseFloat( element.getAttribute( name ) );\n\n            } else {\n\n                return defaultValue;\n\n            }\n\n        };\n\n        function _attr_as_int( element, name, defaultValue ) {\n\n            if ( element.hasAttribute( name ) ) {\n\n                return parseInt( element.getAttribute( name ), 10) ;\n\n            } else {\n\n                return defaultValue;\n\n            }\n\n        };\n\n        function _attr_as_string( element, name, defaultValue ) {\n\n            if ( element.hasAttribute( name ) ) {\n\n                return element.getAttribute( name );\n\n            } else {\n\n                return defaultValue;\n\n            }\n\n        };\n\n        function _format_float( f, num ) {\n\n            if ( f === undefined ) {\n\n                var s = '0.';\n\n                while ( s.length < num + 2 ) {\n\n                    s += '0';\n\n                }\n\n                return s;\n\n            }\n\n            num = num || 2;\n\n            var parts = f.toString().split( '.' );\n            parts[ 1 ] = parts.length > 1 ? parts[ 1 ].substr( 0, num ) : \"0\";\n\n            while ( parts[ 1 ].length < num ) {\n\n                parts[ 1 ] += '0';\n\n            }\n\n            return parts.join( '.' );\n\n        };\n\n        function loadTextureImage ( texture, url ) {\n\n            loader = new THREE.ImageLoader();\n\n            loader.load( url, function ( image ) {\n\n                texture.image = image;\n                texture.needsUpdate = true;\n\n            } );\n\n        };\n\n        function extractDoubleSided( obj, element ) {\n\n            obj.doubleSided = false;\n\n            var node = element.querySelectorAll('extra double_sided')[0];\n\n            if ( node ) {\n\n                if ( node && parseInt( node.textContent, 10 ) === 1 ) {\n\n                    obj.doubleSided = true;\n\n                }\n\n            }\n\n        };\n\n        // Up axis conversion\n\n        function setUpConversion() {\n\n            if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n                upConversion = null;\n\n            } else {\n\n                switch ( colladaUp ) {\n\n                    case 'X':\n\n                        upConversion = options.upAxis === 'Y' ? 'XtoY' : 'XtoZ';\n                        break;\n\n                    case 'Y':\n\n                        upConversion = options.upAxis === 'X' ? 'YtoX' : 'YtoZ';\n                        break;\n\n                    case 'Z':\n\n                        upConversion = options.upAxis === 'X' ? 'ZtoX' : 'ZtoY';\n                        break;\n\n                }\n\n            }\n\n        };\n\n        function fixCoords( data, sign ) {\n\n            if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n                return;\n\n            }\n\n            switch ( upConversion ) {\n\n                case 'XtoY':\n\n                    var tmp = data[ 0 ];\n                    data[ 0 ] = sign * data[ 1 ];\n                    data[ 1 ] = tmp;\n                    break;\n\n                case 'XtoZ':\n\n                    var tmp = data[ 2 ];\n                    data[ 2 ] = data[ 1 ];\n                    data[ 1 ] = data[ 0 ];\n                    data[ 0 ] = tmp;\n                    break;\n\n                case 'YtoX':\n\n                    var tmp = data[ 0 ];\n                    data[ 0 ] = data[ 1 ];\n                    data[ 1 ] = sign * tmp;\n                    break;\n\n                case 'YtoZ':\n\n                    var tmp = data[ 1 ];\n                    data[ 1 ] = sign * data[ 2 ];\n                    data[ 2 ] = tmp;\n                    break;\n\n                case 'ZtoX':\n\n                    var tmp = data[ 0 ];\n                    data[ 0 ] = data[ 1 ];\n                    data[ 1 ] = data[ 2 ];\n                    data[ 2 ] = tmp;\n                    break;\n\n                case 'ZtoY':\n\n                    var tmp = data[ 1 ];\n                    data[ 1 ] = data[ 2 ];\n                    data[ 2 ] = sign * tmp;\n                    break;\n\n            }\n\n        };\n\n        function getConvertedTranslation( axis, data ) {\n\n            if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n                return data;\n\n            }\n\n            switch ( axis ) {\n                case 'X':\n                    data = upConversion === 'XtoY' ? data * -1 : data;\n                    break;\n                case 'Y':\n                    data = upConversion === 'YtoZ' || upConversion === 'YtoX' ? data * -1 : data;\n                    break;\n                case 'Z':\n                    data = upConversion === 'ZtoY' ? data * -1 : data ;\n                    break;\n                default:\n                    break;\n            }\n\n            return data;\n        };\n\n        function getConvertedVec3( data, offset ) {\n\n            var arr = [ data[ offset ], data[ offset + 1 ], data[ offset + 2 ] ];\n            fixCoords( arr, -1 );\n            return new THREE.Vector3( arr[ 0 ], arr[ 1 ], arr[ 2 ] );\n\n        };\n\n        function getConvertedMat4( data ) {\n\n            if ( options.convertUpAxis ) {\n\n                // First fix rotation and scale\n\n                // Columns first\n                var arr = [ data[ 0 ], data[ 4 ], data[ 8 ] ];\n                fixCoords( arr, -1 );\n                data[ 0 ] = arr[ 0 ];\n                data[ 4 ] = arr[ 1 ];\n                data[ 8 ] = arr[ 2 ];\n                arr = [ data[ 1 ], data[ 5 ], data[ 9 ] ];\n                fixCoords( arr, -1 );\n                data[ 1 ] = arr[ 0 ];\n                data[ 5 ] = arr[ 1 ];\n                data[ 9 ] = arr[ 2 ];\n                arr = [ data[ 2 ], data[ 6 ], data[ 10 ] ];\n                fixCoords( arr, -1 );\n                data[ 2 ] = arr[ 0 ];\n                data[ 6 ] = arr[ 1 ];\n                data[ 10 ] = arr[ 2 ];\n                // Rows second\n                arr = [ data[ 0 ], data[ 1 ], data[ 2 ] ];\n                fixCoords( arr, -1 );\n                data[ 0 ] = arr[ 0 ];\n                data[ 1 ] = arr[ 1 ];\n                data[ 2 ] = arr[ 2 ];\n                arr = [ data[ 4 ], data[ 5 ], data[ 6 ] ];\n                fixCoords( arr, -1 );\n                data[ 4 ] = arr[ 0 ];\n                data[ 5 ] = arr[ 1 ];\n                data[ 6 ] = arr[ 2 ];\n                arr = [ data[ 8 ], data[ 9 ], data[ 10 ] ];\n                fixCoords( arr, -1 );\n                data[ 8 ] = arr[ 0 ];\n                data[ 9 ] = arr[ 1 ];\n                data[ 10 ] = arr[ 2 ];\n\n                // Now fix translation\n                arr = [ data[ 3 ], data[ 7 ], data[ 11 ] ];\n                fixCoords( arr, -1 );\n                data[ 3 ] = arr[ 0 ];\n                data[ 7 ] = arr[ 1 ];\n                data[ 11 ] = arr[ 2 ];\n\n            }\n\n            return new THREE.Matrix4().set(\n                data[0], data[1], data[2], data[3],\n                data[4], data[5], data[6], data[7],\n                data[8], data[9], data[10], data[11],\n                data[12], data[13], data[14], data[15]\n                );\n\n        };\n\n        function getConvertedIndex( index ) {\n\n            if ( index > -1 && index < 3 ) {\n\n                var members = [ 'X', 'Y', 'Z' ],\n                    indices = { X: 0, Y: 1, Z: 2 };\n\n                index = getConvertedMember( members[ index ] );\n                index = indices[ index ];\n\n            }\n\n            return index;\n\n        };\n\n        function getConvertedMember( member ) {\n\n            if ( options.convertUpAxis ) {\n\n                switch ( member ) {\n\n                    case 'X':\n\n                        switch ( upConversion ) {\n\n                            case 'XtoY':\n                            case 'XtoZ':\n                            case 'YtoX':\n\n                                member = 'Y';\n                                break;\n\n                            case 'ZtoX':\n\n                                member = 'Z';\n                                break;\n\n                        }\n\n                        break;\n\n                    case 'Y':\n\n                        switch ( upConversion ) {\n\n                            case 'XtoY':\n                            case 'YtoX':\n                            case 'ZtoX':\n\n                                member = 'X';\n                                break;\n\n                            case 'XtoZ':\n                            case 'YtoZ':\n                            case 'ZtoY':\n\n                                member = 'Z';\n                                break;\n\n                        }\n\n                        break;\n\n                    case 'Z':\n\n                        switch ( upConversion ) {\n\n                            case 'XtoZ':\n\n                                member = 'X';\n                                break;\n\n                            case 'YtoZ':\n                            case 'ZtoX':\n                            case 'ZtoY':\n\n                                member = 'Y';\n                                break;\n\n                        }\n\n                        break;\n\n                }\n\n            }\n\n            return member;\n\n        };\n\n        return {\n\n            load: load,\n            parse: parse,\n            setPreferredShading: setPreferredShading,\n            applySkin: applySkin,\n            geometries : geometries,\n            options: options\n\n        };\n\n    };\n\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/three-loaders-collada/index.js"],"sourceRoot":""}